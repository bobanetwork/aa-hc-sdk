LavaPack.loadBundle([[1824,{"./bytes":1827,"./constants":1828,"./helpers":1830,"./internal":1832,"@ethereumjs/rlp":421,buffer:3028,"ethereum-cryptography/keccak":3260,"ethereum-cryptography/secp256k1":3277,"ethereum-cryptography/utils":3279},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.accountBodyToRLP=r.accountBodyToSlim=r.accountBodyFromSlim=r.isZeroAddress=r.zeroAddress=r.importPublic=r.privateToAddress=r.privateToPublic=r.publicToAddress=r.pubToAddress=r.isValidPublic=r.isValidPrivate=r.generateAddress2=r.generateAddress=r.isValidChecksumAddress=r.toChecksumAddress=r.isValidAddress=r.Account=void 0;const i=e("@ethereumjs/rlp"),n=e("ethereum-cryptography/keccak"),s=e("ethereum-cryptography/secp256k1"),a=e("ethereum-cryptography/utils"),o=e("./bytes"),l=e("./constants"),c=e("./helpers"),u=e("./internal"),d=BigInt(0);class h{constructor(e=d,t=d,r=l.KECCAK256_RLP,i=l.KECCAK256_NULL){this.nonce=e,this.balance=t,this.storageRoot=r,this.codeHash=i,this._validate()}static fromAccountData(e){const{nonce:t,balance:r,storageRoot:i,codeHash:n}=e;return new h(t!==undefined?(0,o.bufferToBigInt)((0,o.toBuffer)(t)):undefined,r!==undefined?(0,o.bufferToBigInt)((0,o.toBuffer)(r)):undefined,i!==undefined?(0,o.toBuffer)(i):undefined,n!==undefined?(0,o.toBuffer)(n):undefined)}static fromRlpSerializedAccount(e){const t=(0,o.arrToBufArr)(i.RLP.decode(Uint8Array.from(e)));if(!Array.isArray(t))throw new Error("Invalid serialized account input. Must be array");return this.fromValuesArray(t)}static fromValuesArray(e){const[t,r,i,n]=e;return new h((0,o.bufferToBigInt)(t),(0,o.bufferToBigInt)(r),i,n)}_validate(){if(this.nonce<d)throw new Error("nonce must be greater than zero");if(this.balance<d)throw new Error("balance must be greater than zero");if(32!==this.storageRoot.length)throw new Error("storageRoot must have a length of 32");if(32!==this.codeHash.length)throw new Error("codeHash must have a length of 32")}raw(){return[(0,o.bigIntToUnpaddedBuffer)(this.nonce),(0,o.bigIntToUnpaddedBuffer)(this.balance),this.storageRoot,this.codeHash]}serialize(){return t.from(i.RLP.encode((0,o.bufArrToArr)(this.raw())))}isContract(){return!this.codeHash.equals(l.KECCAK256_NULL)}isEmpty(){return this.balance===d&&this.nonce===d&&this.codeHash.equals(l.KECCAK256_NULL)}}r.Account=h;r.isValidAddress=function(e){try{(0,c.assertIsString)(e)}catch(e){return!1}return/^0x[0-9a-fA-F]{40}$/.test(e)};r.toChecksumAddress=function(e,r){(0,c.assertIsHexString)(e);const i=(0,u.stripHexPrefix)(e).toLowerCase();let s="";if(r!==undefined){s=(0,o.bufferToBigInt)((0,o.toBuffer)(r)).toString()+"0x"}const l=t.from(s+i,"utf8"),d=(0,a.bytesToHex)((0,n.keccak256)(l));let h="0x";for(let e=0;e<i.length;e++)parseInt(d[e],16)>=8?h+=i[e].toUpperCase():h+=i[e];return h};r.isValidChecksumAddress=function(e,t){return(0,r.isValidAddress)(e)&&(0,r.toChecksumAddress)(e,t)===e};r.generateAddress=function(e,r){return(0,c.assertIsBuffer)(e),(0,c.assertIsBuffer)(r),(0,o.bufferToBigInt)(r)===BigInt(0)?t.from((0,n.keccak256)(i.RLP.encode((0,o.bufArrToArr)([e,null])))).slice(-20):t.from((0,n.keccak256)(i.RLP.encode((0,o.bufArrToArr)([e,r])))).slice(-20)};r.generateAddress2=function(e,r,i){if((0,c.assertIsBuffer)(e),(0,c.assertIsBuffer)(r),(0,c.assertIsBuffer)(i),20!==e.length)throw new Error("Expected from to be of length 20");if(32!==r.length)throw new Error("Expected salt to be of length 32");const s=(0,n.keccak256)(t.concat([t.from("ff","hex"),e,r,(0,n.keccak256)(i)]));return(0,o.toBuffer)(s).slice(-20)};r.isValidPrivate=function(e){return s.secp256k1.utils.isValidPrivateKey(e)};r.isValidPublic=function(e,r=!1){if((0,c.assertIsBuffer)(e),64===e.length)try{return s.secp256k1.ProjectivePoint.fromHex(t.concat([t.from([4]),e])),!0}catch(e){return!1}if(!r)return!1;try{return s.secp256k1.ProjectivePoint.fromHex(e),!0}catch(e){return!1}};r.pubToAddress=function(e,r=!1){if((0,c.assertIsBuffer)(e),r&&64!==e.length&&(e=t.from(s.secp256k1.ProjectivePoint.fromHex(e).toRawBytes(!1).slice(1))),64!==e.length)throw new Error("Expected pubKey to be of length 64");return t.from((0,n.keccak256)(e)).slice(-20)},r.publicToAddress=r.pubToAddress;r.privateToPublic=function(e){return(0,c.assertIsBuffer)(e),t.from(s.secp256k1.ProjectivePoint.fromPrivateKey(e).toRawBytes(!1).slice(1))};r.privateToAddress=function(e){return(0,r.publicToAddress)((0,r.privateToPublic)(e))};r.importPublic=function(e){return(0,c.assertIsBuffer)(e),64!==e.length&&(e=t.from(s.secp256k1.ProjectivePoint.fromHex(e).toRawBytes(!1).slice(1))),e};r.zeroAddress=function(){const e=(0,o.zeros)(20);return(0,o.bufferToHex)(e)};function m(e){const[t,r,i,n]=e;return[t,r,0===(0,o.arrToBufArr)(i).length?l.KECCAK256_RLP:i,0===(0,o.arrToBufArr)(n).length?l.KECCAK256_NULL:n]}r.isZeroAddress=function(e){try{(0,c.assertIsString)(e)}catch(e){return!1}return(0,r.zeroAddress)()===e},r.accountBodyFromSlim=m;const p=new Uint8Array(0);r.accountBodyToSlim=function(e){const[t,r,i,n]=e;return[t,r,(0,o.arrToBufArr)(i).equals(l.KECCAK256_RLP)?p:i,(0,o.arrToBufArr)(n).equals(l.KECCAK256_NULL)?p:n]},r.accountBodyToRLP=function(e,t=!0){const r=t?m(e):e;return(0,o.arrToBufArr)(i.RLP.encode(r))}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/smart-transactions-controller>@metamask/controller-utils>@ethereumjs/util",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/controller-utils/node_modules/@ethereumjs/util/dist/account.js"}],[1825,{"./account":1824,"./bytes":1827,buffer:3028},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.Address=void 0;const i=e("./account"),n=e("./bytes");class s{constructor(e){if(20!==e.length)throw new Error("Invalid address length");this.buf=e}static zero(){return new s((0,n.zeros)(20))}static fromString(e){if(!(0,i.isValidAddress)(e))throw new Error("Invalid address");return new s((0,n.toBuffer)(e))}static fromPublicKey(e){if(!t.isBuffer(e))throw new Error("Public key should be Buffer");const r=(0,i.pubToAddress)(e);return new s(r)}static fromPrivateKey(e){if(!t.isBuffer(e))throw new Error("Private key should be Buffer");const r=(0,i.privateToAddress)(e);return new s(r)}static generate(e,t){if("bigint"!=typeof t)throw new Error("Expected nonce to be a bigint");return new s((0,i.generateAddress)(e.buf,(0,n.bigIntToBuffer)(t)))}static generate2(e,r,n){if(!t.isBuffer(r))throw new Error("Expected salt to be a Buffer");if(!t.isBuffer(n))throw new Error("Expected initCode to be a Buffer");return new s((0,i.generateAddress2)(e.buf,r,n))}equals(e){return this.buf.equals(e.buf)}isZero(){return this.equals(s.zero())}isPrecompileOrSystemAddress(){const e=(0,n.bufferToBigInt)(this.buf),t=BigInt(0),r=BigInt("0xffff");return e>=t&&e<=r}toString(){return"0x"+this.buf.toString("hex")}toBuffer(){return t.from(this.buf)}}r.Address=s}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/smart-transactions-controller>@metamask/controller-utils>@ethereumjs/util",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/controller-utils/node_modules/@ethereumjs/util/dist/address.js"}],[1826,{events:3328},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.AsyncEventEmitter=void 0;const i=e("events");class n extends i.EventEmitter{emit(e,...t){let[r,i]=t;const n=this;let s=n._events[e]??[];return i===undefined&&"function"==typeof r&&(i=r,r=undefined),"newListener"!==e&&"removeListener"!==e||(r={event:r,fn:i},i=undefined),s=Array.isArray(s)?s:[s],async function(e,t,r){let i;for await(const n of t)try{n.length<2?n.call(e,r):await new Promise(((t,i)=>{n.call(e,r,(e=>{e?i(e):t()}))}))}catch(e){i=e}if(i)throw i}(n,s.slice(),r).then(i).catch(i),n.listenerCount(e)>0}once(e,t){const r=this;let i;if("function"!=typeof t)throw new TypeError("listener must be a function");return i=t.length>=2?function(n,s){r.removeListener(e,i),t(n,s)}:function(n){r.removeListener(e,i),t(n,i)},r.on(e,i),r}first(e,t){let r=this._events[e]??[];if("function"!=typeof t)throw new TypeError("listener must be a function");return Array.isArray(r)||(this._events[e]=r=[r]),r.unshift(t),this}before(e,t,r){return this.beforeOrAfter(e,t,r)}after(e,t,r){return this.beforeOrAfter(e,t,r,"after")}beforeOrAfter(e,t,r,i){let n,s,a=this._events[e]??[];const o="after"===i?1:0;if("function"!=typeof r)throw new TypeError("listener must be a function");if("function"!=typeof t)throw new TypeError("target must be a function");for(Array.isArray(a)||(this._events[e]=a=[a]),s=a.length,n=a.length;n--;)if(a[n]===t){s=n+o;break}return a.splice(s,0,r),this}on(e,t){return super.on(e,t)}addListener(e,t){return super.addListener(e,t)}prependListener(e,t){return super.prependListener(e,t)}prependOnceListener(e,t){return super.prependOnceListener(e,t)}removeAllListeners(e){return super.removeAllListeners(e)}removeListener(e,t){return super.removeListener(e,t)}eventNames(){return super.eventNames()}listeners(e){return super.listeners(e)}listenerCount(e){return super.listenerCount(e)}getMaxListeners(){return super.getMaxListeners()}setMaxListeners(e){return super.setMaxListeners(e)}}r.AsyncEventEmitter=n}}},{package:"@metamask/smart-transactions-controller>@metamask/controller-utils>@ethereumjs/util",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/controller-utils/node_modules/@ethereumjs/util/dist/asyncEventEmitter.js"}],[1827,{"./helpers":1830,"./internal":1832,buffer:3028},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.intToUnpaddedBuffer=r.bigIntToUnpaddedBuffer=r.bigIntToHex=r.bufArrToArr=r.arrToBufArr=r.validateNoLeadingZeroes=r.baToJSON=r.toUtf8=r.short=r.addHexPrefix=r.toUnsigned=r.fromSigned=r.bufferToInt=r.bigIntToBuffer=r.bufferToBigInt=r.bufferToHex=r.toBuffer=r.unpadHexString=r.unpadArray=r.unpadBuffer=r.setLengthRight=r.setLengthLeft=r.zeros=r.intToBuffer=r.intToHex=void 0;const i=e("./helpers"),n=e("./internal");r.intToHex=function(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`Received an invalid integer type: ${e}`);return`0x${e.toString(16)}`};r.intToBuffer=function(e){const i=(0,r.intToHex)(e);return t.from((0,n.padToEven)(i.slice(2)),"hex")};r.zeros=function(e){return t.allocUnsafe(e).fill(0)};const s=function(e,t,i){const n=(0,r.zeros)(t);return i?e.length<t?(e.copy(n),n):e.slice(0,t):e.length<t?(e.copy(n,t-e.length),n):e.slice(-t)};r.setLengthLeft=function(e,t){return(0,i.assertIsBuffer)(e),s(e,t,!1)};r.setLengthRight=function(e,t){return(0,i.assertIsBuffer)(e),s(e,t,!0)};const a=function(e){let t=e[0];for(;e.length>0&&"0"===t.toString();)t=(e=e.slice(1))[0];return e};r.unpadBuffer=function(e){return(0,i.assertIsBuffer)(e),a(e)};r.unpadArray=function(e){return(0,i.assertIsArray)(e),a(e)};r.unpadHexString=function(e){return(0,i.assertIsHexString)(e),e=(0,n.stripHexPrefix)(e),"0x"+a(e)};r.toBuffer=function(e){if(null===e||e===undefined)return t.allocUnsafe(0);if(t.isBuffer(e))return t.from(e);if(Array.isArray(e)||e instanceof Uint8Array)return t.from(e);if("string"==typeof e){if(!(0,n.isHexString)(e))throw new Error(`Cannot convert string to buffer. toBuffer only supports 0x-prefixed hex strings and this string was given: ${e}`);return t.from((0,n.padToEven)((0,n.stripHexPrefix)(e)),"hex")}if("number"==typeof e)return(0,r.intToBuffer)(e);if("bigint"==typeof e){if(e<BigInt(0))throw new Error(`Cannot convert negative bigint to buffer. Given: ${e}`);let r=e.toString(16);return r.length%2&&(r="0"+r),t.from(r,"hex")}if(e.toArray)return t.from(e.toArray());if(e.toBuffer)return t.from(e.toBuffer());throw new Error("invalid type")};function o(e){const t=(0,r.bufferToHex)(e);return"0x"===t?BigInt(0):BigInt(t)}function l(e){return(0,r.toBuffer)("0x"+e.toString(16))}r.bufferToHex=function(e){return"0x"+(e=(0,r.toBuffer)(e)).toString("hex")},r.bufferToBigInt=o,r.bigIntToBuffer=l;r.bufferToInt=function(e){const t=Number(o(e));if(!Number.isSafeInteger(t))throw new Error("Number exceeds 53 bits");return t};r.fromSigned=function(e){return BigInt.asIntN(256,o(e))};r.toUnsigned=function(e){return l(BigInt.asUintN(256,e))};r.addHexPrefix=function(e){return"string"!=typeof e||(0,n.isHexPrefixed)(e)?e:"0x"+e},r.short=function(e,r=50){const i=t.isBuffer(e)?e.toString("hex"):e;return i.length<=r?i:i.slice(0,r)+"…"};r.toUtf8=function(e){if((e=(0,n.stripHexPrefix)(e)).length%2!=0)throw new Error("Invalid non-even hex string input for toUtf8() provided");return t.from(e.replace(/^(00)+|(00)+$/g,""),"hex").toString("utf8")};r.baToJSON=function(e){if(t.isBuffer(e))return`0x${e.toString("hex")}`;if(e instanceof Array){const t=[];for(let i=0;i<e.length;i++)t.push((0,r.baToJSON)(e[i]));return t}};r.validateNoLeadingZeroes=function(e){for(const[t,r]of Object.entries(e))if(r!==undefined&&r.length>0&&0===r[0])throw new Error(`${t} cannot have leading zeroes, received: ${r.toString("hex")}`)},r.arrToBufArr=function e(r){return Array.isArray(r)?r.map((t=>e(t))):t.from(r)},r.bufArrToArr=function e(t){return Array.isArray(t)?t.map((t=>e(t))):Uint8Array.from(t??[])};r.bigIntToHex=e=>"0x"+e.toString(16),r.bigIntToUnpaddedBuffer=function(e){return(0,r.unpadBuffer)(l(e))},r.intToUnpaddedBuffer=function(e){return(0,r.unpadBuffer)((0,r.intToBuffer)(e))}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/smart-transactions-controller>@metamask/controller-utils>@ethereumjs/util",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/controller-utils/node_modules/@ethereumjs/util/dist/bytes.js"}],[1828,{buffer:3028,"ethereum-cryptography/secp256k1":3277},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.MAX_WITHDRAWALS_PER_PAYLOAD=r.RLP_EMPTY_STRING=r.KECCAK256_RLP=r.KECCAK256_RLP_S=r.KECCAK256_RLP_ARRAY=r.KECCAK256_RLP_ARRAY_S=r.KECCAK256_NULL=r.KECCAK256_NULL_S=r.TWO_POW256=r.SECP256K1_ORDER_DIV_2=r.SECP256K1_ORDER=r.MAX_INTEGER_BIGINT=r.MAX_INTEGER=r.MAX_UINT64=void 0;const i=e("buffer"),n=e("ethereum-cryptography/secp256k1");r.MAX_UINT64=BigInt("0xffffffffffffffff"),r.MAX_INTEGER=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),r.MAX_INTEGER_BIGINT=BigInt("115792089237316195423570985008687907853269984665640564039457584007913129639935"),r.SECP256K1_ORDER=n.secp256k1.CURVE.n,r.SECP256K1_ORDER_DIV_2=n.secp256k1.CURVE.n/BigInt(2),r.TWO_POW256=BigInt("0x10000000000000000000000000000000000000000000000000000000000000000"),r.KECCAK256_NULL_S="c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470",r.KECCAK256_NULL=i.Buffer.from(r.KECCAK256_NULL_S,"hex"),r.KECCAK256_RLP_ARRAY_S="1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347",r.KECCAK256_RLP_ARRAY=i.Buffer.from(r.KECCAK256_RLP_ARRAY_S,"hex"),r.KECCAK256_RLP_S="56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421",r.KECCAK256_RLP=i.Buffer.from(r.KECCAK256_RLP_S,"hex"),r.RLP_EMPTY_STRING=i.Buffer.from([128]),r.MAX_WITHDRAWALS_PER_PAYLOAD=16}}},{package:"@metamask/smart-transactions-controller>@metamask/controller-utils>@ethereumjs/util",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/controller-utils/node_modules/@ethereumjs/util/dist/constants.js"}],[1829,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.compactBytesToNibbles=r.bytesToNibbles=r.nibblesToCompactBytes=r.nibblesToBytes=r.hasTerminator=void 0;r.hasTerminator=e=>e.length>0&&16===e[e.length-1];r.nibblesToBytes=(e,t)=>{for(let r=0,i=0;i<e.length;r+=1,i+=2)t[r]=e[i]<<4|e[i+1]};r.nibblesToCompactBytes=e=>{let t=0;(0,r.hasTerminator)(e)&&(t=1,e=e.subarray(0,e.length-1));const i=new Uint8Array(e.length/2+1);return i[0]=t<<5,1&~e.length||(i[0]|=16,i[0]|=e[0],e=e.subarray(1)),(0,r.nibblesToBytes)(e,i.subarray(1)),i};r.bytesToNibbles=e=>{const t=2*e.length+1,r=new Uint8Array(t);for(let t=0;t<e.length;t++){const i=e[t];r[2*t]=i/16,r[2*t+1]=i%16}return r[t-1]=16,r};r.compactBytesToNibbles=e=>{if(0===e.length)return e;let t=(0,r.bytesToNibbles)(e);t[0]<2&&(t=t.subarray(0,t.length-1));const i=2-(1&t[0]);return t.subarray(i)}}}},{package:"@metamask/smart-transactions-controller>@metamask/controller-utils>@ethereumjs/util",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/controller-utils/node_modules/@ethereumjs/util/dist/encoding.js"}],[183,{lodash:3836},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=e("lodash");r.default={version:63,async migrate(e){const t=(0,i.cloneDeep)(e);t.meta.version=63;const r=function(e){var t,r,i,n,s,a,o,l;const c=null==e||null===(t=e.PreferencesController)||void 0===t?void 0:t.accountTokens,u=null==e||null===(r=e.PreferencesController)||void 0===r?void 0:r.accountHiddenTokens,d={};c&&Object.keys(c).forEach((e=>{Object.keys(c[e]).forEach((t=>{const r=c[e][t];d[t]===undefined?d[t]={[e]:r}:d[t]={...d[t],[e]:r}}))}));const h={};u&&Object.keys(u).forEach((e=>{Object.keys(u[e]).forEach((t=>{const r=u[e][t];h[t]===undefined?h[t]={[e]:r}:h[t]={...h[t],[e]:r}}))}));e.TokensController?(e.TokensController.allTokens=d,e.TokensController.allIgnoredTokens=h):e.TokensController={allTokens:d,allIgnoredTokens:h};return null==e||null===(i=e.PreferencesController)||void 0===i||delete i.accountHiddenTokens,null==e||null===(n=e.PreferencesController)||void 0===n||delete n.accountTokens,null==e||null===(s=e.PreferencesController)||void 0===s||delete s.assetImages,null==e||null===(a=e.PreferencesController)||void 0===a||delete a.hiddenTokens,null==e||null===(o=e.PreferencesController)||void 0===o||delete o.tokens,null==e||null===(l=e.PreferencesController)||void 0===l||delete l.suggestedTokens,e}(t.data);return t.data=r,t}}}}},{package:"$root$",file:"app/scripts/migrations/063.js"}],[1830,{"../../../../../../../../../is-buffer/index.js":3648,"./internal":1832},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.assertIsString=r.assertIsArray=r.assertIsBuffer=r.assertIsHexString=void 0;const i=e("./internal");r.assertIsHexString=function(e){if(!(0,i.isHexString)(e)){throw new Error(`This method only supports 0x-prefixed hex strings but input was: ${e}`)}};r.assertIsBuffer=function(e){if(!t.isBuffer(e)){throw new Error(`This method only supports Buffer but input was: ${e}`)}};r.assertIsArray=function(e){if(!Array.isArray(e)){throw new Error(`This method only supports number arrays but input was: ${e}`)}};r.assertIsString=function(e){if("string"!=typeof e){throw new Error(`This method only supports strings but input was: ${e}`)}}}).call(this)}).call(this,{isBuffer:e("../../../../../../../../../is-buffer/index.js")})}}},{package:"@metamask/smart-transactions-controller>@metamask/controller-utils>@ethereumjs/util",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/controller-utils/node_modules/@ethereumjs/util/dist/helpers.js"}],[1831,{"./account":1824,"./address":1825,"./asyncEventEmitter":1826,"./bytes":1827,"./constants":1828,"./encoding":1829,"./internal":1832,"./lock":1833,"./provider":1834,"./signature":1835,"./types":1836,"./units":1837,"./withdrawal":1838},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var i=this&&this.__createBinding||(Object.create?function(e,t,r,i){i===undefined&&(i=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,i,n)}:function(e,t,r,i){i===undefined&&(i=r),e[i]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||i(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),r.toAscii=r.stripHexPrefix=r.padToEven=r.isHexString=r.isHexPrefixed=r.getKeys=r.getBinarySize=r.fromUtf8=r.fromAscii=r.arrayContainsArray=void 0,n(e("./constants"),r),n(e("./units"),r),n(e("./account"),r),n(e("./address"),r),n(e("./withdrawal"),r),n(e("./signature"),r),n(e("./bytes"),r),n(e("./types"),r),n(e("./encoding"),r),n(e("./asyncEventEmitter"),r);var s=e("./internal");Object.defineProperty(r,"arrayContainsArray",{enumerable:!0,get:function(){return s.arrayContainsArray}}),Object.defineProperty(r,"fromAscii",{enumerable:!0,get:function(){return s.fromAscii}}),Object.defineProperty(r,"fromUtf8",{enumerable:!0,get:function(){return s.fromUtf8}}),Object.defineProperty(r,"getBinarySize",{enumerable:!0,get:function(){return s.getBinarySize}}),Object.defineProperty(r,"getKeys",{enumerable:!0,get:function(){return s.getKeys}}),Object.defineProperty(r,"isHexPrefixed",{enumerable:!0,get:function(){return s.isHexPrefixed}}),Object.defineProperty(r,"isHexString",{enumerable:!0,get:function(){return s.isHexString}}),Object.defineProperty(r,"padToEven",{enumerable:!0,get:function(){return s.padToEven}}),Object.defineProperty(r,"stripHexPrefix",{enumerable:!0,get:function(){return s.stripHexPrefix}}),Object.defineProperty(r,"toAscii",{enumerable:!0,get:function(){return s.toAscii}}),n(e("./lock"),r),n(e("./provider"),r)}}},{package:"@metamask/smart-transactions-controller>@metamask/controller-utils>@ethereumjs/util",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/controller-utils/node_modules/@ethereumjs/util/dist/index.js"}],[1832,{buffer:3028},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(e){(function(){function t(e){if("string"!=typeof e)throw new Error("[isHexPrefixed] input must be type 'string', received type "+typeof e);return"0"===e[0]&&"x"===e[1]}Object.defineProperty(r,"__esModule",{value:!0}),r.isHexString=r.getKeys=r.fromAscii=r.fromUtf8=r.toAscii=r.arrayContainsArray=r.getBinarySize=r.padToEven=r.stripHexPrefix=r.isHexPrefixed=void 0,r.isHexPrefixed=t;function i(e){let t=e;if("string"!=typeof t)throw new Error("[padToEven] value must be type 'string', received "+typeof t);return t.length%2&&(t=`0${t}`),t}r.stripHexPrefix=e=>{if("string"!=typeof e)throw new Error("[stripHexPrefix] input must be type 'string', received "+typeof e);return t(e)?e.slice(2):e},r.padToEven=i,r.getBinarySize=function(t){if("string"!=typeof t)throw new Error("[getBinarySize] method requires input type 'string', received "+typeof t);return e.byteLength(t,"utf8")},r.arrayContainsArray=function(e,t,r){if(!0!==Array.isArray(e))throw new Error(`[arrayContainsArray] method requires input 'superset' to be an array, got type '${typeof e}'`);if(!0!==Array.isArray(t))throw new Error(`[arrayContainsArray] method requires input 'subset' to be an array, got type '${typeof t}'`);return t[!0===r?"some":"every"]((t=>e.indexOf(t)>=0))},r.toAscii=function(e){let t="",r=0;const i=e.length;for("0x"===e.substring(0,2)&&(r=2);r<i;r+=2){const i=parseInt(e.substr(r,2),16);t+=String.fromCharCode(i)}return t},r.fromUtf8=function(t){return`0x${i(e.from(t,"utf8").toString("hex")).replace(/^0+|0+$/g,"")}`},r.fromAscii=function(e){let t="";for(let r=0;r<e.length;r++){const i=e.charCodeAt(r).toString(16);t+=i.length<2?`0${i}`:i}return`0x${t}`},r.getKeys=function(e,t,r){if(!Array.isArray(e))throw new Error("[getKeys] method expects input 'params' to be an array, got "+typeof e);if("string"!=typeof t)throw new Error("[getKeys] method expects input 'key' to be type 'string', got "+typeof e);const i=[];for(let n=0;n<e.length;n++){let s=e[n][t];if(!0!==r||s){if("string"!=typeof s)throw new Error("invalid abi - expected type 'string', received "+typeof s)}else s="";i.push(s)}return i},r.isHexString=function(e,t){return!("string"!=typeof e||!e.match(/^0x[0-9A-Fa-f]*$/))&&!(void 0!==t&&t>0&&e.length!==2+2*t)}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/smart-transactions-controller>@metamask/controller-utils>@ethereumjs/util",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/controller-utils/node_modules/@ethereumjs/util/dist/internal.js"}],[1833,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.Lock=void 0;r.Lock=class{constructor(){this.permits=1,this.promiseResolverQueue=[]}async acquire(){return this.permits>0?(this.permits-=1,Promise.resolve(!0)):new Promise((e=>this.promiseResolverQueue.push(e)))}release(){if(this.permits+=1,this.permits>1&&this.promiseResolverQueue.length>0)console.warn("Lock.permits should never be > 0 when there is someone waiting.");else if(1===this.permits&&this.promiseResolverQueue.length>0){this.permits-=1;const e=this.promiseResolverQueue.shift();e&&e(!0)}}}}}},{package:"@metamask/smart-transactions-controller>@metamask/controller-utils>@ethereumjs/util",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/controller-utils/node_modules/@ethereumjs/util/dist/lock.js"}],[1834,{"micro-ftch":3879},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.getProvider=r.fetchFromProvider=void 0;const i=e("micro-ftch");r.fetchFromProvider=async(e,t)=>(await(0,i.default)(e,{headers:{"content-type":"application/json"},type:"json",data:{method:t.method,params:t.params,jsonrpc:"2.0",id:1}})).result;r.getProvider=e=>{if("string"==typeof e)return e;if(e?.connection?.url!==undefined)return e.connection.url;throw new Error("Must provide valid provider URL or Web3Provider")}}}},{package:"@metamask/smart-transactions-controller>@metamask/controller-utils>@ethereumjs/util",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/controller-utils/node_modules/@ethereumjs/util/dist/provider.js"}],[1835,{"./bytes":1827,"./constants":1828,"./helpers":1830,buffer:3028,"ethereum-cryptography/keccak":3260,"ethereum-cryptography/secp256k1":3277},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.hashPersonalMessage=r.isValidSignature=r.fromRpcSig=r.toCompactSig=r.toRpcSig=r.ecrecover=r.ecsign=void 0;const i=e("ethereum-cryptography/keccak"),n=e("ethereum-cryptography/secp256k1"),s=e("./bytes"),a=e("./constants"),o=e("./helpers");function l(e,t){return e===BigInt(0)||e===BigInt(1)?e:t===undefined?e-BigInt(27):e-(t*BigInt(2)+BigInt(35))}function c(e){return e===BigInt(0)||e===BigInt(1)}r.ecsign=function(e,r,i){const s=n.secp256k1.sign(e,r),a=s.toCompactRawBytes();return{r:t.from(a.slice(0,32)),s:t.from(a.slice(32,64)),v:i===undefined?BigInt(s.recovery+27):BigInt(s.recovery+35)+BigInt(i)*BigInt(2)}};r.ecrecover=function(e,r,i,a,o){const u=t.concat([(0,s.setLengthLeft)(i,32),(0,s.setLengthLeft)(a,32)],64),d=l(r,o);if(!c(d))throw new Error("Invalid signature v value");const h=n.secp256k1.Signature.fromCompact(u).addRecoveryBit(Number(d)).recoverPublicKey(e);return t.from(h.toRawBytes(!1).slice(1))};r.toRpcSig=function(e,r,i,n){if(!c(l(e,n)))throw new Error("Invalid signature v value");return(0,s.bufferToHex)(t.concat([(0,s.setLengthLeft)(r,32),(0,s.setLengthLeft)(i,32),(0,s.toBuffer)(e)]))};r.toCompactSig=function(e,r,i,n){if(!c(l(e,n)))throw new Error("Invalid signature v value");let a=i;return(e>BigInt(28)&&e%BigInt(2)===BigInt(1)||e===BigInt(1)||e===BigInt(28))&&(a=t.from(i),a[0]|=128),(0,s.bufferToHex)(t.concat([(0,s.setLengthLeft)(r,32),(0,s.setLengthLeft)(a,32)]))};r.fromRpcSig=function(e){const t=(0,s.toBuffer)(e);let r,i,n;if(t.length>=65)r=t.slice(0,32),i=t.slice(32,64),n=(0,s.bufferToBigInt)(t.slice(64));else{if(64!==t.length)throw new Error("Invalid signature length");r=t.slice(0,32),i=t.slice(32,64),n=BigInt((0,s.bufferToInt)(t.slice(32,33))>>7),i[0]&=127}return n<27&&(n+=BigInt(27)),{v:n,r:r,s:i}};r.isValidSignature=function(e,t,r,i=!0,n){if(32!==t.length||32!==r.length)return!1;if(!c(l(e,n)))return!1;const o=(0,s.bufferToBigInt)(t),u=(0,s.bufferToBigInt)(r);return!(o===BigInt(0)||o>=a.SECP256K1_ORDER||u===BigInt(0)||u>=a.SECP256K1_ORDER)&&!(i&&u>=a.SECP256K1_ORDER_DIV_2)};r.hashPersonalMessage=function(e){(0,o.assertIsBuffer)(e);const r=t.from(`Ethereum Signed Message:\n${e.length}`,"utf-8");return t.from((0,i.keccak256)(t.concat([r,e])))}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/smart-transactions-controller>@metamask/controller-utils>@ethereumjs/util",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/controller-utils/node_modules/@ethereumjs/util/dist/signature.js"}],[1836,{"./bytes":1827,"./internal":1832},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.toType=r.TypeOutput=void 0;const i=e("./bytes"),n=e("./internal");var s;!function(e){e[e.Number=0]="Number",e[e.BigInt=1]="BigInt",e[e.Buffer=2]="Buffer",e[e.PrefixedHexString=3]="PrefixedHexString"}(s=r.TypeOutput||(r.TypeOutput={})),r.toType=function(e,t){if(null===e)return null;if(e===undefined)return undefined;if("string"==typeof e&&!(0,n.isHexString)(e))throw new Error(`A string must be provided with a 0x-prefix, given: ${e}`);if("number"==typeof e&&!Number.isSafeInteger(e))throw new Error("The provided number is greater than MAX_SAFE_INTEGER (please use an alternative input type)");const r=(0,i.toBuffer)(e);switch(t){case s.Buffer:return r;case s.BigInt:return(0,i.bufferToBigInt)(r);case s.Number:{const e=(0,i.bufferToBigInt)(r);if(e>BigInt(Number.MAX_SAFE_INTEGER))throw new Error("The provided number is greater than MAX_SAFE_INTEGER (please use an alternative output type)");return Number(e)}case s.PrefixedHexString:return(0,i.bufferToHex)(r);default:throw new Error("unknown outputType")}}}}},{package:"@metamask/smart-transactions-controller>@metamask/controller-utils>@ethereumjs/util",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/controller-utils/node_modules/@ethereumjs/util/dist/types.js"}],[1837,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.GWEI_TO_WEI=void 0,r.GWEI_TO_WEI=BigInt(1e9)}}},{package:"@metamask/smart-transactions-controller>@metamask/controller-utils>@ethereumjs/util",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/controller-utils/node_modules/@ethereumjs/util/dist/units.js"}],[1838,{"./address":1825,"./bytes":1827,"./types":1836,buffer:3028},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.Withdrawal=void 0;const i=e("./address"),n=e("./bytes"),s=e("./types");class a{constructor(e,t,r,i){this.index=e,this.validatorIndex=t,this.address=r,this.amount=i}static fromWithdrawalData(e){const{index:t,validatorIndex:r,address:n,amount:o}=e,l=(0,s.toType)(t,s.TypeOutput.BigInt),c=(0,s.toType)(r,s.TypeOutput.BigInt),u=new i.Address((0,s.toType)(n,s.TypeOutput.Buffer)),d=(0,s.toType)(o,s.TypeOutput.BigInt);return new a(l,c,u,d)}static fromValuesArray(e){if(4!==e.length)throw Error(`Invalid withdrawalArray length expected=4 actual=${e.length}`);const[t,r,i,n]=e;return a.fromWithdrawalData({index:t,validatorIndex:r,address:i,amount:n})}static toBufferArray(e){const{index:r,validatorIndex:n,address:a,amount:o}=e,l=(0,s.toType)(r,s.TypeOutput.BigInt)===BigInt(0)?t.alloc(0):(0,s.toType)(r,s.TypeOutput.Buffer),c=(0,s.toType)(n,s.TypeOutput.BigInt)===BigInt(0)?t.alloc(0):(0,s.toType)(n,s.TypeOutput.Buffer);let u;u=a instanceof i.Address?a.buf:(0,s.toType)(a,s.TypeOutput.Buffer);return[l,c,u,(0,s.toType)(o,s.TypeOutput.BigInt)===BigInt(0)?t.alloc(0):(0,s.toType)(o,s.TypeOutput.Buffer)]}raw(){return a.toBufferArray(this)}toValue(){return{index:this.index,validatorIndex:this.validatorIndex,address:this.address.buf,amount:this.amount}}toJSON(){return{index:(0,n.bigIntToHex)(this.index),validatorIndex:(0,n.bigIntToHex)(this.validatorIndex),address:"0x"+this.address.buf.toString("hex"),amount:(0,n.bigIntToHex)(this.amount)}}}r.Withdrawal=a}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/smart-transactions-controller>@metamask/controller-utils>@ethereumjs/util",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/controller-utils/node_modules/@ethereumjs/util/dist/withdrawal.js"}],[1839,{"./has-tx-object":1840,"@babel/runtime/helpers/asyncToGenerator":1767,"@babel/runtime/helpers/interopRequireDefault":1768,"@babel/runtime/regenerator":1771,"@metamask/ethjs-filter":1842,"@metamask/ethjs-util":1846,"ethjs-abi":3325,"js-sha3":3673,"promise-to-callback":3993},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var i=e("@babel/runtime/helpers/interopRequireDefault"),n=i(e("@babel/runtime/regenerator")),s=i(e("@babel/runtime/helpers/asyncToGenerator")),a=e("ethjs-abi"),o=e("@metamask/ethjs-filter"),l=e("@metamask/ethjs-util").getKeys,c=e("js-sha3").keccak_256,u=e("promise-to-callback"),d=e("./has-tx-object");t.exports=function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},t=this;function r(e){return function(){var t,r=[].slice.call(arguments);"function"==typeof r[r.length-1]&&(t=r.pop());var n=function(e){return i.apply(this,arguments)}({methodObject:e,methodArgs:r});return t?u(n)(t):n}}function i(){return(i=(0,s.default)(n.default.mark((function e(r){var i,s,o,l,c,u,h;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=r.methodObject,s=r.methodArgs,o="call",l={},d(s)&&(l=s.pop()),(c=Object.assign({},t.defaultTxObject,l,{to:t.address})).data=a.encodeMethod(i,s),!1===i.constant&&(o="sendTransaction"),e.next=9,t.query[o](c);case 9:if(u=e.sent,"call"!==o){e.next=20;break}return e.prev=11,h=a.decodeMethod(i,u),e.abrupt("return",h);case 16:throw e.prev=16,e.t0=e.catch(11),new Error("[ethjs-contract] while formatting incoming raw call data "+JSON.stringify(u)+" "+e.t0);case 20:return e.abrupt("return",u);case 21:case"end":return e.stop()}}),e,null,[[11,16]])})))).apply(this,arguments)}t.abi=e.contractABI||[],t.query=e.query,t.address=e.address||"0x",t.bytecode=e.contractBytecode||"0x",t.defaultTxObject=e.contractDefaultTxObject||{},t.filters=new o(t.query),(h=t.abi,h.filter((function(e){return("function"===e.type||"event"===e.type)&&e.name.length>0}))).forEach((function(e){"function"===e.type?t[e.name]=r(e):"event"===e.type&&(t[e.name]=function(e){return function(){var r=[].slice.call(arguments),i=l(e.inputs,"type",!1),n=["0x"+c(e.name+"("+i.join(",")+")")],s=Object.assign({},r[0])||{},o=Object.assign({},r[0]||{},{to:t.address,topics:n}),u=Object.assign({},s,{decoder:function(t){return a.decodeEvent(e,t,n)},defaultFilterObject:o});return new t.filters.Filter(u)}}(e))}));var h}}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>eth-method-registry>@metamask/ethjs-contract",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/ethjs-contract/lib/contract.js"}],[184,{"@metamask/transaction-controller":2234,lodash:3836},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=e("lodash"),n=e("@metamask/transaction-controller");const s="sentEther";r.default={version:64,async migrate(e){const t=(0,i.cloneDeep)(e);t.meta.version=64;const r=function(e){var t;const r=null==e||null===(t=e.TransactionController)||void 0===t?void 0:t.transactions;if((0,i.isPlainObject)(r))for(const e of Object.values(r))e.type===s&&(e.type=n.TransactionType.simpleSend),e.history&&e.history.map((e=>(e.type&&e.type===s&&(e.type=n.TransactionType.simpleSend),e)));return e}(t.data);return t.data=r,t}}}}},{package:"$root$",file:"app/scripts/migrations/064.js"}],[1840,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var i=["from","to","data","value","gasPrice","gas"];t.exports=function(e){if(!Array.isArray(e)||0===e.length)return!1;var t=e[e.length-1];if(!t)return!1;if("object"!=typeof t)return!1;if(0===Object.keys(t).length)return!0;var r=Object.keys(t);if(i.some((function(e){return r.includes(e)})))return!0;return!1}}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>eth-method-registry>@metamask/ethjs-contract",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/ethjs-contract/lib/has-tx-object.js"}],[1841,{"./contract":1839,"./has-tx-object":1840,"@metamask/ethjs-filter":1842,"@metamask/ethjs-util":1846,"ethjs-abi":3325,"js-sha3":3673},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var i=e("ethjs-abi"),n=(e("js-sha3").keccak_256,e("@metamask/ethjs-filter"),e("@metamask/ethjs-util").getKeys),s=e("./contract"),a=e("./has-tx-object");t.exports=function(e){return function(t,r,o){if(!Array.isArray(t))throw new Error("[ethjs-contract] Contract ABI must be type Array, got type "+typeof t);if(void 0!==r&&"string"!=typeof r)throw new Error("[ethjs-contract] Contract bytecode must be type String, got type "+typeof r);if(void 0!==o&&"object"!=typeof o)throw new Error("[ethjs-contract] Contract default tx object must be type Object, got type "+typeof t);var l={at:function(i){return new s({address:i,query:e,contractBytecode:r,contractDefaultTxObject:o,contractABI:t})},new:function(){var s={},l=null,c=[].slice.call(arguments);"function"==typeof c[c.length-1]&&(l=c.pop()),a(c)&&(s=c.pop());var u=function(e){return e.filter((function(e){return"constructor"===e.type}))[0]}(t),d=Object.assign({},o,s);if(r&&(d.data=r),u){var h=i.encodeParams(n(u.inputs,"type"),c).substring(2);d.data=""+d.data+h}return l?e.sendTransaction(d,l):e.sendTransaction(d)}};return l}}}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>eth-method-registry>@metamask/ethjs-contract",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/ethjs-contract/lib/index.js"}],[1842,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){function i(e,t){function r(e){var r=this;r.filterId=null,r.options=Object.assign({delay:300,decoder:function(e){return e},defaultFilterObject:{}},e||{}),r.watchers={},r.interval=setInterval((function(){null!==r.filterId&&Object.keys(r.watchers).length>0&&t.getFilterChanges(r.filterId,(function(e,t){var i=[],n=null;if(!e)try{t.forEach((function(e,n){i[n]=t[n],"object"==typeof t[n]&&(i[n].data=r.options.decoder(i[n].data))}))}catch(e){n=new Error("[ethjs-filter] while decoding filter change event data from RPC '"+JSON.stringify(i)+"': "+e)}Object.keys(r.watchers).forEach((function(s){var a=r.watchers[s];!0!==a.stop?n?a.callback(n,null):e?a.callback(e,null):Array.isArray(i)&&t.length>0&&a.callback(e,i):delete r.watchers[s]}))}))}),r.options.delay)}return r.prototype.at=function(e){this.filterId=e},r.prototype.watch=function(e){var t=e||function(){},r=this,i=Math.random().toString(36).substring(7);return r.watchers[i]={callback:t,stop:!1,stopWatching:function(){r.watchers[i].stop=!0}},r.watchers[i]},r.prototype.uninstall=function(e){var r=this,i=e||null;r.watchers=Object.assign({}),clearInterval(r.interval);var n=new Promise((function(e,i){t.uninstallFilter(r.filterId,(function(t,r){t?i(t):e(r)}))}));return i&&n.then((function(e){return i(null,e)})).catch((function(e){return i(e,null)})),i?null:n},r.prototype.new=function(){var r=null,i=this,n=[],s=[].slice.call(arguments);"function"==typeof s[s.length-1]&&(r=s.pop()),"Filter"===e&&n.push(Object.assign(i.options.defaultFilterObject,s[s.length-1]||{}));var a=new Promise((function(r,s){n.push((function(e,t){e?s(e):(i.filterId=t,r(t))})),t["new"+e].apply(t,n)}));return r&&a.then((function(e){return r(null,e)})).catch((function(e){return r(e,null)})),r?null:a},r}t.exports=function e(t){var r=this;if(!(r instanceof e))throw new Error("the EthFilter object must be instantiated with `new` flag.. (e.g. `const filters = new EthFilter(query);`)");if("object"!=typeof t)throw new Error("the EthFilter object must be instantiated with an EthQuery instance (e.g. `const filters = new EthFilter(new EthQuery(provider));`). See github.com/ethjs/ethjs-query for more details..");r.Filter=i("Filter",t),r.BlockFilter=i("BlockFilter",t),r.PendingTransactionFilter=i("PendingTransactionFilter",t)}}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>eth-method-registry>@metamask/ethjs-contract>@metamask/ethjs-filter",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/ethjs-filter/lib/index.js"}],[1843,{"@metamask/ethjs-util":1846,"@metamask/number-to-bn":1602,"ethjs-schema":3327,"strip-hex-prefix":4355},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var i=e("@metamask/number-to-bn"),n=e("ethjs-schema"),s=e("@metamask/ethjs-util"),a=s.arrayContainsArray,o=s.getBinarySize,l=s.padToEven,c=e("strip-hex-prefix");function u(e,t,r){if(-1===["string","number","object"].indexOf(typeof e)||null===e)return e;var n=i(e),s=r&&n.toString(16).length%2?"0":"";if(i(e).isNeg())throw new Error("[ethjs-format] while formatting quantity '"+n.toString(10)+"', invalid negative number. Number must be positive or zero.");return t?"0x"+s+n.toString(16):n}function d(e,t){var r=e;return-1===n.tags.indexOf(e)&&(r=u(e,t)),r}function h(e,t){var r=e,i=0;if("string"==typeof e&&(r="0x"+l(c(e)),i=o(r)),"0x00"===r&&(r="0x0"),"number"==typeof t&&null!==e&&"0x"!==r&&"0x0"!==r&&(!/^[0-9A-Fa-f]+$/.test(c(r))||i!==2+2*t))throw new Error("[ethjs-format] hex string '"+r+"' must be an alphanumeric "+(2+2*t)+" utf8 byte hex (chars: a-fA-F) string, is "+i+" bytes");return r}function m(e,t,r){var i=Object.assign({},t),s=null;if("string"==typeof e&&(s="Boolean|EthSyncing"===e?Object.assign({},n.objects.EthSyncing):"DATA|Transaction"===e?Object.assign({},n.objects.Transaction):Object.assign({},n.objects[e])),!a(Object.keys(t),s.__required))throw new Error("[ethjs-format] object "+JSON.stringify(t)+" must contain properties: "+s.__required.join(", "));return Object.keys(s).forEach((function(e){"__required"!==e&&void 0!==t[e]&&(i[e]=f(s[e],t[e],r))})),i}function p(e,t,r,i){var n=t.slice(),s=e;if("Array|DATA"===e&&(s=["D"]),"FilterChange"===e&&"string"==typeof t[0]&&(s=["D32"]),!0===r&&"number"==typeof i&&t.length<i)throw new Error("array "+JSON.stringify(t)+" must contain at least "+i+" params, but only contains "+t.length+".");return s=s.slice(),t.forEach((function(e,t){var i=0;s.length>1&&(i=t),n[t]=f(s[i],e,r)})),n}function f(e,t,r,i){var n=t;return"Q"===e?n=u(t,r):"QP"===e?n=u(t,r,!0):"Q|T"===e?n=d(t,r):"D"===e?n=h(t):"D20"===e?n=h(t,20):"D32"===e?n=h(t,32):"object"==typeof t&&null!==t&&!1===Array.isArray(t)?n=m(e,t,r):Array.isArray(t)&&(n=p(e,t,r,i)),n}t.exports={schema:n,formatQuantity:u,formatQuantityOrTag:d,formatObject:m,formatArray:p,format:f,formatInputs:function(e,t){return f(n.methods[e][0],t,!0,n.methods[e][2])},formatOutputs:function(e,t){return f(n.methods[e][1],t,!1)}}}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>eth-method-registry>@metamask/ethjs-query>@metamask/ethjs-format",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/ethjs-format/lib/index.js"}],[1844,{"@metamask/ethjs-format":1843,"@metamask/ethjs-rpc":1845,"promise-to-callback":3993},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var i=e("@metamask/ethjs-format"),n=e("@metamask/ethjs-rpc"),s=e("promise-to-callback");function a(e,t){var r=this,i=t||{};if(!(this instanceof a))throw new Error('[ethjs-query] the Eth object requires the "new" flag in order to function normally (i.e. `const eth = new Eth(provider);`).');if("object"!=typeof e)throw new Error("[ethjs-query] the Eth object requires that the first input 'provider' must be an object, got '"+typeof e+"' (i.e. 'const eth = new Eth(provider);')");r.options=Object.assign({debug:i.debug||!1,logger:i.logger||console,jsonSpace:i.jsonSpace||0}),r.rpc=new n(e),r.setProvider=r.rpc.setProvider}function o(e,t){return function(){var r=null,n=null,a=this,o=[].slice.call(arguments),l=e.replace("eth_","");o.length>0&&"function"==typeof o[o.length-1]&&(r=o.pop());var c=function(){var r=this;return new Promise((function(s,c){if(o.length<t[2])c(new Error("[ethjs-query] method '"+l+"' requires at least "+t[2]+" input (format type "+t[0][0]+"), "+o.length+" provided. For more information visit: https://github.com/ethereum/wiki/wiki/JSON-RPC#"+e.toLowerCase()));else if(o.length>t[0].length)c(new Error("[ethjs-query] method '"+l+"' requires at most "+t[0].length+" params, "+o.length+" provided '"+JSON.stringify(o,null,a.options.jsonSpace)+"'. For more information visit: https://github.com/ethereum/wiki/wiki/JSON-RPC#"+e.toLowerCase()));else{t[3]&&o.length<t[3]&&o.push("latest"),r.log("attempting method formatting for '"+l+"' with inputs "+JSON.stringify(o,null,r.options.jsonSpace));try{n=i.formatInputs(e,o),r.log("method formatting success for '"+l+"' with formatted result: "+JSON.stringify(n,null,r.options.jsonSpace))}catch(e){return void c(new Error("[ethjs-query] while formatting inputs '"+JSON.stringify(o,null,r.options.jsonSpace)+"' for method '"+l+"' error: "+e))}r.rpc.sendAsync({method:e,params:n}).then((function(t){r.log("attempting method formatting for '"+l+"' with raw outputs: "+JSON.stringify(t,null,r.options.jsonSpace));var n=i.formatOutputs(e,t);r.log("method formatting success for '"+l+"' formatted result: "+JSON.stringify(n,null,r.options.jsonSpace)),s(n)})).catch((function(e){c(e)}))}}))}.call(this);return r?s(c)(r):c}}t.exports=a,a.prototype.log=function(e){this.options.debug&&this.options.logger.log("[ethjs-query log] "+e)},Object.keys(i.schema.methods).forEach((function(e){Object.defineProperty(a.prototype,e.replace("eth_",""),{enumerable:!0,value:o(e,i.schema.methods[e])})}))}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>eth-method-registry>@metamask/ethjs-query",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/ethjs-query/lib/index.js"}],[1845,{"promise-to-callback":3993},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var i=e("promise-to-callback");function n(e,t){var r=this,i=t||{};if(!(this instanceof n))throw new Error('[ethjs-rpc] the EthRPC object requires the "new" flag in order to function normally (i.e. `const eth = new EthRPC(provider);`).');r.options=Object.assign({jsonSpace:i.jsonSpace||0,max:i.max||9999999999999}),r.idCounter=Math.floor(Math.random()*r.options.max),r.setProvider=function(e){if("object"!=typeof e)throw new Error("[ethjs-rpc] the EthRPC object requires that the first input 'provider' must be an object, got '"+typeof e+"' (i.e. 'const eth = new EthRPC(provider);')");r.currentProvider=e},r.setProvider(e)}t.exports=n,n.prototype.sendAsync=function(e,t){var r=this;r.idCounter=r.idCounter%r.options.max;var n,s,a=(n=e,s=r.idCounter++,Object.assign({},{id:s,jsonrpc:"2.0",params:[]},n)),o=new Promise((function(e,t){r.currentProvider.sendAsync(a,(function(i,n){var s=n||{};if(i||s.error){var o="[ethjs-rpc] "+(s.error?"rpc":"")+" error with payload "+JSON.stringify(a,null,r.options.jsonSpace)+" "+(i?String(i):JSON.stringify(s.error,null,r.options.jsonSpace)),l=new Error(o);return l.value=i||s.error,void t(l)}e(s.result)}))}));return t?i(o)(t):o}}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>eth-method-registry>@metamask/ethjs-query>@metamask/ethjs-rpc",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/ethjs-rpc/lib/index.js"}],[1846,{buffer:3028,"is-hex-prefixed":3653,"strip-hex-prefix":4355},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(r){(function(){var i=e("is-hex-prefixed"),n=e("strip-hex-prefix");function s(e){var t=e;if("string"!=typeof t)throw new Error("[ethjs-util] while padding to even, value must be string, is currently "+typeof t+", while padToEven.");return t.length%2&&(t="0"+t),t}function a(e){return"0x"+e.toString(16)}t.exports={arrayContainsArray:function(e,t,r){if(!0!==Array.isArray(e))throw new Error("[ethjs-util] method arrayContainsArray requires input 'superset' to be an array got type '"+typeof e+"'");if(!0!==Array.isArray(t))throw new Error("[ethjs-util] method arrayContainsArray requires input 'subset' to be an array got type '"+typeof t+"'");return t[Boolean(r)?"some":"every"]((function(t){return e.indexOf(t)>=0}))},intToBuffer:function(e){var t=a(e);return r.from(s(t.slice(2)),"hex")},getBinarySize:function(e){if("string"!=typeof e)throw new Error("[ethjs-util] while getting binary size, method getBinarySize requires input 'str' to be type String, got '"+typeof e+"'.");return r.byteLength(e,"utf8")},isHexPrefixed:i,stripHexPrefix:n,padToEven:s,intToHex:a,fromAscii:function(e){for(var t="",r=0;r<e.length;r++){var i=e.charCodeAt(r).toString(16);t+=i.length<2?"0"+i:i}return"0x"+t},fromUtf8:function(e){return"0x"+s(r.from(e,"utf8").toString("hex")).replace(/^0+|0+$/g,"")},toAscii:function(e){var t="",r=0,i=e.length;for("0x"===e.substring(0,2)&&(r=2);r<i;r+=2){var n=parseInt(e.substr(r,2),16);t+=String.fromCharCode(n)}return t},toUtf8:function(e){return r.from(s(n(e).replace(/^0+|0+$/g,"")),"hex").toString("utf8")},getKeys:function(e,t,r){if(!Array.isArray(e))throw new Error("[ethjs-util] method getKeys expecting type Array as 'params' input, got '"+typeof e+"'");if("string"!=typeof t)throw new Error("[ethjs-util] method getKeys expecting type String for input 'key' got '"+typeof t+"'.");for(var i=[],n=0;n<e.length;n++){var s=e[n][t];if(r&&!s)s="";else if("string"!=typeof s)throw new Error("invalid abi");i.push(s)}return i},isHexString:function(e,t){return!("string"!=typeof e||!e.match(/^0x[0-9A-Fa-f]*$/))&&(!t||e.length===2+2*t)}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>eth-method-registry>@metamask/ethjs-contract>@metamask/ethjs-util",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/ethjs-util/lib/index.js"}],[1847,{"./chunk-Q2YPK5SL.js":1848,"@metamask/controller-utils":1876,"@metamask/eth-query":1316,"@metamask/polling-controller":1880,uuid:4424},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i,n,s,a,o=e("./chunk-Q2YPK5SL.js"),l=e("@metamask/controller-utils"),c=e("@metamask/eth-query"),u=(i=c)&&i.__esModule?i:{default:i},d=e("@metamask/polling-controller"),h=e("uuid"),m="https://gas.api.infura.io",p={FEE_MARKET:"fee-market",LEGACY:"legacy",ETH_GASPRICE:"eth_gasPrice",NONE:"none"},f={gasFeeEstimatesByChainId:{persist:!0,anonymous:!1},gasFeeEstimates:{persist:!0,anonymous:!1},estimatedGasFeeTimeBounds:{persist:!0,anonymous:!1},gasEstimateType:{persist:!0,anonymous:!1},nonRPCGasFeeApisDisabled:{persist:!0,anonymous:!1}},v={gasFeeEstimatesByChainId:{},gasFeeEstimates:{},estimatedGasFeeTimeBounds:{},gasEstimateType:p.NONE,nonRPCGasFeeApisDisabled:!1},g=class extends d.StaticIntervalPollingController{constructor({interval:e=15e3,messenger:t,state:r,getCurrentNetworkEIP1559Compatibility:i,getCurrentAccountEIP1559Compatibility:l,getChainId:c,getCurrentNetworkLegacyGasAPICompatibility:d,getProvider:h,onNetworkDidChange:p,clientId:g,infuraAPIKey:_}){super({name:"GasFeeController",metadata:f,messenger:t,state:{...v,...r}}),o.__privateAdd.call(void 0,this,s),o.__privateAdd.call(void 0,this,n,void 0),this.intervalDelay=e,this.setIntervalLength(e),this.pollTokens=new Set,this.getCurrentNetworkEIP1559Compatibility=i,this.getCurrentNetworkLegacyGasAPICompatibility=d,this.getCurrentAccountEIP1559Compatibility=l,o.__privateSet.call(void 0,this,n,h),this.EIP1559APIEndpoint=`${m}/networks/<chain_id>/suggestedGasFees`,this.legacyAPIEndpoint=`${m}/networks/<chain_id>/gasPrices`,this.clientId=g,this.infuraAPIKey=_,this.ethQuery=new(0,u.default)(o.__privateGet.call(void 0,this,n).call(this)),p&&c?(this.currentChainId=c(),p((async e=>{await o.__privateMethod.call(void 0,this,s,a).call(this,e)}))):(this.currentChainId=this.messagingSystem.call("NetworkController:getState").providerConfig.chainId,this.messagingSystem.subscribe("NetworkController:networkDidChange",(async e=>{await o.__privateMethod.call(void 0,this,s,a).call(this,e)})))}async resetPolling(){if(0!==this.pollTokens.size){const e=Array.from(this.pollTokens);this.stopPolling(),await this.getGasFeeEstimatesAndStartPolling(e[0]),e.slice(1).forEach((e=>{this.pollTokens.add(e)}))}}async fetchGasFeeEstimates(e){return await this._fetchGasFeeEstimateData(e)}async getGasFeeEstimatesAndStartPolling(e){const t=e||h.v1.call(void 0);return this.pollTokens.add(t),1===this.pollTokens.size&&(await this._fetchGasFeeEstimateData(),this._poll()),t}async _fetchGasFeeEstimateData(e={}){const{shouldUpdateState:t=!0,networkClientId:r}=e;let i,n,s,a;if(void 0!==r){const e=this.messagingSystem.call("NetworkController:getNetworkClientById",r);s="0x38"===e.configuration.chainId,a=l.convertHexToDecimal.call(void 0,e.configuration.chainId);try{n=await this.messagingSystem.call("NetworkController:getEIP1559Compatibility",r)||!1}catch{n=!1}i=new(0,u.default)(e.provider)}i??(i=this.ethQuery),s??(s=this.getCurrentNetworkLegacyGasAPICompatibility()),a??(a=l.convertHexToDecimal.call(void 0,this.currentChainId));try{n??(n=await this.getEIP1559Compatibility())}catch(e){console.error(e),n??(n=!1)}const c=await k({isEIP1559Compatible:n,isLegacyGasAPICompatible:s,fetchGasEstimates:o.fetchGasEstimates,fetchGasEstimatesUrl:this.EIP1559APIEndpoint.replace("<chain_id>",`${a}`),fetchLegacyGasPriceEstimates:o.fetchLegacyGasPriceEstimates,fetchLegacyGasPriceEstimatesUrl:this.legacyAPIEndpoint.replace("<chain_id>",`${a}`),fetchEthGasPriceEstimate:o.fetchEthGasPriceEstimate,calculateTimeEstimate:o.calculateTimeEstimate,clientId:this.clientId,ethQuery:i,infuraAPIKey:this.infuraAPIKey,nonRPCGasFeeApisDisabled:this.state.nonRPCGasFeeApisDisabled});if(t){const e=l.toHex.call(void 0,a);this.update((t=>{this.currentChainId===e&&(t.gasFeeEstimates=c.gasFeeEstimates,t.estimatedGasFeeTimeBounds=c.estimatedGasFeeTimeBounds,t.gasEstimateType=c.gasEstimateType),t.gasFeeEstimatesByChainId??(t.gasFeeEstimatesByChainId={}),t.gasFeeEstimatesByChainId[e]={gasFeeEstimates:c.gasFeeEstimates,estimatedGasFeeTimeBounds:c.estimatedGasFeeTimeBounds,gasEstimateType:c.gasEstimateType}}))}return c}disconnectPoller(e){this.pollTokens.delete(e),0===this.pollTokens.size&&this.stopPolling()}stopPolling(){this.intervalId&&clearInterval(this.intervalId),this.pollTokens.clear(),this.resetState()}destroy(){super.destroy(),this.stopPolling()}_poll(){this.intervalId&&clearInterval(this.intervalId),this.intervalId=setInterval((async()=>{await l.safelyExecute.call(void 0,(()=>this._fetchGasFeeEstimateData()))}),this.intervalDelay)}async _executePoll(e){await this._fetchGasFeeEstimateData({networkClientId:e})}resetState(){this.update((()=>v))}async getEIP1559Compatibility(){const e=await this.getCurrentNetworkEIP1559Compatibility(),t=this.getCurrentAccountEIP1559Compatibility?.()??!0;return e&&t}getTimeEstimate(e,t){return this.state.gasFeeEstimates&&this.state.gasEstimateType===p.FEE_MARKET?o.calculateTimeEstimate.call(void 0,e,t,this.state.gasFeeEstimates):{}}enableNonRPCGasFeeApis(){this.update((e=>{e.nonRPCGasFeeApisDisabled=!1}))}disableNonRPCGasFeeApis(){this.update((e=>{e.nonRPCGasFeeApisDisabled=!0}))}};n=new WeakMap,s=new WeakSet,a=async function(e){const t=e.providerConfig.chainId;t!==this.currentChainId&&(this.ethQuery=new(0,u.default)(o.__privateGet.call(void 0,this,n).call(this)),await this.resetPolling(),this.currentChainId=t)};var _=g;async function k(e){try{return await async function(e){const{isEIP1559Compatible:t,isLegacyGasAPICompatible:r,nonRPCGasFeeApisDisabled:i}=e;try{if(t&&!i)return await async function(e){const{fetchGasEstimates:t,fetchGasEstimatesUrl:r,infuraAPIKey:i,clientId:n,calculateTimeEstimate:s}=e,a=await t(r,i,n),{suggestedMaxPriorityFeePerGas:o,suggestedMaxFeePerGas:l}=a.medium,c=s(o,l,a);return{gasFeeEstimates:a,estimatedGasFeeTimeBounds:c,gasEstimateType:p.FEE_MARKET}}(e);if(r&&!i)return await async function(e){const{fetchLegacyGasPriceEstimates:t,fetchLegacyGasPriceEstimatesUrl:r,infuraAPIKey:i,clientId:n}=e;return{gasFeeEstimates:await t(r,i,n),estimatedGasFeeTimeBounds:{},gasEstimateType:p.LEGACY}}(e);throw new Error("Main gas fee/price estimation failed. Use fallback")}catch{return await async function(e){const{ethQuery:t,fetchEthGasPriceEstimate:r}=e;return{gasFeeEstimates:await r(t),estimatedGasFeeTimeBounds:{},gasEstimateType:p.ETH_GASPRICE}}(e)}}(e)}catch(e){if(e instanceof Error)throw new Error(`Gas fee/price estimation failed. Message: ${e.message}`);throw e}}r.determineGasFeeCalculations=k,r.GAS_API_BASE_URL=m,r.GAS_ESTIMATE_TYPES=p,r.GasFeeController=g,r.GasFeeController_default=_}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@metamask/gas-fee-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/gas-fee-controller/dist/chunk-H5WHAYLI.js"}],[1848,{"@metamask/controller-utils":1876,"bn.js":2980,buffer:3028},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0});var i,n=(e,t,r)=>{if(!t.has(e))throw TypeError("Cannot "+r)},s=e("@metamask/controller-utils"),a=e("bn.js"),o=(i=a)&&i.__esModule?i:{default:i},l=e=>({"X-Client-Id":e});function c(e){const t=s.gweiDecToWEIBN.call(void 0,e).toString(16);return s.weiHexToGweiDec.call(void 0,t)}function u(e){return t.from(`${e}:`).toString("base64")}function d(e,t){return{"Content-Type":"application/json",Authorization:`Basic ${e}`,...t?.trim()?l(t):{}}}r.__privateGet=(e,t,r)=>(n(e,t,"read from private field"),r?r.call(e):t.get(e)),r.__privateAdd=(e,t,r)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,r)},r.__privateSet=(e,t,r,i)=>(n(e,t,"write to private field"),i?i.call(e,r):t.set(e,r),r),r.__privateMethod=(e,t,r)=>(n(e,t,"access private method"),r),r.normalizeGWEIDecimalNumbers=c,r.fetchGasEstimates=async function(e,t,r){const i=u(t),n=await s.handleFetch.call(void 0,e,{headers:d(i,r)});return{low:{...n.low,suggestedMaxPriorityFeePerGas:c(n.low.suggestedMaxPriorityFeePerGas),suggestedMaxFeePerGas:c(n.low.suggestedMaxFeePerGas)},medium:{...n.medium,suggestedMaxPriorityFeePerGas:c(n.medium.suggestedMaxPriorityFeePerGas),suggestedMaxFeePerGas:c(n.medium.suggestedMaxFeePerGas)},high:{...n.high,suggestedMaxPriorityFeePerGas:c(n.high.suggestedMaxPriorityFeePerGas),suggestedMaxFeePerGas:c(n.high.suggestedMaxFeePerGas)},estimatedBaseFee:c(n.estimatedBaseFee),historicalBaseFeeRange:n.historicalBaseFeeRange,baseFeeTrend:n.baseFeeTrend,latestPriorityFeeRange:n.latestPriorityFeeRange,historicalPriorityFeeRange:n.historicalPriorityFeeRange,priorityFeeTrend:n.priorityFeeTrend,networkCongestion:n.networkCongestion}},r.fetchLegacyGasPriceEstimates=async function(e,t,r){const i=u(t),n=await s.handleFetch.call(void 0,e,{referrer:e,referrerPolicy:"no-referrer-when-downgrade",method:"GET",mode:"cors",headers:d(i,r)});return{low:n.SafeGasPrice,medium:n.ProposeGasPrice,high:n.FastGasPrice}},r.fetchEthGasPriceEstimate=async function(e){const t=await s.query.call(void 0,e,"gasPrice");return{gasPrice:s.weiHexToGweiDec.call(void 0,t).toString()}},r.calculateTimeEstimate=function(e,t,r){const{low:i,medium:n,high:a,estimatedBaseFee:l}=r,c=s.gweiDecToWEIBN.call(void 0,e),u=s.gweiDecToWEIBN.call(void 0,t),d=s.gweiDecToWEIBN.call(void 0,l),h=o.default.min(c,u.sub(d)),m=s.gweiDecToWEIBN.call(void 0,i.suggestedMaxPriorityFeePerGas),p=s.gweiDecToWEIBN.call(void 0,n.suggestedMaxPriorityFeePerGas),f=s.gweiDecToWEIBN.call(void 0,a.suggestedMaxPriorityFeePerGas);let v,g;return h.lt(m)?(v=null,g="unknown"):h.gte(m)&&h.lt(p)?(v=i.minWaitTimeEstimate,g=i.maxWaitTimeEstimate):h.gte(p)&&h.lt(f)?(v=n.minWaitTimeEstimate,g=n.maxWaitTimeEstimate):h.eq(f)?(v=a.minWaitTimeEstimate,g=a.maxWaitTimeEstimate):(v=0,g=a.maxWaitTimeEstimate),{lowerTimeBound:v,upperTimeBound:g}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@metamask/gas-fee-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/gas-fee-controller/dist/chunk-Q2YPK5SL.js"}],[1849,{"./chunk-H5WHAYLI.js":1847,"./chunk-Q2YPK5SL.js":1848},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i=e("./chunk-H5WHAYLI.js");e("./chunk-Q2YPK5SL.js"),r.GAS_API_BASE_URL=i.GAS_API_BASE_URL,r.GAS_ESTIMATE_TYPES=i.GAS_ESTIMATE_TYPES,r.GasFeeController=i.GasFeeController}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@metamask/gas-fee-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/gas-fee-controller/dist/index.js"}],[185,{lodash:3836},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=e("lodash");r.default={version:65,async migrate(e){const t=(0,i.cloneDeep)(e);t.meta.version=65;const r=function(e){if(e.PreferencesController){const{completedOnboarding:t,firstTimeFlowType:r}=e.PreferencesController;e.OnboardingController=e.OnboardingController??{},t!==undefined&&(e.OnboardingController.completedOnboarding=t,delete e.PreferencesController.completedOnboarding),r!==undefined&&(e.OnboardingController.firstTimeFlowType=r,delete e.PreferencesController.firstTimeFlowType)}return e}(t.data);return t.data=r,t}}}}},{package:"$root$",file:"app/scripts/migrations/065.js"}],[1850,{"./bytes":1853,"./constants":1854,"./helpers":1856,"./internal":1858,"@ethereumjs/rlp":421,buffer:3028,"ethereum-cryptography/keccak":3260,"ethereum-cryptography/secp256k1":3277,"ethereum-cryptography/utils":3279},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.accountBodyToRLP=r.accountBodyToSlim=r.accountBodyFromSlim=r.isZeroAddress=r.zeroAddress=r.importPublic=r.privateToAddress=r.privateToPublic=r.publicToAddress=r.pubToAddress=r.isValidPublic=r.isValidPrivate=r.generateAddress2=r.generateAddress=r.isValidChecksumAddress=r.toChecksumAddress=r.isValidAddress=r.Account=void 0;const i=e("@ethereumjs/rlp"),n=e("ethereum-cryptography/keccak"),s=e("ethereum-cryptography/secp256k1"),a=e("ethereum-cryptography/utils"),o=e("./bytes"),l=e("./constants"),c=e("./helpers"),u=e("./internal"),d=BigInt(0);class h{constructor(e=d,t=d,r=l.KECCAK256_RLP,i=l.KECCAK256_NULL){this.nonce=e,this.balance=t,this.storageRoot=r,this.codeHash=i,this._validate()}static fromAccountData(e){const{nonce:t,balance:r,storageRoot:i,codeHash:n}=e;return new h(t!==undefined?(0,o.bufferToBigInt)((0,o.toBuffer)(t)):undefined,r!==undefined?(0,o.bufferToBigInt)((0,o.toBuffer)(r)):undefined,i!==undefined?(0,o.toBuffer)(i):undefined,n!==undefined?(0,o.toBuffer)(n):undefined)}static fromRlpSerializedAccount(e){const t=(0,o.arrToBufArr)(i.RLP.decode(Uint8Array.from(e)));if(!Array.isArray(t))throw new Error("Invalid serialized account input. Must be array");return this.fromValuesArray(t)}static fromValuesArray(e){const[t,r,i,n]=e;return new h((0,o.bufferToBigInt)(t),(0,o.bufferToBigInt)(r),i,n)}_validate(){if(this.nonce<d)throw new Error("nonce must be greater than zero");if(this.balance<d)throw new Error("balance must be greater than zero");if(32!==this.storageRoot.length)throw new Error("storageRoot must have a length of 32");if(32!==this.codeHash.length)throw new Error("codeHash must have a length of 32")}raw(){return[(0,o.bigIntToUnpaddedBuffer)(this.nonce),(0,o.bigIntToUnpaddedBuffer)(this.balance),this.storageRoot,this.codeHash]}serialize(){return t.from(i.RLP.encode((0,o.bufArrToArr)(this.raw())))}isContract(){return!this.codeHash.equals(l.KECCAK256_NULL)}isEmpty(){return this.balance===d&&this.nonce===d&&this.codeHash.equals(l.KECCAK256_NULL)}}r.Account=h;r.isValidAddress=function(e){try{(0,c.assertIsString)(e)}catch(e){return!1}return/^0x[0-9a-fA-F]{40}$/.test(e)};r.toChecksumAddress=function(e,r){(0,c.assertIsHexString)(e);const i=(0,u.stripHexPrefix)(e).toLowerCase();let s="";if(r!==undefined){s=(0,o.bufferToBigInt)((0,o.toBuffer)(r)).toString()+"0x"}const l=t.from(s+i,"utf8"),d=(0,a.bytesToHex)((0,n.keccak256)(l));let h="0x";for(let e=0;e<i.length;e++)parseInt(d[e],16)>=8?h+=i[e].toUpperCase():h+=i[e];return h};r.isValidChecksumAddress=function(e,t){return(0,r.isValidAddress)(e)&&(0,r.toChecksumAddress)(e,t)===e};r.generateAddress=function(e,r){return(0,c.assertIsBuffer)(e),(0,c.assertIsBuffer)(r),(0,o.bufferToBigInt)(r)===BigInt(0)?t.from((0,n.keccak256)(i.RLP.encode((0,o.bufArrToArr)([e,null])))).slice(-20):t.from((0,n.keccak256)(i.RLP.encode((0,o.bufArrToArr)([e,r])))).slice(-20)};r.generateAddress2=function(e,r,i){if((0,c.assertIsBuffer)(e),(0,c.assertIsBuffer)(r),(0,c.assertIsBuffer)(i),20!==e.length)throw new Error("Expected from to be of length 20");if(32!==r.length)throw new Error("Expected salt to be of length 32");const s=(0,n.keccak256)(t.concat([t.from("ff","hex"),e,r,(0,n.keccak256)(i)]));return(0,o.toBuffer)(s).slice(-20)};r.isValidPrivate=function(e){return s.secp256k1.utils.isValidPrivateKey(e)};r.isValidPublic=function(e,r=!1){if((0,c.assertIsBuffer)(e),64===e.length)try{return s.secp256k1.ProjectivePoint.fromHex(t.concat([t.from([4]),e])),!0}catch(e){return!1}if(!r)return!1;try{return s.secp256k1.ProjectivePoint.fromHex(e),!0}catch(e){return!1}};r.pubToAddress=function(e,r=!1){if((0,c.assertIsBuffer)(e),r&&64!==e.length&&(e=t.from(s.secp256k1.ProjectivePoint.fromHex(e).toRawBytes(!1).slice(1))),64!==e.length)throw new Error("Expected pubKey to be of length 64");return t.from((0,n.keccak256)(e)).slice(-20)},r.publicToAddress=r.pubToAddress;r.privateToPublic=function(e){return(0,c.assertIsBuffer)(e),t.from(s.secp256k1.ProjectivePoint.fromPrivateKey(e).toRawBytes(!1).slice(1))};r.privateToAddress=function(e){return(0,r.publicToAddress)((0,r.privateToPublic)(e))};r.importPublic=function(e){return(0,c.assertIsBuffer)(e),64!==e.length&&(e=t.from(s.secp256k1.ProjectivePoint.fromHex(e).toRawBytes(!1).slice(1))),e};r.zeroAddress=function(){const e=(0,o.zeros)(20);return(0,o.bufferToHex)(e)};function m(e){const[t,r,i,n]=e;return[t,r,0===(0,o.arrToBufArr)(i).length?l.KECCAK256_RLP:i,0===(0,o.arrToBufArr)(n).length?l.KECCAK256_NULL:n]}r.isZeroAddress=function(e){try{(0,c.assertIsString)(e)}catch(e){return!1}return(0,r.zeroAddress)()===e},r.accountBodyFromSlim=m;const p=new Uint8Array(0);r.accountBodyToSlim=function(e){const[t,r,i,n]=e;return[t,r,(0,o.arrToBufArr)(i).equals(l.KECCAK256_RLP)?p:i,(0,o.arrToBufArr)(n).equals(l.KECCAK256_NULL)?p:n]},r.accountBodyToRLP=function(e,t=!0){const r=t?m(e):e;return(0,o.arrToBufArr)(i.RLP.encode(r))}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@metamask/gas-fee-controller>@metamask/controller-utils>@ethereumjs/util",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/gas-fee-controller/node_modules/@ethereumjs/util/dist/account.js"}],[1851,{"./account":1850,"./bytes":1853,buffer:3028},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.Address=void 0;const i=e("./account"),n=e("./bytes");class s{constructor(e){if(20!==e.length)throw new Error("Invalid address length");this.buf=e}static zero(){return new s((0,n.zeros)(20))}static fromString(e){if(!(0,i.isValidAddress)(e))throw new Error("Invalid address");return new s((0,n.toBuffer)(e))}static fromPublicKey(e){if(!t.isBuffer(e))throw new Error("Public key should be Buffer");const r=(0,i.pubToAddress)(e);return new s(r)}static fromPrivateKey(e){if(!t.isBuffer(e))throw new Error("Private key should be Buffer");const r=(0,i.privateToAddress)(e);return new s(r)}static generate(e,t){if("bigint"!=typeof t)throw new Error("Expected nonce to be a bigint");return new s((0,i.generateAddress)(e.buf,(0,n.bigIntToBuffer)(t)))}static generate2(e,r,n){if(!t.isBuffer(r))throw new Error("Expected salt to be a Buffer");if(!t.isBuffer(n))throw new Error("Expected initCode to be a Buffer");return new s((0,i.generateAddress2)(e.buf,r,n))}equals(e){return this.buf.equals(e.buf)}isZero(){return this.equals(s.zero())}isPrecompileOrSystemAddress(){const e=(0,n.bufferToBigInt)(this.buf),t=BigInt(0),r=BigInt("0xffff");return e>=t&&e<=r}toString(){return"0x"+this.buf.toString("hex")}toBuffer(){return t.from(this.buf)}}r.Address=s}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@metamask/gas-fee-controller>@metamask/controller-utils>@ethereumjs/util",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/gas-fee-controller/node_modules/@ethereumjs/util/dist/address.js"}],[1852,{events:3328},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.AsyncEventEmitter=void 0;const i=e("events");class n extends i.EventEmitter{emit(e,...t){let[r,i]=t;const n=this;let s=n._events[e]??[];return i===undefined&&"function"==typeof r&&(i=r,r=undefined),"newListener"!==e&&"removeListener"!==e||(r={event:r,fn:i},i=undefined),s=Array.isArray(s)?s:[s],async function(e,t,r){let i;for await(const n of t)try{n.length<2?n.call(e,r):await new Promise(((t,i)=>{n.call(e,r,(e=>{e?i(e):t()}))}))}catch(e){i=e}if(i)throw i}(n,s.slice(),r).then(i).catch(i),n.listenerCount(e)>0}once(e,t){const r=this;let i;if("function"!=typeof t)throw new TypeError("listener must be a function");return i=t.length>=2?function(n,s){r.removeListener(e,i),t(n,s)}:function(n){r.removeListener(e,i),t(n,i)},r.on(e,i),r}first(e,t){let r=this._events[e]??[];if("function"!=typeof t)throw new TypeError("listener must be a function");return Array.isArray(r)||(this._events[e]=r=[r]),r.unshift(t),this}before(e,t,r){return this.beforeOrAfter(e,t,r)}after(e,t,r){return this.beforeOrAfter(e,t,r,"after")}beforeOrAfter(e,t,r,i){let n,s,a=this._events[e]??[];const o="after"===i?1:0;if("function"!=typeof r)throw new TypeError("listener must be a function");if("function"!=typeof t)throw new TypeError("target must be a function");for(Array.isArray(a)||(this._events[e]=a=[a]),s=a.length,n=a.length;n--;)if(a[n]===t){s=n+o;break}return a.splice(s,0,r),this}on(e,t){return super.on(e,t)}addListener(e,t){return super.addListener(e,t)}prependListener(e,t){return super.prependListener(e,t)}prependOnceListener(e,t){return super.prependOnceListener(e,t)}removeAllListeners(e){return super.removeAllListeners(e)}removeListener(e,t){return super.removeListener(e,t)}eventNames(){return super.eventNames()}listeners(e){return super.listeners(e)}listenerCount(e){return super.listenerCount(e)}getMaxListeners(){return super.getMaxListeners()}setMaxListeners(e){return super.setMaxListeners(e)}}r.AsyncEventEmitter=n}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@metamask/gas-fee-controller>@metamask/controller-utils>@ethereumjs/util",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/gas-fee-controller/node_modules/@ethereumjs/util/dist/asyncEventEmitter.js"}],[1853,{"./helpers":1856,"./internal":1858,buffer:3028},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.intToUnpaddedBuffer=r.bigIntToUnpaddedBuffer=r.bigIntToHex=r.bufArrToArr=r.arrToBufArr=r.validateNoLeadingZeroes=r.baToJSON=r.toUtf8=r.short=r.addHexPrefix=r.toUnsigned=r.fromSigned=r.bufferToInt=r.bigIntToBuffer=r.bufferToBigInt=r.bufferToHex=r.toBuffer=r.unpadHexString=r.unpadArray=r.unpadBuffer=r.setLengthRight=r.setLengthLeft=r.zeros=r.intToBuffer=r.intToHex=void 0;const i=e("./helpers"),n=e("./internal");r.intToHex=function(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`Received an invalid integer type: ${e}`);return`0x${e.toString(16)}`};r.intToBuffer=function(e){const i=(0,r.intToHex)(e);return t.from((0,n.padToEven)(i.slice(2)),"hex")};r.zeros=function(e){return t.allocUnsafe(e).fill(0)};const s=function(e,t,i){const n=(0,r.zeros)(t);return i?e.length<t?(e.copy(n),n):e.slice(0,t):e.length<t?(e.copy(n,t-e.length),n):e.slice(-t)};r.setLengthLeft=function(e,t){return(0,i.assertIsBuffer)(e),s(e,t,!1)};r.setLengthRight=function(e,t){return(0,i.assertIsBuffer)(e),s(e,t,!0)};const a=function(e){let t=e[0];for(;e.length>0&&"0"===t.toString();)t=(e=e.slice(1))[0];return e};r.unpadBuffer=function(e){return(0,i.assertIsBuffer)(e),a(e)};r.unpadArray=function(e){return(0,i.assertIsArray)(e),a(e)};r.unpadHexString=function(e){return(0,i.assertIsHexString)(e),e=(0,n.stripHexPrefix)(e),"0x"+a(e)};r.toBuffer=function(e){if(null===e||e===undefined)return t.allocUnsafe(0);if(t.isBuffer(e))return t.from(e);if(Array.isArray(e)||e instanceof Uint8Array)return t.from(e);if("string"==typeof e){if(!(0,n.isHexString)(e))throw new Error(`Cannot convert string to buffer. toBuffer only supports 0x-prefixed hex strings and this string was given: ${e}`);return t.from((0,n.padToEven)((0,n.stripHexPrefix)(e)),"hex")}if("number"==typeof e)return(0,r.intToBuffer)(e);if("bigint"==typeof e){if(e<BigInt(0))throw new Error(`Cannot convert negative bigint to buffer. Given: ${e}`);let r=e.toString(16);return r.length%2&&(r="0"+r),t.from(r,"hex")}if(e.toArray)return t.from(e.toArray());if(e.toBuffer)return t.from(e.toBuffer());throw new Error("invalid type")};function o(e){const t=(0,r.bufferToHex)(e);return"0x"===t?BigInt(0):BigInt(t)}function l(e){return(0,r.toBuffer)("0x"+e.toString(16))}r.bufferToHex=function(e){return"0x"+(e=(0,r.toBuffer)(e)).toString("hex")},r.bufferToBigInt=o,r.bigIntToBuffer=l;r.bufferToInt=function(e){const t=Number(o(e));if(!Number.isSafeInteger(t))throw new Error("Number exceeds 53 bits");return t};r.fromSigned=function(e){return BigInt.asIntN(256,o(e))};r.toUnsigned=function(e){return l(BigInt.asUintN(256,e))};r.addHexPrefix=function(e){return"string"!=typeof e||(0,n.isHexPrefixed)(e)?e:"0x"+e},r.short=function(e,r=50){const i=t.isBuffer(e)?e.toString("hex"):e;return i.length<=r?i:i.slice(0,r)+"…"};r.toUtf8=function(e){if((e=(0,n.stripHexPrefix)(e)).length%2!=0)throw new Error("Invalid non-even hex string input for toUtf8() provided");return t.from(e.replace(/^(00)+|(00)+$/g,""),"hex").toString("utf8")};r.baToJSON=function(e){if(t.isBuffer(e))return`0x${e.toString("hex")}`;if(e instanceof Array){const t=[];for(let i=0;i<e.length;i++)t.push((0,r.baToJSON)(e[i]));return t}};r.validateNoLeadingZeroes=function(e){for(const[t,r]of Object.entries(e))if(r!==undefined&&r.length>0&&0===r[0])throw new Error(`${t} cannot have leading zeroes, received: ${r.toString("hex")}`)},r.arrToBufArr=function e(r){return Array.isArray(r)?r.map((t=>e(t))):t.from(r)},r.bufArrToArr=function e(t){return Array.isArray(t)?t.map((t=>e(t))):Uint8Array.from(t??[])};r.bigIntToHex=e=>"0x"+e.toString(16),r.bigIntToUnpaddedBuffer=function(e){return(0,r.unpadBuffer)(l(e))},r.intToUnpaddedBuffer=function(e){return(0,r.unpadBuffer)((0,r.intToBuffer)(e))}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@metamask/gas-fee-controller>@metamask/controller-utils>@ethereumjs/util",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/gas-fee-controller/node_modules/@ethereumjs/util/dist/bytes.js"}],[1854,{buffer:3028,"ethereum-cryptography/secp256k1":3277},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.MAX_WITHDRAWALS_PER_PAYLOAD=r.RLP_EMPTY_STRING=r.KECCAK256_RLP=r.KECCAK256_RLP_S=r.KECCAK256_RLP_ARRAY=r.KECCAK256_RLP_ARRAY_S=r.KECCAK256_NULL=r.KECCAK256_NULL_S=r.TWO_POW256=r.SECP256K1_ORDER_DIV_2=r.SECP256K1_ORDER=r.MAX_INTEGER_BIGINT=r.MAX_INTEGER=r.MAX_UINT64=void 0;const i=e("buffer"),n=e("ethereum-cryptography/secp256k1");r.MAX_UINT64=BigInt("0xffffffffffffffff"),r.MAX_INTEGER=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),r.MAX_INTEGER_BIGINT=BigInt("115792089237316195423570985008687907853269984665640564039457584007913129639935"),r.SECP256K1_ORDER=n.secp256k1.CURVE.n,r.SECP256K1_ORDER_DIV_2=n.secp256k1.CURVE.n/BigInt(2),r.TWO_POW256=BigInt("0x10000000000000000000000000000000000000000000000000000000000000000"),r.KECCAK256_NULL_S="c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470",r.KECCAK256_NULL=i.Buffer.from(r.KECCAK256_NULL_S,"hex"),r.KECCAK256_RLP_ARRAY_S="1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347",r.KECCAK256_RLP_ARRAY=i.Buffer.from(r.KECCAK256_RLP_ARRAY_S,"hex"),r.KECCAK256_RLP_S="56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421",r.KECCAK256_RLP=i.Buffer.from(r.KECCAK256_RLP_S,"hex"),r.RLP_EMPTY_STRING=i.Buffer.from([128]),r.MAX_WITHDRAWALS_PER_PAYLOAD=16}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@metamask/gas-fee-controller>@metamask/controller-utils>@ethereumjs/util",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/gas-fee-controller/node_modules/@ethereumjs/util/dist/constants.js"}],[1855,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.compactBytesToNibbles=r.bytesToNibbles=r.nibblesToCompactBytes=r.nibblesToBytes=r.hasTerminator=void 0;r.hasTerminator=e=>e.length>0&&16===e[e.length-1];r.nibblesToBytes=(e,t)=>{for(let r=0,i=0;i<e.length;r+=1,i+=2)t[r]=e[i]<<4|e[i+1]};r.nibblesToCompactBytes=e=>{let t=0;(0,r.hasTerminator)(e)&&(t=1,e=e.subarray(0,e.length-1));const i=new Uint8Array(e.length/2+1);return i[0]=t<<5,1&~e.length||(i[0]|=16,i[0]|=e[0],e=e.subarray(1)),(0,r.nibblesToBytes)(e,i.subarray(1)),i};r.bytesToNibbles=e=>{const t=2*e.length+1,r=new Uint8Array(t);for(let t=0;t<e.length;t++){const i=e[t];r[2*t]=i/16,r[2*t+1]=i%16}return r[t-1]=16,r};r.compactBytesToNibbles=e=>{if(0===e.length)return e;let t=(0,r.bytesToNibbles)(e);t[0]<2&&(t=t.subarray(0,t.length-1));const i=2-(1&t[0]);return t.subarray(i)}}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@metamask/gas-fee-controller>@metamask/controller-utils>@ethereumjs/util",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/gas-fee-controller/node_modules/@ethereumjs/util/dist/encoding.js"}],[1856,{"../../../../../../../../../is-buffer/index.js":3648,"./internal":1858},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.assertIsString=r.assertIsArray=r.assertIsBuffer=r.assertIsHexString=void 0;const i=e("./internal");r.assertIsHexString=function(e){if(!(0,i.isHexString)(e)){throw new Error(`This method only supports 0x-prefixed hex strings but input was: ${e}`)}};r.assertIsBuffer=function(e){if(!t.isBuffer(e)){throw new Error(`This method only supports Buffer but input was: ${e}`)}};r.assertIsArray=function(e){if(!Array.isArray(e)){throw new Error(`This method only supports number arrays but input was: ${e}`)}};r.assertIsString=function(e){if("string"!=typeof e){throw new Error(`This method only supports strings but input was: ${e}`)}}}).call(this)}).call(this,{isBuffer:e("../../../../../../../../../is-buffer/index.js")})}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@metamask/gas-fee-controller>@metamask/controller-utils>@ethereumjs/util",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/gas-fee-controller/node_modules/@ethereumjs/util/dist/helpers.js"}],[1857,{"./account":1850,"./address":1851,"./asyncEventEmitter":1852,"./bytes":1853,"./constants":1854,"./encoding":1855,"./internal":1858,"./lock":1859,"./provider":1860,"./signature":1861,"./types":1862,"./units":1863,"./withdrawal":1864},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var i=this&&this.__createBinding||(Object.create?function(e,t,r,i){i===undefined&&(i=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,i,n)}:function(e,t,r,i){i===undefined&&(i=r),e[i]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||i(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),r.toAscii=r.stripHexPrefix=r.padToEven=r.isHexString=r.isHexPrefixed=r.getKeys=r.getBinarySize=r.fromUtf8=r.fromAscii=r.arrayContainsArray=void 0,n(e("./constants"),r),n(e("./units"),r),n(e("./account"),r),n(e("./address"),r),n(e("./withdrawal"),r),n(e("./signature"),r),n(e("./bytes"),r),n(e("./types"),r),n(e("./encoding"),r),n(e("./asyncEventEmitter"),r);var s=e("./internal");Object.defineProperty(r,"arrayContainsArray",{enumerable:!0,get:function(){return s.arrayContainsArray}}),Object.defineProperty(r,"fromAscii",{enumerable:!0,get:function(){return s.fromAscii}}),Object.defineProperty(r,"fromUtf8",{enumerable:!0,get:function(){return s.fromUtf8}}),Object.defineProperty(r,"getBinarySize",{enumerable:!0,get:function(){return s.getBinarySize}}),Object.defineProperty(r,"getKeys",{enumerable:!0,get:function(){return s.getKeys}}),Object.defineProperty(r,"isHexPrefixed",{enumerable:!0,get:function(){return s.isHexPrefixed}}),Object.defineProperty(r,"isHexString",{enumerable:!0,get:function(){return s.isHexString}}),Object.defineProperty(r,"padToEven",{enumerable:!0,get:function(){return s.padToEven}}),Object.defineProperty(r,"stripHexPrefix",{enumerable:!0,get:function(){return s.stripHexPrefix}}),Object.defineProperty(r,"toAscii",{enumerable:!0,get:function(){return s.toAscii}}),n(e("./lock"),r),n(e("./provider"),r)}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@metamask/gas-fee-controller>@metamask/controller-utils>@ethereumjs/util",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/gas-fee-controller/node_modules/@ethereumjs/util/dist/index.js"}],[1858,{buffer:3028},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(e){(function(){function t(e){if("string"!=typeof e)throw new Error("[isHexPrefixed] input must be type 'string', received type "+typeof e);return"0"===e[0]&&"x"===e[1]}Object.defineProperty(r,"__esModule",{value:!0}),r.isHexString=r.getKeys=r.fromAscii=r.fromUtf8=r.toAscii=r.arrayContainsArray=r.getBinarySize=r.padToEven=r.stripHexPrefix=r.isHexPrefixed=void 0,r.isHexPrefixed=t;function i(e){let t=e;if("string"!=typeof t)throw new Error("[padToEven] value must be type 'string', received "+typeof t);return t.length%2&&(t=`0${t}`),t}r.stripHexPrefix=e=>{if("string"!=typeof e)throw new Error("[stripHexPrefix] input must be type 'string', received "+typeof e);return t(e)?e.slice(2):e},r.padToEven=i,r.getBinarySize=function(t){if("string"!=typeof t)throw new Error("[getBinarySize] method requires input type 'string', received "+typeof t);return e.byteLength(t,"utf8")},r.arrayContainsArray=function(e,t,r){if(!0!==Array.isArray(e))throw new Error(`[arrayContainsArray] method requires input 'superset' to be an array, got type '${typeof e}'`);if(!0!==Array.isArray(t))throw new Error(`[arrayContainsArray] method requires input 'subset' to be an array, got type '${typeof t}'`);return t[!0===r?"some":"every"]((t=>e.indexOf(t)>=0))},r.toAscii=function(e){let t="",r=0;const i=e.length;for("0x"===e.substring(0,2)&&(r=2);r<i;r+=2){const i=parseInt(e.substr(r,2),16);t+=String.fromCharCode(i)}return t},r.fromUtf8=function(t){return`0x${i(e.from(t,"utf8").toString("hex")).replace(/^0+|0+$/g,"")}`},r.fromAscii=function(e){let t="";for(let r=0;r<e.length;r++){const i=e.charCodeAt(r).toString(16);t+=i.length<2?`0${i}`:i}return`0x${t}`},r.getKeys=function(e,t,r){if(!Array.isArray(e))throw new Error("[getKeys] method expects input 'params' to be an array, got "+typeof e);if("string"!=typeof t)throw new Error("[getKeys] method expects input 'key' to be type 'string', got "+typeof e);const i=[];for(let n=0;n<e.length;n++){let s=e[n][t];if(!0!==r||s){if("string"!=typeof s)throw new Error("invalid abi - expected type 'string', received "+typeof s)}else s="";i.push(s)}return i},r.isHexString=function(e,t){return!("string"!=typeof e||!e.match(/^0x[0-9A-Fa-f]*$/))&&!(void 0!==t&&t>0&&e.length!==2+2*t)}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@metamask/gas-fee-controller>@metamask/controller-utils>@ethereumjs/util",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/gas-fee-controller/node_modules/@ethereumjs/util/dist/internal.js"}],[1859,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.Lock=void 0;r.Lock=class{constructor(){this.permits=1,this.promiseResolverQueue=[]}async acquire(){return this.permits>0?(this.permits-=1,Promise.resolve(!0)):new Promise((e=>this.promiseResolverQueue.push(e)))}release(){if(this.permits+=1,this.permits>1&&this.promiseResolverQueue.length>0)console.warn("Lock.permits should never be > 0 when there is someone waiting.");else if(1===this.permits&&this.promiseResolverQueue.length>0){this.permits-=1;const e=this.promiseResolverQueue.shift();e&&e(!0)}}}}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@metamask/gas-fee-controller>@metamask/controller-utils>@ethereumjs/util",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/gas-fee-controller/node_modules/@ethereumjs/util/dist/lock.js"}],[186,{"../../../shared/constants/hardware-wallets":4501,lodash:3836},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=e("lodash"),n=e("../../../shared/constants/hardware-wallets");r.default={version:66,async migrate(e){const t=(0,i.cloneDeep)(e);t.meta.version=66;const r=function(e){var t;const r=window.navigator.hid?n.LedgerTransportTypes.webhid:n.LedgerTransportTypes.u2f,i=Boolean(null===(t=e.PreferencesController)||void 0===t?void 0:t.useLedgerLive),s={...e,PreferencesController:{...null==e?void 0:e.PreferencesController,ledgerTransportType:i?n.LedgerTransportTypes.live:r}};return delete s.PreferencesController.useLedgerLive,s}(t.data);return t.data=r,t}}}}},{package:"$root$",file:"app/scripts/migrations/066.js"}],[1860,{"micro-ftch":3879},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.getProvider=r.fetchFromProvider=void 0;const i=e("micro-ftch");r.fetchFromProvider=async(e,t)=>(await(0,i.default)(e,{headers:{"content-type":"application/json"},type:"json",data:{method:t.method,params:t.params,jsonrpc:"2.0",id:1}})).result;r.getProvider=e=>{if("string"==typeof e)return e;if(e?.connection?.url!==undefined)return e.connection.url;throw new Error("Must provide valid provider URL or Web3Provider")}}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@metamask/gas-fee-controller>@metamask/controller-utils>@ethereumjs/util",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/gas-fee-controller/node_modules/@ethereumjs/util/dist/provider.js"}],[1861,{"./bytes":1853,"./constants":1854,"./helpers":1856,buffer:3028,"ethereum-cryptography/keccak":3260,"ethereum-cryptography/secp256k1":3277},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.hashPersonalMessage=r.isValidSignature=r.fromRpcSig=r.toCompactSig=r.toRpcSig=r.ecrecover=r.ecsign=void 0;const i=e("ethereum-cryptography/keccak"),n=e("ethereum-cryptography/secp256k1"),s=e("./bytes"),a=e("./constants"),o=e("./helpers");function l(e,t){return e===BigInt(0)||e===BigInt(1)?e:t===undefined?e-BigInt(27):e-(t*BigInt(2)+BigInt(35))}function c(e){return e===BigInt(0)||e===BigInt(1)}r.ecsign=function(e,r,i){const s=n.secp256k1.sign(e,r),a=s.toCompactRawBytes();return{r:t.from(a.slice(0,32)),s:t.from(a.slice(32,64)),v:i===undefined?BigInt(s.recovery+27):BigInt(s.recovery+35)+BigInt(i)*BigInt(2)}};r.ecrecover=function(e,r,i,a,o){const u=t.concat([(0,s.setLengthLeft)(i,32),(0,s.setLengthLeft)(a,32)],64),d=l(r,o);if(!c(d))throw new Error("Invalid signature v value");const h=n.secp256k1.Signature.fromCompact(u).addRecoveryBit(Number(d)).recoverPublicKey(e);return t.from(h.toRawBytes(!1).slice(1))};r.toRpcSig=function(e,r,i,n){if(!c(l(e,n)))throw new Error("Invalid signature v value");return(0,s.bufferToHex)(t.concat([(0,s.setLengthLeft)(r,32),(0,s.setLengthLeft)(i,32),(0,s.toBuffer)(e)]))};r.toCompactSig=function(e,r,i,n){if(!c(l(e,n)))throw new Error("Invalid signature v value");let a=i;return(e>BigInt(28)&&e%BigInt(2)===BigInt(1)||e===BigInt(1)||e===BigInt(28))&&(a=t.from(i),a[0]|=128),(0,s.bufferToHex)(t.concat([(0,s.setLengthLeft)(r,32),(0,s.setLengthLeft)(a,32)]))};r.fromRpcSig=function(e){const t=(0,s.toBuffer)(e);let r,i,n;if(t.length>=65)r=t.slice(0,32),i=t.slice(32,64),n=(0,s.bufferToBigInt)(t.slice(64));else{if(64!==t.length)throw new Error("Invalid signature length");r=t.slice(0,32),i=t.slice(32,64),n=BigInt((0,s.bufferToInt)(t.slice(32,33))>>7),i[0]&=127}return n<27&&(n+=BigInt(27)),{v:n,r:r,s:i}};r.isValidSignature=function(e,t,r,i=!0,n){if(32!==t.length||32!==r.length)return!1;if(!c(l(e,n)))return!1;const o=(0,s.bufferToBigInt)(t),u=(0,s.bufferToBigInt)(r);return!(o===BigInt(0)||o>=a.SECP256K1_ORDER||u===BigInt(0)||u>=a.SECP256K1_ORDER)&&!(i&&u>=a.SECP256K1_ORDER_DIV_2)};r.hashPersonalMessage=function(e){(0,o.assertIsBuffer)(e);const r=t.from(`Ethereum Signed Message:\n${e.length}`,"utf-8");return t.from((0,i.keccak256)(t.concat([r,e])))}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@metamask/gas-fee-controller>@metamask/controller-utils>@ethereumjs/util",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/gas-fee-controller/node_modules/@ethereumjs/util/dist/signature.js"}],[1862,{"./bytes":1853,"./internal":1858},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.toType=r.TypeOutput=void 0;const i=e("./bytes"),n=e("./internal");var s;!function(e){e[e.Number=0]="Number",e[e.BigInt=1]="BigInt",e[e.Buffer=2]="Buffer",e[e.PrefixedHexString=3]="PrefixedHexString"}(s=r.TypeOutput||(r.TypeOutput={})),r.toType=function(e,t){if(null===e)return null;if(e===undefined)return undefined;if("string"==typeof e&&!(0,n.isHexString)(e))throw new Error(`A string must be provided with a 0x-prefix, given: ${e}`);if("number"==typeof e&&!Number.isSafeInteger(e))throw new Error("The provided number is greater than MAX_SAFE_INTEGER (please use an alternative input type)");const r=(0,i.toBuffer)(e);switch(t){case s.Buffer:return r;case s.BigInt:return(0,i.bufferToBigInt)(r);case s.Number:{const e=(0,i.bufferToBigInt)(r);if(e>BigInt(Number.MAX_SAFE_INTEGER))throw new Error("The provided number is greater than MAX_SAFE_INTEGER (please use an alternative output type)");return Number(e)}case s.PrefixedHexString:return(0,i.bufferToHex)(r);default:throw new Error("unknown outputType")}}}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@metamask/gas-fee-controller>@metamask/controller-utils>@ethereumjs/util",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/gas-fee-controller/node_modules/@ethereumjs/util/dist/types.js"}],[1863,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.GWEI_TO_WEI=void 0,r.GWEI_TO_WEI=BigInt(1e9)}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@metamask/gas-fee-controller>@metamask/controller-utils>@ethereumjs/util",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/gas-fee-controller/node_modules/@ethereumjs/util/dist/units.js"}],[1864,{"./address":1851,"./bytes":1853,"./types":1862,buffer:3028},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.Withdrawal=void 0;const i=e("./address"),n=e("./bytes"),s=e("./types");class a{constructor(e,t,r,i){this.index=e,this.validatorIndex=t,this.address=r,this.amount=i}static fromWithdrawalData(e){const{index:t,validatorIndex:r,address:n,amount:o}=e,l=(0,s.toType)(t,s.TypeOutput.BigInt),c=(0,s.toType)(r,s.TypeOutput.BigInt),u=new i.Address((0,s.toType)(n,s.TypeOutput.Buffer)),d=(0,s.toType)(o,s.TypeOutput.BigInt);return new a(l,c,u,d)}static fromValuesArray(e){if(4!==e.length)throw Error(`Invalid withdrawalArray length expected=4 actual=${e.length}`);const[t,r,i,n]=e;return a.fromWithdrawalData({index:t,validatorIndex:r,address:i,amount:n})}static toBufferArray(e){const{index:r,validatorIndex:n,address:a,amount:o}=e,l=(0,s.toType)(r,s.TypeOutput.BigInt)===BigInt(0)?t.alloc(0):(0,s.toType)(r,s.TypeOutput.Buffer),c=(0,s.toType)(n,s.TypeOutput.BigInt)===BigInt(0)?t.alloc(0):(0,s.toType)(n,s.TypeOutput.Buffer);let u;u=a instanceof i.Address?a.buf:(0,s.toType)(a,s.TypeOutput.Buffer);return[l,c,u,(0,s.toType)(o,s.TypeOutput.BigInt)===BigInt(0)?t.alloc(0):(0,s.toType)(o,s.TypeOutput.Buffer)]}raw(){return a.toBufferArray(this)}toValue(){return{index:this.index,validatorIndex:this.validatorIndex,address:this.address.buf,amount:this.amount}}toJSON(){return{index:(0,n.bigIntToHex)(this.index),validatorIndex:(0,n.bigIntToHex)(this.validatorIndex),address:"0x"+this.address.buf.toString("hex"),amount:(0,n.bigIntToHex)(this.amount)}}}r.Withdrawal=a}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@metamask/gas-fee-controller>@metamask/controller-utils>@ethereumjs/util",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/gas-fee-controller/node_modules/@ethereumjs/util/dist/withdrawal.js"}],[1865,{"./chunk-UJFCPTF3.js":1867,"./chunk-Z4BLTVTB.js":1868},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i,n,s,a,o=e("./chunk-UJFCPTF3.js"),l=e("./chunk-Z4BLTVTB.js");i=new WeakMap,n=new WeakMap,s=new WeakMap,a=new WeakMap,r.ControllerMessenger=class{constructor(){l.__privateAdd.call(void 0,this,i,new Map),l.__privateAdd.call(void 0,this,n,new Map),l.__privateAdd.call(void 0,this,s,new Map),l.__privateAdd.call(void 0,this,a,new Map)}registerActionHandler(e,t){if(l.__privateGet.call(void 0,this,i).has(e))throw new Error(`A handler for ${e} has already been registered`);l.__privateGet.call(void 0,this,i).set(e,t)}unregisterActionHandler(e){l.__privateGet.call(void 0,this,i).delete(e)}clearActions(){l.__privateGet.call(void 0,this,i).clear()}call(e,...t){const r=l.__privateGet.call(void 0,this,i).get(e);if(!r)throw new Error(`A handler for ${e} has not been registered`);return r(...t)}registerInitialEventPayload({eventType:e,getPayload:t}){l.__privateGet.call(void 0,this,s).set(e,t)}publish(e,...t){const r=l.__privateGet.call(void 0,this,n).get(e);if(r)for(const[e,i]of r.entries())try{if(i){const r=l.__privateGet.call(void 0,this,a).get(e),n=i(...t);n!==r&&(l.__privateGet.call(void 0,this,a).set(e,n),e(n,r))}else e(...t)}catch(e){setTimeout((()=>{throw e}))}}subscribe(e,t,r){let i=l.__privateGet.call(void 0,this,n).get(e);if(i||(i=new Map,l.__privateGet.call(void 0,this,n).set(e,i)),i.set(t,r),r){const i=l.__privateGet.call(void 0,this,s).get(e);if(i){const e=r(...i());l.__privateGet.call(void 0,this,a).set(t,e)}}}unsubscribe(e,t){const r=l.__privateGet.call(void 0,this,n).get(e);if(!r||!r.has(t))throw new Error(`Subscription not found for event: ${e}`);r.get(t)&&l.__privateGet.call(void 0,this,a).delete(t),r.delete(t)}clearEventSubscriptions(e){l.__privateGet.call(void 0,this,n).delete(e)}clearSubscriptions(){l.__privateGet.call(void 0,this,n).clear()}getRestricted({name:e,allowedActions:t,allowedEvents:r}){return new(0,o.RestrictedControllerMessenger)({controllerMessenger:this,name:e,allowedActions:t,allowedEvents:r})}}}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@metamask/gas-fee-controller>@metamask/base-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/gas-fee-controller/node_modules/@metamask/base-controller/dist/chunk-G42723LG.js"}],[1866,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i=class{constructor(e={},t={}){this.defaultConfig={},this.defaultState={},this.disabled=!1,this.name="BaseController",this.internalConfig=this.defaultConfig,this.internalState=this.defaultState,this.internalListeners=[],this.initialState=t,this.initialConfig=e}initialize(){return this.internalState=this.defaultState,this.internalConfig=this.defaultConfig,this.configure(this.initialConfig),this.update(this.initialState),this}get config(){return this.internalConfig}get state(){return this.internalState}configure(e,t=!1,r=!0){if(r){this.internalConfig=t?e:Object.assign(this.internalConfig,e);for(const e of Object.keys(this.internalConfig)){const t=this.internalConfig[e];void 0!==t&&(this[e]=t)}}else for(const t of Object.keys(e))if(void 0!==this.internalConfig[t]){const r=e[t];this.internalConfig[t]=r,this[t]=r}}notify(){this.disabled||this.internalListeners.forEach((e=>{e(this.internalState)}))}subscribe(e){this.internalListeners.push(e)}unsubscribe(e){const t=this.internalListeners.findIndex((t=>e===t));return t>-1&&this.internalListeners.splice(t,1),t>-1}update(e,t=!1){this.internalState=t?Object.assign({},e):Object.assign({},this.internalState,e),this.notify()}},n=i;r.BaseControllerV1=i,r.BaseControllerV1_default=n}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@metamask/gas-fee-controller>@metamask/base-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/gas-fee-controller/node_modules/@metamask/base-controller/dist/chunk-NINOM2XQ.js"}],[1867,{"./chunk-Z4BLTVTB.js":1868},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i,n,s,a,o,l,c,u,d,h,m=e("./chunk-Z4BLTVTB.js");i=new WeakMap,n=new WeakMap,s=new WeakMap,a=new WeakMap,o=new WeakSet,l=function(e){const t=m.__privateGet.call(void 0,this,a);return m.__privateMethod.call(void 0,this,d,h).call(this,e)||null!==t&&t.includes(e)},c=new WeakSet,u=function(e){const t=m.__privateGet.call(void 0,this,s);return m.__privateMethod.call(void 0,this,d,h).call(this,e)||null!==t&&t.includes(e)},d=new WeakSet,h=function(e){return e.startsWith(`${m.__privateGet.call(void 0,this,n)}:`)},r.RestrictedControllerMessenger=class{constructor({controllerMessenger:e,name:t,allowedActions:r,allowedEvents:l}){m.__privateAdd.call(void 0,this,o),m.__privateAdd.call(void 0,this,c),m.__privateAdd.call(void 0,this,d),m.__privateAdd.call(void 0,this,i,void 0),m.__privateAdd.call(void 0,this,n,void 0),m.__privateAdd.call(void 0,this,s,void 0),m.__privateAdd.call(void 0,this,a,void 0),m.__privateSet.call(void 0,this,i,e),m.__privateSet.call(void 0,this,n,t),m.__privateSet.call(void 0,this,s,r),m.__privateSet.call(void 0,this,a,l)}registerActionHandler(e,t){if(!m.__privateMethod.call(void 0,this,d,h).call(this,e))throw new Error(`Only allowed registering action handlers prefixed by '${m.__privateGet.call(void 0,this,n)}:'`);m.__privateGet.call(void 0,this,i).registerActionHandler(e,t)}unregisterActionHandler(e){if(!m.__privateMethod.call(void 0,this,d,h).call(this,e))throw new Error(`Only allowed unregistering action handlers prefixed by '${m.__privateGet.call(void 0,this,n)}:'`);m.__privateGet.call(void 0,this,i).unregisterActionHandler(e)}call(e,...t){if(!m.__privateMethod.call(void 0,this,c,u).call(this,e))throw new Error(`Action missing from allow list: ${e}`);return m.__privateGet.call(void 0,this,i).call(e,...t)}registerInitialEventPayload({eventType:e,getPayload:t}){if(!m.__privateMethod.call(void 0,this,d,h).call(this,e))throw new Error(`Only allowed publishing events prefixed by '${m.__privateGet.call(void 0,this,n)}:'`);m.__privateGet.call(void 0,this,i).registerInitialEventPayload({eventType:e,getPayload:t})}publish(e,...t){if(!m.__privateMethod.call(void 0,this,d,h).call(this,e))throw new Error(`Only allowed publishing events prefixed by '${m.__privateGet.call(void 0,this,n)}:'`);m.__privateGet.call(void 0,this,i).publish(e,...t)}subscribe(e,t,r){if(!m.__privateMethod.call(void 0,this,o,l).call(this,e))throw new Error(`Event missing from allow list: ${e}`);return r?m.__privateGet.call(void 0,this,i).subscribe(e,t,r):m.__privateGet.call(void 0,this,i).subscribe(e,t)}unsubscribe(e,t){if(!m.__privateMethod.call(void 0,this,o,l).call(this,e))throw new Error(`Event missing from allow list: ${e}`);m.__privateGet.call(void 0,this,i).unsubscribe(e,t)}clearEventSubscriptions(e){if(!m.__privateMethod.call(void 0,this,d,h).call(this,e))throw new Error(`Only allowed clearing events prefixed by '${m.__privateGet.call(void 0,this,n)}:'`);m.__privateGet.call(void 0,this,i).clearEventSubscriptions(e)}}}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@metamask/gas-fee-controller>@metamask/base-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/gas-fee-controller/node_modules/@metamask/base-controller/dist/chunk-UJFCPTF3.js"}],[1868,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i=(e,t,r)=>{if(!t.has(e))throw TypeError("Cannot "+r)};r.__privateGet=(e,t,r)=>(i(e,t,"read from private field"),r?r.call(e):t.get(e)),r.__privateAdd=(e,t,r)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,r)},r.__privateSet=(e,t,r,n)=>(i(e,t,"write to private field"),n?n.call(e,r):t.set(e,r),r),r.__privateMethod=(e,t,r)=>(i(e,t,"access private method"),r)}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@metamask/gas-fee-controller>@metamask/base-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/gas-fee-controller/node_modules/@metamask/base-controller/dist/chunk-Z4BLTVTB.js"}],[1869,{"./chunk-Z4BLTVTB.js":1868,immer:3640},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i,n=e("./chunk-Z4BLTVTB.js"),s=e("immer");s.enablePatches.call(void 0);function a(e,t,r){return Object.keys(e).reduce(((i,n)=>{try{const s=t[n];if(!s)throw new Error(`No metadata found for '${String(n)}'`);const a=s[r],o=e[n];return"function"==typeof a?i[n]=a(o):a&&(i[n]=o),i}catch(e){return setTimeout((()=>{throw e})),i}}),{})}i=new WeakMap,r.BaseController=class{constructor({messenger:e,metadata:t,name:r,state:a}){n.__privateAdd.call(void 0,this,i,void 0),this.messagingSystem=e,this.name=r,n.__privateSet.call(void 0,this,i,s.freeze.call(void 0,a,!0)),this.metadata=t,this.messagingSystem.registerActionHandler(`${r}:getState`,(()=>this.state)),this.messagingSystem.registerInitialEventPayload({eventType:`${r}:stateChange`,getPayload:()=>[this.state,[]]})}get state(){return n.__privateGet.call(void 0,this,i)}set state(e){throw new Error("Controller state cannot be directly mutated; use 'update' method instead.")}update(e){const[t,r,a]=s.produceWithPatches.call(void 0,n.__privateGet.call(void 0,this,i),e);return n.__privateSet.call(void 0,this,i,t),this.messagingSystem.publish(`${this.name}:stateChange`,t,r),{nextState:t,patches:r,inversePatches:a}}applyPatches(e){const t=s.applyPatches.call(void 0,n.__privateGet.call(void 0,this,i),e);n.__privateSet.call(void 0,this,i,t),this.messagingSystem.publish(`${this.name}:stateChange`,t,e)}destroy(){this.messagingSystem.clearEventSubscriptions(`${this.name}:stateChange`)}},r.getAnonymizedState=function(e,t){return a(e,t,"anonymous")},r.getPersistentState=function(e,t){return a(e,t,"persist")}}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@metamask/gas-fee-controller>@metamask/base-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/gas-fee-controller/node_modules/@metamask/base-controller/dist/chunk-ZNOPSWMU.js"}],[187,{"../../../shared/constants/network":4507,"bignumber.js":2933,lodash:3836},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i,n=e("lodash"),s=(i=e("bignumber.js"))&&i.__esModule?i:{default:i},a=e("../../../shared/constants/network");const o=e=>new s.default(e||"0x0",16).gt(0);r.default={version:67,async migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=67;const r=function(e){var t,r,i;const n=(null==e?void 0:e.PreferencesController)||{},s=n.preferences||{};if(s.showTestNetworks)return e;const l=(null==e||null===(t=e.TransactionController)||void 0===t?void 0:t.transactions)||{},c=(null===(r=e.NetworkController)||void 0===r?void 0:r.provider)||{},u=(null===(i=e.CachedBalancesController)||void 0===i?void 0:i.cachedBalances)||{},d=a.TEST_CHAINS.includes(null==c?void 0:c.chainId),h=Object.values(l).some((({chainId:e})=>a.TEST_CHAINS.includes(e))),m=a.TEST_CHAINS.some((e=>Object.values(u[e]||{}).some(o))),p=d||h||m,f={...e,PreferencesController:{...n,preferences:{...s,showTestNetworks:p}}};return f}(t.data);return t.data=r,t}}}}},{package:"$root$",file:"app/scripts/migrations/067.js"}],[1870,{"./chunk-G42723LG.js":1865,"./chunk-NINOM2XQ.js":1866,"./chunk-UJFCPTF3.js":1867,"./chunk-Z4BLTVTB.js":1868,"./chunk-ZNOPSWMU.js":1869},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i=e("./chunk-NINOM2XQ.js"),n=e("./chunk-ZNOPSWMU.js"),s=e("./chunk-G42723LG.js"),a=e("./chunk-UJFCPTF3.js");e("./chunk-Z4BLTVTB.js"),r.BaseController=n.BaseController,r.BaseControllerV1=i.BaseControllerV1,r.ControllerMessenger=s.ControllerMessenger,r.RestrictedControllerMessenger=a.RestrictedControllerMessenger,r.getAnonymizedState=n.getAnonymizedState,r.getPersistentState=n.getPersistentState}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@metamask/gas-fee-controller>@metamask/base-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/gas-fee-controller/node_modules/@metamask/base-controller/dist/index.js"}],[1871,{"./chunk-RKVNLW2C.js":1875,"@ethereumjs/util":1857,"@metamask/ethjs-unit":1381,"@metamask/utils":2300,"bn.js":2980,buffer:3028,"eth-ens-namehash":3225,"fast-deep-equal":3356},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t){(function(){function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var n=e("./chunk-RKVNLW2C.js"),s=e("@ethereumjs/util"),a=e("@metamask/ethjs-unit"),o=e("@metamask/utils"),l=i(e("bn.js")),c=i(e("eth-ens-namehash")),u=i(e("fast-deep-equal")),d=new Error("timeout"),h=["__proto__","constructor","prototype"];function m(e){return e?new(0,l.default)(o.remove0x.call(void 0,e),16):new(0,l.default)(0)}async function p(e,t){const r=await fetch(e,t);if(!r.ok)throw new Error(`Fetch failed with status '${r.status}' for request '${String(e)}'`);return r}async function f(e,t){const r=await p(e,t);return await r.json()}r.PROTOTYPE_POLLUTION_BLOCKLIST=h,r.isSafeDynamicKey=function(e){return"string"==typeof e&&!h.some((t=>e===t))},r.isSafeChainId=function(e){if(!o.isHexString.call(void 0,e))return!1;const t=Number.parseInt(e,o.isStrictHexString.call(void 0,e)?16:10);return Number.isSafeInteger(t)&&t>0&&t<=n.MAX_SAFE_CHAIN_ID},r.BNToHex=function(e){return o.add0x.call(void 0,e.toString(16))},r.fractionBN=function(e,t,r){const i=new(0,l.default)(t),n=new(0,l.default)(r);return e.mul(i).div(n)},r.gweiDecToWEIBN=function(e){if(Number.isNaN(e))return new(0,l.default)(0);const t=e.toString().split("."),r=t[0]||"0";let i=t[1]||"";if(!i)return a.toWei.call(void 0,r,"gwei");if(i.length<=9)return a.toWei.call(void 0,`${r}.${i}`,"gwei");const n=i.slice(9)[0];i=i.slice(0,9);let s=a.toWei.call(void 0,`${r}.${i}`,"gwei");return Number(n)>=5&&(s=s.add(new(0,l.default)(1))),s},r.weiHexToGweiDec=function(e){const t=new(0,l.default)(o.remove0x.call(void 0,e),16);return a.fromWei.call(void 0,t,"gwei")},r.getBuyURL=function(e="1",t,r=5){switch(e){case"1":return`https://buy.coinbase.com/?code=9ec56d01-7e81-5017-930c-513daa27bb6a&amount=${r}&address=${t}&crypto_currency=ETH`;case"5":return"https://goerli-faucet.slock.it/";case"11155111":return"https://sepoliafaucet.net/";default:return}},r.hexToBN=m,r.hexToText=function(e){try{const r=o.remove0x.call(void 0,e);return t.from(r,"hex").toString("utf8")}catch(t){return e}},r.fromHex=function(e){return l.default.isBN(e)?e:new(0,l.default)(m(e).toString(10))},r.toHex=function(e){return"string"==typeof e&&o.isStrictHexString.call(void 0,e)?e:`0x${l.default.isBN(e)?e.toString(16):new(0,l.default)(e.toString(),10).toString(16)}`},r.safelyExecute=async function(e,t=!1){try{return await e()}catch(e){return void(t&&console.error(e))}},r.safelyExecuteWithTimeout=async function(e,t=!1,r=500){try{return await Promise.race([e(),new Promise(((e,t)=>setTimeout((()=>{t(d)}),r)))])}catch(e){return void(t&&console.error(e))}},r.toChecksumHexAddress=function(e){if("string"!=typeof e)return e;const t=o.add0x.call(void 0,e);return o.isHexString.call(void 0,t)?s.toChecksumAddress.call(void 0,t):t},r.isValidHexAddress=function(e,{allowNonPrefixed:t=!0}={}){const r=t?o.add0x.call(void 0,e):e;return!!o.isStrictHexString.call(void 0,r)&&s.isValidAddress.call(void 0,r)},r.isSmartContractCode=function(e){return!!e&&("0x"!==e&&"0x0"!==e)},r.successfulFetch=p,r.handleFetch=f,r.fetchWithErrorHandling=async function({url:e,options:t,timeout:r,errorCodesToCatch:i}){let n;try{n=r?Promise.race([await f(e,t),new Promise(((e,t)=>setTimeout((()=>{t(d)}),r)))]):await f(e,t)}catch(e){!function(e,t=[]){if(!e)return;if(!(e instanceof Error))throw e;if(!t.some((t=>e.message.includes(`Fetch failed with status '${t}'`)))&&!e.message.includes("Failed to fetch")&&e!==d)throw e;console.error(e)}(e,i)}return n},r.timeoutFetch=async function(e,t,r=500){return Promise.race([p(e,t),new Promise(((e,t)=>setTimeout((()=>{t(d)}),r)))])},r.normalizeEnsName=function(e){if("."===e)return e;if(e&&"string"==typeof e)try{const t=c.default.normalize(e.trim());if(t.match(/^(([\w\d-]+)\.)*[\w\d-]{7,}\.(eth|test)$/u))return t}catch(e){}return null},r.query=function(e,t,r=[]){return new Promise(((i,n)=>{const s=(e,t)=>{e?n(e):i(t)};t in e&&"function"==typeof e[t]?e[t](...r,s):e.sendAsync({method:t,params:r},s)}))},r.convertHexToDecimal=(e="0x0")=>o.isStrictHexString.call(void 0,e)?parseInt(e,16):Number(e)?Number(e):0,r.isPlainObject=function(e){return Boolean(e)&&"object"==typeof e&&!Array.isArray(e)},r.isNonEmptyArray=function(e){return Array.isArray(e)&&e.length>0},r.isValidJson=function(e){try{return u.default.call(void 0,e,JSON.parse(JSON.stringify(e)))}catch(e){return!1}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@metamask/gas-fee-controller>@metamask/controller-utils",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/gas-fee-controller/node_modules/@metamask/controller-utils/dist/chunk-7C4YHS6A.js"}],[1872,{"@metamask/utils":2300},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i=e("@metamask/utils"),n=i.createProjectLogger.call(void 0,"controller-utils");r.createModuleLogger=i.createModuleLogger,r.projectLogger=n}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@metamask/gas-fee-controller>@metamask/controller-utils",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/gas-fee-controller/node_modules/@metamask/controller-utils/dist/chunk-DBJSLKNR.js"}],[1873,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i={mainnet:"mainnet",goerli:"goerli",sepolia:"sepolia","linea-goerli":"linea-goerli","linea-sepolia":"linea-sepolia","linea-mainnet":"linea-mainnet"},n={...i,rpc:"rpc"};var s=(e=>(e.Mainnet="mainnet",e.Goerli="goerli",e.Sepolia="sepolia",e.LineaGoerli="linea-goerli",e.LineaSepolia="linea-sepolia",e.LineaMainnet="linea-mainnet",e.Aurora="aurora",e))(s||{}),a={mainnet:"0x1",goerli:"0x5",sepolia:"0xaa36a7",aurora:"0x4e454152","linea-goerli":"0xe704","linea-sepolia":"0xe705","linea-mainnet":"0xe708"},o=(e=>(e.mainnet="ETH",e.goerli="GoerliETH",e.sepolia="SepoliaETH",e["linea-goerli"]="LineaETH",e["linea-sepolia"]="LineaETH",e["linea-mainnet"]="ETH",e.rpc="",e))(o||{});r.InfuraNetworkType=i,r.NetworkType=n,r.isNetworkType=function(e){return Object.values(n).includes(e)},r.isInfuraNetworkType=function(e){return Object.keys(i).includes(e)},r.BuiltInNetworkName=s,r.ChainId=a,r.NetworksTicker=o}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@metamask/gas-fee-controller>@metamask/controller-utils",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/gas-fee-controller/node_modules/@metamask/controller-utils/dist/chunk-LGGBBU6G.js"}],[1874,{"./chunk-DBJSLKNR.js":1872,"@metamask/utils":2300,"@spruceid/siwe-parser":2526,buffer:3028},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0});var i=e("./chunk-DBJSLKNR.js"),n=e("@metamask/utils"),s=e("@spruceid/siwe-parser"),a=i.createModuleLogger.call(void 0,i.projectLogger,"detect-siwe");function o(e){try{const i="string"!=typeof(r=e)?r:n.remove0x.call(void 0,r),s=t.from(i,"hex");return 32===s.length?e:s.toString("utf8")}catch(t){return a(t),e}var r}var l={"http:":"80","https:":"443"},c=(e,t)=>e.match(/^[^/:]*:\/\//u)?new URL(e):new URL(`${t}//${e}`);r.parseDomainParts=c,r.isValidSIWEOrigin=e=>{try{const{origin:t,siwe:r}=e;if(!t||!r?.parsedMessage?.domain)return!1;const i=new URL(t),n=c(r.parsedMessage.domain,i.protocol);return 0===n.hostname.localeCompare(i.hostname,void 0,{sensitivity:"accent"})&&(""!==n.port&&n.port!==i.port?""===i.port&&n.port===l[i.protocol]:""===n.username||n.username===i.username)}catch(e){return a(e),!1}},r.detectSIWE=e=>{try{const{data:t}=e,r=o(t);return{isSIWEMessage:!0,parsedMessage:new(0,s.ParsedMessage)(r)}}catch(e){return{isSIWEMessage:!1,parsedMessage:null}}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@metamask/gas-fee-controller>@metamask/controller-utils",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/gas-fee-controller/node_modules/@metamask/controller-utils/dist/chunk-M6G3ISXG.js"}],[1875,{"./chunk-LGGBBU6G.js":1873},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i=e("./chunk-LGGBBU6G.js"),n={[i.NetworkType.goerli]:{chainId:i.ChainId.goerli,ticker:"GoerliETH",rpcPrefs:{blockExplorerUrl:`https://${i.NetworkType.goerli}.etherscan.io`}},[i.NetworkType.sepolia]:{chainId:i.ChainId.sepolia,ticker:"SepoliaETH",rpcPrefs:{blockExplorerUrl:`https://${i.NetworkType.sepolia}.etherscan.io`}},[i.NetworkType.mainnet]:{chainId:i.ChainId.mainnet,ticker:"ETH",rpcPrefs:{blockExplorerUrl:"https://etherscan.io"}},[i.NetworkType["linea-goerli"]]:{chainId:i.ChainId["linea-goerli"],ticker:"LineaETH",rpcPrefs:{blockExplorerUrl:"https://goerli.lineascan.build"}},[i.NetworkType["linea-sepolia"]]:{chainId:i.ChainId["linea-sepolia"],ticker:"LineaETH",rpcPrefs:{blockExplorerUrl:"https://sepolia.lineascan.build"}},[i.NetworkType["linea-mainnet"]]:{chainId:i.ChainId["linea-mainnet"],ticker:"ETH",rpcPrefs:{blockExplorerUrl:"https://lineascan.build"}},[i.NetworkType.rpc]:{chainId:void 0,blockExplorerUrl:void 0,ticker:void 0,rpcPrefs:void 0}},s=(e=>(e.AddEthereumChain="wallet_addEthereumChain",e.ConnectAccounts="connect_accounts",e.EthDecrypt="eth_decrypt",e.EthGetEncryptionPublicKey="eth_getEncryptionPublicKey",e.EthSignTypedData="eth_signTypedData",e.PersonalSign="personal_sign",e.ResultError="result_error",e.ResultSuccess="result_success",e.SnapDialogAlert="snap_dialog:alert",e.SnapDialogConfirmation="snap_dialog:confirmation",e.SnapDialogPrompt="snap_dialog:prompt",e.SwitchEthereumChain="wallet_switchEthereumChain",e.Transaction="transaction",e.Unlock="unlock",e.WalletConnect="wallet_connect",e.WalletRequestPermissions="wallet_requestPermissions",e.WatchAsset="wallet_watchAsset",e))(s||{}),a={[i.ChainId.goerli]:"goerli",[i.ChainId.sepolia]:"sepolia",[i.ChainId.mainnet]:"mainnet",[i.ChainId["linea-goerli"]]:"linea-goerli",[i.ChainId["linea-sepolia"]]:"linea-sepolia",[i.ChainId["linea-mainnet"]]:"linea-mainnet",[i.ChainId.aurora]:"aurora"};r.RPC="rpc",r.FALL_BACK_VS_CURRENCY="ETH",r.IPFS_DEFAULT_GATEWAY_URL="https://cloudflare-ipfs.com/ipfs/",r.GANACHE_CHAIN_ID="0x539",r.MAX_SAFE_CHAIN_ID=0xfffffffffffec,r.ERC721="ERC721",r.ERC1155="ERC1155",r.ERC20="ERC20",r.ERC721_INTERFACE_ID="0x80ac58cd",r.ERC721_METADATA_INTERFACE_ID="0x5b5e139f",r.ERC721_ENUMERABLE_INTERFACE_ID="0x780e9d63",r.ERC1155_INTERFACE_ID="0xd9b67a26",r.ERC1155_METADATA_URI_INTERFACE_ID="0x0e89341c",r.ERC1155_TOKEN_RECEIVER_INTERFACE_ID="0x4e2312e0",r.GWEI="gwei",r.ASSET_TYPES={NATIVE:"NATIVE",TOKEN:"TOKEN",NFT:"NFT",UNKNOWN:"UNKNOWN"},r.TESTNET_TICKER_SYMBOLS={GOERLI:"GoerliETH",SEPOLIA:"SepoliaETH",LINEA_GOERLI:"LineaETH",LINEA_SEPOLIA:"LineaETH"},r.BUILT_IN_NETWORKS=n,r.OPENSEA_PROXY_URL="https://proxy.api.cx.metamask.io/opensea/v1/api/v2",r.NFT_API_BASE_URL="https://nft.api.cx.metamask.io",r.NFT_API_VERSION="1",r.NFT_API_TIMEOUT=15e3,r.ORIGIN_METAMASK="metamask",r.ApprovalType=s,r.CHAIN_ID_TO_ETHERS_NETWORK_NAME_MAP=a}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@metamask/gas-fee-controller>@metamask/controller-utils",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/gas-fee-controller/node_modules/@metamask/controller-utils/dist/chunk-RKVNLW2C.js"}],[1876,{"./chunk-7C4YHS6A.js":1871,"./chunk-DBJSLKNR.js":1872,"./chunk-LGGBBU6G.js":1873,"./chunk-M6G3ISXG.js":1874,"./chunk-RKVNLW2C.js":1875},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i=e("./chunk-M6G3ISXG.js");e("./chunk-DBJSLKNR.js");var n=e("./chunk-7C4YHS6A.js"),s=e("./chunk-RKVNLW2C.js"),a=e("./chunk-LGGBBU6G.js");r.ASSET_TYPES=s.ASSET_TYPES,r.ApprovalType=s.ApprovalType,r.BNToHex=n.BNToHex,r.BUILT_IN_NETWORKS=s.BUILT_IN_NETWORKS,r.BuiltInNetworkName=a.BuiltInNetworkName,r.CHAIN_ID_TO_ETHERS_NETWORK_NAME_MAP=s.CHAIN_ID_TO_ETHERS_NETWORK_NAME_MAP,r.ChainId=a.ChainId,r.ERC1155=s.ERC1155,r.ERC1155_INTERFACE_ID=s.ERC1155_INTERFACE_ID,r.ERC1155_METADATA_URI_INTERFACE_ID=s.ERC1155_METADATA_URI_INTERFACE_ID,r.ERC1155_TOKEN_RECEIVER_INTERFACE_ID=s.ERC1155_TOKEN_RECEIVER_INTERFACE_ID,r.ERC20=s.ERC20,r.ERC721=s.ERC721,r.ERC721_ENUMERABLE_INTERFACE_ID=s.ERC721_ENUMERABLE_INTERFACE_ID,r.ERC721_INTERFACE_ID=s.ERC721_INTERFACE_ID,r.ERC721_METADATA_INTERFACE_ID=s.ERC721_METADATA_INTERFACE_ID,r.FALL_BACK_VS_CURRENCY=s.FALL_BACK_VS_CURRENCY,r.GANACHE_CHAIN_ID=s.GANACHE_CHAIN_ID,r.GWEI=s.GWEI,r.IPFS_DEFAULT_GATEWAY_URL=s.IPFS_DEFAULT_GATEWAY_URL,r.InfuraNetworkType=a.InfuraNetworkType,r.MAX_SAFE_CHAIN_ID=s.MAX_SAFE_CHAIN_ID,r.NFT_API_BASE_URL=s.NFT_API_BASE_URL,r.NFT_API_TIMEOUT=s.NFT_API_TIMEOUT,r.NFT_API_VERSION=s.NFT_API_VERSION,r.NetworkType=a.NetworkType,r.NetworksTicker=a.NetworksTicker,r.OPENSEA_PROXY_URL=s.OPENSEA_PROXY_URL,r.ORIGIN_METAMASK=s.ORIGIN_METAMASK,r.RPC=s.RPC,r.TESTNET_TICKER_SYMBOLS=s.TESTNET_TICKER_SYMBOLS,r.convertHexToDecimal=n.convertHexToDecimal,r.detectSIWE=i.detectSIWE,r.fetchWithErrorHandling=n.fetchWithErrorHandling,r.fractionBN=n.fractionBN,r.fromHex=n.fromHex,r.getBuyURL=n.getBuyURL,r.gweiDecToWEIBN=n.gweiDecToWEIBN,r.handleFetch=n.handleFetch,r.hexToBN=n.hexToBN,r.hexToText=n.hexToText,r.isInfuraNetworkType=a.isInfuraNetworkType,r.isNetworkType=a.isNetworkType,r.isNonEmptyArray=n.isNonEmptyArray,r.isPlainObject=n.isPlainObject,r.isSafeChainId=n.isSafeChainId,r.isSafeDynamicKey=n.isSafeDynamicKey,r.isSmartContractCode=n.isSmartContractCode,r.isValidHexAddress=n.isValidHexAddress,r.isValidJson=n.isValidJson,r.isValidSIWEOrigin=i.isValidSIWEOrigin,r.normalizeEnsName=n.normalizeEnsName,r.parseDomainParts=i.parseDomainParts,r.query=n.query,r.safelyExecute=n.safelyExecute,r.safelyExecuteWithTimeout=n.safelyExecuteWithTimeout,r.successfulFetch=n.successfulFetch,r.timeoutFetch=n.timeoutFetch,r.toChecksumHexAddress=n.toChecksumHexAddress,r.toHex=n.toHex,r.weiHexToGweiDec=n.weiHexToGweiDec}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@metamask/gas-fee-controller>@metamask/controller-utils",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/gas-fee-controller/node_modules/@metamask/controller-utils/dist/index.js"}],[1877,{"./chunk-LBXAXAXH.js":1878,"@metamask/base-controller":1870},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i=e("./chunk-LBXAXAXH.js"),n=e("@metamask/base-controller");function s(e){var t,r;class n extends(i.AbstractPollingControllerBaseMixin.call(void 0,e)){constructor(){super(...arguments),i.__privateAdd.call(void 0,this,t,{}),i.__privateAdd.call(void 0,this,r,1e3)}setIntervalLength(e){i.__privateSet.call(void 0,this,r,e)}getIntervalLength(){return i.__privateGet.call(void 0,this,r)}_startPollingByNetworkClientId(e,n){if(!i.__privateGet.call(void 0,this,r))throw new Error("intervalLength must be defined and greater than 0");const s=i.getKey.call(void 0,e,n),a=i.__privateGet.call(void 0,this,t)[s];this._stopPollingByPollingTokenSetId(s);const o=i.__privateGet.call(void 0,this,t)[s]=setTimeout((async()=>{try{await this._executePoll(e,n)}catch(e){console.error(e)}o===i.__privateGet.call(void 0,this,t)[s]&&this._startPollingByNetworkClientId(e,n)}),a?i.__privateGet.call(void 0,this,r):0)}_stopPollingByPollingTokenSetId(e){const r=i.__privateGet.call(void 0,this,t)[e];r&&(clearTimeout(r),delete i.__privateGet.call(void 0,this,t)[e])}}return t=new WeakMap,r=new WeakMap,n}var a=s(class{}),o=s(n.BaseController),l=s(n.BaseControllerV1);r.StaticIntervalPollingControllerOnly=a,r.StaticIntervalPollingController=o,r.StaticIntervalPollingControllerV1=l}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@metamask/gas-fee-controller>@metamask/polling-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/gas-fee-controller/node_modules/@metamask/polling-controller/dist/chunk-I2PH5XQP.js"}],[1878,{"fast-json-stable-stringify":3363,uuid:4424},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i,n=(e,t,r)=>{if(!t.has(e))throw TypeError("Cannot "+r)},s=(e,t,r)=>(n(e,t,"read from private field"),r?r.call(e):t.get(e)),a=(e,t,r)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,r)},o=e("fast-json-stable-stringify"),l=(i=o)&&i.__esModule?i:{default:i},c=e("uuid"),u=(e,t)=>`${e}:${l.default.call(void 0,t)}`;r.__privateGet=s,r.__privateAdd=a,r.__privateSet=(e,t,r,i)=>(n(e,t,"write to private field"),i?i.call(e,r):t.set(e,r),r),r.getKey=u,r.AbstractPollingControllerBaseMixin=function(e){var t,r;return t=new WeakMap,r=new WeakMap,class extends e{constructor(){super(...arguments),a(this,t,new Map),a(this,r,new Map)}startPollingByNetworkClientId(e,r={}){const i=c.v4.call(void 0),n=u(e,r),a=s(this,t).get(n)??new Set;return a.add(i),s(this,t).set(n,a),1===a.size&&this._startPollingByNetworkClientId(e,r),i}stopAllPolling(){s(this,t).forEach(((e,t)=>{e.forEach((e=>{this.stopPollingByPollingToken(e)}))}))}stopPollingByPollingToken(e){if(!e)throw new Error("pollingToken required");let i=null;for(const[r,n]of s(this,t))if(n.delete(e)){0===n.size&&(i=r);break}if(i){this._stopPollingByPollingTokenSetId(i),s(this,t).delete(i);const e=s(this,r).get(i);if(e){for(const t of e)t(i);e.clear()}}}onPollingCompleteByNetworkClientId(e,t,i={}){const n=u(e,i),a=s(this,r).get(n)??new Set;a.add(t),s(this,r).set(n,a)}}}}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@metamask/gas-fee-controller>@metamask/polling-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/gas-fee-controller/node_modules/@metamask/polling-controller/dist/chunk-LBXAXAXH.js"}],[1879,{"./chunk-LBXAXAXH.js":1878,"@metamask/base-controller":1870},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i=e("./chunk-LBXAXAXH.js"),n=e("@metamask/base-controller");function s(e){var t;class r extends(i.AbstractPollingControllerBaseMixin.call(void 0,e)){constructor(){super(...arguments),i.__privateAdd.call(void 0,this,t,{})}_startPollingByNetworkClientId(e,r){const n=i.getKey.call(void 0,e,r);if(i.__privateGet.call(void 0,this,t)[n])return;const s=this._getNetworkClientById(e);if(!s)throw new Error(`Unable to retrieve blockTracker for networkClientId ${e}`);{const a=this._executePoll.bind(this,e,r);s.blockTracker.addListener("latest",a),i.__privateGet.call(void 0,this,t)[n]=a}}_stopPollingByPollingTokenSetId(e){const[r]=e.split(":"),n=this._getNetworkClientById(r);if(n&&i.__privateGet.call(void 0,this,t)[e]){const r=i.__privateGet.call(void 0,this,t)[e];r&&(n.blockTracker.removeListener("latest",r),delete i.__privateGet.call(void 0,this,t)[e])}}}return t=new WeakMap,r}var a=s(class{}),o=s(n.BaseController),l=s(n.BaseControllerV1);r.BlockTrackerPollingControllerOnly=a,r.BlockTrackerPollingController=o,r.BlockTrackerPollingControllerV1=l}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@metamask/gas-fee-controller>@metamask/polling-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/gas-fee-controller/node_modules/@metamask/polling-controller/dist/chunk-MUDX6BUY.js"}],[188,{lodash:3836},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=e("lodash");r.default={version:68,async migrate(e){const t=(0,i.cloneDeep)(e);t.meta.version=68;const r=function(e){const{PermissionsController:t={},PermissionsMetadata:r={},...i}=e,{domainMetadata:a={},permissionsHistory:o={},permissionsLog:l=[]}=r;return{...i,PermissionController:n(t),PermissionLogController:{permissionActivityLog:l,permissionHistory:o},SubjectMetadataController:s(a)}}(t.data);return t.data=r,t}};function n(e){const{domains:t={}}=e;return{subjects:Object.entries(t).reduce(((e,[t,r])=>{const{permissions:[i]}=r,n=i.caveats.find((e=>"exposedAccounts"===e.name)),s={...i,caveats:[{type:"restrictReturnedAccounts",value:n.value}]};return delete s["@context"],e[t]={origin:t,permissions:{eth_accounts:s}},e}),{})}}function s(e){return{subjectMetadata:Object.entries(e).reduce(((e,[t,r])=>{const{name:i=null,icon:n=null,extensionId:s=null,...a}=r;return delete a.lastUpdated,delete a.host,t&&(e[t]={name:i,iconUrl:n,extensionId:s,...a,origin:t}),e}),{})}}}}},{package:"$root$",file:"app/scripts/migrations/068.js"}],[1880,{"./chunk-I2PH5XQP.js":1877,"./chunk-LBXAXAXH.js":1878,"./chunk-MUDX6BUY.js":1879},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i=e("./chunk-MUDX6BUY.js"),n=e("./chunk-I2PH5XQP.js");e("./chunk-LBXAXAXH.js"),r.BlockTrackerPollingController=i.BlockTrackerPollingController,r.BlockTrackerPollingControllerOnly=i.BlockTrackerPollingControllerOnly,r.BlockTrackerPollingControllerV1=i.BlockTrackerPollingControllerV1,r.StaticIntervalPollingController=n.StaticIntervalPollingController,r.StaticIntervalPollingControllerOnly=n.StaticIntervalPollingControllerOnly,r.StaticIntervalPollingControllerV1=n.StaticIntervalPollingControllerV1}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@metamask/gas-fee-controller>@metamask/polling-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/gas-fee-controller/node_modules/@metamask/polling-controller/dist/index.js"}],[1881,{"./chunk-S6VGOPUY.js":1900,"@metamask/utils":2300},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i=e("./chunk-S6VGOPUY.js"),n=e("@metamask/utils").createModuleLogger.call(void 0,i.projectLogger,"layer-1-gas-fee-flow");async function s({layer1GasFeeFlows:e,provider:t,transactionMeta:r}){const i=function(e,t){return t.find((t=>t.matchesTransaction(e)))}(r,e);if(i){n("Found layer 1 gas fee flow",i.constructor.name,r.id);try{const{layer1Fee:e}=await i.getLayer1Fee({provider:t,transactionMeta:r});return e}catch(e){return void n("Failed to get layer 1 gas fee",r.id,e)}}}r.updateTransactionLayer1GasFee=async function(e){const t=await s(e);if(!t)return;const{transactionMeta:r}=e;r.layer1GasFee=t,n("Updated layer 1 gas fee",t,r.id)},r.getTransactionLayer1GasFee=s}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/dist/chunk-2XKEAKQG.js"}],[1882,{"./chunk-DLOQPH4M.js":1886,"./chunk-S6VGOPUY.js":1900,"./chunk-UT4M4XI3.js":1905,"@metamask/controller-utils":1948,"@metamask/utils":2300},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i=e("./chunk-UT4M4XI3.js"),n=e("./chunk-DLOQPH4M.js"),s=e("./chunk-S6VGOPUY.js"),a=e("@metamask/controller-utils"),o=e("@metamask/utils"),l=o.createModuleLogger.call(void 0,s.projectLogger,"gas-fees");function c(e){return a.toHex.call(void 0,a.gweiDecToWEIBN.call(void 0,e))}r.updateGasFees=async function(e){const{txMeta:t}=e,r={...t.txParams},s=i.SWAP_TRANSACTION_TYPES.includes(t.type)?void 0:e.getSavedGasFees(t.chainId),u=await async function(e){const{eip1559:t,ethQuery:r,gasFeeFlows:i,getGasFeeEstimates:s,txMeta:c}=e,{networkClientId:u}=c;if(!t&&c.txParams.gasPrice||t&&c.txParams.maxFeePerGas&&c.txParams.maxPriorityFeePerGas)return{};const d=n.getGasFeeFlow.call(void 0,c,i);try{const e=await s({networkClientId:u}),t=await d.getGasFees({ethQuery:r,gasFeeControllerData:e,transactionMeta:c}),i=t.estimates?.type;switch(i){case"fee-market":return t.estimates.medium;case"legacy":return{gasPrice:t.estimates.medium};case"eth_gasPrice":return{gasPrice:t.estimates.gasPrice};default:throw new Error(`Unsupported gas fee estimate type returned from flow: ${i}`)}}catch(e){l("Failed to get suggested gas fees",e)}const h=await a.query.call(void 0,r,"gasPrice");return{gasPrice:h?o.add0x.call(void 0,h.toString(16)):void 0}}(e);l("Suggested gas fees",u);const d={...e,initialParams:r,savedGasFees:s,suggestedGasFees:u};t.txParams.maxFeePerGas=function(e){const{savedGasFees:t,eip1559:r,initialParams:i,suggestedGasFees:n}=e;if(!r)return;if(t){const e=c(t.maxBaseFee);return l("Using maxFeePerGas from savedGasFees",e),e}if(i.maxFeePerGas)return l("Using maxFeePerGas from request",i.maxFeePerGas),i.maxFeePerGas;if(i.gasPrice&&!i.maxPriorityFeePerGas)return l("Setting maxFeePerGas to gasPrice from request",i.gasPrice),i.gasPrice;if(n.maxFeePerGas)return l("Using suggested maxFeePerGas",n.maxFeePerGas),n.maxFeePerGas;if(n.gasPrice)return l("Setting maxFeePerGas to suggested gasPrice",n.gasPrice),n.gasPrice;return void l("maxFeePerGas not set")}(d),t.txParams.maxPriorityFeePerGas=function(e){const{eip1559:t,initialParams:r,savedGasFees:i,suggestedGasFees:n,txMeta:s}=e;if(!t)return;if(i){const e=c(i.priorityFee);return l("Using maxPriorityFeePerGas from savedGasFees.priorityFee",e),e}if(r.maxPriorityFeePerGas)return l("Using maxPriorityFeePerGas from request",r.maxPriorityFeePerGas),r.maxPriorityFeePerGas;if(r.gasPrice&&!r.maxFeePerGas)return l("Setting maxPriorityFeePerGas to gasPrice from request",r.gasPrice),r.gasPrice;if(n.maxPriorityFeePerGas)return l("Using suggested maxPriorityFeePerGas",n.maxPriorityFeePerGas),n.maxPriorityFeePerGas;if(s.txParams.maxFeePerGas)return l("Setting maxPriorityFeePerGas to maxFeePerGas",s.txParams.maxFeePerGas),s.txParams.maxFeePerGas;return void l("maxPriorityFeePerGas not set")}(d),t.txParams.gasPrice=function(e){const{eip1559:t,initialParams:r,suggestedGasFees:i}=e;if(t)return;if(r.gasPrice)return l("Using gasPrice from request",r.gasPrice),r.gasPrice;if(i.maxFeePerGas)return l("Using suggested maxFeePerGas",i.maxFeePerGas),i.maxFeePerGas;if(i.gasPrice)return l("Using suggested gasPrice",i.gasPrice),i.gasPrice;return void l("gasPrice not set")}(d),t.userFeeLevel=function(e){const{eip1559:t,initialParams:r,savedGasFees:i,suggestedGasFees:n,txMeta:s}=e;if(!t)return;if(i)return"custom";if(!r.maxFeePerGas&&!r.maxPriorityFeePerGas&&r.gasPrice)return s.origin===a.ORIGIN_METAMASK?"custom":"dappSuggested";if(!r.maxFeePerGas&&!r.maxPriorityFeePerGas&&n.maxFeePerGas&&n.maxPriorityFeePerGas)return"medium";if(s.origin===a.ORIGIN_METAMASK)return"medium";return"dappSuggested"}(d),l("Updated gas fee properties",{maxFeePerGas:t.txParams.maxFeePerGas,maxPriorityFeePerGas:t.txParams.maxPriorityFeePerGas,gasPrice:t.txParams.gasPrice}),(t.txParams.maxFeePerGas||t.txParams.maxPriorityFeePerGas)&&delete t.txParams.gasPrice,t.txParams.gasPrice&&(delete t.txParams.maxFeePerGas,delete t.txParams.maxPriorityFeePerGas),function(e){e.defaultGasEstimates||(e.defaultGasEstimates={});e.defaultGasEstimates.maxFeePerGas=e.txParams.maxFeePerGas,e.defaultGasEstimates.maxPriorityFeePerGas=e.txParams.maxPriorityFeePerGas,e.defaultGasEstimates.gasPrice=e.txParams.gasPrice,e.defaultGasEstimates.estimateType=e.userFeeLevel}(t)},r.gweiDecimalToWeiHex=c}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/dist/chunk-3ZRHCVVS.js"}],[1883,{"./chunk-S6VGOPUY.js":1900,"./chunk-Z4BLTVTB.js":1911,"@metamask/controller-utils":1948,events:3328,lodash:3836},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i,n,s,a,o,l,c,u,d,h,m,p,f,v,g,_,k,y,w,T,b,E,S,P,A,C,I,j,x,M,N,O,R,B,L,G,F,D,H,U,W,$,K,V,q,Y,X,J,z,Q,Z,ee,te,re,ie=e("./chunk-S6VGOPUY.js"),ne=e("./chunk-Z4BLTVTB.js"),se=e("@metamask/controller-utils"),ae=e("events"),oe=(i=ae)&&i.__esModule?i:{default:i},le=e("lodash"),ce=["replacement transaction underpriced","known transaction","gas price too low to replace","transaction with the same hash was already imported","gateway timeout","nonce too low"],ue=ie.createModuleLogger.call(void 0,ie.projectLogger,"pending-transactions");n=new WeakMap,s=new WeakMap,a=new WeakMap,o=new WeakMap,l=new WeakMap,c=new WeakMap,u=new WeakMap,d=new WeakMap,h=new WeakMap,m=new WeakMap,p=new WeakMap,f=new WeakMap,v=new WeakMap,g=new WeakSet,_=function(){ne.__privateGet.call(void 0,this,p)||(ne.__privateGet.call(void 0,this,s).on("latest",ne.__privateGet.call(void 0,this,d)),ne.__privateSet.call(void 0,this,p,!0),ue("Started polling"))},k=new WeakSet,y=async function(e){const t=await ne.__privateGet.call(void 0,this,h).call(this);try{await ne.__privateMethod.call(void 0,this,w,T).call(this)}catch(e){ue("Failed to check transactions",e)}finally{t()}try{await ne.__privateMethod.call(void 0,this,b,E).call(this,e)}catch(e){ue("Failed to resubmit transactions",e)}},w=new WeakSet,T=async function(){ue("Checking transactions");const e=ne.__privateMethod.call(void 0,this,F,D).call(this);e.length?(ue("Found pending transactions to check",{count:e.length,ids:e.map((e=>e.id))}),await Promise.all(e.map((e=>ne.__privateMethod.call(void 0,this,x,M).call(this,e))))):ue("No pending transactions to check")},b=new WeakSet,E=async function(e){if(!ne.__privateGet.call(void 0,this,u).call(this)||!ne.__privateGet.call(void 0,this,p))return;ue("Resubmitting transactions");const t=ne.__privateMethod.call(void 0,this,F,D).call(this);if(t.length){ue("Found pending transactions to resubmit",{count:t.length,ids:t.map((e=>e.id))});for(const r of t)try{await ne.__privateMethod.call(void 0,this,A,C).call(this,r,e)}catch(e){const t=e.value?.message?.toLowerCase()||e.message.toLowerCase();if(ne.__privateMethod.call(void 0,this,S,P).call(this,t))return void ue("Ignoring known transaction error",t);ne.__privateMethod.call(void 0,this,H,U).call(this,r,e.message,"There was an error when resubmitting this transaction.")}}else ue("No pending transactions to resubmit")},S=new WeakSet,P=function(e){return ce.some((t=>e.includes(t)))},A=new WeakSet,C=async function(e,t){if(!ne.__privateMethod.call(void 0,this,I,j).call(this,e,t))return;const{rawTx:r}=e;if(!ne.__privateGet.call(void 0,this,v).call(this,e))return;if(!r?.length)return ue("Approving transaction as no raw value"),void await ne.__privateGet.call(void 0,this,n).call(this,e.id);const i=ne.__privateGet.call(void 0,this,l).call(this,e.networkClientId);await ne.__privateGet.call(void 0,this,m).call(this,i,r);const s=(e.retryCount??0)+1;ne.__privateMethod.call(void 0,this,q,Y).call(this,le.merge.call(void 0,{},e,{retryCount:s}),"PendingTransactionTracker:transaction-retry - Retry count increased")},I=new WeakSet,j=function(e,t){const r=le.cloneDeep.call(void 0,e);r.firstRetryBlockNumber||(r.firstRetryBlockNumber=t,ne.__privateMethod.call(void 0,this,q,Y).call(this,r,"PendingTransactionTracker:#isResubmitDue - First retry block number set"));const{firstRetryBlockNumber:i}=r,n=Number.parseInt(t,16)-Number.parseInt(i,16),s=e.retryCount||0;return n>=Math.min(50,Math.pow(2,s))},x=new WeakSet,M=async function(e){const{hash:t,id:r}=e;if(!t&&ne.__privateGet.call(void 0,this,f).call(this,e)){const t=new Error("We had an error while submitting this transaction, please try again.");return t.name="NoTxHashError",void ne.__privateMethod.call(void 0,this,W,$).call(this,e,t)}if(ne.__privateMethod.call(void 0,this,L,G).call(this,e))return ue("Nonce already taken",r),void ne.__privateMethod.call(void 0,this,K,V).call(this,e);try{const r=await ne.__privateMethod.call(void 0,this,X,J).call(this,t),i="0x1"===r?.status;if("0x0"===r?.status)return ue("Transaction receipt has failed status"),void ne.__privateMethod.call(void 0,this,W,$).call(this,e,new Error("Transaction dropped or replaced"));const{blockNumber:n,blockHash:s}=r||{};if(i&&n&&s)return void await ne.__privateMethod.call(void 0,this,N,O).call(this,e,{...r,blockNumber:n,blockHash:s})}catch(t){return ue("Failed to check transaction",r,t),void ne.__privateMethod.call(void 0,this,H,U).call(this,e,t.message,"There was a problem loading this transaction.")}await ne.__privateMethod.call(void 0,this,R,B).call(this,e)&&ne.__privateMethod.call(void 0,this,K,V).call(this,e)},N=new WeakSet,O=async function(e,t){const{id:r}=e,{blockHash:i}=t;ue("Transaction confirmed",r);const{baseFeePerGas:n,timestamp:s}=await ne.__privateMethod.call(void 0,this,z,Q).call(this,i,!1),a=le.cloneDeep.call(void 0,e);a.baseFeePerGas=n,a.blockTimestamp=s,a.status="confirmed",a.txParams={...a.txParams,gasUsed:t.gasUsed},a.txReceipt=t,a.verifiedOnBlockchain=!0,ne.__privateMethod.call(void 0,this,q,Y).call(this,a,"PendingTransactionTracker:#onTransactionConfirmed - Transaction confirmed"),this.hub.emit("transaction-confirmed",a)},R=new WeakSet,B=async function(e){const{hash:t,id:r,txParams:{nonce:i,from:n}}=e;if(!i||!t)return!1;const s=await ne.__privateMethod.call(void 0,this,Z,ee).call(this,n),o=parseInt(s,16);if(parseInt(i,16)>=o)return!1;let l=ne.__privateGet.call(void 0,this,a).get(t);return void 0===l&&(l=0,ne.__privateGet.call(void 0,this,a).set(t,l)),l<3?(ue("Incrementing dropped block count",{id:r,droppedBlockCount:l}),ne.__privateGet.call(void 0,this,a).set(t,l+1),!1):(ue("Hit dropped block count",r),ne.__privateGet.call(void 0,this,a).delete(t),!0)},L=new WeakSet,G=function(e){const{id:t,txParams:r}=e;return ne.__privateMethod.call(void 0,this,te,re).call(this).some((e=>e.id!==t&&e.txParams.from===r.from&&"confirmed"===e.status&&e.txParams.nonce===r.nonce&&"incoming"!==e.type))},F=new WeakSet,D=function(){return ne.__privateMethod.call(void 0,this,te,re).call(this).filter((e=>"submitted"===e.status&&!e.verifiedOnBlockchain&&!e.isUserOperation))},H=new WeakSet,U=function(e,t,r){ne.__privateMethod.call(void 0,this,q,Y).call(this,{...e,warning:{error:t,message:r}},"PendingTransactionTracker:#warnTransaction - Warning added")},W=new WeakSet,$=function(e,t){ue("Transaction failed",e.id,t),this.hub.emit("transaction-failed",e,t)},K=new WeakSet,V=function(e){ue("Transaction dropped",e.id),this.hub.emit("transaction-dropped",e)},q=new WeakSet,Y=function(e,t){this.hub.emit("transaction-updated",e,t)},X=new WeakSet,J=async function(e){return await se.query.call(void 0,ne.__privateGet.call(void 0,this,l).call(this),"getTransactionReceipt",[e])},z=new WeakSet,Q=async function(e,t){return await se.query.call(void 0,ne.__privateGet.call(void 0,this,l).call(this),"getBlockByHash",[e,t])},Z=new WeakSet,ee=async function(e){return await se.query.call(void 0,ne.__privateGet.call(void 0,this,l).call(this),"getTransactionCount",[e])},te=new WeakSet,re=function(){const e=ne.__privateGet.call(void 0,this,o).call(this);return ne.__privateGet.call(void 0,this,c).call(this).filter((t=>t.chainId===e))},r.PendingTransactionTracker=class{constructor({approveTransaction:e,blockTracker:t,getChainId:r,getEthQuery:i,getTransactions:T,isResubmitEnabled:E,getGlobalLock:P,publishTransaction:C,hooks:j}){ne.__privateAdd.call(void 0,this,g),ne.__privateAdd.call(void 0,this,k),ne.__privateAdd.call(void 0,this,w),ne.__privateAdd.call(void 0,this,b),ne.__privateAdd.call(void 0,this,S),ne.__privateAdd.call(void 0,this,A),ne.__privateAdd.call(void 0,this,I),ne.__privateAdd.call(void 0,this,x),ne.__privateAdd.call(void 0,this,N),ne.__privateAdd.call(void 0,this,R),ne.__privateAdd.call(void 0,this,L),ne.__privateAdd.call(void 0,this,F),ne.__privateAdd.call(void 0,this,H),ne.__privateAdd.call(void 0,this,W),ne.__privateAdd.call(void 0,this,K),ne.__privateAdd.call(void 0,this,q),ne.__privateAdd.call(void 0,this,X),ne.__privateAdd.call(void 0,this,z),ne.__privateAdd.call(void 0,this,Z),ne.__privateAdd.call(void 0,this,te),ne.__privateAdd.call(void 0,this,n,void 0),ne.__privateAdd.call(void 0,this,s,void 0),ne.__privateAdd.call(void 0,this,a,void 0),ne.__privateAdd.call(void 0,this,o,void 0),ne.__privateAdd.call(void 0,this,l,void 0),ne.__privateAdd.call(void 0,this,c,void 0),ne.__privateAdd.call(void 0,this,u,void 0),ne.__privateAdd.call(void 0,this,d,void 0),ne.__privateAdd.call(void 0,this,h,void 0),ne.__privateAdd.call(void 0,this,m,void 0),ne.__privateAdd.call(void 0,this,p,void 0),ne.__privateAdd.call(void 0,this,f,void 0),ne.__privateAdd.call(void 0,this,v,void 0),this.startIfPendingTransactions=()=>{ne.__privateMethod.call(void 0,this,F,D).call(this).length?ne.__privateMethod.call(void 0,this,g,_).call(this):this.stop()},this.hub=new(0,oe.default),ne.__privateSet.call(void 0,this,n,e),ne.__privateSet.call(void 0,this,s,t),ne.__privateSet.call(void 0,this,a,new Map),ne.__privateSet.call(void 0,this,o,r),ne.__privateSet.call(void 0,this,l,i),ne.__privateSet.call(void 0,this,c,T),ne.__privateSet.call(void 0,this,u,E??(()=>!0)),ne.__privateSet.call(void 0,this,d,ne.__privateMethod.call(void 0,this,k,y).bind(this)),ne.__privateSet.call(void 0,this,h,P),ne.__privateSet.call(void 0,this,m,C),ne.__privateSet.call(void 0,this,p,!1),ne.__privateSet.call(void 0,this,v,j?.beforePublish??(()=>!0)),ne.__privateSet.call(void 0,this,f,j?.beforeCheckPendingTransaction??(()=>!0))}async forceCheckTransaction(e){const t=await ne.__privateGet.call(void 0,this,h).call(this);try{await ne.__privateMethod.call(void 0,this,x,M).call(this,e)}catch(e){ue("Failed to check transaction",e)}finally{t()}}stop(){ne.__privateGet.call(void 0,this,p)&&(ne.__privateGet.call(void 0,this,s).removeListener("latest",ne.__privateGet.call(void 0,this,d)),ne.__privateSet.call(void 0,this,p,!1),ue("Stopped polling"))}}}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/dist/chunk-5KMU2IAT.js"}],[1884,{"@metamask/rpc-errors":1717},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i=e("@metamask/rpc-errors");r.validateConfirmedExternalTransaction=function(e,t,r){if(!e||!e.txParams)throw i.rpcErrors.invalidParams('"transactionMeta" or "transactionMeta.txParams" is missing');if("confirmed"!==e.status)throw i.rpcErrors.invalidParams('External transaction status should be "confirmed"');const n=e.txParams.nonce;if(r&&r.length>0){if(r.find((e=>e.txParams?.nonce===n)))throw i.rpcErrors.invalidParams("External transaction nonce should not be in pending txs")}if(t&&t.length>0){if(t.find((e=>e.txParams?.nonce===n)))throw i.rpcErrors.invalidParams("External transaction nonce should not be in confirmed txs")}}}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/dist/chunk-7LXE4KHV.js"}],[1885,{"./chunk-2XKEAKQG.js":1881,"./chunk-DLOQPH4M.js":1886,"./chunk-S6VGOPUY.js":1900,"./chunk-Z4BLTVTB.js":1911,"@metamask/eth-query":1316,"@metamask/utils":2300,events:3328},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var n,s,a,o,l,c,u,d,h,m,p,f,v,g,_,k,y,w,T,b,E,S,P,A,C,I,j=e("./chunk-2XKEAKQG.js"),x=e("./chunk-DLOQPH4M.js"),M=e("./chunk-S6VGOPUY.js"),N=e("./chunk-Z4BLTVTB.js"),O=i(e("@metamask/eth-query")),R=e("@metamask/utils"),B=i(e("events")),L=R.createModuleLogger.call(void 0,M.projectLogger,"gas-fee-poller");n=new WeakMap,s=new WeakMap,a=new WeakMap,o=new WeakMap,l=new WeakMap,c=new WeakMap,u=new WeakMap,d=new WeakMap,h=new WeakSet,m=function(){N.__privateGet.call(void 0,this,d)||(N.__privateMethod.call(void 0,this,v,g).call(this),N.__privateSet.call(void 0,this,d,!0),L("Started polling"))},p=new WeakSet,f=function(){N.__privateGet.call(void 0,this,d)&&(clearTimeout(N.__privateGet.call(void 0,this,u)),N.__privateSet.call(void 0,this,u,void 0),N.__privateSet.call(void 0,this,d,!1),L("Stopped polling"))},v=new WeakSet,g=async function(){await N.__privateMethod.call(void 0,this,_,k).call(this),N.__privateSet.call(void 0,this,u,setTimeout((()=>N.__privateMethod.call(void 0,this,v,g).call(this)),1e4))},_=new WeakSet,k=async function(){const e=N.__privateMethod.call(void 0,this,P,A).call(this);if(!e.length)return;L("Found unapproved transactions",e.length);const t=await N.__privateMethod.call(void 0,this,C,I).call(this,e);L("Retrieved gas fee controller data",t),await Promise.all(e.flatMap((e=>{const{chainId:r}=e,i=t.get(r);return N.__privateMethod.call(void 0,this,y,w).call(this,e,i)})))},y=new WeakSet,w=async function(e,t){const{id:r}=e,[i,n]=await Promise.all([N.__privateMethod.call(void 0,this,T,b).call(this,e,t),N.__privateMethod.call(void 0,this,E,S).call(this,e)]);(i||n)&&this.hub.emit("transaction-updated",{transactionId:r,gasFeeEstimates:i?.gasFeeEstimates,gasFeeEstimatesLoaded:i?.gasFeeEstimatesLoaded,layer1GasFee:n})},T=new WeakSet,b=async function(e,t){const{chainId:r,networkClientId:i}=e,n=new(0,O.default)(N.__privateGet.call(void 0,this,o).call(this,r,i)),a=x.getGasFeeFlow.call(void 0,e,N.__privateGet.call(void 0,this,s));a&&L("Found gas fee flow",a.constructor.name,e.id);const l={ethQuery:n,gasFeeControllerData:t,transactionMeta:e};let c;if(a)try{c=(await a.getGasFees(l)).estimates}catch(t){L("Failed to get suggested gas fees",e.id,t)}if(c||!e.gasFeeEstimatesLoaded)return L("Updated gas fee estimates",{gasFeeEstimates:c,transaction:e.id}),{gasFeeEstimates:c,gasFeeEstimatesLoaded:!0}},E=new WeakSet,S=async function(e){const{chainId:t,networkClientId:r}=e,i=N.__privateGet.call(void 0,this,o).call(this,t,r),n=await j.getTransactionLayer1GasFee.call(void 0,{layer1GasFeeFlows:N.__privateGet.call(void 0,this,c),provider:i,transactionMeta:e});return n&&L("Updated layer 1 gas fee",n,e.id),n},P=new WeakSet,A=function(){return N.__privateGet.call(void 0,this,l).call(this).filter((e=>"unapproved"===e.status))},C=new WeakSet,I=async function(e){const t=new Map;for(const r of e){const{chainId:e,networkClientId:i}=r;if(t.has(e))continue;const s=i??N.__privateGet.call(void 0,this,n).call(this,e);t.set(e,s)}L("Extracted network client IDs by chain ID",t);const r=Array.from(t.entries()).map((async([e,t])=>[e,await N.__privateGet.call(void 0,this,a).call(this,{networkClientId:t})]));return new Map(await Promise.all(r))},r.GasFeePoller=class{constructor({findNetworkClientIdByChainId:e,gasFeeFlows:t,getGasFeeControllerEstimates:r,getProvider:i,getTransactions:g,layer1GasFeeFlows:k,onStateChange:w}){N.__privateAdd.call(void 0,this,h),N.__privateAdd.call(void 0,this,p),N.__privateAdd.call(void 0,this,v),N.__privateAdd.call(void 0,this,_),N.__privateAdd.call(void 0,this,y),N.__privateAdd.call(void 0,this,T),N.__privateAdd.call(void 0,this,E),N.__privateAdd.call(void 0,this,P),N.__privateAdd.call(void 0,this,C),this.hub=new(0,B.default),N.__privateAdd.call(void 0,this,n,void 0),N.__privateAdd.call(void 0,this,s,void 0),N.__privateAdd.call(void 0,this,a,void 0),N.__privateAdd.call(void 0,this,o,void 0),N.__privateAdd.call(void 0,this,l,void 0),N.__privateAdd.call(void 0,this,c,void 0),N.__privateAdd.call(void 0,this,u,void 0),N.__privateAdd.call(void 0,this,d,!1),N.__privateSet.call(void 0,this,n,e),N.__privateSet.call(void 0,this,s,t),N.__privateSet.call(void 0,this,c,k),N.__privateSet.call(void 0,this,a,r),N.__privateSet.call(void 0,this,o,i),N.__privateSet.call(void 0,this,l,g),w((()=>{N.__privateMethod.call(void 0,this,P,A).call(this).length?N.__privateMethod.call(void 0,this,h,m).call(this):N.__privateMethod.call(void 0,this,p,f).call(this)}))}}}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/dist/chunk-7MKQDZKY.js"}],[1886,{"./chunk-RAOYRJ25.js":1899,"@metamask/controller-utils":1948},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i=e("./chunk-RAOYRJ25.js"),n=e("@metamask/controller-utils");function s(e,t){return n.weiHexToGweiDec.call(void 0,e[t])}r.getGasFeeFlow=function(e,t){return t.find((t=>t.matchesTransaction(e)))},r.mergeGasFeeEstimates=function({gasFeeControllerEstimates:e,transactionGasFeeEstimates:t}){const r=t.type;return"fee-market"===r?Object.values(i.GasFeeEstimateLevel).reduce(((r,i)=>{return{...r,[i]:(s=e?.[i],a=t[i],{...s,suggestedMaxFeePerGas:n.weiHexToGweiDec.call(void 0,a.maxFeePerGas),suggestedMaxPriorityFeePerGas:n.weiHexToGweiDec.call(void 0,a.maxPriorityFeePerGas)})};var s,a}),{...e}):"legacy"===r?Object.values(i.GasFeeEstimateLevel).reduce(((e,r)=>({...e,[r]:s(t,r)})),{}):"eth_gasPrice"===r?{gasPrice:(a=t,n.weiHexToGweiDec.call(void 0,a.gasPrice))}:e;var a}}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/dist/chunk-DLOQPH4M.js"}],[1887,{"./chunk-S6VGOPUY.js":1900,"./chunk-Z4BLTVTB.js":1911,"async-mutex":1952,events:3328},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i,n,s,a,o,l,c,u,d,h,m,p,f,v,g,_,k,y,w,T,b,E,S,P,A,C,I,j,x,M,N,O,R=e("./chunk-S6VGOPUY.js"),B=e("./chunk-Z4BLTVTB.js"),L=e("async-mutex"),G=e("events"),F=(i=G)&&i.__esModule?i:{default:i},D=[e=>e.status,e=>e.txParams.gasUsed];n=new WeakMap,s=new WeakMap,a=new WeakMap,o=new WeakMap,l=new WeakMap,c=new WeakMap,u=new WeakMap,d=new WeakMap,h=new WeakMap,m=new WeakMap,p=new WeakMap,f=new WeakMap,v=new WeakMap,g=new WeakSet,_=function(e){e.sort(((e,t)=>e.time<t.time?-1:1))},k=new WeakSet,y=function(e,t){return e.filter((e=>!t.some((({hash:t})=>t===e.hash))))},w=new WeakSet,T=function(e,t){return e.filter((e=>t.some((t=>e.hash===t.hash&&B.__privateMethod.call(void 0,this,b,E).call(this,e,t)))))},b=new WeakSet,E=function(e,t){return D.some((r=>r(e)!==r(t)))},S=new WeakSet,P=function(){const e=B.__privateGet.call(void 0,this,p).getLastBlockVariations?.()??[],t=B.__privateMethod.call(void 0,this,x,M).call(this,e);return B.__privateGet.call(void 0,this,a).call(this)[t]},A=new WeakSet,C=function(e){const t=B.__privateMethod.call(void 0,this,S,P).call(this);return t?t+1:B.__privateGet.call(void 0,this,m)?void 0:e-10},I=new WeakSet,j=function(e,t){let r=-1;for(const t of e){const e=t.blockNumber?parseInt(t.blockNumber,10):-1;r=Math.max(r,e)}if(-1===r)return;const i=B.__privateMethod.call(void 0,this,x,M).call(this,t),n=B.__privateGet.call(void 0,this,a).call(this);n[i]>=r||this.hub.emit("updatedLastFetchedBlockNumbers",{lastFetchedBlockNumbers:{...n,[i]:r},blockNumber:r})},x=new WeakSet,M=function(e){const t=B.__privateGet.call(void 0,this,l).call(this),r=B.__privateGet.call(void 0,this,s).call(this)?.toLowerCase();return[t,r,...e].join("#")},N=new WeakSet,O=function(){const e=B.__privateGet.call(void 0,this,c).call(this),t=B.__privateGet.call(void 0,this,l).call(this),r=B.__privateGet.call(void 0,this,p).isSupportedNetwork(t);return e&&r},r.IncomingTransactionHelper=class{constructor({blockTracker:e,getCurrentAccount:t,getLastFetchedBlockNumbers:r,getLocalTransactions:i,getChainId:_,isEnabled:y,queryEntireHistory:T,remoteTransactionSource:E,transactionLimit:P,updateTransactions:C}){B.__privateAdd.call(void 0,this,g),B.__privateAdd.call(void 0,this,k),B.__privateAdd.call(void 0,this,w),B.__privateAdd.call(void 0,this,b),B.__privateAdd.call(void 0,this,S),B.__privateAdd.call(void 0,this,A),B.__privateAdd.call(void 0,this,I),B.__privateAdd.call(void 0,this,x),B.__privateAdd.call(void 0,this,N),B.__privateAdd.call(void 0,this,n,void 0),B.__privateAdd.call(void 0,this,s,void 0),B.__privateAdd.call(void 0,this,a,void 0),B.__privateAdd.call(void 0,this,o,void 0),B.__privateAdd.call(void 0,this,l,void 0),B.__privateAdd.call(void 0,this,c,void 0),B.__privateAdd.call(void 0,this,u,void 0),B.__privateAdd.call(void 0,this,d,new(0,L.Mutex)),B.__privateAdd.call(void 0,this,h,void 0),B.__privateAdd.call(void 0,this,m,void 0),B.__privateAdd.call(void 0,this,p,void 0),B.__privateAdd.call(void 0,this,f,void 0),B.__privateAdd.call(void 0,this,v,void 0),this.hub=new(0,F.default),B.__privateSet.call(void 0,this,n,e),B.__privateSet.call(void 0,this,s,t),B.__privateSet.call(void 0,this,a,r),B.__privateSet.call(void 0,this,o,i||(()=>[])),B.__privateSet.call(void 0,this,l,_),B.__privateSet.call(void 0,this,c,y??(()=>!0)),B.__privateSet.call(void 0,this,u,!1),B.__privateSet.call(void 0,this,m,T??!0),B.__privateSet.call(void 0,this,p,E),B.__privateSet.call(void 0,this,f,P),B.__privateSet.call(void 0,this,v,C??!1),B.__privateSet.call(void 0,this,h,(async e=>{try{await this.update(e)}catch(e){console.error("Error while checking incoming transactions",e)}}))}start(){B.__privateGet.call(void 0,this,u)||B.__privateMethod.call(void 0,this,N,O).call(this)&&(B.__privateGet.call(void 0,this,n).addListener("latest",B.__privateGet.call(void 0,this,h)),B.__privateSet.call(void 0,this,u,!0))}stop(){B.__privateGet.call(void 0,this,n).removeListener("latest",B.__privateGet.call(void 0,this,h)),B.__privateSet.call(void 0,this,u,!1)}async update(e){const t=await B.__privateGet.call(void 0,this,d).acquire();R.incomingTransactionsLogger.call(void 0,"Checking for incoming transactions");try{if(!B.__privateMethod.call(void 0,this,N,O).call(this))return;const t=parseInt(e||await B.__privateGet.call(void 0,this,n).getLatestBlock(),16),r=B.__privateGet.call(void 0,this,p).getLastBlockVariations?.()??[],i=B.__privateMethod.call(void 0,this,A,C).call(this,t),a=B.__privateGet.call(void 0,this,s).call(this),c=B.__privateGet.call(void 0,this,l).call(this);let u=[];try{u=await B.__privateGet.call(void 0,this,p).fetchTransactions({address:a,currentChainId:c,fromBlock:i,limit:B.__privateGet.call(void 0,this,f)})}catch(e){return void R.incomingTransactionsLogger.call(void 0,"Error while fetching remote transactions",e)}B.__privateGet.call(void 0,this,v)||(u=u.filter((e=>e.txParams.to?.toLowerCase()===a.toLowerCase())));const d=B.__privateGet.call(void 0,this,v)?B.__privateGet.call(void 0,this,o).call(this):[],h=B.__privateMethod.call(void 0,this,k,y).call(this,u,d),m=B.__privateMethod.call(void 0,this,w,T).call(this,u,d);(h.length>0||m.length>0)&&(B.__privateMethod.call(void 0,this,g,_).call(this,h),B.__privateMethod.call(void 0,this,g,_).call(this,m),R.incomingTransactionsLogger.call(void 0,"Found incoming transactions",{new:h,updated:m}),this.hub.emit("transactions",{added:h,updated:m})),B.__privateMethod.call(void 0,this,I,j).call(this,u,r)}finally{t()}}}}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/dist/chunk-DTDTOMTB.js"}],[1888,{"./chunk-FDUCRHYT.js":1889,"./chunk-S6VGOPUY.js":1900,"./chunk-UGN7PBON.js":1904,"./chunk-Z4BLTVTB.js":1911,"@metamask/controller-utils":1948,"async-mutex":1952,"bn.js":2980,uuid:4424},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i,n,s,a,o,l,c,u,d,h,m,p,f,v,g,_,k=e("./chunk-FDUCRHYT.js"),y=e("./chunk-UGN7PBON.js"),w=e("./chunk-S6VGOPUY.js"),T=e("./chunk-Z4BLTVTB.js"),b=e("@metamask/controller-utils"),E=e("async-mutex"),S=e("bn.js"),P=(i=S)&&i.__esModule?i:{default:i},A=e("uuid");n=new WeakMap,s=new WeakMap,a=new WeakMap,o=new WeakSet,l=function(e,t){const r=Date.now()-e,i=Math.max(0,5e3-r);i>0?setTimeout(t,i):t()},c=new WeakMap,u=new WeakMap,d=new WeakSet,h=function(e){let t=e.result;return"0"===e.status&&(t=[],e.result.length&&w.incomingTransactionsLogger.call(void 0,"Ignored Etherscan request error",{message:e.result,type:T.__privateGet.call(void 0,this,s)?"token":"normal"})),t},m=new WeakSet,p=function(e,t){const r=T.__privateMethod.call(void 0,this,g,_).call(this,e,t);return{...r,txParams:{...r.txParams,data:e.input},..."0"===e.isError?{status:"confirmed"}:{error:new Error("Transaction failed"),status:"failed"}}},f=new WeakSet,v=function(e,t){return{...T.__privateMethod.call(void 0,this,g,_).call(this,e,t),isTransfer:!0,transferInformation:{contractAddress:e.contractAddress,decimals:Number(e.tokenDecimal),symbol:e.tokenSymbol}}},g=new WeakSet,_=function(e,t){const r=1e3*parseInt(e.timeStamp,10);return{blockNumber:e.blockNumber,chainId:t,hash:e.hash,id:A.v1.call(void 0,{msecs:r}),status:"confirmed",time:r,txParams:{chainId:t,from:e.from,gas:b.BNToHex.call(void 0,new(0,P.default)(e.gas)),gasPrice:b.BNToHex.call(void 0,new(0,P.default)(e.gasPrice)),gasUsed:b.BNToHex.call(void 0,new(0,P.default)(e.gasUsed)),nonce:b.BNToHex.call(void 0,new(0,P.default)(e.nonce)),to:e.to,value:b.BNToHex.call(void 0,new(0,P.default)(e.value))},type:"incoming",verifiedOnBlockchain:!1}},r.EtherscanRemoteTransactionSource=class{constructor({includeTokenTransfers:e}={}){T.__privateAdd.call(void 0,this,o),T.__privateAdd.call(void 0,this,d),T.__privateAdd.call(void 0,this,m),T.__privateAdd.call(void 0,this,f),T.__privateAdd.call(void 0,this,g),T.__privateAdd.call(void 0,this,n,void 0),T.__privateAdd.call(void 0,this,s,void 0),T.__privateAdd.call(void 0,this,a,new(0,E.Mutex)),T.__privateAdd.call(void 0,this,c,(async(e,t)=>{const{currentChainId:r}=e,i=await k.fetchEtherscanTransactions.call(void 0,t);return T.__privateMethod.call(void 0,this,d,h).call(this,i).map((e=>T.__privateMethod.call(void 0,this,m,p).call(this,e,r)))})),T.__privateAdd.call(void 0,this,u,(async(e,t)=>{const{currentChainId:r}=e,i=await k.fetchEtherscanTokenTransactions.call(void 0,t);return T.__privateMethod.call(void 0,this,d,h).call(this,i).map((e=>T.__privateMethod.call(void 0,this,f,v).call(this,e,r)))})),T.__privateSet.call(void 0,this,n,e??!0),T.__privateSet.call(void 0,this,s,!1)}isSupportedNetwork(e){return Object.keys(y.ETHERSCAN_SUPPORTED_NETWORKS).includes(e)}getLastBlockVariations(){return[T.__privateGet.call(void 0,this,s)?"token":"normal"]}async fetchTransactions(e){const t=await T.__privateGet.call(void 0,this,a).acquire(),r=Date.now(),i={...e,chainId:e.currentChainId};try{const t=T.__privateGet.call(void 0,this,s)?await T.__privateGet.call(void 0,this,u).call(this,e,i):await T.__privateGet.call(void 0,this,c).call(this,e,i);return T.__privateGet.call(void 0,this,n)&&T.__privateSet.call(void 0,this,s,!T.__privateGet.call(void 0,this,s)),t}finally{T.__privateMethod.call(void 0,this,o,l).call(this,r,t)}}}}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/dist/chunk-EQT25RSP.js"}],[1889,{"./chunk-S6VGOPUY.js":1900,"./chunk-UGN7PBON.js":1904,"@metamask/controller-utils":1948},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i=e("./chunk-UGN7PBON.js"),n=e("./chunk-S6VGOPUY.js"),s=e("@metamask/controller-utils");async function a(e,{address:t,chainId:r,fromBlock:i,limit:a}){const l=function(e,t){const r=o(e);let i=`${r}/api?`;for(const e of Object.keys(t)){const r=t[e];r&&(i+=`${e}=${r}&`)}return i+="tag=latest&page=1",i}(r,{...{module:"account",address:t,startBlock:i?.toString(),offset:a?.toString(),sort:"desc"},action:e});n.incomingTransactionsLogger.call(void 0,"Sending Etherscan request",l);return await s.handleFetch.call(void 0,l)}function o(e){const t=i.ETHERSCAN_SUPPORTED_NETWORKS[e];if(!t)throw new Error(`Etherscan does not support chain with ID: ${e}`);return`https://${t.subdomain}.${t.domain}`}r.fetchEtherscanTransactions=async function({address:e,chainId:t,fromBlock:r,limit:i}){return await a("txlist",{address:e,chainId:t,fromBlock:r,limit:i})},r.fetchEtherscanTokenTransactions=async function({address:e,chainId:t,fromBlock:r,limit:i}){return await a("tokentx",{address:e,chainId:t,fromBlock:r,limit:i})},r.getEtherscanApiHost=o}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/dist/chunk-FDUCRHYT.js"}],[189,{"@metamask/permission-controller":1624,lodash:3836},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=e("@metamask/permission-controller"),n=e("lodash");r.default={version:69,async migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=69;const r=function(e){var t;if("object"==typeof(null==e||null===(t=e.SubjectMetadataController)||void 0===t?void 0:t.subjectMetadata)){const{SubjectMetadataController:{subjectMetadata:t}}=e;Object.values(t).forEach((e=>{e&&"object"==typeof e&&!Array.isArray(e)&&(e.subjectType=e.extensionId?i.SubjectType.Extension:i.SubjectType.Website)}))}return e}(t.data);return t.data=r,t}}}}},{package:"$root$",file:"app/scripts/migrations/069.js"}],[1890,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i=class extends Error{constructor(e,t){super(e??"Simulation failed"),this.code=t}};r.SimulationError=i,r.SimulationChainNotSupportedError=class extends i{constructor(e){super(`Chain is not supported: ${e}`,"chain-not-supported")}},r.SimulationInvalidResponseError=class extends i{constructor(){super("Invalid response from simulation API","invalid-response")}},r.SimulationRevertedError=class extends i{constructor(){super("Transaction was reverted","reverted")}}}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/dist/chunk-HMOSP33F.js"}],[1891,{"./chunk-HMOSP33F.js":1890,"./chunk-KT6UAKBB.js":1892,"./chunk-S6VGOPUY.js":1900,"./chunk-UGN7PBON.js":1904,"@ethersproject/abi":460,"@metamask/controller-utils":1948,"@metamask/metamask-eth-abis":1518,"@metamask/utils":2300},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i=e("./chunk-KT6UAKBB.js"),n=e("./chunk-HMOSP33F.js"),s=e("./chunk-UGN7PBON.js"),a=e("./chunk-S6VGOPUY.js"),o=e("@ethersproject/abi"),l=e("@metamask/controller-utils"),c=e("@metamask/metamask-eth-abis"),u=e("@metamask/utils"),d=(e=>(e.ERC20="erc20",e.ERC721="erc721",e.ERC1155="erc1155",e.ERC20_WRAPPED="erc20Wrapped",e.ERC721_LEGACY="erc721Legacy",e))(d||{}),h=u.createModuleLogger.call(void 0,a.projectLogger,"simulation"),m=["Transfer","TransferSingle","TransferBatch","Deposit","Withdrawal"],p={erc20:{abi:c.abiERC20,standard:"erc20"},erc721:{abi:c.abiERC721,standard:"erc721"},erc1155:{abi:c.abiERC1155,standard:"erc1155"},erc20Wrapped:{abi:s.ABI_SIMULATION_ERC20_WRAPPED,standard:"erc20"},erc721Legacy:{abi:s.ABI_SIMULATION_ERC721_LEGACY,standard:"erc721"}},f=["execution reverted","insufficient funds for gas"];function v(e){const t=T(e.transactions[0]?.callTrace??{});h("Extracted logs",t);const r=function(){const e=Object.values(d);return new Map(e.map((e=>{const{abi:t}=p[e];return[e,new(0,o.Interface)(t)]})))}();return t.map((e=>{const t=function(e,t){const r=Object.values(d);for(const i of r)try{const r=t.get(i),{abi:n,standard:s}=p[i];return{...r.parseLog(e),abi:n,standard:s}}catch(e){continue}return}(e,r);if(!t)return void h("Failed to parse log",e);const i=t.abi.find((e=>e.name===t.name))?.inputs;if(!i)return void h("Failed to find inputs for event",t);const n=function(e,t){return e.reduce(((e,r,i)=>{const n=t[i].name.replace("_",""),s=g(r);return e[n]=s,e}),{})}(t.args,i);return{contractAddress:e.address,tokenStandard:t.standard,name:t.name,args:n,abi:t.abi}})).filter((e=>void 0!==e))}function g(e){return Array.isArray(e)?e.map(g):(e.toHexString?.()??e).toLowerCase()}function _(e){return"Transfer"===e.name&&"erc721"===e.tokenStandard&&0===parseInt(e.args.from,16)}function k(e){return"erc721"===e.tokenStandard?[e.args.tokenId]:"erc1155"===e.tokenStandard&&"TransferSingle"===e.name?[e.args.id]:"erc1155"===e.tokenStandard&&"TransferBatch"===e.name?e.args.ids:[void 0]}function y(e,t,r){const i=(n=r.return,l.toHex.call(void 0,l.hexToBN.call(void 0,n)));var n;return"erc721"===t.standard?i===e?"0x1":"0x0":i}function w(e,t,r){switch(e){case"erc721":return new(0,o.Interface)(c.abiERC721).encodeFunctionData("ownerOf",[r]);case"erc1155":return new(0,o.Interface)(c.abiERC1155).encodeFunctionData("balanceOf",[t,r]);default:return new(0,o.Interface)(c.abiERC20).encodeFunctionData("balanceOf",[t])}}function T(e){return[...e.logs??[],...(e.calls??[]).map((e=>T(e))).flat()]}function b(e,t){const r=l.hexToBN.call(void 0,t).sub(l.hexToBN.call(void 0,e)),i=r.isNeg(),n=l.toHex.call(void 0,r.abs());if(!r.isZero())return{previousBalance:e,newBalance:t,difference:n,isDecrease:i};h("Balance change is zero")}r.SupportedToken=d,r.getSimulationData=async function(e){const{chainId:t,from:r,to:s,value:a,data:o}=e;h("Getting simulation data",e);try{const l=await i.simulateTransactions.call(void 0,t,{transactions:[{data:o,from:r,maxFeePerGas:"0x0",maxPriorityFeePerGas:"0x0",to:s,value:a}],withCallTrace:!0,withLogs:!0}),c=l.transactions?.[0]?.error;if(c)throw new(0,n.SimulationError)(c);const u=function(e,t){const r=t.transactions[0];if(!r)return;const{stateDiff:i}=r,n=i?.pre?.[e]?.balance,s=i?.post?.[e]?.balance;if(!n||!s)return;return b(n,s)}(e.from,l),d=v(l);h("Parsed events",d);const p=await async function(e,t){const r=function(e,t){const r=new Set,i=new Map,n=new Map,s=t.filter((t=>m.includes(t.name)&&[t.args.from,t.args.to].includes(e.from)));h("Filtered user events",s);for(const t of s){const s=k(t);h("Extracted token ids",s);for(const a of s){const s={address:t.contractAddress,standard:t.tokenStandard,id:a},o=JSON.stringify(s);if(r.has(o)){h("Ignoring additional event with same contract and token ID",s);continue}r.add(o);const l=w(t.tokenStandard,e.from,a),c={from:e.from,to:t.contractAddress,data:l};_(t)||i.set(s,c),n.set(s,c)}}return{before:i,after:n}}(e,t);h("Generated balance transactions",[...r.after.values()]);const s=[...r.before.values(),e,...r.after.values()];if(1===s.length)return[];const a=await i.simulateTransactions.call(void 0,e.chainId,{transactions:s});if(h("Balance simulation response",a),a.transactions.length!==s.length)throw new(0,n.SimulationInvalidResponseError);let o=0;return[...r.after.keys()].map(((t,i)=>{const n=b(!r.before.get(t)?"0x0":y(e.from,t,a.transactions[o++]),y(e.from,t,a.transactions[i+r.before.size+1]));if(n)return{...t,...n}})).filter((e=>void 0!==e))}(e,d);return{nativeBalanceChange:u,tokenBalanceChanges:p}}catch(t){h("Failed to get simulation data",t,e);let r=t;f.some((e=>r.message?.includes(e)))&&(r=new(0,n.SimulationRevertedError));const{code:i,message:s}=r;return{tokenBalanceChanges:[],error:{code:i,message:s}}}},r.getEvents=v}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/dist/chunk-IT3SYNZ6.js"}],[1892,{"./chunk-HMOSP33F.js":1890,"./chunk-S6VGOPUY.js":1900,"@metamask/controller-utils":1948,"@metamask/utils":2300},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i=e("./chunk-HMOSP33F.js"),n=e("./chunk-S6VGOPUY.js"),s=e("@metamask/controller-utils"),a=e("@metamask/utils").createModuleLogger.call(void 0,n.projectLogger,"simulation-api"),o="https://tx-sentinel-{0}.api.cx.metamask.io/",l="networks",c=0;function u(e){return o.replace("{0}",e)}r.simulateTransactions=async function(e,t){const r=await async function(e){const t=await async function(){const e=`${u("ethereum-mainnet")}${l}`,t=await fetch(e);return t.json()}(),r=s.convertHexToDecimal.call(void 0,e),n=t[r];if(!n?.confirmations)throw a("Chain is not supported",e),new(0,i.SimulationChainNotSupportedError)(e);return u(n.network)}(e);a("Sending request",r,t);const n=c;c+=1;const o=await fetch(r,{method:"POST",body:JSON.stringify({id:String(n),jsonrpc:"2.0",method:"infura_simulateTransactions",params:[t]})}),d=await o.json();if(a("Received response",d),d.error){const{code:e,message:t}=d.error;throw new(0,i.SimulationError)(t,e)}return d?.result}}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/dist/chunk-KT6UAKBB.js"}],[1893,{"./chunk-UGN7PBON.js":1904,"./chunk-YVCX6Z75.js":1909},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i=e("./chunk-YVCX6Z75.js"),n=e("./chunk-UGN7PBON.js"),s=[n.CHAIN_IDS.OPTIMISM,n.CHAIN_IDS.OPTIMISM_TESTNET,n.CHAIN_IDS.BASE,n.CHAIN_IDS.BASE_TESTNET,n.CHAIN_IDS.OPBNB,n.CHAIN_IDS.OPBNB_TESTNET,n.CHAIN_IDS.ZORA],a=class extends i.OracleLayer1GasFeeFlow{constructor(){super("0x420000000000000000000000000000000000000F")}matchesTransaction(e){return s.includes(e.chainId)}};r.OptimismLayer1GasFeeFlow=a}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/dist/chunk-NYKRCWBG.js"}],[1894,{"./chunk-2XKEAKQG.js":1881,"./chunk-3ZRHCVVS.js":1882,"./chunk-5KMU2IAT.js":1883,"./chunk-7LXE4KHV.js":1884,"./chunk-7MKQDZKY.js":1885,"./chunk-DLOQPH4M.js":1886,"./chunk-DTDTOMTB.js":1887,"./chunk-EQT25RSP.js":1888,"./chunk-IT3SYNZ6.js":1891,"./chunk-NYKRCWBG.js":1893,"./chunk-PRUNMTRD.js":1895,"./chunk-PUESYN62.js":1896,"./chunk-Q6Q44V4W.js":1897,"./chunk-QP75SWIQ.js":1898,"./chunk-S6VGOPUY.js":1900,"./chunk-SD6CWFDF.js":1901,"./chunk-TJMQEH57.js":1902,"./chunk-UGFBA4GV.js":1903,"./chunk-UT4M4XI3.js":1905,"./chunk-V72C4MCR.js":1906,"./chunk-VH47Q6TS.js":1907,"./chunk-WR5F34OW.js":1908,"./chunk-YXSCBWTU.js":1910,"./chunk-Z4BLTVTB.js":1911,"@ethereumjs/common":418,"@ethereumjs/tx":1917,"@ethereumjs/util":1929,"@metamask/base-controller":1942,"@metamask/controller-utils":1948,"@metamask/eth-query":1316,"@metamask/network-controller":1555,"@metamask/nonce-tracker":1569,"@metamask/rpc-errors":1717,"@metamask/utils":2300,"async-mutex":1952,"eth-method-registry":1957,events:3328,lodash:3836,uuid:4424},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i,n,s,a,o,l,c,u,d,h,m,p,f,v,g,_,k,y,w,T,b,E,S,P,A,C,I,j,x,M,N,O,R,B,L,G,F,D,H,U,W,$,K,V,q,Y,X,J,z,Q=e("./chunk-PRUNMTRD.js"),Z=e("./chunk-IT3SYNZ6.js"),ee=e("./chunk-SD6CWFDF.js"),te=e("./chunk-VH47Q6TS.js"),re=e("./chunk-5KMU2IAT.js"),ie=e("./chunk-7LXE4KHV.js"),ne=e("./chunk-V72C4MCR.js"),se=e("./chunk-QP75SWIQ.js"),ae=e("./chunk-NYKRCWBG.js"),oe=e("./chunk-WR5F34OW.js"),le=e("./chunk-TJMQEH57.js"),ce=e("./chunk-7MKQDZKY.js"),ue=e("./chunk-2XKEAKQG.js"),de=e("./chunk-DTDTOMTB.js"),he=e("./chunk-PUESYN62.js"),me=e("./chunk-EQT25RSP.js"),pe=e("./chunk-Q6Q44V4W.js"),fe=e("./chunk-YXSCBWTU.js"),ve=e("./chunk-3ZRHCVVS.js"),ge=e("./chunk-UT4M4XI3.js"),_e=e("./chunk-UGFBA4GV.js"),ke=e("./chunk-DLOQPH4M.js"),ye=e("./chunk-S6VGOPUY.js"),we=e("./chunk-Z4BLTVTB.js"),Te=e("@ethereumjs/common"),be=e("@ethereumjs/tx"),Ee=e("@ethereumjs/util"),Se=e("@metamask/base-controller"),Pe=e("@metamask/controller-utils"),Ae=e("@metamask/eth-query"),Ce=(i=Ae)&&i.__esModule?i:{default:i},Ie=e("@metamask/network-controller"),je=e("@metamask/nonce-tracker"),xe=e("@metamask/rpc-errors"),Me=e("@metamask/utils"),Ne=e("async-mutex"),Oe=e("eth-method-registry"),Re=e("events"),Be=e("lodash"),Le=e("uuid"),Ge={transactions:{persist:!0,anonymous:!1},methodData:{persist:!0,anonymous:!1},lastFetchedBlockNumbers:{persist:!0,anonymous:!1}},Fe=Te.Hardfork.London,De=1.1,He=1.1,Ue="TransactionController",We=(e=>(e.Approved="approved",e.NotApproved="not-approved",e.SkippedViaBeforePublishHook="skipped-via-before-publish-hook",e))(We||{});var $e=class extends Se.BaseController{constructor({blockTracker:e,disableHistory:t,disableSendFlowHistory:r,disableSwaps:i,getCurrentAccountEIP1559Compatibility:k,getCurrentNetworkEIP1559Compatibility:b,getExternalPendingTransactions:A,getGasFeeEstimates:I,getNetworkClientRegistry:R,getNetworkState:L,getPermittedAccounts:F,getSavedGasFees:H,getSelectedAddress:K,incomingTransactions:q={},isMultichainEnabled:X=!1,isSimulationEnabled:z,messenger:Q,onNetworkStateChange:Z,pendingTransactions:ee={},provider:te,securityProviderRequest:re,sign:ie,state:ne,testGasFeeFlows:se,transactionHistoryLimit:ae=40,hooks:oe}){super({name:Ue,metadata:Ge,messenger:Q,state:{methodData:{},transactions:[],lastFetchedBlockNumbers:{},...ne}}),we.__privateAdd.call(void 0,this,d),we.__privateAdd.call(void 0,this,m),we.__privateAdd.call(void 0,this,f),we.__privateAdd.call(void 0,this,_),we.__privateAdd.call(void 0,this,y),we.__privateAdd.call(void 0,this,T),we.__privateAdd.call(void 0,this,E),we.__privateAdd.call(void 0,this,P),we.__privateAdd.call(void 0,this,C),we.__privateAdd.call(void 0,this,j),we.__privateAdd.call(void 0,this,M),we.__privateAdd.call(void 0,this,O),we.__privateAdd.call(void 0,this,B),we.__privateAdd.call(void 0,this,G),we.__privateAdd.call(void 0,this,D),we.__privateAdd.call(void 0,this,U),we.__privateAdd.call(void 0,this,$),we.__privateAdd.call(void 0,this,V),we.__privateAdd.call(void 0,this,Y),we.__privateAdd.call(void 0,this,J),we.__privateAdd.call(void 0,this,n,new(0,Re.EventEmitter)),this.approvingTransactionIds=new Set,this.mutex=new(0,Ne.Mutex),we.__privateAdd.call(void 0,this,s,void 0),we.__privateAdd.call(void 0,this,a,void 0),this.signAbortCallbacks=new Map,we.__privateAdd.call(void 0,this,o,void 0),we.__privateAdd.call(void 0,this,l,void 0),we.__privateAdd.call(void 0,this,c,void 0),we.__privateAdd.call(void 0,this,u,void 0),we.__privateAdd.call(void 0,this,g,(()=>{this.pendingTransactionTracker.startIfPendingTransactions(),we.__privateGet.call(void 0,this,u).checkForPendingTransactionAndStartPolling()})),this.messagingSystem=Q,this.getNetworkState=L,this.isSendFlowHistoryDisabled=r??!1,this.isHistoryDisabled=t??!1,this.isSwapsDisabled=i??!1,we.__privateSet.call(void 0,this,l,z??(()=>!0)),this.registry=new(0,Oe.MethodRegistry)({provider:te}),this.getSavedGasFees=H??(e=>{}),this.getCurrentAccountEIP1559Compatibility=k??(()=>Promise.resolve(!0)),this.getCurrentNetworkEIP1559Compatibility=b,this.getGasFeeEstimates=I||(()=>Promise.resolve({})),this.getPermittedAccounts=F,this.getSelectedAddress=K,this.getExternalPendingTransactions=A??(()=>[]),this.securityProviderRequest=re,we.__privateSet.call(void 0,this,s,q),we.__privateSet.call(void 0,this,a,ee),we.__privateSet.call(void 0,this,o,ae),this.sign=ie,we.__privateSet.call(void 0,this,c,!0===se),this.afterSign=oe?.afterSign??(()=>!0),this.beforeApproveOnInit=oe?.beforeApproveOnInit??(()=>!0),this.beforeCheckPendingTransaction=oe?.beforeCheckPendingTransaction??(()=>!0),this.beforePublish=oe?.beforePublish??(()=>!0),this.getAdditionalSignArguments=oe?.getAdditionalSignArguments??(()=>[]),this.publish=oe?.publish??(()=>Promise.resolve({transactionHash:void 0})),this.nonceTracker=we.__privateMethod.call(void 0,this,d,h).call(this,{provider:te,blockTracker:e});const le=e=>this.messagingSystem.call("NetworkController:findNetworkClientIdByChainId",e);we.__privateSet.call(void 0,this,u,new(0,he.MultichainTrackingHelper)({isMultichainEnabled:X,provider:te,nonceTracker:this.nonceTracker,incomingTransactionOptions:q,findNetworkClientIdByChainId:le,getNetworkClientById:e=>this.messagingSystem.call("NetworkController:getNetworkClientById",e),getNetworkClientRegistry:R,removeIncomingTransactionHelperListeners:we.__privateMethod.call(void 0,this,y,w).bind(this),removePendingTransactionTrackerListeners:we.__privateMethod.call(void 0,this,E,S).bind(this),createNonceTracker:we.__privateMethod.call(void 0,this,d,h).bind(this),createIncomingTransactionHelper:we.__privateMethod.call(void 0,this,m,p).bind(this),createPendingTransactionTracker:we.__privateMethod.call(void 0,this,f,v).bind(this),onNetworkStateChange:e=>{this.messagingSystem.subscribe("NetworkController:stateChange",e)}})),we.__privateGet.call(void 0,this,u).initialize();const ue=new(0,me.EtherscanRemoteTransactionSource)({includeTokenTransfers:q.includeTokenTransfers});this.incomingTransactionHelper=we.__privateMethod.call(void 0,this,m,p).call(this,{blockTracker:e,etherscanRemoteTransactionSource:ue}),this.pendingTransactionTracker=we.__privateMethod.call(void 0,this,f,v).call(this,{provider:te,blockTracker:e}),this.gasFeeFlows=we.__privateMethod.call(void 0,this,j,x).call(this),this.layer1GasFeeFlows=we.__privateMethod.call(void 0,this,M,N).call(this);new(0,ce.GasFeePoller)({findNetworkClientIdByChainId:le,gasFeeFlows:this.gasFeeFlows,getGasFeeControllerEstimates:this.getGasFeeEstimates,getProvider:(e,t)=>we.__privateGet.call(void 0,this,u).getProvider({networkClientId:t,chainId:e}),getTransactions:()=>this.state.transactions,layer1GasFeeFlows:this.layer1GasFeeFlows,onStateChange:e=>{this.messagingSystem.subscribe("TransactionController:stateChange",e)}}).hub.on("transaction-updated",we.__privateMethod.call(void 0,this,U,W).bind(this)),this.messagingSystem.subscribe("TransactionController:stateChange",we.__privateGet.call(void 0,this,g)),Z((()=>{ye.projectLogger.call(void 0,"Detected network change",this.getChainId()),this.pendingTransactionTracker.startIfPendingTransactions(),this.onBootCleanup()})),this.onBootCleanup(),we.__privateGet.call(void 0,this,g).call(this)}failTransaction(e,t,r){const i=Be.merge.call(void 0,{},e,{error:_e.normalizeTxError.call(void 0,t),status:"failed"});this.messagingSystem.publish(`${Ue}:transactionFailed`,{actionId:r,error:t.message,transactionMeta:i}),this.updateTransaction(i,"TransactionController#failTransaction - Add error message and set status to failed"),this.onTransactionStatusChange(i),this.messagingSystem.publish(`${Ue}:transactionFinished`,i),we.__privateGet.call(void 0,this,n).emit(`${e.id}:finished`,i)}async registryLookup(e){const t=await this.registry.lookup(e);if(!t)return{registryMethod:"",parsedRegistryMethod:{name:void 0,args:void 0}};return{registryMethod:t,parsedRegistryMethod:this.registry.parse(t)}}destroy(){we.__privateMethod.call(void 0,this,_,k).call(this)}async handleMethodData(e){const t=await this.mutex.acquire();try{const{methodData:t}=this.state;if(Object.keys(t).find((t=>e===t)))return t[e];const r=await this.registryLookup(e);return this.update((t=>{t.methodData[e]=r})),r}finally{t()}}async addTransaction(e,{actionId:t,deviceConfirmedOn:r,method:i,origin:n,requireApproval:s,securityAlertResponse:a,sendFlowHistory:o,swaps:l={},type:c,networkClientId:d}={}){if(ye.projectLogger.call(void 0,"Adding transaction",e),e=_e.normalizeTransactionParams.call(void 0,e),d&&!we.__privateGet.call(void 0,this,u).has(d))throw new Error("The networkClientId for this transaction could not be found");const h=d??we.__privateMethod.call(void 0,this,V,q).call(this),m=await this.getEIP1559Compatibility(h);te.validateTxParams.call(void 0,e,m),n&&await te.validateTransactionOrigin.call(void 0,await this.getPermittedAccounts(n),this.getSelectedAddress(),e.from,n);const p=this.generateDappSuggestedGasFees(e,n),f=this.getChainId(h),v=we.__privateGet.call(void 0,this,u).getEthQuery({networkClientId:h,chainId:f}),g=c??(await ee.determineTransactionType.call(void 0,e,v)).type,_=this.getTransactionWithActionId(t);let k=_?Be.cloneDeep.call(void 0,_):{actionId:t,chainId:f,dappSuggestedGasFees:p,deviceConfirmedOn:r,id:Le.v1.call(void 0),origin:n,securityAlertResponse:a,status:"unapproved",time:Date.now(),txParams:e,userEditedGasLimit:!1,verifiedOnBlockchain:!1,type:g,networkClientId:h};if(await this.updateGasProperties(k),!_){if(i&&this.securityProviderRequest){const e=await this.securityProviderRequest(k,i);k.securityProviderResponse=e}this.isSendFlowHistoryDisabled||(k.sendFlowHistory=o??[]),this.isHistoryDisabled||(k=se.addInitialHistorySnapshot.call(void 0,k)),k=ge.updateSwapsTransaction.call(void 0,k,g,l,{isSwapsDisabled:this.isSwapsDisabled,cancelTransaction:this.cancelTransaction.bind(this),messenger:this.messagingSystem}),this.addMetadata(k),!1!==s?we.__privateMethod.call(void 0,this,D,H).call(this,k):ye.projectLogger.call(void 0,"Skipping simulation as approval not required"),this.messagingSystem.publish(`${Ue}:unapprovedTransactionAdded`,k)}return{result:this.processApproval(k,{isExisting:Boolean(_),requireApproval:s,actionId:t}),transactionMeta:k}}startIncomingTransactionPolling(e=[]){0!==e.length?we.__privateGet.call(void 0,this,u).startIncomingTransactionPolling(e):this.incomingTransactionHelper.start()}stopIncomingTransactionPolling(e=[]){0!==e.length?we.__privateGet.call(void 0,this,u).stopIncomingTransactionPolling(e):this.incomingTransactionHelper.stop()}stopAllIncomingTransactionPolling(){this.incomingTransactionHelper.stop(),we.__privateGet.call(void 0,this,u).stopAllIncomingTransactionPolling()}async updateIncomingTransactions(e=[]){0!==e.length?await we.__privateGet.call(void 0,this,u).updateIncomingTransactions(e):await this.incomingTransactionHelper.update()}async stopTransaction(e,t,{estimatedBaseFee:r,actionId:i}={}){if(this.getTransactionWithActionId(i))return;t&&(t=_e.normalizeGasFeeValues.call(void 0,t),_e.validateGasValues.call(void 0,t)),ye.projectLogger.call(void 0,"Creating cancel transaction",e,t);const s=this.getTransaction(e);if(!s)return;if(!this.sign)throw new Error("No sign method defined.");const a=_e.getIncreasedPriceFromExisting.call(void 0,s.txParams.gasPrice,De),o=_e.isGasPriceValue.call(void 0,t)&&t.gasPrice,l=o&&_e.validateMinimumIncrease.call(void 0,o,a)||a,c=s.txParams?.maxFeePerGas,d=_e.getIncreasedPriceFromExisting.call(void 0,c,De),h=_e.isFeeMarketEIP1559Values.call(void 0,t)&&t.maxFeePerGas,m=h&&_e.validateMinimumIncrease.call(void 0,h,d)||c&&d,p=s.txParams?.maxPriorityFeePerGas,f=_e.getIncreasedPriceFromExisting.call(void 0,p,De),v=_e.isFeeMarketEIP1559Values.call(void 0,t)&&t.maxPriorityFeePerGas,g=v&&_e.validateMinimumIncrease.call(void 0,v,f)||p&&f,_=m&&g?{from:s.txParams.from,gasLimit:s.txParams.gas,maxFeePerGas:m,maxPriorityFeePerGas:g,type:"0x2",nonce:s.txParams.nonce,to:s.txParams.from,value:"0x0"}:{from:s.txParams.from,gasLimit:s.txParams.gas,gasPrice:l,nonce:s.txParams.nonce,to:s.txParams.from,value:"0x0"},k=this.prepareUnsignedEthTx(s.chainId,_),y=await this.sign(k,s.txParams.from),w=Ee.bufferToHex.call(void 0,y.serialize()),T=_.maxFeePerGas??_.gasPrice,b=_.maxFeePerGas?s.txParams.maxFeePerGas:s.txParams.gasPrice;ye.projectLogger.call(void 0,"Submitting cancel transaction",{oldFee:b,newFee:T,txParams:_});const E=we.__privateGet.call(void 0,this,u).getEthQuery({networkClientId:s.networkClientId,chainId:s.chainId}),S=await this.publishTransactionForRetry(E,w,s),P={actionId:i,chainId:s.chainId,networkClientId:s.networkClientId,estimatedBaseFee:r,hash:S,id:Le.v1.call(void 0),originalGasEstimate:s.txParams.gas,status:"submitted",time:Date.now(),type:"cancel",txParams:_};this.addMetadata(P),this.messagingSystem.publish(`${Ue}:transactionApproved`,{transactionMeta:P,actionId:i}),this.messagingSystem.publish(`${Ue}:transactionSubmitted`,{transactionMeta:P,actionId:i}),this.messagingSystem.publish(`${Ue}:transactionFinished`,P),we.__privateGet.call(void 0,this,n).emit(`${s.id}:finished`,P)}async speedUpTransaction(e,t,{actionId:r,estimatedBaseFee:i}={}){if(this.getTransactionWithActionId(r))return;t&&(t=_e.normalizeGasFeeValues.call(void 0,t),_e.validateGasValues.call(void 0,t)),ye.projectLogger.call(void 0,"Creating speed up transaction",e,t);const n=this.getTransaction(e);if(!n)return;if(!this.sign)throw new Error("No sign method defined.");const s=_e.getIncreasedPriceFromExisting.call(void 0,n.txParams.gasPrice,He),a=_e.isGasPriceValue.call(void 0,t)&&t.gasPrice,o=a&&_e.validateMinimumIncrease.call(void 0,a,s)||s,l=n.txParams?.maxFeePerGas,c=_e.getIncreasedPriceFromExisting.call(void 0,l,He),d=_e.isFeeMarketEIP1559Values.call(void 0,t)&&t.maxFeePerGas,h=d&&_e.validateMinimumIncrease.call(void 0,d,c)||l&&c,m=n.txParams?.maxPriorityFeePerGas,p=_e.getIncreasedPriceFromExisting.call(void 0,m,He),f=_e.isFeeMarketEIP1559Values.call(void 0,t)&&t.maxPriorityFeePerGas,v=f&&_e.validateMinimumIncrease.call(void 0,f,p)||m&&p,g=h&&v?{...n.txParams,gasLimit:n.txParams.gas,maxFeePerGas:h,maxPriorityFeePerGas:v,type:"0x2"}:{...n.txParams,gasLimit:n.txParams.gas,gasPrice:o},_=this.prepareUnsignedEthTx(n.chainId,g),k=await this.sign(_,n.txParams.from),y=this.updateTransactionMetaRSV(n,k),w=Ee.bufferToHex.call(void 0,k.serialize()),T=g.maxFeePerGas??g.gasPrice,b=g.maxFeePerGas?y.txParams.maxFeePerGas:y.txParams.gasPrice;ye.projectLogger.call(void 0,"Submitting speed up transaction",{oldFee:b,newFee:T,txParams:g});const E=we.__privateGet.call(void 0,this,u).getEthQuery({networkClientId:n.networkClientId,chainId:n.chainId}),S=await this.publishTransactionForRetry(E,w,n),P={...y,estimatedBaseFee:i,id:Le.v1.call(void 0),time:Date.now(),hash:S,actionId:r,originalGasEstimate:n.txParams.gas,type:"retry",originalType:n.type},A=h&&v?{...P,txParams:{...n.txParams,maxFeePerGas:h,maxPriorityFeePerGas:v}}:{...P,txParams:{...n.txParams,gasPrice:o}};this.addMetadata(A),this.messagingSystem.publish(`${Ue}:transactionApproved`,{transactionMeta:A,actionId:r}),this.messagingSystem.publish(`${Ue}:transactionSubmitted`,{transactionMeta:A,actionId:r}),this.messagingSystem.publish(`${Ue}:speedupTransactionAdded`,A)}async estimateGas(e,t){const r=we.__privateGet.call(void 0,this,u).getEthQuery({networkClientId:t}),{estimatedGas:i,simulationFails:n}=await ne.estimateGas.call(void 0,e,r);return{gas:i,simulationFails:n}}async estimateGasBuffered(e,t,r){const i=we.__privateGet.call(void 0,this,u).getEthQuery({networkClientId:r}),{blockGasLimit:n,estimatedGas:s,simulationFails:a}=await ne.estimateGas.call(void 0,e,i);return{gas:ne.addGasBuffer.call(void 0,s,n,t),simulationFails:a}}updateTransaction(e,t){const{id:r}=e;we.__privateMethod.call(void 0,this,O,R).call(this,{transactionId:r,note:t,skipHistory:this.isHistoryDisabled},(()=>({...e})))}updateSecurityAlertResponse(e,t){if(!t)throw new Error("updateSecurityAlertResponse: securityAlertResponse should not be null");const r=this.getTransaction(e);if(!r)throw new Error("Cannot update security alert response as no transaction metadata found");const i={...r,securityAlertResponse:t};this.updateTransaction(i,`${Ue}:updatesecurityAlertResponse - securityAlertResponse updated`)}wipeTransactions(e,t){if(e&&!t)return void this.update((e=>{e.transactions=[]}));const r=this.getChainId(),i=this.state.transactions.filter((({chainId:i,txParams:n})=>{if(!(e||i===r))return!0;return!(!t||n.from?.toLowerCase()===t.toLowerCase())}));this.update((e=>{e.transactions=this.trimTransactionsForState(i)}))}async confirmExternalTransaction(e,t,r){const i=this.addExternalTransaction(e);try{const e=i.id,n={...i,status:"confirmed",txReceipt:t};r&&(n.baseFeePerGas=r),this.markNonceDuplicatesDropped(e),this.updateTransaction(n,`${Ue}:confirmExternalTransaction - Add external transaction`),this.onTransactionStatusChange(n),this.updatePostBalance(n),this.messagingSystem.publish(`${Ue}:transactionConfirmed`,n)}catch(e){console.error("Failed to confirm external transaction",e)}}updateTransactionSendFlowHistory(e,t,r){if(this.isSendFlowHistoryDisabled)throw new Error("Send flow history is disabled for the current transaction controller");const i=this.getTransaction(e);if(!i)throw new Error("Cannot update send flow history as no transaction metadata found");_e.validateIfTransactionUnapproved.call(void 0,i,"updateTransactionSendFlowHistory");const n=i.sendFlowHistory??[];if(t===n.length){const e={...i,sendFlowHistory:[...n,...r]};this.updateTransaction(e,`${Ue}:updateTransactionSendFlowHistory - sendFlowHistory updated`)}return this.getTransaction(e)}updateTransactionGasFees(e,{defaultGasEstimates:t,estimateUsed:r,estimateSuggested:i,gas:n,gasLimit:s,gasPrice:a,maxPriorityFeePerGas:o,maxFeePerGas:l,originalGasEstimate:c,userEditedGasLimit:u,userFeeLevel:d}){const h=this.getTransaction(e);if(!h)throw new Error("Cannot update transaction as no transaction metadata found");_e.validateIfTransactionUnapproved.call(void 0,h,"updateTransactionGasFees");let m={txParams:{gas:n,gasLimit:s,gasPrice:a,maxPriorityFeePerGas:o,maxFeePerGas:l},defaultGasEstimates:t,estimateUsed:r,estimateSuggested:i,originalGasEstimate:c,userEditedGasLimit:u,userFeeLevel:d};m.txParams=Be.pickBy.call(void 0,m.txParams),m=Be.pickBy.call(void 0,m);const p=Be.merge.call(void 0,{},h,m);return this.updateTransaction(p,`${Ue}:updateTransactionGasFees - gas values updated`),this.getTransaction(e)}updatePreviousGasParams(e,{gasLimit:t,maxFeePerGas:r,maxPriorityFeePerGas:i}){const n=this.getTransaction(e);if(!n)throw new Error("Cannot update transaction as no transaction metadata found");_e.validateIfTransactionUnapproved.call(void 0,n,"updatePreviousGasParams");const s={previousGas:{gasLimit:t,maxFeePerGas:r,maxPriorityFeePerGas:i}};s.previousGas=Be.pickBy.call(void 0,s.previousGas);const a=Be.merge.call(void 0,{},n,s);return this.updateTransaction(a,`${Ue}:updatePreviousGasParams - Previous gas values updated`),this.getTransaction(e)}async getNonceLock(e,t){return we.__privateGet.call(void 0,this,u).getNonceLock(e,t)}async updateEditableParams(e,{data:t,gas:r,gasPrice:i,from:n,to:s,value:a}){const o=this.getTransaction(e);if(!o)throw new Error("Cannot update editable params as no transaction metadata found");_e.validateIfTransactionUnapproved.call(void 0,o,"updateEditableParams");const l={txParams:{data:t,from:n,to:s,value:a,gas:r,gasPrice:i}};l.txParams=Be.pickBy.call(void 0,l.txParams);const c=Be.merge.call(void 0,{},o,l),d=we.__privateGet.call(void 0,this,u).getProvider({chainId:o.chainId,networkClientId:o.networkClientId}),h=new(0,Ce.default)(d),{type:m}=await ee.determineTransactionType.call(void 0,c.txParams,h);return c.type=m,await ue.updateTransactionLayer1GasFee.call(void 0,{layer1GasFeeFlows:this.layer1GasFeeFlows,provider:d,transactionMeta:c}),this.updateTransaction(c,`Update Editable Params for ${e}`),this.getTransaction(e)}async approveTransactionsWithSameNonce(e=[],{hasNonce:t}={}){if(ye.projectLogger.call(void 0,"Approving transactions with same nonce",{transactions:e}),0===e.length)return"";const r=e[0],i=this.getCommonConfiguration(r.chainId);let n;try{n=this.messagingSystem.call("NetworkController:findNetworkClientIdByChainId",r.chainId)}catch(e){ye.projectLogger.call(void 0,"failed to find networkClientId from chainId",e)}const s=be.TransactionFactory.fromTxData(r,{common:i}),a=Ee.bufferToHex.call(void 0,s.serialize());if(this.approvingTransactionIds.has(a))return"";let o,l;this.approvingTransactionIds.add(a);try{const i=r.from;l=!0!==t?await this.getNonceLock(i,n):void 0;const s=l?Me.add0x.call(void 0,l.nextNonce.toString(16)):r.nonce;l&&ye.projectLogger.call(void 0,"Using nonce from nonce tracker",s,l.nonceDetails),o=await Promise.all(e.map((e=>(e.nonce=s,this.signExternalTransaction(e.chainId,e)))))}catch(e){throw ye.projectLogger.call(void 0,"Error while signing transactions with same nonce",e),e}finally{l?.releaseLock(),this.approvingTransactionIds.delete(a)}return o}updateCustodialTransaction(e,{errorMessage:t,hash:r,status:i}){const s=this.getTransaction(e);if(!s)throw new Error("Cannot update custodial transaction as no transaction metadata found");if(!s.custodyId)throw new Error("Transaction must be a custodian transaction");if(i&&!["submitted","signed","failed"].includes(i))throw new Error(`Cannot update custodial transaction with status: ${i}`);const a=Be.merge.call(void 0,{},s,Be.pickBy.call(void 0,{hash:r,status:i}));"submitted"===a.status&&(a.submittedTime=(new Date).getTime()),"failed"===a.status&&(a.error=_e.normalizeTxError.call(void 0,new Error(t))),this.updateTransaction(a,`${Ue}:updateCustodialTransaction - Custodial transaction updated`),["submitted","failed"].includes(i)&&(this.messagingSystem.publish(`${Ue}:transactionFinished`,a),we.__privateGet.call(void 0,this,n).emit(`${a.id}:finished`,a))}initApprovals(){const e=this.getChainId(),t=this.state.transactions.filter((t=>"unapproved"===t.status&&t.chainId===e&&!t.isUserOperation));for(const e of t)this.processApproval(e,{shouldShowRequest:!1}).catch((e=>{e?.code!==xe.errorCodes.provider.userRejectedRequest&&console.error("Error during persisted transaction approval",e)}))}getTransactions({searchCriteria:e={},initialList:t,filterToCurrentNetwork:r=!0,limit:i}={}){const n=this.getChainId(),s=Be.mapValues.call(void 0,e,(e=>"function"==typeof e?e:t=>t===e)),a=t??this.state.transactions,o=Be.sortBy.call(void 0,Be.pickBy.call(void 0,a,(e=>{if(r&&e.chainId!==n)return!1;for(const[t,r]of Object.entries(s))if(t in e.txParams){if(!1===r(e.txParams[t]))return!1}else if(!1===r(e[t]))return!1;return!0})),"time");if(void 0!==i){const e=new Set,t=[];for(let r=o.length-1;r>-1;r--){const n=o[r],{nonce:s}=n.txParams;if(!e.has(s)){if(!(e.size<i))continue;e.add(s)}t.unshift(n)}return t}return o}async estimateGasFee({transactionParams:e,chainId:t,networkClientId:r}){const i=we.__privateMethod.call(void 0,this,$,K).call(this,{networkClientId:r,chainId:t}),n={txParams:e,chainId:t,networkClientId:i},s=ke.getGasFeeFlow.call(void 0,n,this.gasFeeFlows),a=we.__privateGet.call(void 0,this,u).getEthQuery({networkClientId:i,chainId:t}),o=await this.getGasFeeEstimates({networkClientId:i});return s.getGasFees({ethQuery:a,gasFeeControllerData:o,transactionMeta:n})}async getLayer1GasFee({transactionParams:e,chainId:t,networkClientId:r}){const i=we.__privateGet.call(void 0,this,u).getProvider({networkClientId:r,chainId:t});return await ue.getTransactionLayer1GasFee.call(void 0,{layer1GasFeeFlows:this.layer1GasFeeFlows,provider:i,transactionMeta:{txParams:e,chainId:t}})}async signExternalTransaction(e,t){if(!this.sign)throw new Error("No sign method defined.");const r=_e.normalizeTransactionParams.call(void 0,t),i=_e.isEIP1559Transaction.call(void 0,r)?"0x2":"0x0",n={...r,type:i,gasLimit:r.gas,chainId:e},{from:s}=n,a=this.getCommonConfiguration(e),o=be.TransactionFactory.fromTxData(n,{common:a}),l=await this.sign(o,s);return Ee.bufferToHex.call(void 0,l.serialize())}clearUnapprovedTransactions(){const e=this.state.transactions.filter((({status:e})=>"unapproved"!==e));this.update((t=>{t.transactions=this.trimTransactionsForState(e)}))}abortTransactionSigning(e){if(!this.getTransaction(e))throw new Error("Cannot abort signing as no transaction metadata found");const t=this.signAbortCallbacks.get(e);if(!t)throw new Error("Cannot abort signing as transaction is not waiting for signing");t(),this.signAbortCallbacks.delete(e)}addMetadata(e){this.update((t=>{t.transactions=this.trimTransactionsForState([...t.transactions,e])}))}async updateGasProperties(e){const t=await this.getEIP1559Compatibility(e.networkClientId)&&"0x0"!==e.txParams.type,{networkClientId:r,chainId:i}=e,n=we.__privateMethod.call(void 0,this,J,z).call(this,r),s=we.__privateGet.call(void 0,this,u).getEthQuery({networkClientId:r,chainId:i}),a=we.__privateGet.call(void 0,this,u).getProvider({networkClientId:r,chainId:i});await ne.updateGas.call(void 0,{ethQuery:s,chainId:i,isCustomNetwork:n,txMeta:e}),await ve.updateGasFees.call(void 0,{eip1559:t,ethQuery:s,gasFeeFlows:this.gasFeeFlows,getGasFeeEstimates:this.getGasFeeEstimates,getSavedGasFees:this.getSavedGasFees.bind(this),txMeta:e}),await ue.updateTransactionLayer1GasFee.call(void 0,{layer1GasFeeFlows:this.layer1GasFeeFlows,provider:a,transactionMeta:e})}onBootCleanup(){this.submitApprovedTransactions()}submitApprovedTransactions(){const e=this.state.transactions.filter((e=>"approved"===e.status));for(const t of e)this.beforeApproveOnInit(t)&&this.approveTransaction(t.id).catch((e=>{console.error("Error while submitting persisted transaction",e)}))}async processApproval(e,{isExisting:t=!1,requireApproval:r,shouldShowRequest:i=!0,actionId:n}){const s=e.id;let a;const{meta:o,isCompleted:l}=this.isTransactionCompleted(s),c=l?Promise.resolve(o):this.waitForTransactionFinished(s);if(o&&!t&&!l)try{if(!1!==r){const t=await this.requestApproval(e,{shouldShowRequest:i});a=t.resultCallbacks;const r=t.value,n=r?.txMeta;n&&(ye.projectLogger.call(void 0,"Updating transaction with approval data",{customNonce:n.customNonceValue,params:n.txParams}),this.updateTransaction(n,"TransactionController#processApproval - Updated with approval data"))}const{isCompleted:t}=this.isTransactionCompleted(s);if(!t){"skipped-via-before-publish-hook"===await this.approveTransaction(s)&&a&&a.success();const e=this.getTransaction(s);this.messagingSystem.publish(`${Ue}:transactionApproved`,{transactionMeta:e,actionId:n})}}catch(e){const{isCompleted:t}=this.isTransactionCompleted(s);if(!t){if(e?.code===xe.errorCodes.provider.userRejectedRequest)throw this.cancelTransaction(s,n),xe.providerErrors.userRejectedRequest("MetaMask Tx Signature: User denied transaction signature.");this.failTransaction(o,e,n)}}const u=await c;switch(u?.status){case"failed":throw a?.error(u.error),xe.rpcErrors.internal(u.error.message);case"submitted":return a?.success(),u.hash;default:const e=xe.rpcErrors.internal(`MetaMask Tx Signature: Unknown problem: ${JSON.stringify(u||s)}`);throw a?.error(e),e}}async approveTransaction(e){const t=new Array;t.push(await this.mutex.acquire());let r=this.getTransactionOrThrow(e);try{if(!this.sign)return this.failTransaction(r,new Error("No sign method defined.")),"not-approved";if(!r.chainId)return this.failTransaction(r,new Error("No chainId defined.")),"not-approved";if(this.approvingTransactionIds.has(e))return ye.projectLogger.call(void 0,"Skipping approval as signing in progress",e),"not-approved";this.approvingTransactionIds.add(e),t.push((()=>this.approvingTransactionIds.delete(e)));const[i,s]=await Q.getNextNonce.call(void 0,r,(e=>we.__privateGet.call(void 0,this,u).getNonceLock(e,r.networkClientId)));s&&t.push(s),r=we.__privateMethod.call(void 0,this,O,R).call(this,{transactionId:e,note:"TransactionController#approveTransaction - Transaction approved"},(e=>{const{txParams:t,chainId:r}=e;e.status="approved",e.txParams={...t,nonce:i,chainId:r,gasLimit:t.gas,..._e.isEIP1559Transaction.call(void 0,t)&&{type:"0x2"}}})),this.onTransactionStatusChange(r);const a=await this.signTransaction(r,r.txParams);if(!this.beforePublish(r))return ye.projectLogger.call(void 0,"Skipping publishing transaction based on hook"),this.messagingSystem.publish(`${Ue}:transactionPublishingSkipped`,r),"skipped-via-before-publish-hook";if(!a)return"not-approved";const o=we.__privateGet.call(void 0,this,u).getEthQuery({networkClientId:r.networkClientId,chainId:r.chainId});let l;const c="swap"===r.type;c&&(ye.projectLogger.call(void 0,"Determining pre-transaction balance"),l=await Pe.query.call(void 0,o,"getBalance",[r.txParams.from])),ye.projectLogger.call(void 0,"Publishing transaction",r.txParams);let{transactionHash:d}=await this.publish(r,a);return void 0===d&&(d=await this.publishTransaction(o,a)),ye.projectLogger.call(void 0,"Publish successful",d),r=we.__privateMethod.call(void 0,this,O,R).call(this,{transactionId:e,note:"TransactionController#approveTransaction - Transaction submitted"},(e=>{e.hash=d,e.status="submitted",e.submittedTime=(new Date).getTime(),c&&(e.preTxBalance=l,ye.projectLogger.call(void 0,"Updated pre-transaction balance",l))})),this.messagingSystem.publish(`${Ue}:transactionSubmitted`,{transactionMeta:r}),this.messagingSystem.publish(`${Ue}:transactionFinished`,r),we.__privateGet.call(void 0,this,n).emit(`${e}:finished`,r),this.onTransactionStatusChange(r),"approved"}catch(e){return this.failTransaction(r,e),"not-approved"}finally{t.forEach((e=>e()))}}async publishTransaction(e,t){return await Pe.query.call(void 0,e,"sendRawTransaction",[t])}cancelTransaction(e,t){const r=this.state.transactions.find((({id:t})=>t===e));if(!r)return;this.update((t=>{const r=t.transactions.filter((({id:t})=>t!==e));t.transactions=this.trimTransactionsForState(r)}));const i={...r,status:"rejected"};this.messagingSystem.publish(`${Ue}:transactionFinished`,i),we.__privateGet.call(void 0,this,n).emit(`${r.id}:finished`,i),this.messagingSystem.publish(`${Ue}:transactionRejected`,{transactionMeta:i,actionId:t}),this.onTransactionStatusChange(i)}trimTransactionsForState(e){const t=new Set,r=[...e].sort(((e,t)=>e.time>t.time?-1:1)).filter((e=>{const{chainId:r,status:i,txParams:n,time:s}=e;if(n){const e=`${String(n.nonce)}-${Pe.convertHexToDecimal.call(void 0,r)}-${new Date(s).toDateString()}`;if(t.has(e))return!0;if(t.size<we.__privateGet.call(void 0,this,o)||!this.isFinalState(i))return t.add(e),!0}return!1}));return r.reverse(),r}isFinalState(e){return"rejected"===e||"confirmed"===e||"failed"===e}isLocalFinalState(e){return["confirmed","failed","rejected","submitted"].includes(e)}async requestApproval(e,{shouldShowRequest:t}){const r=this.getApprovalId(e),{origin:i}=e,n=Pe.ApprovalType.Transaction,s={txId:e.id};return await this.messagingSystem.call("ApprovalController:addRequest",{id:r,origin:i||Pe.ORIGIN_METAMASK,type:n,requestData:s,expectsResult:!0},t)}getTransaction(e){const{transactions:t}=this.state;return t.find((({id:t})=>t===e))}getTransactionOrThrow(e,t="TransactionController"){const r=this.getTransaction(e);if(!r)throw new Error(`${t}: No transaction found with id ${e}`);return r}getApprovalId(e){return String(e.id)}isTransactionCompleted(e){const t=this.getTransaction(e);if(!t)return{meta:void 0,isCompleted:!1};return{meta:t,isCompleted:this.isLocalFinalState(t.status)}}getChainId(e){const t=we.__privateMethod.call(void 0,this,Y,X).call(this),r=we.__privateMethod.call(void 0,this,V,q).call(this);return e&&e!==r?this.messagingSystem.call("NetworkController:getNetworkClientById",e).configuration.chainId:t}prepareUnsignedEthTx(e,t){return be.TransactionFactory.fromTxData(t,{freeze:!1,common:this.getCommonConfiguration(e)})}getCommonConfiguration(e){const t={chainId:parseInt(e,16),defaultHardfork:Fe};return Te.Common.custom(t)}onIncomingTransactions({added:e,updated:t}){this.update((r=>{const{transactions:i}=r,n=[...e,...i.map((e=>t.find((({hash:t})=>t===e.hash))??e))];r.transactions=this.trimTransactionsForState(n)}))}onUpdatedLastFetchedBlockNumbers({lastFetchedBlockNumbers:e,blockNumber:t}){this.update((t=>{t.lastFetchedBlockNumbers=e})),this.messagingSystem.publish(`${Ue}:incomingTransactionBlockReceived`,t)}generateDappSuggestedGasFees(e,t){if(!t||t===Pe.ORIGIN_METAMASK)return;const{gasPrice:r,maxFeePerGas:i,maxPriorityFeePerGas:n,gas:s}=e;if(void 0===r&&void 0===i&&void 0===n&&void 0===s)return;const a={};return void 0!==r?a.gasPrice=r:void 0===i&&void 0===n||(a.maxFeePerGas=i,a.maxPriorityFeePerGas=n),void 0!==s&&(a.gas=s),a}addExternalTransaction(e){const{chainId:t}=e,{transactions:r}=this.state,i=e?.txParams?.from,n=r.filter((e=>e.txParams.from===i&&e.chainId===t)),s=n.filter((e=>"confirmed"===e.status)),a=n.filter((e=>"submitted"===e.status));ie.validateConfirmedExternalTransaction.call(void 0,e,s,a);const o=0!==(e.history??[]).length||this.isHistoryDisabled?e:se.addInitialHistorySnapshot.call(void 0,e);return this.update((e=>{e.transactions=this.trimTransactionsForState([...e.transactions,o])})),o}markNonceDuplicatesDropped(e){const t=this.getTransaction(e);if(!t)return;const r=t.txParams?.nonce,i=t.txParams?.from,{chainId:n}=t,s=this.state.transactions.filter((t=>t.id!==e&&t.txParams.from===i&&t.txParams.nonce===r&&t.chainId===n&&"incoming"!==t.type)),a=s.map((e=>e.id));if(0!==s.length){this.update((e=>{for(const r of e.transactions)a.includes(r.id)&&(r.replacedBy=t?.hash,r.replacedById=t?.id)}));for(const e of this.state.transactions)a.includes(e.id)&&"failed"!==e.status&&this.setTransactionStatusDropped(e)}}setTransactionStatusDropped(e){const t={...e,status:"dropped"};this.messagingSystem.publish(`${Ue}:transactionDropped`,{transactionMeta:t}),this.updateTransaction(t,"TransactionController#setTransactionStatusDropped - Transaction dropped"),this.onTransactionStatusChange(t)}getTransactionWithActionId(e){return this.state.transactions.find((t=>e&&t.actionId===e))}async waitForTransactionFinished(e){return new Promise((t=>{we.__privateGet.call(void 0,this,n).once(`${e}:finished`,(e=>{t(e)}))}))}updateTransactionMetaRSV(e,t){const r=Be.cloneDeep.call(void 0,e);for(const e of["r","s","v"]){const i=t[e];null!=i&&(r[e]=Me.add0x.call(void 0,i.toString(16)))}return r}async getEIP1559Compatibility(e){const t=await this.getCurrentNetworkEIP1559Compatibility(e),r=await this.getCurrentAccountEIP1559Compatibility();return t&&r}async signTransaction(e,t){ye.projectLogger.call(void 0,"Signing transaction",t);const r=this.prepareUnsignedEthTx(e.chainId,t);this.approvingTransactionIds.add(e.id);const i=await new Promise(((i,n)=>{this.sign?.(r,t.from,...this.getAdditionalSignArguments(e)).then(i,n),this.signAbortCallbacks.set(e.id,(()=>n(new Error("Signing aborted by user"))))}));if(this.signAbortCallbacks.delete(e.id),!i)return void ye.projectLogger.call(void 0,"Skipping signed status as no signed transaction");const n=Be.cloneDeep.call(void 0,e);if(!this.afterSign(n,i))return this.updateTransaction(n,"TransactionController#signTransaction - Update after sign"),void ye.projectLogger.call(void 0,"Skipping signed status based on hook");const s={...this.updateTransactionMetaRSV(n,i),status:"signed"};this.updateTransaction(s,"TransactionController#approveTransaction - Transaction signed"),this.onTransactionStatusChange(s);const a=Ee.bufferToHex.call(void 0,i.serialize()),o=Be.merge.call(void 0,{},s,{rawTx:a});return this.updateTransaction(o,"TransactionController#approveTransaction - RawTransaction added"),a}onTransactionStatusChange(e){this.messagingSystem.publish(`${Ue}:transactionStatusUpdated`,{transactionMeta:e})}getNonceTrackerTransactions(e,t,r=this.getChainId()){return Q.getAndFormatTransactionsForNonceTracker.call(void 0,r,t,e,this.state.transactions)}onConfirmedTransaction(e){ye.projectLogger.call(void 0,"Processing confirmed transaction",e.id),this.markNonceDuplicatesDropped(e.id),this.messagingSystem.publish(`${Ue}:transactionConfirmed`,e),this.onTransactionStatusChange(e),this.updatePostBalance(e)}async updatePostBalance(e){try{if("swap"!==e.type)return;const t=we.__privateGet.call(void 0,this,u).getEthQuery({networkClientId:e.networkClientId,chainId:e.chainId}),{updatedTransactionMeta:r,approvalTransactionMeta:i}=await ge.updatePostTransactionBalance.call(void 0,e,{ethQuery:t,getTransaction:this.getTransaction.bind(this),updateTransaction:this.updateTransaction.bind(this)});this.messagingSystem.publish(`${Ue}:postTransactionBalanceUpdated`,{transactionMeta:r,approvalTransactionMeta:i})}catch(e){ye.projectLogger.call(void 0,"Error while updating post transaction balance",e)}}async publishTransactionForRetry(e,t,r){try{return await this.publishTransaction(e,t)}catch(e){if(this.isTransactionAlreadyConfirmedError(e))throw await this.pendingTransactionTracker.forceCheckTransaction(r),new Error("Previous transaction is already confirmed");throw e}}isTransactionAlreadyConfirmedError(e){return e?.message?.includes("nonce too low")||e?.data?.message?.includes("nonce too low")}};n=new WeakMap,s=new WeakMap,a=new WeakMap,o=new WeakMap,l=new WeakMap,c=new WeakMap,u=new WeakMap,d=new WeakSet,h=function({provider:e,blockTracker:t,chainId:r}){return new(0,je.NonceTracker)({provider:e,blockTracker:t,getPendingTransactions:we.__privateMethod.call(void 0,this,C,I).bind(this,r),getConfirmedTransactions:this.getNonceTrackerTransactions.bind(this,"confirmed")})},m=new WeakSet,p=function({blockTracker:e,etherscanRemoteTransactionSource:t,chainId:r}){const i=new(0,de.IncomingTransactionHelper)({blockTracker:e,getCurrentAccount:this.getSelectedAddress,getLastFetchedBlockNumbers:()=>this.state.lastFetchedBlockNumbers,getChainId:r?()=>r:this.getChainId.bind(this),isEnabled:we.__privateGet.call(void 0,this,s).isEnabled,queryEntireHistory:we.__privateGet.call(void 0,this,s).queryEntireHistory,remoteTransactionSource:t,transactionLimit:we.__privateGet.call(void 0,this,o),updateTransactions:we.__privateGet.call(void 0,this,s).updateTransactions});return we.__privateMethod.call(void 0,this,T,b).call(this,i),i},f=new WeakSet,v=function({provider:e,blockTracker:t,chainId:r}){const i=new(0,Ce.default)(e),n=r?()=>r:this.getChainId.bind(this),s=new(0,re.PendingTransactionTracker)({approveTransaction:async e=>{await this.approveTransaction(e)},blockTracker:t,getChainId:n,getEthQuery:()=>i,getTransactions:()=>this.state.transactions,isResubmitEnabled:we.__privateGet.call(void 0,this,a).isResubmitEnabled,getGlobalLock:()=>we.__privateGet.call(void 0,this,u).acquireNonceLockForChainIdKey({chainId:n()}),publishTransaction:this.publishTransaction.bind(this),hooks:{beforeCheckPendingTransaction:this.beforeCheckPendingTransaction.bind(this),beforePublish:this.beforePublish.bind(this)}});return we.__privateMethod.call(void 0,this,P,A).call(this,s),s},g=new WeakMap,_=new WeakSet,k=function(){this.pendingTransactionTracker.stop(),we.__privateMethod.call(void 0,this,E,S).call(this,this.pendingTransactionTracker),this.incomingTransactionHelper.stop(),we.__privateMethod.call(void 0,this,y,w).call(this,this.incomingTransactionHelper),we.__privateGet.call(void 0,this,u).stopAllTracking()},y=new WeakSet,w=function(e){e.hub.removeAllListeners("transactions"),e.hub.removeAllListeners("updatedLastFetchedBlockNumbers")},T=new WeakSet,b=function(e){e.hub.on("transactions",this.onIncomingTransactions.bind(this)),e.hub.on("updatedLastFetchedBlockNumbers",this.onUpdatedLastFetchedBlockNumbers.bind(this))},E=new WeakSet,S=function(e){e.hub.removeAllListeners("transaction-confirmed"),e.hub.removeAllListeners("transaction-dropped"),e.hub.removeAllListeners("transaction-failed"),e.hub.removeAllListeners("transaction-updated")},P=new WeakSet,A=function(e){e.hub.on("transaction-confirmed",this.onConfirmedTransaction.bind(this)),e.hub.on("transaction-dropped",this.setTransactionStatusDropped.bind(this)),e.hub.on("transaction-failed",this.failTransaction.bind(this)),e.hub.on("transaction-updated",this.updateTransaction.bind(this))},C=new WeakSet,I=function(e,t){return[...this.getNonceTrackerTransactions("submitted",t,e),...this.getExternalPendingTransactions(t,e)]},j=new WeakSet,x=function(){return we.__privateGet.call(void 0,this,c)?[new(0,le.TestGasFeeFlow)]:[new(0,pe.LineaGasFeeFlow),new(0,fe.DefaultGasFeeFlow)]},M=new WeakSet,N=function(){return[new(0,ae.OptimismLayer1GasFeeFlow),new(0,oe.ScrollLayer1GasFeeFlow)]},O=new WeakSet,R=function({transactionId:e,note:t,skipHistory:r},i){let n=[];this.update((s=>{const a=s.transactions.findIndex((({id:t})=>t===e));let o=s.transactions[a];o=i(o)??o,o.txParams=_e.normalizeTransactionParams.call(void 0,o.txParams),te.validateTxParams.call(void 0,o.txParams),n=we.__privateMethod.call(void 0,this,B,L).call(this,o),!0!==r&&(o=se.updateTransactionHistory.call(void 0,o,t??"Transaction updated")),s.transactions[a]=o}));const s=this.getTransaction(e);return n.length>0&&we.__privateMethod.call(void 0,this,G,F).call(this,s,n),s},B=new WeakSet,L=function(e){const{id:t,txParams:r}=e,i=this.getTransaction(t)?.txParams;if(!i||Be.isEqual.call(void 0,i,r))return[];const n=Object.keys(r).filter((e=>r[e]!==i[e]));return ye.projectLogger.call(void 0,"Transaction parameters have been updated",t,n,i,r),n},G=new WeakSet,F=function(e,t){["to","value","data"].some((e=>t.includes(e)))&&(ye.projectLogger.call(void 0,"Updating simulation data due to transaction parameter update"),we.__privateMethod.call(void 0,this,D,H).call(this,e))},D=new WeakSet,H=async function(e){const{id:t,chainId:r,txParams:i}=e,{from:n,to:s,value:a,data:o}=i;let c={error:{code:"disabled",message:"Simulation disabled"},tokenBalanceChanges:[]};we.__privateGet.call(void 0,this,l).call(this)&&(we.__privateMethod.call(void 0,this,O,R).call(this,{transactionId:t,skipHistory:!0},(e=>{e.simulationData=void 0})),c=await Z.getSimulationData.call(void 0,{chainId:r,from:n,to:s,value:a,data:o}));this.getTransaction(t)?(we.__privateMethod.call(void 0,this,O,R).call(this,{transactionId:t,note:"TransactionController#updateSimulationData - Update simulation data"},(e=>{e.simulationData=c})),ye.projectLogger.call(void 0,"Updated simulation data",t,c)):ye.projectLogger.call(void 0,"Cannot update simulation data as transaction not found",t,c)},U=new WeakSet,W=function({transactionId:e,gasFeeEstimates:t,gasFeeEstimatesLoaded:r,layer1GasFee:i}){we.__privateMethod.call(void 0,this,O,R).call(this,{transactionId:e,skipHistory:!0},(e=>{t&&(e.gasFeeEstimates=t),void 0!==r&&(e.gasFeeEstimatesLoaded=r),i&&(e.layer1GasFee=i)}))},$=new WeakSet,K=function({networkClientId:e,chainId:t}){const r=we.__privateMethod.call(void 0,this,Y,X).call(this),i=we.__privateMethod.call(void 0,this,V,q).call(this);return e||(t&&t!==r?this.messagingSystem.call("NetworkController:findNetworkClientIdByChainId",t):i)},V=new WeakSet,q=function(){return this.getNetworkState().selectedNetworkClientId},Y=new WeakSet,X=function(){return this.getNetworkState().providerConfig.chainId},J=new WeakSet,z=function(e){const t=we.__privateMethod.call(void 0,this,V,q).call(this);return e&&e!==t?this.messagingSystem.call("NetworkController:getNetworkClientById",e).configuration.type===Ie.NetworkClientType.Custom:this.getNetworkState().providerConfig.type===Pe.NetworkType.rpc},r.HARDFORK=Fe,r.CANCEL_RATE=De,r.SPEED_UP_RATE=He,r.ApprovalState=We,r.TransactionController=$e}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/dist/chunk-PBYK4OMK.js"}],[1895,{"./chunk-S6VGOPUY.js":1900,"@metamask/controller-utils":1948},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i=e("./chunk-S6VGOPUY.js"),n=e("@metamask/controller-utils"),s=i.createModuleLogger.call(void 0,i.projectLogger,"nonce");r.getNextNonce=async function(e,t){const{customNonceValue:r,txParams:{from:i,nonce:a}}=e,o=r?n.toHex.call(void 0,r):void 0;if(o)return s("Using custom nonce",o),[o,void 0];if(a)return s("Using existing nonce",a),[a,void 0];const l=await t(i),c=n.toHex.call(void 0,l.nextNonce),u=l.releaseLock.bind(l);return s("Using nonce from nonce tracker",c,l.nonceDetails),[c,u]},r.getAndFormatTransactionsForNonceTracker=function(e,t,r,i){return i.filter((({chainId:i,isTransfer:n,isUserOperation:s,status:a,txParams:{from:o}})=>!n&&!s&&i===e&&a===r&&o.toLowerCase()===t.toLowerCase())).map((({status:e,txParams:{from:t,gas:r,value:i,nonce:n}})=>({status:e,history:[{}],txParams:{from:t??"",gas:r??"",value:i??"",nonce:n??""}})))}}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/dist/chunk-PRUNMTRD.js"}],[1896,{"./chunk-EQT25RSP.js":1888,"./chunk-S6VGOPUY.js":1900,"./chunk-Z4BLTVTB.js":1911,"@metamask/eth-query":1316,"async-mutex":1952},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i,n,s,a,o,l,c,u,d,h,m,p,f,v,g,_,k,y,w,T,b,E,S,P,A=e("./chunk-EQT25RSP.js"),C=e("./chunk-S6VGOPUY.js"),I=e("./chunk-Z4BLTVTB.js"),j=e("@metamask/eth-query"),x=(i=j)&&i.__esModule?i:{default:i},M=e("async-mutex");n=new WeakMap,s=new WeakMap,a=new WeakMap,o=new WeakMap,l=new WeakMap,c=new WeakMap,u=new WeakMap,d=new WeakMap,h=new WeakMap,m=new WeakMap,p=new WeakMap,f=new WeakMap,v=new WeakMap,g=new WeakMap,_=new WeakMap,k=new WeakMap,y=new WeakSet,w=function(e){const t=I.__privateGet.call(void 0,this,g).get(e);t&&(t.pendingTransactionTracker.stop(),I.__privateGet.call(void 0,this,h).call(this,t.pendingTransactionTracker),t.incomingTransactionHelper.stop(),I.__privateGet.call(void 0,this,d).call(this,t.incomingTransactionHelper),I.__privateGet.call(void 0,this,g).delete(e))},T=new WeakSet,b=function(e){if(I.__privateGet.call(void 0,this,g).get(e))return;const{provider:t,blockTracker:r,configuration:{chainId:i}}=I.__privateGet.call(void 0,this,c).call(this,e);let n=I.__privateGet.call(void 0,this,_).get(i);n||(n=new(0,A.EtherscanRemoteTransactionSource)({includeTokenTransfers:I.__privateGet.call(void 0,this,o).includeTokenTransfers}),I.__privateGet.call(void 0,this,_).set(i,n));const s=I.__privateGet.call(void 0,this,m).call(this,{provider:t,blockTracker:r,chainId:i}),a=I.__privateGet.call(void 0,this,p).call(this,{blockTracker:r,etherscanRemoteTransactionSource:n,chainId:i}),l=I.__privateGet.call(void 0,this,f).call(this,{provider:t,blockTracker:r,chainId:i});I.__privateGet.call(void 0,this,g).set(e,{nonceTracker:s,incomingTransactionHelper:a,pendingTransactionTracker:l})},E=new WeakMap,S=new WeakSet,P=function({networkClientId:e,chainId:t}={}){let r;if(e)try{r=I.__privateGet.call(void 0,this,c).call(this,e)}catch(e){C.incomingTransactionsLogger.call(void 0,"failed to get network client by networkClientId")}if(!r&&t)try{const e=I.__privateGet.call(void 0,this,l).call(this,t);r=I.__privateGet.call(void 0,this,c).call(this,e)}catch(e){C.incomingTransactionsLogger.call(void 0,"failed to get network client by chainId")}return r},r.MultichainTrackingHelper=class{constructor({isMultichainEnabled:e,provider:t,nonceTracker:r,incomingTransactionOptions:i,findNetworkClientIdByChainId:P,getNetworkClientById:A,getNetworkClientRegistry:C,removeIncomingTransactionHelperListeners:j,removePendingTransactionTrackerListeners:x,createNonceTracker:M,createIncomingTransactionHelper:N,createPendingTransactionTracker:O,onNetworkStateChange:R}){I.__privateAdd.call(void 0,this,y),I.__privateAdd.call(void 0,this,T),I.__privateAdd.call(void 0,this,S),I.__privateAdd.call(void 0,this,n,void 0),I.__privateAdd.call(void 0,this,s,void 0),I.__privateAdd.call(void 0,this,a,void 0),I.__privateAdd.call(void 0,this,o,void 0),I.__privateAdd.call(void 0,this,l,void 0),I.__privateAdd.call(void 0,this,c,void 0),I.__privateAdd.call(void 0,this,u,void 0),I.__privateAdd.call(void 0,this,d,void 0),I.__privateAdd.call(void 0,this,h,void 0),I.__privateAdd.call(void 0,this,m,void 0),I.__privateAdd.call(void 0,this,p,void 0),I.__privateAdd.call(void 0,this,f,void 0),I.__privateAdd.call(void 0,this,v,new Map),I.__privateAdd.call(void 0,this,g,new Map),I.__privateAdd.call(void 0,this,_,new Map),this.checkForPendingTransactionAndStartPolling=()=>{for(const[,e]of I.__privateGet.call(void 0,this,g))e.pendingTransactionTracker.startIfPendingTransactions()},I.__privateAdd.call(void 0,this,k,(e=>{I.__privateGet.call(void 0,this,E).call(this,e);const t=Object.keys(e),r=Array.from(I.__privateGet.call(void 0,this,g).keys());r.filter((e=>!t.includes(e))).forEach((e=>{I.__privateMethod.call(void 0,this,y,w).call(this,e)}));t.filter((e=>!r.includes(e))).forEach((e=>{I.__privateMethod.call(void 0,this,T,b).call(this,e)}))})),I.__privateAdd.call(void 0,this,E,(e=>{const t=new Set;Object.values(e).forEach((e=>t.add(e.configuration.chainId)));Array.from(I.__privateGet.call(void 0,this,_).keys()).filter((e=>!t.has(e))).forEach((e=>{I.__privateGet.call(void 0,this,_).delete(e)}))})),I.__privateSet.call(void 0,this,n,e),I.__privateSet.call(void 0,this,s,t),I.__privateSet.call(void 0,this,a,r),I.__privateSet.call(void 0,this,o,i),I.__privateSet.call(void 0,this,l,P),I.__privateSet.call(void 0,this,c,A),I.__privateSet.call(void 0,this,u,C),I.__privateSet.call(void 0,this,d,j),I.__privateSet.call(void 0,this,h,x),I.__privateSet.call(void 0,this,m,M),I.__privateSet.call(void 0,this,p,N),I.__privateSet.call(void 0,this,f,O),R(((e,t)=>{if(I.__privateGet.call(void 0,this,n)){const e=I.__privateGet.call(void 0,this,u).call(this);t.forEach((({op:t,path:r})=>{if("remove"===t&&"networkConfigurations"===r[0]){const t=r[1];delete e[t]}})),I.__privateGet.call(void 0,this,k).call(this,e)}}))}initialize(){if(!I.__privateGet.call(void 0,this,n))return;const e=I.__privateGet.call(void 0,this,u).call(this);I.__privateGet.call(void 0,this,k).call(this,e)}has(e){return I.__privateGet.call(void 0,this,g).has(e)}getEthQuery({networkClientId:e,chainId:t}={}){return new(0,x.default)(this.getProvider({networkClientId:e,chainId:t}))}getProvider({networkClientId:e,chainId:t}={}){if(!I.__privateGet.call(void 0,this,n))return I.__privateGet.call(void 0,this,s);const r=I.__privateMethod.call(void 0,this,S,P).call(this,{networkClientId:e,chainId:t});return r?.provider||I.__privateGet.call(void 0,this,s)}async acquireNonceLockForChainIdKey({chainId:e,key:t="global"}){let r=I.__privateGet.call(void 0,this,v).get(e);r||(r=new Map,I.__privateGet.call(void 0,this,v).set(e,r));let i=r.get(t);return i||(i=new(0,M.Mutex),r.set(t,i)),await i.acquire()}async getNonceLock(e,t){let r,i=I.__privateGet.call(void 0,this,a);if(t&&I.__privateGet.call(void 0,this,n)){const n=I.__privateGet.call(void 0,this,c).call(this,t);r=await this.acquireNonceLockForChainIdKey({chainId:n.configuration.chainId,key:e});const s=I.__privateGet.call(void 0,this,g).get(t);if(!s)throw new Error("missing nonceTracker for networkClientId");i=s.nonceTracker}try{const t=await i.getNonceLock(e);return{...t,releaseLock:()=>{t.releaseLock(),r?.()}}}catch(e){throw r?.(),e}}startIncomingTransactionPolling(e=[]){e.forEach((e=>{I.__privateGet.call(void 0,this,g).get(e)?.incomingTransactionHelper.start()}))}stopIncomingTransactionPolling(e=[]){e.forEach((e=>{I.__privateGet.call(void 0,this,g).get(e)?.incomingTransactionHelper.stop()}))}stopAllIncomingTransactionPolling(){for(const[,e]of I.__privateGet.call(void 0,this,g))e.incomingTransactionHelper.stop()}async updateIncomingTransactions(e=[]){(await Promise.allSettled(e.map((async e=>await(I.__privateGet.call(void 0,this,g).get(e)?.incomingTransactionHelper.update()))))).filter((e=>"rejected"===e.status)).forEach((e=>{C.incomingTransactionsLogger.call(void 0,"failed to update incoming transactions",e.reason)}))}stopAllTracking(){for(const[e]of I.__privateGet.call(void 0,this,g))I.__privateMethod.call(void 0,this,y,w).call(this,e)}}}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/dist/chunk-PUESYN62.js"}],[1897,{"./chunk-RAOYRJ25.js":1899,"./chunk-S6VGOPUY.js":1900,"./chunk-YXSCBWTU.js":1910,"./chunk-Z4BLTVTB.js":1911,"@metamask/controller-utils":1948,"@metamask/utils":2300},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i,n,s,a,o,l,c,u,d,h,m=e("./chunk-YXSCBWTU.js"),p=e("./chunk-S6VGOPUY.js"),f=e("./chunk-RAOYRJ25.js"),v=e("./chunk-Z4BLTVTB.js"),g=e("@metamask/controller-utils"),_=e("@metamask/utils").createModuleLogger.call(void 0,p.projectLogger,"linea-gas-fee-flow"),k=[g.ChainId["linea-mainnet"],g.ChainId["linea-goerli"],g.ChainId["linea-sepolia"]],y={low:1,medium:1.35,high:1.7},w={low:1,medium:1.05,high:1.1};i=new WeakSet,n=async function(e){const{ethQuery:t,transactionMeta:r}=e,i=await v.__privateMethod.call(void 0,this,s,a).call(this,r,t);_("Received Linea response",i);const n=v.__privateMethod.call(void 0,this,o,l).call(this,i.baseFeePerGas,y);_("Generated base fees",v.__privateMethod.call(void 0,this,d,h).call(this,n));const m=v.__privateMethod.call(void 0,this,o,l).call(this,i.priorityFeePerGas,w);_("Generated priority fees",v.__privateMethod.call(void 0,this,d,h).call(this,m));const p=v.__privateMethod.call(void 0,this,c,u).call(this,n,m);_("Generated max fees",v.__privateMethod.call(void 0,this,d,h).call(this,p));return{estimates:Object.values(f.GasFeeEstimateLevel).reduce(((e,t)=>({...e,[t]:{maxFeePerGas:g.toHex.call(void 0,p[t]),maxPriorityFeePerGas:g.toHex.call(void 0,m[t])}})),{type:"fee-market"})}},s=new WeakSet,a=function(e,t){return g.query.call(void 0,t,"linea_estimateGas",[{from:e.txParams.from,to:e.txParams.to,value:e.txParams.value,input:e.txParams.data,gasPrice:"0x100000000"}])},o=new WeakSet,l=function(e,t){const r=g.hexToBN.call(void 0,e);return{low:r.muln(t.low),medium:r.muln(t.medium),high:r.muln(t.high)}},c=new WeakSet,u=function(e,t){return{low:e.low.add(t.low),medium:e.medium.add(t.medium),high:e.high.add(t.high)}},d=new WeakSet,h=function(e){return Object.values(f.GasFeeEstimateLevel).map((t=>e[t].toString(10)))},r.LineaGasFeeFlow=class{constructor(){v.__privateAdd.call(void 0,this,i),v.__privateAdd.call(void 0,this,s),v.__privateAdd.call(void 0,this,o),v.__privateAdd.call(void 0,this,c),v.__privateAdd.call(void 0,this,d)}matchesTransaction(e){return k.includes(e.chainId)}async getGasFees(e){try{return await v.__privateMethod.call(void 0,this,i,n).call(this,e)}catch(t){return _("Using default flow as fallback due to error",t),(new(0,m.DefaultGasFeeFlow)).getGasFees(e)}}}}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/dist/chunk-Q6Q44V4W.js"}],[1898,{"fast-json-patch":3362,lodash:3836},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i,n=e("fast-json-patch"),s=(i=n)&&i.__esModule?i:{default:i},a=e("lodash");function o(e){const t={...e};return delete t.history,a.cloneDeep.call(void 0,t)}r.addInitialHistorySnapshot=function(e){const t=o(e);return a.merge.call(void 0,{},e,{history:[t]})},r.updateTransactionHistory=function(e,t){if(!e.history)return e;const r=o(e);var i;const n=function(e,t,r){const i=s.default.compare(e,t);i[0]&&(r&&(i[0].note=r),i[0].timestamp=Date.now());return i}((i=e.history,a.cloneDeep.call(void 0,i).reduce(((e,t)=>s.default.applyPatch(e,t).newDocument))),r,t);return n.length>0?a.merge.call(void 0,{},e,{history:[...e.history,n]}):e}}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/dist/chunk-QP75SWIQ.js"}],[1899,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i=(e=>(e.approved="approved",e.cancelled="cancelled",e.confirmed="confirmed",e.dropped="dropped",e.failed="failed",e.rejected="rejected",e.signed="signed",e.submitted="submitted",e.unapproved="unapproved",e))(i||{}),n=(e=>(e.MM_MOBILE="metamask_mobile",e.MM_EXTENSION="metamask_extension",e.OTHER="other_device",e))(n||{}),s=(e=>(e.cancel="cancel",e.contractInteraction="contractInteraction",e.deployContract="contractDeployment",e.ethDecrypt="eth_decrypt",e.ethGetEncryptionPublicKey="eth_getEncryptionPublicKey",e.incoming="incoming",e.personalSign="personal_sign",e.retry="retry",e.simpleSend="simpleSend",e.signTypedData="eth_signTypedData",e.smart="smart",e.swap="swap",e.swapAndSend="swapAndSend",e.swapApproval="swapApproval",e.tokenMethodApprove="approve",e.tokenMethodSafeTransferFrom="safetransferfrom",e.tokenMethodTransfer="transfer",e.tokenMethodTransferFrom="transferfrom",e.tokenMethodSetApprovalForAll="setapprovalforall",e.tokenMethodIncreaseAllowance="increaseAllowance",e))(s||{}),a=(e=>(e.legacy="0x0",e.accessList="0x1",e.feeMarket="0x2",e))(a||{}),o=(e=>(e.CUSTOM="custom",e.DAPP_SUGGESTED="dappSuggested",e.MEDIUM="medium",e))(o||{}),l=(e=>(e.Low="low",e.Medium="medium",e.High="high",e))(l||{}),c=(e=>(e.FeeMarket="fee-market",e.Legacy="legacy",e.GasPrice="eth_gasPrice",e))(c||{}),u=(e=>(e.erc20="erc20",e.erc721="erc721",e.erc1155="erc1155",e))(u||{}),d=(e=>(e.ChainNotSupported="chain-not-supported",e.Disabled="disabled",e.InvalidResponse="invalid-response",e.Reverted="reverted",e))(d||{});r.TransactionStatus=i,r.WalletDevice=n,r.TransactionType=s,r.TransactionEnvelopeType=a,r.UserFeeLevel=o,r.GasFeeEstimateLevel=l,r.GasFeeEstimateType=c,r.SimulationTokenStandard=u,r.SimulationErrorCode=d}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/dist/chunk-RAOYRJ25.js"}],[19,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.isFeatureAnnouncementRead=function(e,t){if(t.includes(e.id))return!0;return function(e){const t=Date.now()-e.getTime();return t/i>=90}(new Date(e.createdAt))},r.processFeatureAnnouncement=function(e){return{type:e.type,id:e.data.id,createdAt:new Date(e.createdAt).toISOString(),data:e.data,isRead:!1}};const i=864e5}}},{package:"$root$",file:"app/scripts/controllers/metamask-notifications/processors/process-feature-announcement.ts"}],[190,{lodash:3836},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=e("lodash");r.default={version:70,async migrate(e){const t=(0,i.cloneDeep)(e);t.meta.version=70;const r=function(e){var t;if(Array.isArray(null==e||null===(t=e.PermissionLogController)||void 0===t?void 0:t.permissionActivityLog)){const{PermissionLogController:{permissionActivityLog:t}}=e;t.forEach((e=>{e&&"object"==typeof e&&!Array.isArray(e)&&(delete e.request,delete e.response)}))}return e}(t.data);return t.data=r,t}}}}},{package:"$root$",file:"app/scripts/migrations/070.js"}],[1900,{"@metamask/utils":2300},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i=e("@metamask/utils"),n=i.createProjectLogger.call(void 0,"transaction-controller"),s=i.createModuleLogger.call(void 0,n,"incoming-transactions");r.createModuleLogger=i.createModuleLogger,r.projectLogger=n,r.incomingTransactionsLogger=s}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/dist/chunk-S6VGOPUY.js"}],[1901,{"@ethersproject/abi":460,"@metamask/controller-utils":1948,"@metamask/metamask-eth-abis":1518},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i=e("@ethersproject/abi"),n=e("@metamask/controller-utils"),s=e("@metamask/metamask-eth-abis"),a=new(0,i.Interface)(s.abiERC20),o=new(0,i.Interface)(s.abiERC721),l=new(0,i.Interface)(s.abiERC1155),c=new(0,i.Interface)(s.abiFiatTokenV2);r.ESTIMATE_GAS_ERROR="eth_estimateGas rpc method error",r.determineTransactionType=async function(e,t){const{data:r,to:i}=e;if(r&&!i)return{type:"contractDeployment",getCodeResponse:void 0};const{contractCode:s,isContractAddress:u}=await async function(e,t){let r;try{r=await n.query.call(void 0,e,"getCode",[t])}catch(e){r=null}const i=!!r&&("0x"!==r&&"0x0"!==r);return{contractCode:r,isContractAddress:i}}(t,i);if(!u)return{type:"simpleSend",getCodeResponse:s};const d=0!==Number(e.value??"0"),h={type:"contractInteraction",getCodeResponse:s};if(!r||d)return h;const m=function(e){if(!e)return;try{return a.parseTransaction({data:e})}catch{}try{return o.parseTransaction({data:e})}catch{}try{return l.parseTransaction({data:e})}catch{}try{return c.parseTransaction({data:e})}catch{}return}(r)?.name;if(!m)return h;const p=["approve","setapprovalforall","transfer","transferfrom","safetransferfrom","increaseAllowance"].find((e=>e.toLowerCase()===m.toLowerCase()));return p?{type:p,getCodeResponse:s}:h}}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/dist/chunk-SD6CWFDF.js"}],[1902,{"./chunk-Z4BLTVTB.js":1911,"@metamask/controller-utils":1948},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i,n,s,a=e("./chunk-Z4BLTVTB.js"),o=e("@metamask/controller-utils"),l=1e15;i=new WeakMap,n=new WeakSet,s=function(e,t){const r=Math.ceil(e/t);return o.toHex.call(void 0,r)},r.TestGasFeeFlow=class{constructor(){a.__privateAdd.call(void 0,this,n),a.__privateAdd.call(void 0,this,i,1)}matchesTransaction(e){return!0}async getGasFees(e){const{transactionMeta:t}=e,{txParams:r}=t,{gas:o}=r;if(!o)throw new Error("Cannot estimate fee without gas value");const c=parseInt(o,16),u=.5*l,d=(a.__privateGet.call(void 0,this,i)+1)*l,h=a.__privateGet.call(void 0,this,i)*l,m=d-u,p=h-u,f=d+u,v=h+u;return a.__privateSet.call(void 0,this,i,a.__privateGet.call(void 0,this,i)+1),{estimates:{type:"fee-market",low:{maxFeePerGas:a.__privateMethod.call(void 0,this,n,s).call(this,m,c),maxPriorityFeePerGas:a.__privateMethod.call(void 0,this,n,s).call(this,p,c)},medium:{maxFeePerGas:a.__privateMethod.call(void 0,this,n,s).call(this,d,c),maxPriorityFeePerGas:a.__privateMethod.call(void 0,this,n,s).call(this,h,c)},high:{maxFeePerGas:a.__privateMethod.call(void 0,this,n,s).call(this,f,c),maxPriorityFeePerGas:a.__privateMethod.call(void 0,this,n,s).call(this,v,c)}}}}}}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/dist/chunk-TJMQEH57.js"}],[1903,{"@metamask/controller-utils":1948,"@metamask/utils":2300},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i=e("@metamask/controller-utils"),n=e("@metamask/utils"),s={data:e=>n.add0x.call(void 0,l(e)),from:e=>n.add0x.call(void 0,e).toLowerCase(),gas:e=>n.add0x.call(void 0,e),gasLimit:e=>n.add0x.call(void 0,e),gasPrice:e=>n.add0x.call(void 0,e),nonce:e=>n.add0x.call(void 0,e),to:e=>n.add0x.call(void 0,e).toLowerCase(),value:e=>n.add0x.call(void 0,e),maxFeePerGas:e=>n.add0x.call(void 0,e),maxPriorityFeePerGas:e=>n.add0x.call(void 0,e),estimatedBaseFee:e=>n.add0x.call(void 0,e),type:e=>n.add0x.call(void 0,e)};var a=(e,t)=>n.add0x.call(void 0,`${parseInt(""+e*t,10).toString(16)}`);function o(e){try{return JSON.parse(JSON.stringify(e)),!0}catch{return!1}}function l(e){const t=e.toLowerCase().startsWith("0x")?e.slice(0,2):"",r=t?e.slice(2):e;return t+(r.length%2==0?r:`0${r}`)}r.ESTIMATE_GAS_ERROR="eth_estimateGas rpc method error",r.normalizeTransactionParams=function(e){const t={from:""};for(const r of n.getKnownPropertyNames.call(void 0,s))e[r]&&(t[r]=s[r](e[r]));return t.value||(t.value="0x0"),t},r.isEIP1559Transaction=function(e){const t=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);return t(e,"maxFeePerGas")&&t(e,"maxPriorityFeePerGas")},r.validateGasValues=e=>{Object.keys(e).forEach((t=>{const r=e[t];if("string"!=typeof r||!n.isStrictHexString.call(void 0,r))throw new TypeError(`expected hex string for ${t} but received: ${r}`)}))},r.isFeeMarketEIP1559Values=e=>void 0!==e?.maxFeePerGas||void 0!==e?.maxPriorityFeePerGas,r.isGasPriceValue=e=>void 0!==e?.gasPrice,r.getIncreasedPriceHex=a,r.getIncreasedPriceFromExisting=(e,t)=>a(i.convertHexToDecimal.call(void 0,e),t),r.validateMinimumIncrease=function(e,t){const r=i.convertHexToDecimal.call(void 0,e),n=i.convertHexToDecimal.call(void 0,t);if(r>=n)return e;throw new Error(`The proposed value: ${r} should meet or exceed the minimum value: ${n}`)},r.validateIfTransactionUnapproved=function(e,t){if("unapproved"!==e?.status)throw new Error(`TransactionsController: Can only call ${t} on an unapproved transaction.\n      Current tx status: ${e?.status}`)},r.normalizeTxError=function(e){return{name:e.name,message:e.message,stack:e.stack,code:e.code,rpc:o(e.value)?e.value:void 0}},r.normalizeGasFeeValues=function(e){const t=e=>"string"==typeof e?n.add0x.call(void 0,e):e;return"gasPrice"in e?{gasPrice:t(e.gasPrice)}:{maxFeePerGas:t(e.maxFeePerGas),maxPriorityFeePerGas:t(e.maxPriorityFeePerGas)}},r.padHexToEvenLength=l}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/dist/chunk-UGFBA4GV.js"}],[1904,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i={MAINNET:"0x1",GOERLI:"0x5",BASE:"0x2105",BASE_TESTNET:"0x14a33",BSC:"0x38",BSC_TESTNET:"0x61",OPTIMISM:"0xa",OPTIMISM_TESTNET:"0x1a4",OPBNB:"0xcc",OPBNB_TESTNET:"0x15eb",OPTIMISM_SEPOLIA:"0xaa37dc",POLYGON:"0x89",POLYGON_TESTNET:"0x13881",AVALANCHE:"0xa86a",AVALANCHE_TESTNET:"0xa869",FANTOM:"0xfa",FANTOM_TESTNET:"0xfa2",SEPOLIA:"0xaa36a7",LINEA_GOERLI:"0xe704",LINEA_SEPOLIA:"0xe705",LINEA_MAINNET:"0xe708",MOONBEAM:"0x504",MOONBEAM_TESTNET:"0x507",MOONRIVER:"0x505",GNOSIS:"0x64",ARBITRUM:"0xa4b1",ZKSYNC_ERA:"0x144",ZORA:"0x76adf1",SCROLL:"0x82750",SCROLL_SEPOLIA:"0x8274f"},n="etherscan.io",s="api",a={[i.GOERLI]:{domain:n,subdomain:`${s}-goerli`},[i.MAINNET]:{domain:n,subdomain:s},[i.SEPOLIA]:{domain:n,subdomain:`${s}-sepolia`},[i.LINEA_GOERLI]:{domain:"lineascan.build",subdomain:`${s}-goerli`},[i.LINEA_SEPOLIA]:{domain:"lineascan.build",subdomain:`${s}-sepolia`},[i.LINEA_MAINNET]:{domain:"lineascan.build",subdomain:s},[i.BSC]:{domain:"bscscan.com",subdomain:s},[i.BSC_TESTNET]:{domain:"bscscan.com",subdomain:`${s}-testnet`},[i.OPTIMISM]:{domain:n,subdomain:`${s}-optimistic`},[i.OPTIMISM_SEPOLIA]:{domain:n,subdomain:`${s}-sepolia-optimistic`},[i.POLYGON]:{domain:"polygonscan.com",subdomain:s},[i.POLYGON_TESTNET]:{domain:"polygonscan.com",subdomain:`${s}-mumbai`},[i.AVALANCHE]:{domain:"snowtrace.io",subdomain:s},[i.AVALANCHE_TESTNET]:{domain:"snowtrace.io",subdomain:`${s}-testnet`},[i.FANTOM]:{domain:"ftmscan.com",subdomain:s},[i.FANTOM_TESTNET]:{domain:"ftmscan.com",subdomain:`${s}-testnet`},[i.MOONBEAM]:{domain:"moonscan.io",subdomain:`${s}-moonbeam`},[i.MOONBEAM_TESTNET]:{domain:"moonscan.io",subdomain:`${s}-moonbase`},[i.MOONRIVER]:{domain:"moonscan.io",subdomain:`${s}-moonriver`},[i.GNOSIS]:{domain:"gnosisscan.io",subdomain:`${s}-gnosis`}},o={[i.OPTIMISM]:1,[i.OPTIMISM_SEPOLIA]:1};r.CHAIN_IDS=i,r.DEFAULT_ETHERSCAN_DOMAIN=n,r.DEFAULT_ETHERSCAN_SUBDOMAIN_PREFIX=s,r.ETHERSCAN_SUPPORTED_NETWORKS=a,r.GAS_BUFFER_CHAIN_OVERRIDES=o,r.ABI_SIMULATION_ERC20_WRAPPED=[{anonymous:!1,inputs:[{indexed:!0,name:"to",type:"address"},{indexed:!1,name:"wad",type:"uint256"}],name:"Deposit",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"from",type:"address"},{indexed:!1,name:"wad",type:"uint256"}],name:"Withdrawal",type:"event"}],r.ABI_SIMULATION_ERC721_LEGACY=[{anonymous:!1,inputs:[{indexed:!1,name:"_from",type:"address"},{indexed:!1,name:"_to",type:"address"},{indexed:!1,name:"_tokenId",type:"uint256"}],name:"Transfer",type:"event"}]}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/dist/chunk-UGN7PBON.js"}],[1905,{"./chunk-S6VGOPUY.js":1900,"./chunk-UGFBA4GV.js":1903,"./chunk-UGN7PBON.js":1904,"@metamask/controller-utils":1948,lodash:3836},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i=e("./chunk-UGFBA4GV.js"),n=e("./chunk-UGN7PBON.js"),s=e("./chunk-S6VGOPUY.js"),a=e("@metamask/controller-utils"),o=e("lodash"),l=s.createModuleLogger.call(void 0,s.projectLogger,"swaps"),c=5e3,u="0x0000000000000000000000000000000000000000",d={name:"Ether",address:u,decimals:18},h={name:"Binance Coin",address:u,decimals:18},m={name:"Matic",address:u,decimals:18},p={name:"Avalanche",address:u,decimals:18},f={name:"Test Ether",address:u,decimals:18},v={name:"Ether",address:u,decimals:18},g={...d},_={...d},k={...d},y={[n.CHAIN_IDS.MAINNET]:d,"0x539":f,[n.CHAIN_IDS.BSC]:h,[n.CHAIN_IDS.POLYGON]:m,[n.CHAIN_IDS.GOERLI]:v,[n.CHAIN_IDS.AVALANCHE]:p,[n.CHAIN_IDS.OPTIMISM]:_,[n.CHAIN_IDS.ARBITRUM]:g,[n.CHAIN_IDS.ZKSYNC_ERA]:k},w=["swap","swapAndSend","swapApproval"];function T(e,t){return!(!e||!t)&&e===y[t]?.address}function b(e){return new Promise((t=>setTimeout(t,e)))}r.UPDATE_POST_TX_BALANCE_TIMEOUT=c,r.UPDATE_POST_TX_BALANCE_ATTEMPTS=6,r.DEFAULT_TOKEN_ADDRESS=u,r.SWAPS_CHAINID_DEFAULT_TOKEN_MAP=y,r.SWAP_TRANSACTION_TYPES=w,r.updateSwapsTransaction=function(e,t,r,{isSwapsDisabled:n,cancelTransaction:s,messenger:a}){if(n||!w.includes(t))return e;if("swap"===t&&!1===r?.hasApproveTx&&e.simulationFails)throw s(e.id),new Error("Simulation failed");const l=r?.meta;if(!l)return e;let c=e;return"swapApproval"===t&&(c=function(e,{type:t,sourceTokenSymbol:r}){i.validateIfTransactionUnapproved.call(void 0,e,"updateSwapApprovalTransaction");let n={type:t,sourceTokenSymbol:r};return n=o.pickBy.call(void 0,{type:t,sourceTokenSymbol:r}),o.merge.call(void 0,{},e,n)}(e,l),a.publish("TransactionController:transactionNewSwapApproval",{transactionMeta:c})),"swapAndSend"===t&&(c=function(e,{approvalTxId:t,destinationTokenAddress:r,destinationTokenAmount:n,destinationTokenDecimals:s,destinationTokenSymbol:a,estimatedBaseFee:l,sourceTokenAddress:c,sourceTokenAmount:u,sourceTokenDecimals:d,sourceTokenSymbol:h,swapAndSendRecipient:m,swapMetaData:p,swapTokenValue:f,type:v}){i.validateIfTransactionUnapproved.call(void 0,e,"updateSwapTransaction");let g={approvalTxId:t,destinationTokenAddress:r,destinationTokenAmount:n,destinationTokenDecimals:s,destinationTokenSymbol:a,estimatedBaseFee:l,sourceTokenAddress:c,sourceTokenAmount:u,sourceTokenDecimals:d,sourceTokenSymbol:h,swapAndSendRecipient:m,swapMetaData:p,swapTokenValue:f,type:v};return g=o.pickBy.call(void 0,g),o.merge.call(void 0,{},e,g)}(e,l),a.publish("TransactionController:transactionNewSwapAndSend",{transactionMeta:c})),"swap"===t&&(c=function(e,{sourceTokenSymbol:t,destinationTokenSymbol:r,type:n,destinationTokenDecimals:s,destinationTokenAddress:a,swapMetaData:l,swapTokenValue:c,estimatedBaseFee:u,approvalTxId:d}){i.validateIfTransactionUnapproved.call(void 0,e,"updateSwapTransaction");let h={sourceTokenSymbol:t,destinationTokenSymbol:r,type:n,destinationTokenDecimals:s,destinationTokenAddress:a,swapMetaData:l,swapTokenValue:c,estimatedBaseFee:u,approvalTxId:d};return h=o.pickBy.call(void 0,h),o.merge.call(void 0,{},e,h)}(e,l),a.publish("TransactionController:transactionNewSwap",{transactionMeta:c})),c},r.updatePostTransactionBalance=async function(e,{ethQuery:t,getTransaction:r,updateTransaction:i}){l("Updating post transaction balance",e.id);const n=e.id;let s,o;for(let i=0;i<6;i++){l("Querying balance",{attempt:i});const u=await a.query.call(void 0,t,"getBalance",[e.txParams.from]);s={...r(n)??{}},o=s.approvalTxId?r(s.approvalTxId):void 0,s.postTxBalance=u.toString(16);const d=T(e.destinationTokenAddress,e.chainId);if(!d||e.preTxBalance!==s.postTxBalance){l("Finishing post balance update",{isDefaultTokenAddress:d,preTxBalance:e.preTxBalance,postTxBalance:s.postTxBalance});break}l("Waiting for balance to update",{delay:c}),await b(c)}return i(s,"TransactionController#updatePostTransactionBalance - Add post transaction balance"),l("Completed post balance update",s?.postTxBalance),{updatedTransactionMeta:s,approvalTransactionMeta:o}}}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/dist/chunk-UT4M4XI3.js"}],[1906,{"./chunk-S6VGOPUY.js":1900,"./chunk-UGN7PBON.js":1904,"@metamask/controller-utils":1948,"@metamask/utils":2300},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i=e("./chunk-UGN7PBON.js"),n=e("./chunk-S6VGOPUY.js"),s=e("@metamask/controller-utils"),a=e("@metamask/utils"),o=a.createModuleLogger.call(void 0,n.projectLogger,"gas"),l="0x5208",c=1.5;async function u(e,t){const r={...e},{data:i,value:n}=r,{gasLimit:l,number:c}=await async function(e){return await s.query.call(void 0,e,"getBlockByNumber",["latest",!1])}(t),d=s.hexToBN.call(void 0,l);r.data=i?a.add0x.call(void 0,i):i,r.gas=s.BNToHex.call(void 0,s.fractionBN.call(void 0,d,19,20)),r.value=n||"0x0";let h,m=r.gas;try{m=await s.query.call(void 0,t,"estimateGas",[r])}catch(e){h={reason:e.message,errorKey:e.errorKey,debug:{blockNumber:c,blockGasLimit:l}},o("Estimation failed",{...h,fallback:u})}return{blockGasLimit:l,estimatedGas:m,simulationFails:h}}function d(e,t,r){const i=s.hexToBN.call(void 0,e),n=s.hexToBN.call(void 0,t).muln(.9),l=i.muln(r);if(i.gt(n)){const t=a.add0x.call(void 0,e);return o("Using estimated value",t),t}if(l.lt(n)){const e=a.add0x.call(void 0,s.BNToHex.call(void 0,l));return o("Using padded estimate",e,r),e}const c=a.add0x.call(void 0,s.BNToHex.call(void 0,n));return o("Using 90% of block gas limit",c),c}r.log=o,r.FIXED_GAS=l,r.DEFAULT_GAS_MULTIPLIER=c,r.updateGas=async function(e){const{txMeta:t}=e,r={...t.txParams},[n,a]=await async function(e){const{isCustomNetwork:t,chainId:r,txMeta:n}=e;if(n.txParams.gas)return o("Using value from request",n.txParams.gas),[n.txParams.gas];if(await async function({ethQuery:e,txMeta:t,isCustomNetwork:r}){const{txParams:{to:i,data:n}}=t;if(r||!i||n)return!1;const a=await async function(e,t){return await s.query.call(void 0,e,"getCode",[t])}(e,i);return!a||"0x"===a}(e))return o("Using fixed value",l),[l];const{blockGasLimit:a,estimatedGas:h,simulationFails:m}=await u(n.txParams,e.ethQuery);if(t)return o("Using original estimate as custom network"),[h,m];const p=i.GAS_BUFFER_CHAIN_OVERRIDES[r]??c;return[d(h,a,p),m]}(e);t.txParams.gas=n,t.simulationFails=a,r.gas||(t.originalGasEstimate=t.txParams.gas),t.defaultGasEstimates||(t.defaultGasEstimates={}),t.defaultGasEstimates.gas=t.txParams.gas},r.estimateGas=u,r.addGasBuffer=d}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/dist/chunk-V72C4MCR.js"}],[1907,{"./chunk-UGFBA4GV.js":1903,"@ethersproject/abi":460,"@metamask/controller-utils":1948,"@metamask/metamask-eth-abis":1518,"@metamask/rpc-errors":1717},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i=e("./chunk-UGFBA4GV.js"),n=e("@ethersproject/abi"),s=e("@metamask/controller-utils"),a=e("@metamask/metamask-eth-abis"),o=e("@metamask/rpc-errors");function l(e,t){switch(t){case"maxFeePerGas":case"maxPriorityFeePerGas":if(e.type&&"0x2"!==e.type)throw o.rpcErrors.invalidParams(`Invalid transaction envelope type: specified type "${e.type}" but including maxFeePerGas and maxPriorityFeePerGas requires type: "0x2"`);break;default:if(e.type&&"0x2"===e.type)throw o.rpcErrors.invalidParams(`Invalid transaction envelope type: specified type "${e.type}" but included a gasPrice instead of maxFeePerGas and maxPriorityFeePerGas`)}}function c(e,t,r){if(void 0!==e[r])throw o.rpcErrors.invalidParams(`Invalid transaction params: specified ${t} but also included ${r}, these cannot be mixed`)}function u(e,t){if("string"!=typeof e[t])throw o.rpcErrors.invalidParams(`Invalid transaction params: ${t} is not a string. got: (${e[t]})`)}r.validateTransactionOrigin=async function(e,t,r,i){if(i!==s.ORIGIN_METAMASK){if(!e.includes(r))throw o.providerErrors.unauthorized({data:{origin:i}})}else if(r!==t)throw o.rpcErrors.internal({message:"Internally initiated transaction is using invalid account.",data:{origin:i,fromAddress:r,selectedAddress:t}})},r.validateTxParams=function(e,t=!0){!function(e,t){if(i.isEIP1559Transaction.call(void 0,e)&&!t)throw o.rpcErrors.invalidParams("Invalid transaction params: params specify an EIP-1559 transaction but the current network does not support EIP-1559")}(e,t),function(e){if(!e||"string"!=typeof e)throw o.rpcErrors.invalidParams(`Invalid "from" address ${e}: not a string.`);if(!s.isValidHexAddress.call(void 0,e))throw o.rpcErrors.invalidParams('Invalid "from" address.')}(e.from),function(e){if("0x"===e.to||void 0===e.to){if(!e.data)throw o.rpcErrors.invalidParams('Invalid "to" address.');delete e.to}else if(void 0!==e.to&&!s.isValidHexAddress.call(void 0,e.to))throw o.rpcErrors.invalidParams('Invalid "to" address.')}(e),function(e){if(void 0!==e){if(e.includes("-"))throw o.rpcErrors.invalidParams(`Invalid transaction value "${e}": not a positive number.`);if(e.includes("."))throw o.rpcErrors.invalidParams(`Invalid transaction value "${e}": number must be in wei.`);const t=parseInt(e,10);if(!(Number.isFinite(t)&&!Number.isNaN(t)&&!isNaN(Number(e))&&Number.isSafeInteger(t)))throw o.rpcErrors.invalidParams(`Invalid transaction value ${e}: number must be a valid number.`)}}(e.value),function(e){if(e){const t=new(0,n.Interface)(a.abiERC20);try{t.parseTransaction({data:e})}catch(e){if(e.message.match(/BUFFER_OVERRUN/u))throw o.rpcErrors.invalidParams("Invalid transaction params: data out-of-bounds, BUFFER_OVERRUN.")}}}(e.data),function(e){if(void 0!==e&&"number"!=typeof e&&"string"!=typeof e)throw o.rpcErrors.invalidParams(`Invalid transaction params: chainId is not a Number or hex string. got: (${e})`)}(e.chainId),function(e){e.gasPrice&&(l(e,"gasPrice"),c(e,"gasPrice","maxFeePerGas"),c(e,"gasPrice","maxPriorityFeePerGas"),u(e,"gasPrice"));e.maxFeePerGas&&(l(e,"maxFeePerGas"),c(e,"maxFeePerGas","gasPrice"),u(e,"maxFeePerGas"));e.maxPriorityFeePerGas&&(l(e,"maxPriorityFeePerGas"),c(e,"maxPriorityFeePerGas","gasPrice"),u(e,"maxPriorityFeePerGas"))}(e)}}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/dist/chunk-VH47Q6TS.js"}],[1908,{"./chunk-UGN7PBON.js":1904,"./chunk-YVCX6Z75.js":1909},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i=e("./chunk-YVCX6Z75.js"),n=e("./chunk-UGN7PBON.js"),s=[n.CHAIN_IDS.SCROLL,n.CHAIN_IDS.SCROLL_SEPOLIA],a=class extends i.OracleLayer1GasFeeFlow{constructor(){super("0x5300000000000000000000000000000000000002",!0)}matchesTransaction(e){return s.includes(e.chainId)}};r.ScrollLayer1GasFeeFlow=a}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/dist/chunk-WR5F34OW.js"}],[1909,{"./chunk-S6VGOPUY.js":1900,"./chunk-Z4BLTVTB.js":1911,"@ethereumjs/common":418,"@ethereumjs/tx":1917,"@ethersproject/contracts":483,"@ethersproject/providers":521,"@metamask/utils":2300,buffer:3028,lodash:3836},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0});var i,n,s,a,o,l,c,u,d,h,m=e("./chunk-S6VGOPUY.js"),p=e("./chunk-Z4BLTVTB.js"),f=e("@ethereumjs/common"),v=e("@ethereumjs/tx"),g=e("@ethersproject/contracts"),_=e("@ethersproject/providers"),k=e("@metamask/utils"),y=e("lodash"),w=k.createModuleLogger.call(void 0,m.projectLogger,"oracle-layer1-gas-fee-flow"),T=[{inputs:[{internalType:"bytes",name:"_data",type:"bytes"}],name:"getL1Fee",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"}];i=new WeakMap,n=new WeakMap,s=new WeakSet,a=async function(e){const{provider:t,transactionMeta:r}=e,s=new(0,g.Contract)(p.__privateGet.call(void 0,this,i),T,new(0,_.Web3Provider)(t)),a=p.__privateMethod.call(void 0,this,o,l).call(this,r,p.__privateGet.call(void 0,this,n)).serialize(),c=await s.getL1Fee(a);if(void 0===c)throw new Error("No value returned from oracle contract");return{layer1Fee:c.toHexString()}},o=new WeakSet,l=function(e,r){const i=p.__privateMethod.call(void 0,this,c,u).call(this,e),n=p.__privateMethod.call(void 0,this,d,h).call(this,e);let s=v.TransactionFactory.fromTxData(i,{common:n});if(r){const e=t.from("abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789","hex");s=s.sign(e)}return s},c=new WeakSet,u=function(e){return{...y.omit.call(void 0,e.txParams,"gas"),gasLimit:e.txParams.gas}},d=new WeakSet,h=function(e){const t=Number(e.chainId);return f.Common.custom({chainId:t,defaultHardfork:f.Hardfork.London})},r.OracleLayer1GasFeeFlow=class{constructor(e,t){p.__privateAdd.call(void 0,this,s),p.__privateAdd.call(void 0,this,o),p.__privateAdd.call(void 0,this,c),p.__privateAdd.call(void 0,this,d),p.__privateAdd.call(void 0,this,i,void 0),p.__privateAdd.call(void 0,this,n,void 0),p.__privateSet.call(void 0,this,i,e),p.__privateSet.call(void 0,this,n,t??!1)}async getLayer1Fee(e){try{return await p.__privateMethod.call(void 0,this,s,a).call(this,e)}catch(e){throw w("Failed to get oracle layer 1 gas fee",e),new Error("Failed to get oracle layer 1 gas fee")}}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/dist/chunk-YVCX6Z75.js"}],[191,{lodash:3836},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=e("lodash");r.default={version:71,async migrate(e){const t=(0,i.cloneDeep)(e);t.meta.version=71;const r=function(e){e.NotificationController&&(e.AnnouncementController={announcements:e.NotificationController.notifications},delete e.NotificationController);return e}(t.data);return t.data=r,t}}}}},{package:"$root$",file:"app/scripts/migrations/071.js"}],[1910,{"./chunk-3ZRHCVVS.js":1882,"./chunk-RAOYRJ25.js":1899,"./chunk-S6VGOPUY.js":1900,"./chunk-Z4BLTVTB.js":1911,"@metamask/gas-fee-controller":1849,"@metamask/utils":2300},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i,n,s,a,o,l,c,u,d,h,m=e("./chunk-3ZRHCVVS.js"),p=e("./chunk-S6VGOPUY.js"),f=e("./chunk-RAOYRJ25.js"),v=e("./chunk-Z4BLTVTB.js"),g=e("@metamask/gas-fee-controller"),_=e("@metamask/utils").createModuleLogger.call(void 0,p.projectLogger,"default-gas-fee-flow");i=new WeakSet,n=function(e){return{type:"fee-market",...Object.values(f.GasFeeEstimateLevel).reduce(((t,r)=>({...t,[r]:v.__privateMethod.call(void 0,this,c,u).call(this,e,r)})),{})}},s=new WeakSet,a=function(e){return{type:"legacy",...Object.values(f.GasFeeEstimateLevel).reduce(((t,r)=>({...t,[r]:v.__privateMethod.call(void 0,this,d,h).call(this,e,r)})),{})}},o=new WeakSet,l=function(e){return{type:"eth_gasPrice",gasPrice:m.gweiDecimalToWeiHex.call(void 0,e.gasPrice)}},c=new WeakSet,u=function(e,t){return{maxFeePerGas:m.gweiDecimalToWeiHex.call(void 0,e[t].suggestedMaxFeePerGas),maxPriorityFeePerGas:m.gweiDecimalToWeiHex.call(void 0,e[t].suggestedMaxPriorityFeePerGas)}},d=new WeakSet,h=function(e,t){return m.gweiDecimalToWeiHex.call(void 0,e[t])},r.DefaultGasFeeFlow=class{constructor(){v.__privateAdd.call(void 0,this,i),v.__privateAdd.call(void 0,this,s),v.__privateAdd.call(void 0,this,o),v.__privateAdd.call(void 0,this,c),v.__privateAdd.call(void 0,this,d)}matchesTransaction(e){return!0}async getGasFees(e){const{gasFeeControllerData:t}=e,{gasEstimateType:r,gasFeeEstimates:c}=t;let u;switch(r){case g.GAS_ESTIMATE_TYPES.FEE_MARKET:_("Using fee market estimates",c),u=v.__privateMethod.call(void 0,this,i,n).call(this,c);break;case g.GAS_ESTIMATE_TYPES.LEGACY:_("Using legacy estimates",c),u=v.__privateMethod.call(void 0,this,s,a).call(this,c);break;case g.GAS_ESTIMATE_TYPES.ETH_GASPRICE:_("Using eth_gasPrice estimates",c),u=v.__privateMethod.call(void 0,this,o,l).call(this,c);break;default:throw new Error(`Unsupported gas estimate type: ${r}`)}return{estimates:u}}}}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/dist/chunk-YXSCBWTU.js"}],[1911,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i=(e,t,r)=>{if(!t.has(e))throw TypeError("Cannot "+r)};r.__privateGet=(e,t,r)=>(i(e,t,"read from private field"),r?r.call(e):t.get(e)),r.__privateAdd=(e,t,r)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,r)},r.__privateSet=(e,t,r,n)=>(i(e,t,"write to private field"),n?n.call(e,r):t.set(e,r),r),r.__privateMethod=(e,t,r)=>(i(e,t,"access private method"),r)}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/dist/chunk-Z4BLTVTB.js"}],[1912,{"./chunk-2XKEAKQG.js":1881,"./chunk-3ZRHCVVS.js":1882,"./chunk-5KMU2IAT.js":1883,"./chunk-7LXE4KHV.js":1884,"./chunk-7MKQDZKY.js":1885,"./chunk-DLOQPH4M.js":1886,"./chunk-DTDTOMTB.js":1887,"./chunk-EQT25RSP.js":1888,"./chunk-FDUCRHYT.js":1889,"./chunk-HMOSP33F.js":1890,"./chunk-IT3SYNZ6.js":1891,"./chunk-KT6UAKBB.js":1892,"./chunk-NYKRCWBG.js":1893,"./chunk-PBYK4OMK.js":1894,"./chunk-PRUNMTRD.js":1895,"./chunk-PUESYN62.js":1896,"./chunk-Q6Q44V4W.js":1897,"./chunk-QP75SWIQ.js":1898,"./chunk-RAOYRJ25.js":1899,"./chunk-S6VGOPUY.js":1900,"./chunk-SD6CWFDF.js":1901,"./chunk-TJMQEH57.js":1902,"./chunk-UGFBA4GV.js":1903,"./chunk-UGN7PBON.js":1904,"./chunk-UT4M4XI3.js":1905,"./chunk-V72C4MCR.js":1906,"./chunk-VH47Q6TS.js":1907,"./chunk-WR5F34OW.js":1908,"./chunk-YVCX6Z75.js":1909,"./chunk-YXSCBWTU.js":1910,"./chunk-Z4BLTVTB.js":1911},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i=e("./chunk-PBYK4OMK.js");e("./chunk-PRUNMTRD.js"),e("./chunk-IT3SYNZ6.js"),e("./chunk-KT6UAKBB.js");var n=e("./chunk-SD6CWFDF.js");e("./chunk-VH47Q6TS.js"),e("./chunk-5KMU2IAT.js"),e("./chunk-7LXE4KHV.js"),e("./chunk-V72C4MCR.js"),e("./chunk-QP75SWIQ.js"),e("./chunk-NYKRCWBG.js"),e("./chunk-WR5F34OW.js"),e("./chunk-YVCX6Z75.js"),e("./chunk-TJMQEH57.js"),e("./chunk-7MKQDZKY.js"),e("./chunk-2XKEAKQG.js"),e("./chunk-DTDTOMTB.js"),e("./chunk-PUESYN62.js"),e("./chunk-EQT25RSP.js"),e("./chunk-FDUCRHYT.js"),e("./chunk-HMOSP33F.js"),e("./chunk-Q6Q44V4W.js"),e("./chunk-YXSCBWTU.js"),e("./chunk-3ZRHCVVS.js"),e("./chunk-UT4M4XI3.js");var s=e("./chunk-UGFBA4GV.js"),a=e("./chunk-DLOQPH4M.js");e("./chunk-UGN7PBON.js"),e("./chunk-S6VGOPUY.js");var o=e("./chunk-RAOYRJ25.js");e("./chunk-Z4BLTVTB.js"),r.CANCEL_RATE=i.CANCEL_RATE,r.GasFeeEstimateLevel=o.GasFeeEstimateLevel,r.GasFeeEstimateType=o.GasFeeEstimateType,r.HARDFORK=i.HARDFORK,r.SimulationErrorCode=o.SimulationErrorCode,r.SimulationTokenStandard=o.SimulationTokenStandard,r.TransactionController=i.TransactionController,r.TransactionEnvelopeType=o.TransactionEnvelopeType,r.TransactionStatus=o.TransactionStatus,r.TransactionType=o.TransactionType,r.UserFeeLevel=o.UserFeeLevel,r.WalletDevice=o.WalletDevice,r.determineTransactionType=n.determineTransactionType,r.isEIP1559Transaction=s.isEIP1559Transaction,r.mergeGasFeeEstimates=a.mergeGasFeeEstimates,r.normalizeTransactionParams=s.normalizeTransactionParams}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/dist/index.js"}],[1913,{"./types":1920,"./util":1921,"@ethereumjs/common":418,"@ethereumjs/util":1929},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.BaseTransaction=void 0;const i=e("@ethereumjs/common"),n=e("@ethereumjs/util"),s=e("./types"),a=e("./util");r.BaseTransaction=class{constructor(e,t){this.cache={hash:undefined,dataFee:undefined},this.activeCapabilities=[],this.DEFAULT_CHAIN=i.Chain.Mainnet,this.DEFAULT_HARDFORK=i.Hardfork.Merge;const{nonce:r,gasLimit:s,to:o,value:l,data:c,v:u,r:d,s:h,type:m}=e;this._type=Number((0,n.bufferToBigInt)((0,n.toBuffer)(m))),this.txOptions=t;const p=(0,n.toBuffer)(""===o?"0x":o),f=(0,n.toBuffer)(""===u?"0x":u),v=(0,n.toBuffer)(""===d?"0x":d),g=(0,n.toBuffer)(""===h?"0x":h);this.nonce=(0,n.bufferToBigInt)((0,n.toBuffer)(""===r?"0x":r)),this.gasLimit=(0,n.bufferToBigInt)((0,n.toBuffer)(""===s?"0x":s)),this.to=p.length>0?new n.Address(p):undefined,this.value=(0,n.bufferToBigInt)((0,n.toBuffer)(""===l?"0x":l)),this.data=(0,n.toBuffer)(""===c?"0x":c),this.v=f.length>0?(0,n.bufferToBigInt)(f):undefined,this.r=v.length>0?(0,n.bufferToBigInt)(v):undefined,this.s=g.length>0?(0,n.bufferToBigInt)(g):undefined,this._validateCannotExceedMaxInteger({value:this.value,r:this.r,s:this.s}),this._validateCannotExceedMaxInteger({gasLimit:this.gasLimit},64),this._validateCannotExceedMaxInteger({nonce:this.nonce},64,!0);const _=this.to===undefined||null===this.to,k=t.allowUnlimitedInitCodeSize??!1,y=t.common??this._getCommon();_&&y.isActivatedEIP(3860)&&!1===k&&(0,a.checkMaxInitCodeSize)(y,this.data.length)}get type(){return this._type}supports(e){return this.activeCapabilities.includes(e)}validate(e=!1){const t=[];return this.getBaseFee()>this.gasLimit&&t.push(`gasLimit is too low. given ${this.gasLimit}, need at least ${this.getBaseFee()}`),this.isSigned()&&!this.verifySignature()&&t.push("Invalid Signature"),e?t:0===t.length}_validateYParity(){const{v:e}=this;if(e!==undefined&&e!==BigInt(0)&&e!==BigInt(1)){const e=this._errorMsg("The y-parity of the transaction should either be 0 or 1");throw new Error(e)}}_validateHighS(){const{s:e}=this;if(this.common.gteHardfork("homestead")&&e!==undefined&&e>n.SECP256K1_ORDER_DIV_2){const e=this._errorMsg("Invalid Signature: s-values greater than secp256k1n/2 are considered invalid");throw new Error(e)}}getBaseFee(){const e=this.common.param("gasPrices","tx");let t=this.getDataFee();if(e&&(t+=e),this.common.gteHardfork("homestead")&&this.toCreationAddress()){const e=this.common.param("gasPrices","txCreation");e&&(t+=e)}return t}getDataFee(){const e=this.common.param("gasPrices","txDataZero"),t=this.common.param("gasPrices","txDataNonZero");let r=BigInt(0);for(let i=0;i<this.data.length;i++)0===this.data[i]?r+=e:r+=t;if((this.to===undefined||null===this.to)&&this.common.isActivatedEIP(3860)){const e=BigInt(Math.ceil(this.data.length/32));r+=this.common.param("gasPrices","initCodeWordCost")*e}return r}toCreationAddress(){return this.to===undefined||0===this.to.buf.length}isSigned(){const{v:e,r:t,s:r}=this;return e!==undefined&&t!==undefined&&r!==undefined}verifySignature(){try{const e=this.getSenderPublicKey();return 0!==(0,n.unpadBuffer)(e).length}catch(e){return!1}}getSenderAddress(){return new n.Address((0,n.publicToAddress)(this.getSenderPublicKey()))}sign(e){if(32!==e.length){const e=this._errorMsg("Private key must be 32 bytes in length.");throw new Error(e)}let t=!1;0===this.type&&this.common.gteHardfork("spuriousDragon")&&!this.supports(s.Capability.EIP155ReplayProtection)&&(this.activeCapabilities.push(s.Capability.EIP155ReplayProtection),t=!0);const r=this.getMessageToSign(!0),{v:i,r:a,s:o}=(0,n.ecsign)(r,e),l=this._processSignature(i,a,o);if(t){const e=this.activeCapabilities.indexOf(s.Capability.EIP155ReplayProtection);e>-1&&this.activeCapabilities.splice(e,1)}return l}_getCommon(e,t){if(t!==undefined){const r=(0,n.bufferToBigInt)((0,n.toBuffer)(t));if(e){if(e.chainId()!==r){const e=this._errorMsg("The chain ID does not match the chain ID of Common");throw new Error(e)}return e.copy()}return i.Common.isSupportedChainId(r)?new i.Common({chain:r,hardfork:this.DEFAULT_HARDFORK}):i.Common.custom({name:"custom-chain",networkId:r,chainId:r},{baseChain:this.DEFAULT_CHAIN,hardfork:this.DEFAULT_HARDFORK})}return e?.copy()??new i.Common({chain:this.DEFAULT_CHAIN,hardfork:this.DEFAULT_HARDFORK})}_validateCannotExceedMaxInteger(e,t=256,r=!1){for(const[i,s]of Object.entries(e))switch(t){case 64:if(r){if(s!==undefined&&s>=n.MAX_UINT64){const e=this._errorMsg(`${i} cannot equal or exceed MAX_UINT64 (2^64-1), given ${s}`);throw new Error(e)}}else if(s!==undefined&&s>n.MAX_UINT64){const e=this._errorMsg(`${i} cannot exceed MAX_UINT64 (2^64-1), given ${s}`);throw new Error(e)}break;case 256:if(r){if(s!==undefined&&s>=n.MAX_INTEGER){const e=this._errorMsg(`${i} cannot equal or exceed MAX_INTEGER (2^256-1), given ${s}`);throw new Error(e)}}else if(s!==undefined&&s>n.MAX_INTEGER){const e=this._errorMsg(`${i} cannot exceed MAX_INTEGER (2^256-1), given ${s}`);throw new Error(e)}break;default:{const e=this._errorMsg("unimplemented bits value");throw new Error(e)}}}static _validateNotArray(e){const t=["nonce","gasPrice","gasLimit","to","value","data","v","r","s","type","baseFee","maxFeePerGas","chainId"];for(const[r,i]of Object.entries(e))if(t.includes(r)&&Array.isArray(i))throw new Error(`${r} cannot be an array`)}_getSharedErrorPostfix(){let e="";try{e=this.isSigned()?(0,n.bufferToHex)(this.hash()):"not available (unsigned)"}catch(t){e="error"}let t="";try{t=this.isSigned().toString()}catch(t){e="error"}let r="";try{r=this.common.hardfork()}catch(e){r="error"}let i=`tx type=${this.type} hash=${e} nonce=${this.nonce} value=${this.value} `;return i+=`signed=${t} hf=${r}`,i}}}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@ethereumjs/tx",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/node_modules/@ethereumjs/tx/dist/baseTransaction.js"}],[1914,{"./baseTransaction":1913,"./util":1921,"@ethereumjs/rlp":421,"@ethereumjs/util":1929,buffer:3028,"ethereum-cryptography/keccak":3260},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.FeeMarketEIP1559Transaction=void 0;const i=e("@ethereumjs/rlp"),n=e("@ethereumjs/util"),s=e("ethereum-cryptography/keccak"),a=e("./baseTransaction"),o=e("./util"),l=t.from(2..toString(16).padStart(2,"0"),"hex");class c extends a.BaseTransaction{constructor(e,t={}){super({...e,type:2},t),this.DEFAULT_HARDFORK="london";const{chainId:r,accessList:i,maxFeePerGas:s,maxPriorityFeePerGas:l}=e;if(this.common=this._getCommon(t.common,r),this.chainId=this.common.chainId(),!1===this.common.isActivatedEIP(1559))throw new Error("EIP-1559 not enabled on Common");this.activeCapabilities=this.activeCapabilities.concat([1559,2718,2930]);const c=o.AccessLists.getAccessListData(i??[]);if(this.accessList=c.accessList,this.AccessListJSON=c.AccessListJSON,o.AccessLists.verifyAccessList(this.accessList),this.maxFeePerGas=(0,n.bufferToBigInt)((0,n.toBuffer)(""===s?"0x":s)),this.maxPriorityFeePerGas=(0,n.bufferToBigInt)((0,n.toBuffer)(""===l?"0x":l)),this._validateCannotExceedMaxInteger({maxFeePerGas:this.maxFeePerGas,maxPriorityFeePerGas:this.maxPriorityFeePerGas}),a.BaseTransaction._validateNotArray(e),this.gasLimit*this.maxFeePerGas>n.MAX_INTEGER){const e=this._errorMsg("gasLimit * maxFeePerGas cannot exceed MAX_INTEGER (2^256-1)");throw new Error(e)}if(this.maxFeePerGas<this.maxPriorityFeePerGas){const e=this._errorMsg("maxFeePerGas cannot be less than maxPriorityFeePerGas (The total must be the larger of the two)");throw new Error(e)}this._validateYParity(),this._validateHighS();(t?.freeze??!0)&&Object.freeze(this)}static fromTxData(e,t={}){return new c(e,t)}static fromSerializedTx(e,t={}){if(!e.slice(0,1).equals(l))throw new Error(`Invalid serialized tx input: not an EIP-1559 transaction (wrong tx type, expected: 2, received: ${e.slice(0,1).toString("hex")}`);const r=(0,n.arrToBufArr)(i.RLP.decode(e.slice(1)));if(!Array.isArray(r))throw new Error("Invalid serialized tx input: must be array");return c.fromValuesArray(r,t)}static fromValuesArray(e,t={}){if(9!==e.length&&12!==e.length)throw new Error("Invalid EIP-1559 transaction. Only expecting 9 values (for unsigned tx) or 12 values (for signed tx).");const[r,i,s,a,o,l,u,d,h,m,p,f]=e;return this._validateNotArray({chainId:r,v:m}),(0,n.validateNoLeadingZeroes)({nonce:i,maxPriorityFeePerGas:s,maxFeePerGas:a,gasLimit:o,value:u,v:m,r:p,s:f}),new c({chainId:(0,n.bufferToBigInt)(r),nonce:i,maxPriorityFeePerGas:s,maxFeePerGas:a,gasLimit:o,to:l,value:u,data:d,accessList:h??[],v:m!==undefined?(0,n.bufferToBigInt)(m):undefined,r:p,s:f},t)}getDataFee(){if(this.cache.dataFee&&this.cache.dataFee.hardfork===this.common.hardfork())return this.cache.dataFee.value;let e=super.getDataFee();return e+=BigInt(o.AccessLists.getDataFeeEIP2930(this.accessList,this.common)),Object.isFrozen(this)&&(this.cache.dataFee={value:e,hardfork:this.common.hardfork()}),e}getUpfrontCost(e=BigInt(0)){const t=this.maxPriorityFeePerGas,r=this.maxFeePerGas-e,i=(t<r?t:r)+e;return this.gasLimit*i+this.value}raw(){return[(0,n.bigIntToUnpaddedBuffer)(this.chainId),(0,n.bigIntToUnpaddedBuffer)(this.nonce),(0,n.bigIntToUnpaddedBuffer)(this.maxPriorityFeePerGas),(0,n.bigIntToUnpaddedBuffer)(this.maxFeePerGas),(0,n.bigIntToUnpaddedBuffer)(this.gasLimit),this.to!==undefined?this.to.buf:t.from([]),(0,n.bigIntToUnpaddedBuffer)(this.value),this.data,this.accessList,this.v!==undefined?(0,n.bigIntToUnpaddedBuffer)(this.v):t.from([]),this.r!==undefined?(0,n.bigIntToUnpaddedBuffer)(this.r):t.from([]),this.s!==undefined?(0,n.bigIntToUnpaddedBuffer)(this.s):t.from([])]}serialize(){const e=this.raw();return t.concat([l,t.from(i.RLP.encode((0,n.bufArrToArr)(e)))])}getMessageToSign(e=!0){const r=this.raw().slice(0,9),a=t.concat([l,t.from(i.RLP.encode((0,n.bufArrToArr)(r)))]);return e?t.from((0,s.keccak256)(a)):a}hash(){if(!this.isSigned()){const e=this._errorMsg("Cannot call hash method if transaction is not signed");throw new Error(e)}return Object.isFrozen(this)?(this.cache.hash||(this.cache.hash=t.from((0,s.keccak256)(this.serialize()))),this.cache.hash):t.from((0,s.keccak256)(this.serialize()))}getMessageToVerifySignature(){return this.getMessageToSign()}getSenderPublicKey(){if(!this.isSigned()){const e=this._errorMsg("Cannot call this method if transaction is not signed");throw new Error(e)}const e=this.getMessageToVerifySignature(),{v:t,r:r,s:i}=this;this._validateHighS();try{return(0,n.ecrecover)(e,t+BigInt(27),(0,n.bigIntToUnpaddedBuffer)(r),(0,n.bigIntToUnpaddedBuffer)(i))}catch(e){const t=this._errorMsg("Invalid Signature");throw new Error(t)}}_processSignature(e,t,r){const i={...this.txOptions,common:this.common};return c.fromTxData({chainId:this.chainId,nonce:this.nonce,maxPriorityFeePerGas:this.maxPriorityFeePerGas,maxFeePerGas:this.maxFeePerGas,gasLimit:this.gasLimit,to:this.to,value:this.value,data:this.data,accessList:this.accessList,v:e-BigInt(27),r:(0,n.bufferToBigInt)(t),s:(0,n.bufferToBigInt)(r)},i)}toJSON(){const e=o.AccessLists.getAccessListJSON(this.accessList);return{chainId:(0,n.bigIntToHex)(this.chainId),nonce:(0,n.bigIntToHex)(this.nonce),maxPriorityFeePerGas:(0,n.bigIntToHex)(this.maxPriorityFeePerGas),maxFeePerGas:(0,n.bigIntToHex)(this.maxFeePerGas),gasLimit:(0,n.bigIntToHex)(this.gasLimit),to:this.to!==undefined?this.to.toString():undefined,value:(0,n.bigIntToHex)(this.value),data:"0x"+this.data.toString("hex"),accessList:e,v:this.v!==undefined?(0,n.bigIntToHex)(this.v):undefined,r:this.r!==undefined?(0,n.bigIntToHex)(this.r):undefined,s:this.s!==undefined?(0,n.bigIntToHex)(this.s):undefined}}errorStr(){let e=this._getSharedErrorPostfix();return e+=` maxFeePerGas=${this.maxFeePerGas} maxPriorityFeePerGas=${this.maxPriorityFeePerGas}`,e}_errorMsg(e){return`${e} (${this.errorStr()})`}}r.FeeMarketEIP1559Transaction=c}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@ethereumjs/tx",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/node_modules/@ethereumjs/tx/dist/eip1559Transaction.js"}],[1915,{"./baseTransaction":1913,"./util":1921,"@ethereumjs/rlp":421,"@ethereumjs/util":1929,buffer:3028,"ethereum-cryptography/keccak":3260},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.AccessListEIP2930Transaction=void 0;const i=e("@ethereumjs/rlp"),n=e("@ethereumjs/util"),s=e("ethereum-cryptography/keccak"),a=e("./baseTransaction"),o=e("./util"),l=t.from(1..toString(16).padStart(2,"0"),"hex");class c extends a.BaseTransaction{constructor(e,t={}){super({...e,type:1},t),this.DEFAULT_HARDFORK="berlin";const{chainId:r,accessList:i,gasPrice:s}=e;if(this.common=this._getCommon(t.common,r),this.chainId=this.common.chainId(),!this.common.isActivatedEIP(2930))throw new Error("EIP-2930 not enabled on Common");this.activeCapabilities=this.activeCapabilities.concat([2718,2930]);const l=o.AccessLists.getAccessListData(i??[]);if(this.accessList=l.accessList,this.AccessListJSON=l.AccessListJSON,o.AccessLists.verifyAccessList(this.accessList),this.gasPrice=(0,n.bufferToBigInt)((0,n.toBuffer)(""===s?"0x":s)),this._validateCannotExceedMaxInteger({gasPrice:this.gasPrice}),a.BaseTransaction._validateNotArray(e),this.gasPrice*this.gasLimit>n.MAX_INTEGER){const e=this._errorMsg("gasLimit * gasPrice cannot exceed MAX_INTEGER");throw new Error(e)}this._validateYParity(),this._validateHighS();(t?.freeze??!0)&&Object.freeze(this)}static fromTxData(e,t={}){return new c(e,t)}static fromSerializedTx(e,t={}){if(!e.slice(0,1).equals(l))throw new Error(`Invalid serialized tx input: not an EIP-2930 transaction (wrong tx type, expected: 1, received: ${e.slice(0,1).toString("hex")}`);const r=(0,n.arrToBufArr)(i.RLP.decode(Uint8Array.from(e.slice(1))));if(!Array.isArray(r))throw new Error("Invalid serialized tx input: must be array");return c.fromValuesArray(r,t)}static fromValuesArray(e,t={}){if(8!==e.length&&11!==e.length)throw new Error("Invalid EIP-2930 transaction. Only expecting 8 values (for unsigned tx) or 11 values (for signed tx).");const[r,i,s,a,o,l,u,d,h,m,p]=e;this._validateNotArray({chainId:r,v:h}),(0,n.validateNoLeadingZeroes)({nonce:i,gasPrice:s,gasLimit:a,value:l,v:h,r:m,s:p});return new c({chainId:(0,n.bufferToBigInt)(r),nonce:i,gasPrice:s,gasLimit:a,to:o,value:l,data:u,accessList:d??[],v:h!==undefined?(0,n.bufferToBigInt)(h):undefined,r:m,s:p},t)}getDataFee(){if(this.cache.dataFee&&this.cache.dataFee.hardfork===this.common.hardfork())return this.cache.dataFee.value;let e=super.getDataFee();return e+=BigInt(o.AccessLists.getDataFeeEIP2930(this.accessList,this.common)),Object.isFrozen(this)&&(this.cache.dataFee={value:e,hardfork:this.common.hardfork()}),e}getUpfrontCost(){return this.gasLimit*this.gasPrice+this.value}raw(){return[(0,n.bigIntToUnpaddedBuffer)(this.chainId),(0,n.bigIntToUnpaddedBuffer)(this.nonce),(0,n.bigIntToUnpaddedBuffer)(this.gasPrice),(0,n.bigIntToUnpaddedBuffer)(this.gasLimit),this.to!==undefined?this.to.buf:t.from([]),(0,n.bigIntToUnpaddedBuffer)(this.value),this.data,this.accessList,this.v!==undefined?(0,n.bigIntToUnpaddedBuffer)(this.v):t.from([]),this.r!==undefined?(0,n.bigIntToUnpaddedBuffer)(this.r):t.from([]),this.s!==undefined?(0,n.bigIntToUnpaddedBuffer)(this.s):t.from([])]}serialize(){const e=this.raw();return t.concat([l,t.from(i.RLP.encode((0,n.bufArrToArr)(e)))])}getMessageToSign(e=!0){const r=this.raw().slice(0,8),a=t.concat([l,t.from(i.RLP.encode((0,n.bufArrToArr)(r)))]);return e?t.from((0,s.keccak256)(a)):a}hash(){if(!this.isSigned()){const e=this._errorMsg("Cannot call hash method if transaction is not signed");throw new Error(e)}return Object.isFrozen(this)?(this.cache.hash||(this.cache.hash=t.from((0,s.keccak256)(this.serialize()))),this.cache.hash):t.from((0,s.keccak256)(this.serialize()))}getMessageToVerifySignature(){return this.getMessageToSign()}getSenderPublicKey(){if(!this.isSigned()){const e=this._errorMsg("Cannot call this method if transaction is not signed");throw new Error(e)}const e=this.getMessageToVerifySignature(),{v:t,r:r,s:i}=this;this._validateHighS();try{return(0,n.ecrecover)(e,t+BigInt(27),(0,n.bigIntToUnpaddedBuffer)(r),(0,n.bigIntToUnpaddedBuffer)(i))}catch(e){const t=this._errorMsg("Invalid Signature");throw new Error(t)}}_processSignature(e,t,r){const i={...this.txOptions,common:this.common};return c.fromTxData({chainId:this.chainId,nonce:this.nonce,gasPrice:this.gasPrice,gasLimit:this.gasLimit,to:this.to,value:this.value,data:this.data,accessList:this.accessList,v:e-BigInt(27),r:(0,n.bufferToBigInt)(t),s:(0,n.bufferToBigInt)(r)},i)}toJSON(){const e=o.AccessLists.getAccessListJSON(this.accessList);return{chainId:(0,n.bigIntToHex)(this.chainId),nonce:(0,n.bigIntToHex)(this.nonce),gasPrice:(0,n.bigIntToHex)(this.gasPrice),gasLimit:(0,n.bigIntToHex)(this.gasLimit),to:this.to!==undefined?this.to.toString():undefined,value:(0,n.bigIntToHex)(this.value),data:"0x"+this.data.toString("hex"),accessList:e,v:this.v!==undefined?(0,n.bigIntToHex)(this.v):undefined,r:this.r!==undefined?(0,n.bigIntToHex)(this.r):undefined,s:this.s!==undefined?(0,n.bigIntToHex)(this.s):undefined}}errorStr(){let e=this._getSharedErrorPostfix();return e+=` gasPrice=${this.gasPrice} accessListCount=${this.accessList?.length??0}`,e}_errorMsg(e){return`${e} (${this.errorStr()})`}}r.AccessListEIP2930Transaction=c}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@ethereumjs/tx",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/node_modules/@ethereumjs/tx/dist/eip2930Transaction.js"}],[1916,{"@ethereumjs/util":1929},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.normalizeTxParams=void 0;const i=e("@ethereumjs/util");r.normalizeTxParams=e=>{const t=Object.assign({},e);return t.gasLimit=(0,i.toType)(t.gasLimit??t.gas,i.TypeOutput.BigInt),t.data=t.data===undefined?t.input:t.data,t.gasPrice=t.gasPrice!==undefined?BigInt(t.gasPrice):undefined,t.value=t.value!==undefined?BigInt(t.value):undefined,t.to=null!==t.to&&t.to!==undefined?(0,i.setLengthLeft)((0,i.toBuffer)(t.to),20):null,t.v="0x0"===t.v?"0x":t.v,t.r="0x0"===t.r?"0x":t.r,t.s="0x0"===t.s?"0x":t.s,"0x"!==t.v&&(t.v=(0,i.toType)(t.v,i.TypeOutput.BigInt)),t}}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@ethereumjs/tx",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/node_modules/@ethereumjs/tx/dist/fromRpc.js"}],[1917,{"./eip1559Transaction":1914,"./eip2930Transaction":1915,"./legacyTransaction":1918,"./transactionFactory":1919,"./types":1920},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var i=this&&this.__createBinding||(Object.create?function(e,t,r,i){i===undefined&&(i=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,i,n)}:function(e,t,r,i){i===undefined&&(i=r),e[i]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||i(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),r.TransactionFactory=r.Transaction=r.AccessListEIP2930Transaction=r.FeeMarketEIP1559Transaction=void 0;var s=e("./eip1559Transaction");Object.defineProperty(r,"FeeMarketEIP1559Transaction",{enumerable:!0,get:function(){return s.FeeMarketEIP1559Transaction}});var a=e("./eip2930Transaction");Object.defineProperty(r,"AccessListEIP2930Transaction",{enumerable:!0,get:function(){return a.AccessListEIP2930Transaction}});var o=e("./legacyTransaction");Object.defineProperty(r,"Transaction",{enumerable:!0,get:function(){return o.Transaction}});var l=e("./transactionFactory");Object.defineProperty(r,"TransactionFactory",{enumerable:!0,get:function(){return l.TransactionFactory}}),n(e("./types"),r)}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@ethereumjs/tx",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/node_modules/@ethereumjs/tx/dist/index.js"}],[1918,{"./baseTransaction":1913,"./types":1920,"@ethereumjs/rlp":421,"@ethereumjs/util":1929,buffer:3028,"ethereum-cryptography/keccak":3260},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.Transaction=void 0;const i=e("@ethereumjs/rlp"),n=e("@ethereumjs/util"),s=e("ethereum-cryptography/keccak"),a=e("./baseTransaction"),o=e("./types");function l(e,t){const r=Number(e),i=2*Number(t);return r===i+35||r===i+36}class c extends a.BaseTransaction{constructor(e,t={}){if(super({...e,type:0},t),this.common=this._validateTxV(this.v,t.common),this.gasPrice=(0,n.bufferToBigInt)((0,n.toBuffer)(""===e.gasPrice?"0x":e.gasPrice)),this.gasPrice*this.gasLimit>n.MAX_INTEGER){const e=this._errorMsg("gas limit * gasPrice cannot exceed MAX_INTEGER (2^256-1)");throw new Error(e)}this._validateCannotExceedMaxInteger({gasPrice:this.gasPrice}),a.BaseTransaction._validateNotArray(e),this.common.gteHardfork("spuriousDragon")&&(this.isSigned()?l(this.v,this.common.chainId())&&this.activeCapabilities.push(o.Capability.EIP155ReplayProtection):this.activeCapabilities.push(o.Capability.EIP155ReplayProtection));(t?.freeze??!0)&&Object.freeze(this)}static fromTxData(e,t={}){return new c(e,t)}static fromSerializedTx(e,t={}){const r=(0,n.arrToBufArr)(i.RLP.decode(Uint8Array.from(e)));if(!Array.isArray(r))throw new Error("Invalid serialized tx input. Must be array");return this.fromValuesArray(r,t)}static fromValuesArray(e,t={}){if(6!==e.length&&9!==e.length)throw new Error("Invalid transaction. Only expecting 6 values (for unsigned tx) or 9 values (for signed tx).");const[r,i,s,a,o,l,u,d,h]=e;return(0,n.validateNoLeadingZeroes)({nonce:r,gasPrice:i,gasLimit:s,value:o,v:u,r:d,s:h}),new c({nonce:r,gasPrice:i,gasLimit:s,to:a,value:o,data:l,v:u,r:d,s:h},t)}raw(){return[(0,n.bigIntToUnpaddedBuffer)(this.nonce),(0,n.bigIntToUnpaddedBuffer)(this.gasPrice),(0,n.bigIntToUnpaddedBuffer)(this.gasLimit),this.to!==undefined?this.to.buf:t.from([]),(0,n.bigIntToUnpaddedBuffer)(this.value),this.data,this.v!==undefined?(0,n.bigIntToUnpaddedBuffer)(this.v):t.from([]),this.r!==undefined?(0,n.bigIntToUnpaddedBuffer)(this.r):t.from([]),this.s!==undefined?(0,n.bigIntToUnpaddedBuffer)(this.s):t.from([])]}serialize(){return t.from(i.RLP.encode((0,n.bufArrToArr)(this.raw())))}_getMessageToSign(){const e=[(0,n.bigIntToUnpaddedBuffer)(this.nonce),(0,n.bigIntToUnpaddedBuffer)(this.gasPrice),(0,n.bigIntToUnpaddedBuffer)(this.gasLimit),this.to!==undefined?this.to.buf:t.from([]),(0,n.bigIntToUnpaddedBuffer)(this.value),this.data];return this.supports(o.Capability.EIP155ReplayProtection)&&(e.push((0,n.bigIntToUnpaddedBuffer)(this.common.chainId())),e.push((0,n.unpadBuffer)((0,n.toBuffer)(0))),e.push((0,n.unpadBuffer)((0,n.toBuffer)(0)))),e}getMessageToSign(e=!0){const r=this._getMessageToSign();return e?t.from((0,s.keccak256)(i.RLP.encode((0,n.bufArrToArr)(r)))):r}getDataFee(){return this.cache.dataFee&&this.cache.dataFee.hardfork===this.common.hardfork()?this.cache.dataFee.value:(Object.isFrozen(this)&&(this.cache.dataFee={value:super.getDataFee(),hardfork:this.common.hardfork()}),super.getDataFee())}getUpfrontCost(){return this.gasLimit*this.gasPrice+this.value}hash(){if(!this.isSigned()){const e=this._errorMsg("Cannot call hash method if transaction is not signed");throw new Error(e)}return Object.isFrozen(this)?(this.cache.hash||(this.cache.hash=t.from((0,s.keccak256)(i.RLP.encode((0,n.bufArrToArr)(this.raw()))))),this.cache.hash):t.from((0,s.keccak256)(i.RLP.encode((0,n.bufArrToArr)(this.raw()))))}getMessageToVerifySignature(){if(!this.isSigned()){const e=this._errorMsg("This transaction is not signed");throw new Error(e)}const e=this._getMessageToSign();return t.from((0,s.keccak256)(i.RLP.encode((0,n.bufArrToArr)(e))))}getSenderPublicKey(){const e=this.getMessageToVerifySignature(),{v:t,r:r,s:i}=this;this._validateHighS();try{return(0,n.ecrecover)(e,t,(0,n.bigIntToUnpaddedBuffer)(r),(0,n.bigIntToUnpaddedBuffer)(i),this.supports(o.Capability.EIP155ReplayProtection)?this.common.chainId():undefined)}catch(e){const t=this._errorMsg("Invalid Signature");throw new Error(t)}}_processSignature(e,t,r){this.supports(o.Capability.EIP155ReplayProtection)&&(e+=this.common.chainId()*BigInt(2)+BigInt(8));const i={...this.txOptions,common:this.common};return c.fromTxData({nonce:this.nonce,gasPrice:this.gasPrice,gasLimit:this.gasLimit,to:this.to,value:this.value,data:this.data,v:e,r:(0,n.bufferToBigInt)(t),s:(0,n.bufferToBigInt)(r)},i)}toJSON(){return{nonce:(0,n.bigIntToHex)(this.nonce),gasPrice:(0,n.bigIntToHex)(this.gasPrice),gasLimit:(0,n.bigIntToHex)(this.gasLimit),to:this.to!==undefined?this.to.toString():undefined,value:(0,n.bigIntToHex)(this.value),data:"0x"+this.data.toString("hex"),v:this.v!==undefined?(0,n.bigIntToHex)(this.v):undefined,r:this.r!==undefined?(0,n.bigIntToHex)(this.r):undefined,s:this.s!==undefined?(0,n.bigIntToHex)(this.s):undefined}}_validateTxV(e,t){let r;const i=e!==undefined?Number(e):undefined;if(i!==undefined&&i<37&&27!==i&&28!==i)throw new Error(`Legacy txs need either v = 27/28 or v >= 37 (EIP-155 replay protection), got v = ${i}`);if(i!==undefined&&0!==i&&(!t||t.gteHardfork("spuriousDragon"))&&27!==i&&28!==i)if(t){if(!l(BigInt(i),t.chainId()))throw new Error(`Incompatible EIP155-based V ${i} and chain id ${t.chainId()}. See the Common parameter of the Transaction constructor to set the chain id.`)}else{let e;e=(i-35)%2==0?35:36,r=BigInt(i-e)/BigInt(2)}return this._getCommon(t,r)}errorStr(){let e=this._getSharedErrorPostfix();return e+=` gasPrice=${this.gasPrice}`,e}_errorMsg(e){return`${e} (${this.errorStr()})`}}r.Transaction=c}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@ethereumjs/tx",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/node_modules/@ethereumjs/tx/dist/legacyTransaction.js"}],[1919,{"../../../../../../../../../is-buffer/index.js":3648,"./eip1559Transaction":1914,"./eip2930Transaction":1915,"./fromRpc":1916,"./legacyTransaction":1918,"@ethereumjs/util":1929},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.TransactionFactory=void 0;const i=e("@ethereumjs/util"),n=e("./eip1559Transaction"),s=e("./eip2930Transaction"),a=e("./fromRpc"),o=e("./legacyTransaction");class l{constructor(){}static fromTxData(e,t={}){if("type"in e&&e.type!==undefined){const r=Number((0,i.bufferToBigInt)((0,i.toBuffer)(e.type)));if(0===r)return o.Transaction.fromTxData(e,t);if(1===r)return s.AccessListEIP2930Transaction.fromTxData(e,t);if(2===r)return n.FeeMarketEIP1559Transaction.fromTxData(e,t);throw new Error(`Tx instantiation with type ${r} not supported`)}return o.Transaction.fromTxData(e,t)}static fromSerializedData(e,t={}){if(!(e[0]<=127))return o.Transaction.fromSerializedTx(e,t);switch(e[0]){case 1:return s.AccessListEIP2930Transaction.fromSerializedTx(e,t);case 2:return n.FeeMarketEIP1559Transaction.fromSerializedTx(e,t);default:throw new Error(`TypedTransaction with ID ${e[0]} unknown`)}}static fromBlockBodyData(e,r={}){if(t.isBuffer(e))return this.fromSerializedData(e,r);if(Array.isArray(e))return o.Transaction.fromValuesArray(e,r);throw new Error("Cannot decode transaction: unknown type input")}static async fromEthersProvider(e,t,r){const n=(0,i.getProvider)(e),s=await(0,i.fetchFromProvider)(n,{method:"eth_getTransactionByHash",params:[t]});if(null===s)throw new Error("No data returned from provider");return l.fromRPCTx(s,r)}static async fromRPCTx(e,t={}){return l.fromTxData((0,a.normalizeTxParams)(e),t)}}r.TransactionFactory=l}).call(this)}).call(this,{isBuffer:e("../../../../../../../../../is-buffer/index.js")})}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@ethereumjs/tx",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/node_modules/@ethereumjs/tx/dist/transactionFactory.js"}],[192,{lodash:3836},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=e("lodash");r.default={version:72,async migrate(e){const t=(0,i.cloneDeep)(e);t.meta.version=72;const r=function(e){const t=(null==e?void 0:e.PreferencesController)||{};return{...e,PreferencesController:{...t,knownMethodData:{}}}}(t.data);return t.data=r,t}}}}},{package:"$root$",file:"app/scripts/migrations/072.js"}],[1920,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){function i(e){if(0===e.length)return!0;const t=e[0];return!!Array.isArray(t)}Object.defineProperty(r,"__esModule",{value:!0}),r.isAccessList=r.isAccessListBuffer=r.Capability=void 0,function(e){e[e.EIP155ReplayProtection=155]="EIP155ReplayProtection",e[e.EIP1559FeeMarket=1559]="EIP1559FeeMarket",e[e.EIP2718TypedTransaction=2718]="EIP2718TypedTransaction",e[e.EIP2930AccessLists=2930]="EIP2930AccessLists"}(r.Capability||(r.Capability={})),r.isAccessListBuffer=i,r.isAccessList=function(e){return!i(e)}}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@ethereumjs/tx",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/node_modules/@ethereumjs/tx/dist/types.js"}],[1921,{"./types":1920,"@ethereumjs/util":1929},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.AccessLists=r.checkMaxInitCodeSize=void 0;const i=e("@ethereumjs/util"),n=e("./types");r.checkMaxInitCodeSize=function(e,t){const r=e.param("vm","maxInitCodeSize");if(r&&BigInt(t)>r)throw new Error(`the initcode size of this transaction is too large: it is ${t} while the max is ${e.param("vm","maxInitCodeSize")}`)};r.AccessLists=class{static getAccessListData(e){let t,r;if((0,n.isAccessList)(e)){t=e;const n=[];for(let t=0;t<e.length;t++){const r=e[t],s=(0,i.toBuffer)(r.address),a=[];for(let e=0;e<r.storageKeys.length;e++)a.push((0,i.toBuffer)(r.storageKeys[e]));n.push([s,a])}r=n}else{r=e??[];const n=[];for(let e=0;e<r.length;e++){const t=r[e],s=(0,i.bufferToHex)(t[0]),a=[];for(let e=0;e<t[1].length;e++)a.push((0,i.bufferToHex)(t[1][e]));const o={address:s,storageKeys:a};n.push(o)}t=n}return{AccessListJSON:t,accessList:r}}static verifyAccessList(e){for(let t=0;t<e.length;t++){const r=e[t],i=r[0],n=r[1];if(r[2]!==undefined)throw new Error("Access list item cannot have 3 elements. It can only have an address, and an array of storage slots.");if(20!==i.length)throw new Error("Invalid EIP-2930 transaction: address length should be 20 bytes");for(let e=0;e<n.length;e++)if(32!==n[e].length)throw new Error("Invalid EIP-2930 transaction: storage slot length should be 32 bytes")}}static getAccessListJSON(e){const t=[];for(let r=0;r<e.length;r++){const n=e[r],s={address:"0x"+(0,i.setLengthLeft)(n[0],20).toString("hex"),storageKeys:[]},a=n[1];for(let e=0;e<a.length;e++){const t=a[e];s.storageKeys.push("0x"+(0,i.setLengthLeft)(t,32).toString("hex"))}t.push(s)}return t}static getDataFeeEIP2930(e,t){const r=t.param("gasPrices","accessListStorageKeyCost"),i=t.param("gasPrices","accessListAddressCost");let n=0;for(let t=0;t<e.length;t++){n+=e[t][1].length}return e.length*Number(i)+n*Number(r)}}}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@ethereumjs/tx",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/node_modules/@ethereumjs/tx/dist/util.js"}],[1922,{"./bytes":1925,"./constants":1926,"./helpers":1928,"./internal":1930,"@ethereumjs/rlp":421,buffer:3028,"ethereum-cryptography/keccak":3260,"ethereum-cryptography/secp256k1":3277,"ethereum-cryptography/utils":3279},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.accountBodyToRLP=r.accountBodyToSlim=r.accountBodyFromSlim=r.isZeroAddress=r.zeroAddress=r.importPublic=r.privateToAddress=r.privateToPublic=r.publicToAddress=r.pubToAddress=r.isValidPublic=r.isValidPrivate=r.generateAddress2=r.generateAddress=r.isValidChecksumAddress=r.toChecksumAddress=r.isValidAddress=r.Account=void 0;const i=e("@ethereumjs/rlp"),n=e("ethereum-cryptography/keccak"),s=e("ethereum-cryptography/secp256k1"),a=e("ethereum-cryptography/utils"),o=e("./bytes"),l=e("./constants"),c=e("./helpers"),u=e("./internal"),d=BigInt(0);class h{constructor(e=d,t=d,r=l.KECCAK256_RLP,i=l.KECCAK256_NULL){this.nonce=e,this.balance=t,this.storageRoot=r,this.codeHash=i,this._validate()}static fromAccountData(e){const{nonce:t,balance:r,storageRoot:i,codeHash:n}=e;return new h(t!==undefined?(0,o.bufferToBigInt)((0,o.toBuffer)(t)):undefined,r!==undefined?(0,o.bufferToBigInt)((0,o.toBuffer)(r)):undefined,i!==undefined?(0,o.toBuffer)(i):undefined,n!==undefined?(0,o.toBuffer)(n):undefined)}static fromRlpSerializedAccount(e){const t=(0,o.arrToBufArr)(i.RLP.decode(Uint8Array.from(e)));if(!Array.isArray(t))throw new Error("Invalid serialized account input. Must be array");return this.fromValuesArray(t)}static fromValuesArray(e){const[t,r,i,n]=e;return new h((0,o.bufferToBigInt)(t),(0,o.bufferToBigInt)(r),i,n)}_validate(){if(this.nonce<d)throw new Error("nonce must be greater than zero");if(this.balance<d)throw new Error("balance must be greater than zero");if(32!==this.storageRoot.length)throw new Error("storageRoot must have a length of 32");if(32!==this.codeHash.length)throw new Error("codeHash must have a length of 32")}raw(){return[(0,o.bigIntToUnpaddedBuffer)(this.nonce),(0,o.bigIntToUnpaddedBuffer)(this.balance),this.storageRoot,this.codeHash]}serialize(){return t.from(i.RLP.encode((0,o.bufArrToArr)(this.raw())))}isContract(){return!this.codeHash.equals(l.KECCAK256_NULL)}isEmpty(){return this.balance===d&&this.nonce===d&&this.codeHash.equals(l.KECCAK256_NULL)}}r.Account=h;r.isValidAddress=function(e){try{(0,c.assertIsString)(e)}catch(e){return!1}return/^0x[0-9a-fA-F]{40}$/.test(e)};r.toChecksumAddress=function(e,r){(0,c.assertIsHexString)(e);const i=(0,u.stripHexPrefix)(e).toLowerCase();let s="";if(r!==undefined){s=(0,o.bufferToBigInt)((0,o.toBuffer)(r)).toString()+"0x"}const l=t.from(s+i,"utf8"),d=(0,a.bytesToHex)((0,n.keccak256)(l));let h="0x";for(let e=0;e<i.length;e++)parseInt(d[e],16)>=8?h+=i[e].toUpperCase():h+=i[e];return h};r.isValidChecksumAddress=function(e,t){return(0,r.isValidAddress)(e)&&(0,r.toChecksumAddress)(e,t)===e};r.generateAddress=function(e,r){return(0,c.assertIsBuffer)(e),(0,c.assertIsBuffer)(r),(0,o.bufferToBigInt)(r)===BigInt(0)?t.from((0,n.keccak256)(i.RLP.encode((0,o.bufArrToArr)([e,null])))).slice(-20):t.from((0,n.keccak256)(i.RLP.encode((0,o.bufArrToArr)([e,r])))).slice(-20)};r.generateAddress2=function(e,r,i){if((0,c.assertIsBuffer)(e),(0,c.assertIsBuffer)(r),(0,c.assertIsBuffer)(i),20!==e.length)throw new Error("Expected from to be of length 20");if(32!==r.length)throw new Error("Expected salt to be of length 32");const s=(0,n.keccak256)(t.concat([t.from("ff","hex"),e,r,(0,n.keccak256)(i)]));return(0,o.toBuffer)(s).slice(-20)};r.isValidPrivate=function(e){return s.secp256k1.utils.isValidPrivateKey(e)};r.isValidPublic=function(e,r=!1){if((0,c.assertIsBuffer)(e),64===e.length)try{return s.secp256k1.ProjectivePoint.fromHex(t.concat([t.from([4]),e])),!0}catch(e){return!1}if(!r)return!1;try{return s.secp256k1.ProjectivePoint.fromHex(e),!0}catch(e){return!1}};r.pubToAddress=function(e,r=!1){if((0,c.assertIsBuffer)(e),r&&64!==e.length&&(e=t.from(s.secp256k1.ProjectivePoint.fromHex(e).toRawBytes(!1).slice(1))),64!==e.length)throw new Error("Expected pubKey to be of length 64");return t.from((0,n.keccak256)(e)).slice(-20)},r.publicToAddress=r.pubToAddress;r.privateToPublic=function(e){return(0,c.assertIsBuffer)(e),t.from(s.secp256k1.ProjectivePoint.fromPrivateKey(e).toRawBytes(!1).slice(1))};r.privateToAddress=function(e){return(0,r.publicToAddress)((0,r.privateToPublic)(e))};r.importPublic=function(e){return(0,c.assertIsBuffer)(e),64!==e.length&&(e=t.from(s.secp256k1.ProjectivePoint.fromHex(e).toRawBytes(!1).slice(1))),e};r.zeroAddress=function(){const e=(0,o.zeros)(20);return(0,o.bufferToHex)(e)};function m(e){const[t,r,i,n]=e;return[t,r,0===(0,o.arrToBufArr)(i).length?l.KECCAK256_RLP:i,0===(0,o.arrToBufArr)(n).length?l.KECCAK256_NULL:n]}r.isZeroAddress=function(e){try{(0,c.assertIsString)(e)}catch(e){return!1}return(0,r.zeroAddress)()===e},r.accountBodyFromSlim=m;const p=new Uint8Array(0);r.accountBodyToSlim=function(e){const[t,r,i,n]=e;return[t,r,(0,o.arrToBufArr)(i).equals(l.KECCAK256_RLP)?p:i,(0,o.arrToBufArr)(n).equals(l.KECCAK256_NULL)?p:n]},r.accountBodyToRLP=function(e,t=!0){const r=t?m(e):e;return(0,o.arrToBufArr)(i.RLP.encode(r))}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@ethereumjs/util",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/node_modules/@ethereumjs/util/dist/account.js"}],[1923,{"./account":1922,"./bytes":1925,buffer:3028},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.Address=void 0;const i=e("./account"),n=e("./bytes");class s{constructor(e){if(20!==e.length)throw new Error("Invalid address length");this.buf=e}static zero(){return new s((0,n.zeros)(20))}static fromString(e){if(!(0,i.isValidAddress)(e))throw new Error("Invalid address");return new s((0,n.toBuffer)(e))}static fromPublicKey(e){if(!t.isBuffer(e))throw new Error("Public key should be Buffer");const r=(0,i.pubToAddress)(e);return new s(r)}static fromPrivateKey(e){if(!t.isBuffer(e))throw new Error("Private key should be Buffer");const r=(0,i.privateToAddress)(e);return new s(r)}static generate(e,t){if("bigint"!=typeof t)throw new Error("Expected nonce to be a bigint");return new s((0,i.generateAddress)(e.buf,(0,n.bigIntToBuffer)(t)))}static generate2(e,r,n){if(!t.isBuffer(r))throw new Error("Expected salt to be a Buffer");if(!t.isBuffer(n))throw new Error("Expected initCode to be a Buffer");return new s((0,i.generateAddress2)(e.buf,r,n))}equals(e){return this.buf.equals(e.buf)}isZero(){return this.equals(s.zero())}isPrecompileOrSystemAddress(){const e=(0,n.bufferToBigInt)(this.buf),t=BigInt(0),r=BigInt("0xffff");return e>=t&&e<=r}toString(){return"0x"+this.buf.toString("hex")}toBuffer(){return t.from(this.buf)}}r.Address=s}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@ethereumjs/util",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/node_modules/@ethereumjs/util/dist/address.js"}],[1924,{events:3328},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.AsyncEventEmitter=void 0;const i=e("events");class n extends i.EventEmitter{emit(e,...t){let[r,i]=t;const n=this;let s=n._events[e]??[];return i===undefined&&"function"==typeof r&&(i=r,r=undefined),"newListener"!==e&&"removeListener"!==e||(r={event:r,fn:i},i=undefined),s=Array.isArray(s)?s:[s],async function(e,t,r){let i;for await(const n of t)try{n.length<2?n.call(e,r):await new Promise(((t,i)=>{n.call(e,r,(e=>{e?i(e):t()}))}))}catch(e){i=e}if(i)throw i}(n,s.slice(),r).then(i).catch(i),n.listenerCount(e)>0}once(e,t){const r=this;let i;if("function"!=typeof t)throw new TypeError("listener must be a function");return i=t.length>=2?function(n,s){r.removeListener(e,i),t(n,s)}:function(n){r.removeListener(e,i),t(n,i)},r.on(e,i),r}first(e,t){let r=this._events[e]??[];if("function"!=typeof t)throw new TypeError("listener must be a function");return Array.isArray(r)||(this._events[e]=r=[r]),r.unshift(t),this}before(e,t,r){return this.beforeOrAfter(e,t,r)}after(e,t,r){return this.beforeOrAfter(e,t,r,"after")}beforeOrAfter(e,t,r,i){let n,s,a=this._events[e]??[];const o="after"===i?1:0;if("function"!=typeof r)throw new TypeError("listener must be a function");if("function"!=typeof t)throw new TypeError("target must be a function");for(Array.isArray(a)||(this._events[e]=a=[a]),s=a.length,n=a.length;n--;)if(a[n]===t){s=n+o;break}return a.splice(s,0,r),this}on(e,t){return super.on(e,t)}addListener(e,t){return super.addListener(e,t)}prependListener(e,t){return super.prependListener(e,t)}prependOnceListener(e,t){return super.prependOnceListener(e,t)}removeAllListeners(e){return super.removeAllListeners(e)}removeListener(e,t){return super.removeListener(e,t)}eventNames(){return super.eventNames()}listeners(e){return super.listeners(e)}listenerCount(e){return super.listenerCount(e)}getMaxListeners(){return super.getMaxListeners()}setMaxListeners(e){return super.setMaxListeners(e)}}r.AsyncEventEmitter=n}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@ethereumjs/util",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/node_modules/@ethereumjs/util/dist/asyncEventEmitter.js"}],[1925,{"./helpers":1928,"./internal":1930,buffer:3028},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.intToUnpaddedBuffer=r.bigIntToUnpaddedBuffer=r.bigIntToHex=r.bufArrToArr=r.arrToBufArr=r.validateNoLeadingZeroes=r.baToJSON=r.toUtf8=r.short=r.addHexPrefix=r.toUnsigned=r.fromSigned=r.bufferToInt=r.bigIntToBuffer=r.bufferToBigInt=r.bufferToHex=r.toBuffer=r.unpadHexString=r.unpadArray=r.unpadBuffer=r.setLengthRight=r.setLengthLeft=r.zeros=r.intToBuffer=r.intToHex=void 0;const i=e("./helpers"),n=e("./internal");r.intToHex=function(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`Received an invalid integer type: ${e}`);return`0x${e.toString(16)}`};r.intToBuffer=function(e){const i=(0,r.intToHex)(e);return t.from((0,n.padToEven)(i.slice(2)),"hex")};r.zeros=function(e){return t.allocUnsafe(e).fill(0)};const s=function(e,t,i){const n=(0,r.zeros)(t);return i?e.length<t?(e.copy(n),n):e.slice(0,t):e.length<t?(e.copy(n,t-e.length),n):e.slice(-t)};r.setLengthLeft=function(e,t){return(0,i.assertIsBuffer)(e),s(e,t,!1)};r.setLengthRight=function(e,t){return(0,i.assertIsBuffer)(e),s(e,t,!0)};const a=function(e){let t=e[0];for(;e.length>0&&"0"===t.toString();)t=(e=e.slice(1))[0];return e};r.unpadBuffer=function(e){return(0,i.assertIsBuffer)(e),a(e)};r.unpadArray=function(e){return(0,i.assertIsArray)(e),a(e)};r.unpadHexString=function(e){return(0,i.assertIsHexString)(e),e=(0,n.stripHexPrefix)(e),"0x"+a(e)};r.toBuffer=function(e){if(null===e||e===undefined)return t.allocUnsafe(0);if(t.isBuffer(e))return t.from(e);if(Array.isArray(e)||e instanceof Uint8Array)return t.from(e);if("string"==typeof e){if(!(0,n.isHexString)(e))throw new Error(`Cannot convert string to buffer. toBuffer only supports 0x-prefixed hex strings and this string was given: ${e}`);return t.from((0,n.padToEven)((0,n.stripHexPrefix)(e)),"hex")}if("number"==typeof e)return(0,r.intToBuffer)(e);if("bigint"==typeof e){if(e<BigInt(0))throw new Error(`Cannot convert negative bigint to buffer. Given: ${e}`);let r=e.toString(16);return r.length%2&&(r="0"+r),t.from(r,"hex")}if(e.toArray)return t.from(e.toArray());if(e.toBuffer)return t.from(e.toBuffer());throw new Error("invalid type")};function o(e){const t=(0,r.bufferToHex)(e);return"0x"===t?BigInt(0):BigInt(t)}function l(e){return(0,r.toBuffer)("0x"+e.toString(16))}r.bufferToHex=function(e){return"0x"+(e=(0,r.toBuffer)(e)).toString("hex")},r.bufferToBigInt=o,r.bigIntToBuffer=l;r.bufferToInt=function(e){const t=Number(o(e));if(!Number.isSafeInteger(t))throw new Error("Number exceeds 53 bits");return t};r.fromSigned=function(e){return BigInt.asIntN(256,o(e))};r.toUnsigned=function(e){return l(BigInt.asUintN(256,e))};r.addHexPrefix=function(e){return"string"!=typeof e||(0,n.isHexPrefixed)(e)?e:"0x"+e},r.short=function(e,r=50){const i=t.isBuffer(e)?e.toString("hex"):e;return i.length<=r?i:i.slice(0,r)+"…"};r.toUtf8=function(e){if((e=(0,n.stripHexPrefix)(e)).length%2!=0)throw new Error("Invalid non-even hex string input for toUtf8() provided");return t.from(e.replace(/^(00)+|(00)+$/g,""),"hex").toString("utf8")};r.baToJSON=function(e){if(t.isBuffer(e))return`0x${e.toString("hex")}`;if(e instanceof Array){const t=[];for(let i=0;i<e.length;i++)t.push((0,r.baToJSON)(e[i]));return t}};r.validateNoLeadingZeroes=function(e){for(const[t,r]of Object.entries(e))if(r!==undefined&&r.length>0&&0===r[0])throw new Error(`${t} cannot have leading zeroes, received: ${r.toString("hex")}`)},r.arrToBufArr=function e(r){return Array.isArray(r)?r.map((t=>e(t))):t.from(r)},r.bufArrToArr=function e(t){return Array.isArray(t)?t.map((t=>e(t))):Uint8Array.from(t??[])};r.bigIntToHex=e=>"0x"+e.toString(16),r.bigIntToUnpaddedBuffer=function(e){return(0,r.unpadBuffer)(l(e))},r.intToUnpaddedBuffer=function(e){return(0,r.unpadBuffer)((0,r.intToBuffer)(e))}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@ethereumjs/util",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/node_modules/@ethereumjs/util/dist/bytes.js"}],[1926,{buffer:3028,"ethereum-cryptography/secp256k1":3277},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.MAX_WITHDRAWALS_PER_PAYLOAD=r.RLP_EMPTY_STRING=r.KECCAK256_RLP=r.KECCAK256_RLP_S=r.KECCAK256_RLP_ARRAY=r.KECCAK256_RLP_ARRAY_S=r.KECCAK256_NULL=r.KECCAK256_NULL_S=r.TWO_POW256=r.SECP256K1_ORDER_DIV_2=r.SECP256K1_ORDER=r.MAX_INTEGER_BIGINT=r.MAX_INTEGER=r.MAX_UINT64=void 0;const i=e("buffer"),n=e("ethereum-cryptography/secp256k1");r.MAX_UINT64=BigInt("0xffffffffffffffff"),r.MAX_INTEGER=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),r.MAX_INTEGER_BIGINT=BigInt("115792089237316195423570985008687907853269984665640564039457584007913129639935"),r.SECP256K1_ORDER=n.secp256k1.CURVE.n,r.SECP256K1_ORDER_DIV_2=n.secp256k1.CURVE.n/BigInt(2),r.TWO_POW256=BigInt("0x10000000000000000000000000000000000000000000000000000000000000000"),r.KECCAK256_NULL_S="c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470",r.KECCAK256_NULL=i.Buffer.from(r.KECCAK256_NULL_S,"hex"),r.KECCAK256_RLP_ARRAY_S="1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347",r.KECCAK256_RLP_ARRAY=i.Buffer.from(r.KECCAK256_RLP_ARRAY_S,"hex"),r.KECCAK256_RLP_S="56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421",r.KECCAK256_RLP=i.Buffer.from(r.KECCAK256_RLP_S,"hex"),r.RLP_EMPTY_STRING=i.Buffer.from([128]),r.MAX_WITHDRAWALS_PER_PAYLOAD=16}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@ethereumjs/util",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/node_modules/@ethereumjs/util/dist/constants.js"}],[1927,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.compactBytesToNibbles=r.bytesToNibbles=r.nibblesToCompactBytes=r.nibblesToBytes=r.hasTerminator=void 0;r.hasTerminator=e=>e.length>0&&16===e[e.length-1];r.nibblesToBytes=(e,t)=>{for(let r=0,i=0;i<e.length;r+=1,i+=2)t[r]=e[i]<<4|e[i+1]};r.nibblesToCompactBytes=e=>{let t=0;(0,r.hasTerminator)(e)&&(t=1,e=e.subarray(0,e.length-1));const i=new Uint8Array(e.length/2+1);return i[0]=t<<5,1&~e.length||(i[0]|=16,i[0]|=e[0],e=e.subarray(1)),(0,r.nibblesToBytes)(e,i.subarray(1)),i};r.bytesToNibbles=e=>{const t=2*e.length+1,r=new Uint8Array(t);for(let t=0;t<e.length;t++){const i=e[t];r[2*t]=i/16,r[2*t+1]=i%16}return r[t-1]=16,r};r.compactBytesToNibbles=e=>{if(0===e.length)return e;let t=(0,r.bytesToNibbles)(e);t[0]<2&&(t=t.subarray(0,t.length-1));const i=2-(1&t[0]);return t.subarray(i)}}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@ethereumjs/util",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/node_modules/@ethereumjs/util/dist/encoding.js"}],[1928,{"../../../../../../../../../is-buffer/index.js":3648,"./internal":1930},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.assertIsString=r.assertIsArray=r.assertIsBuffer=r.assertIsHexString=void 0;const i=e("./internal");r.assertIsHexString=function(e){if(!(0,i.isHexString)(e)){throw new Error(`This method only supports 0x-prefixed hex strings but input was: ${e}`)}};r.assertIsBuffer=function(e){if(!t.isBuffer(e)){throw new Error(`This method only supports Buffer but input was: ${e}`)}};r.assertIsArray=function(e){if(!Array.isArray(e)){throw new Error(`This method only supports number arrays but input was: ${e}`)}};r.assertIsString=function(e){if("string"!=typeof e){throw new Error(`This method only supports strings but input was: ${e}`)}}}).call(this)}).call(this,{isBuffer:e("../../../../../../../../../is-buffer/index.js")})}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@ethereumjs/util",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/node_modules/@ethereumjs/util/dist/helpers.js"}],[1929,{"./account":1922,"./address":1923,"./asyncEventEmitter":1924,"./bytes":1925,"./constants":1926,"./encoding":1927,"./internal":1930,"./lock":1931,"./provider":1932,"./signature":1933,"./types":1934,"./units":1935,"./withdrawal":1936},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var i=this&&this.__createBinding||(Object.create?function(e,t,r,i){i===undefined&&(i=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,i,n)}:function(e,t,r,i){i===undefined&&(i=r),e[i]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||i(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),r.toAscii=r.stripHexPrefix=r.padToEven=r.isHexString=r.isHexPrefixed=r.getKeys=r.getBinarySize=r.fromUtf8=r.fromAscii=r.arrayContainsArray=void 0,n(e("./constants"),r),n(e("./units"),r),n(e("./account"),r),n(e("./address"),r),n(e("./withdrawal"),r),n(e("./signature"),r),n(e("./bytes"),r),n(e("./types"),r),n(e("./encoding"),r),n(e("./asyncEventEmitter"),r);var s=e("./internal");Object.defineProperty(r,"arrayContainsArray",{enumerable:!0,get:function(){return s.arrayContainsArray}}),Object.defineProperty(r,"fromAscii",{enumerable:!0,get:function(){return s.fromAscii}}),Object.defineProperty(r,"fromUtf8",{enumerable:!0,get:function(){return s.fromUtf8}}),Object.defineProperty(r,"getBinarySize",{enumerable:!0,get:function(){return s.getBinarySize}}),Object.defineProperty(r,"getKeys",{enumerable:!0,get:function(){return s.getKeys}}),Object.defineProperty(r,"isHexPrefixed",{enumerable:!0,get:function(){return s.isHexPrefixed}}),Object.defineProperty(r,"isHexString",{enumerable:!0,get:function(){return s.isHexString}}),Object.defineProperty(r,"padToEven",{enumerable:!0,get:function(){return s.padToEven}}),Object.defineProperty(r,"stripHexPrefix",{enumerable:!0,get:function(){return s.stripHexPrefix}}),Object.defineProperty(r,"toAscii",{enumerable:!0,get:function(){return s.toAscii}}),n(e("./lock"),r),n(e("./provider"),r)}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@ethereumjs/util",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/node_modules/@ethereumjs/util/dist/index.js"}],[193,{lodash:3836},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=e("lodash");r.default={version:73,async migrate(e){const t=(0,i.cloneDeep)(e);t.meta.version=73;const r=function(e){const t=(null==e?void 0:e.PreferencesController)||{};return{...e,PreferencesController:{...t,knownMethodData:{}}}}(t.data);return t.data=r,t}}}}},{package:"$root$",file:"app/scripts/migrations/073.js"}],[1930,{buffer:3028},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(e){(function(){function t(e){if("string"!=typeof e)throw new Error("[isHexPrefixed] input must be type 'string', received type "+typeof e);return"0"===e[0]&&"x"===e[1]}Object.defineProperty(r,"__esModule",{value:!0}),r.isHexString=r.getKeys=r.fromAscii=r.fromUtf8=r.toAscii=r.arrayContainsArray=r.getBinarySize=r.padToEven=r.stripHexPrefix=r.isHexPrefixed=void 0,r.isHexPrefixed=t;function i(e){let t=e;if("string"!=typeof t)throw new Error("[padToEven] value must be type 'string', received "+typeof t);return t.length%2&&(t=`0${t}`),t}r.stripHexPrefix=e=>{if("string"!=typeof e)throw new Error("[stripHexPrefix] input must be type 'string', received "+typeof e);return t(e)?e.slice(2):e},r.padToEven=i,r.getBinarySize=function(t){if("string"!=typeof t)throw new Error("[getBinarySize] method requires input type 'string', received "+typeof t);return e.byteLength(t,"utf8")},r.arrayContainsArray=function(e,t,r){if(!0!==Array.isArray(e))throw new Error(`[arrayContainsArray] method requires input 'superset' to be an array, got type '${typeof e}'`);if(!0!==Array.isArray(t))throw new Error(`[arrayContainsArray] method requires input 'subset' to be an array, got type '${typeof t}'`);return t[!0===r?"some":"every"]((t=>e.indexOf(t)>=0))},r.toAscii=function(e){let t="",r=0;const i=e.length;for("0x"===e.substring(0,2)&&(r=2);r<i;r+=2){const i=parseInt(e.substr(r,2),16);t+=String.fromCharCode(i)}return t},r.fromUtf8=function(t){return`0x${i(e.from(t,"utf8").toString("hex")).replace(/^0+|0+$/g,"")}`},r.fromAscii=function(e){let t="";for(let r=0;r<e.length;r++){const i=e.charCodeAt(r).toString(16);t+=i.length<2?`0${i}`:i}return`0x${t}`},r.getKeys=function(e,t,r){if(!Array.isArray(e))throw new Error("[getKeys] method expects input 'params' to be an array, got "+typeof e);if("string"!=typeof t)throw new Error("[getKeys] method expects input 'key' to be type 'string', got "+typeof e);const i=[];for(let n=0;n<e.length;n++){let s=e[n][t];if(!0!==r||s){if("string"!=typeof s)throw new Error("invalid abi - expected type 'string', received "+typeof s)}else s="";i.push(s)}return i},r.isHexString=function(e,t){return!("string"!=typeof e||!e.match(/^0x[0-9A-Fa-f]*$/))&&!(void 0!==t&&t>0&&e.length!==2+2*t)}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@ethereumjs/util",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/node_modules/@ethereumjs/util/dist/internal.js"}],[1931,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.Lock=void 0;r.Lock=class{constructor(){this.permits=1,this.promiseResolverQueue=[]}async acquire(){return this.permits>0?(this.permits-=1,Promise.resolve(!0)):new Promise((e=>this.promiseResolverQueue.push(e)))}release(){if(this.permits+=1,this.permits>1&&this.promiseResolverQueue.length>0)console.warn("Lock.permits should never be > 0 when there is someone waiting.");else if(1===this.permits&&this.promiseResolverQueue.length>0){this.permits-=1;const e=this.promiseResolverQueue.shift();e&&e(!0)}}}}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@ethereumjs/util",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/node_modules/@ethereumjs/util/dist/lock.js"}],[1932,{"micro-ftch":3879},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.getProvider=r.fetchFromProvider=void 0;const i=e("micro-ftch");r.fetchFromProvider=async(e,t)=>(await(0,i.default)(e,{headers:{"content-type":"application/json"},type:"json",data:{method:t.method,params:t.params,jsonrpc:"2.0",id:1}})).result;r.getProvider=e=>{if("string"==typeof e)return e;if(e?.connection?.url!==undefined)return e.connection.url;throw new Error("Must provide valid provider URL or Web3Provider")}}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@ethereumjs/util",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/node_modules/@ethereumjs/util/dist/provider.js"}],[1933,{"./bytes":1925,"./constants":1926,"./helpers":1928,buffer:3028,"ethereum-cryptography/keccak":3260,"ethereum-cryptography/secp256k1":3277},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.hashPersonalMessage=r.isValidSignature=r.fromRpcSig=r.toCompactSig=r.toRpcSig=r.ecrecover=r.ecsign=void 0;const i=e("ethereum-cryptography/keccak"),n=e("ethereum-cryptography/secp256k1"),s=e("./bytes"),a=e("./constants"),o=e("./helpers");function l(e,t){return e===BigInt(0)||e===BigInt(1)?e:t===undefined?e-BigInt(27):e-(t*BigInt(2)+BigInt(35))}function c(e){return e===BigInt(0)||e===BigInt(1)}r.ecsign=function(e,r,i){const s=n.secp256k1.sign(e,r),a=s.toCompactRawBytes();return{r:t.from(a.slice(0,32)),s:t.from(a.slice(32,64)),v:i===undefined?BigInt(s.recovery+27):BigInt(s.recovery+35)+BigInt(i)*BigInt(2)}};r.ecrecover=function(e,r,i,a,o){const u=t.concat([(0,s.setLengthLeft)(i,32),(0,s.setLengthLeft)(a,32)],64),d=l(r,o);if(!c(d))throw new Error("Invalid signature v value");const h=n.secp256k1.Signature.fromCompact(u).addRecoveryBit(Number(d)).recoverPublicKey(e);return t.from(h.toRawBytes(!1).slice(1))};r.toRpcSig=function(e,r,i,n){if(!c(l(e,n)))throw new Error("Invalid signature v value");return(0,s.bufferToHex)(t.concat([(0,s.setLengthLeft)(r,32),(0,s.setLengthLeft)(i,32),(0,s.toBuffer)(e)]))};r.toCompactSig=function(e,r,i,n){if(!c(l(e,n)))throw new Error("Invalid signature v value");let a=i;return(e>BigInt(28)&&e%BigInt(2)===BigInt(1)||e===BigInt(1)||e===BigInt(28))&&(a=t.from(i),a[0]|=128),(0,s.bufferToHex)(t.concat([(0,s.setLengthLeft)(r,32),(0,s.setLengthLeft)(a,32)]))};r.fromRpcSig=function(e){const t=(0,s.toBuffer)(e);let r,i,n;if(t.length>=65)r=t.slice(0,32),i=t.slice(32,64),n=(0,s.bufferToBigInt)(t.slice(64));else{if(64!==t.length)throw new Error("Invalid signature length");r=t.slice(0,32),i=t.slice(32,64),n=BigInt((0,s.bufferToInt)(t.slice(32,33))>>7),i[0]&=127}return n<27&&(n+=BigInt(27)),{v:n,r:r,s:i}};r.isValidSignature=function(e,t,r,i=!0,n){if(32!==t.length||32!==r.length)return!1;if(!c(l(e,n)))return!1;const o=(0,s.bufferToBigInt)(t),u=(0,s.bufferToBigInt)(r);return!(o===BigInt(0)||o>=a.SECP256K1_ORDER||u===BigInt(0)||u>=a.SECP256K1_ORDER)&&!(i&&u>=a.SECP256K1_ORDER_DIV_2)};r.hashPersonalMessage=function(e){(0,o.assertIsBuffer)(e);const r=t.from(`Ethereum Signed Message:\n${e.length}`,"utf-8");return t.from((0,i.keccak256)(t.concat([r,e])))}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@ethereumjs/util",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/node_modules/@ethereumjs/util/dist/signature.js"}],[1934,{"./bytes":1925,"./internal":1930},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.toType=r.TypeOutput=void 0;const i=e("./bytes"),n=e("./internal");var s;!function(e){e[e.Number=0]="Number",e[e.BigInt=1]="BigInt",e[e.Buffer=2]="Buffer",e[e.PrefixedHexString=3]="PrefixedHexString"}(s=r.TypeOutput||(r.TypeOutput={})),r.toType=function(e,t){if(null===e)return null;if(e===undefined)return undefined;if("string"==typeof e&&!(0,n.isHexString)(e))throw new Error(`A string must be provided with a 0x-prefix, given: ${e}`);if("number"==typeof e&&!Number.isSafeInteger(e))throw new Error("The provided number is greater than MAX_SAFE_INTEGER (please use an alternative input type)");const r=(0,i.toBuffer)(e);switch(t){case s.Buffer:return r;case s.BigInt:return(0,i.bufferToBigInt)(r);case s.Number:{const e=(0,i.bufferToBigInt)(r);if(e>BigInt(Number.MAX_SAFE_INTEGER))throw new Error("The provided number is greater than MAX_SAFE_INTEGER (please use an alternative output type)");return Number(e)}case s.PrefixedHexString:return(0,i.bufferToHex)(r);default:throw new Error("unknown outputType")}}}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@ethereumjs/util",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/node_modules/@ethereumjs/util/dist/types.js"}],[1935,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.GWEI_TO_WEI=void 0,r.GWEI_TO_WEI=BigInt(1e9)}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@ethereumjs/util",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/node_modules/@ethereumjs/util/dist/units.js"}],[1936,{"./address":1923,"./bytes":1925,"./types":1934,buffer:3028},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.Withdrawal=void 0;const i=e("./address"),n=e("./bytes"),s=e("./types");class a{constructor(e,t,r,i){this.index=e,this.validatorIndex=t,this.address=r,this.amount=i}static fromWithdrawalData(e){const{index:t,validatorIndex:r,address:n,amount:o}=e,l=(0,s.toType)(t,s.TypeOutput.BigInt),c=(0,s.toType)(r,s.TypeOutput.BigInt),u=new i.Address((0,s.toType)(n,s.TypeOutput.Buffer)),d=(0,s.toType)(o,s.TypeOutput.BigInt);return new a(l,c,u,d)}static fromValuesArray(e){if(4!==e.length)throw Error(`Invalid withdrawalArray length expected=4 actual=${e.length}`);const[t,r,i,n]=e;return a.fromWithdrawalData({index:t,validatorIndex:r,address:i,amount:n})}static toBufferArray(e){const{index:r,validatorIndex:n,address:a,amount:o}=e,l=(0,s.toType)(r,s.TypeOutput.BigInt)===BigInt(0)?t.alloc(0):(0,s.toType)(r,s.TypeOutput.Buffer),c=(0,s.toType)(n,s.TypeOutput.BigInt)===BigInt(0)?t.alloc(0):(0,s.toType)(n,s.TypeOutput.Buffer);let u;u=a instanceof i.Address?a.buf:(0,s.toType)(a,s.TypeOutput.Buffer);return[l,c,u,(0,s.toType)(o,s.TypeOutput.BigInt)===BigInt(0)?t.alloc(0):(0,s.toType)(o,s.TypeOutput.Buffer)]}raw(){return a.toBufferArray(this)}toValue(){return{index:this.index,validatorIndex:this.validatorIndex,address:this.address.buf,amount:this.amount}}toJSON(){return{index:(0,n.bigIntToHex)(this.index),validatorIndex:(0,n.bigIntToHex)(this.validatorIndex),address:"0x"+this.address.buf.toString("hex"),amount:(0,n.bigIntToHex)(this.amount)}}}r.Withdrawal=a}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@ethereumjs/util",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/node_modules/@ethereumjs/util/dist/withdrawal.js"}],[1937,{"./chunk-UJFCPTF3.js":1939,"./chunk-Z4BLTVTB.js":1940},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i,n,s,a,o=e("./chunk-UJFCPTF3.js"),l=e("./chunk-Z4BLTVTB.js");i=new WeakMap,n=new WeakMap,s=new WeakMap,a=new WeakMap,r.ControllerMessenger=class{constructor(){l.__privateAdd.call(void 0,this,i,new Map),l.__privateAdd.call(void 0,this,n,new Map),l.__privateAdd.call(void 0,this,s,new Map),l.__privateAdd.call(void 0,this,a,new Map)}registerActionHandler(e,t){if(l.__privateGet.call(void 0,this,i).has(e))throw new Error(`A handler for ${e} has already been registered`);l.__privateGet.call(void 0,this,i).set(e,t)}unregisterActionHandler(e){l.__privateGet.call(void 0,this,i).delete(e)}clearActions(){l.__privateGet.call(void 0,this,i).clear()}call(e,...t){const r=l.__privateGet.call(void 0,this,i).get(e);if(!r)throw new Error(`A handler for ${e} has not been registered`);return r(...t)}registerInitialEventPayload({eventType:e,getPayload:t}){l.__privateGet.call(void 0,this,s).set(e,t)}publish(e,...t){const r=l.__privateGet.call(void 0,this,n).get(e);if(r)for(const[e,i]of r.entries())try{if(i){const r=l.__privateGet.call(void 0,this,a).get(e),n=i(...t);n!==r&&(l.__privateGet.call(void 0,this,a).set(e,n),e(n,r))}else e(...t)}catch(e){setTimeout((()=>{throw e}))}}subscribe(e,t,r){let i=l.__privateGet.call(void 0,this,n).get(e);if(i||(i=new Map,l.__privateGet.call(void 0,this,n).set(e,i)),i.set(t,r),r){const i=l.__privateGet.call(void 0,this,s).get(e);if(i){const e=r(...i());l.__privateGet.call(void 0,this,a).set(t,e)}}}unsubscribe(e,t){const r=l.__privateGet.call(void 0,this,n).get(e);if(!r||!r.has(t))throw new Error(`Subscription not found for event: ${e}`);r.get(t)&&l.__privateGet.call(void 0,this,a).delete(t),r.delete(t)}clearEventSubscriptions(e){l.__privateGet.call(void 0,this,n).delete(e)}clearSubscriptions(){l.__privateGet.call(void 0,this,n).clear()}getRestricted({name:e,allowedActions:t,allowedEvents:r}){return new(0,o.RestrictedControllerMessenger)({controllerMessenger:this,name:e,allowedActions:t,allowedEvents:r})}}}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@metamask/base-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/node_modules/@metamask/base-controller/dist/chunk-G42723LG.js"}],[1938,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i=class{constructor(e={},t={}){this.defaultConfig={},this.defaultState={},this.disabled=!1,this.name="BaseController",this.internalConfig=this.defaultConfig,this.internalState=this.defaultState,this.internalListeners=[],this.initialState=t,this.initialConfig=e}initialize(){return this.internalState=this.defaultState,this.internalConfig=this.defaultConfig,this.configure(this.initialConfig),this.update(this.initialState),this}get config(){return this.internalConfig}get state(){return this.internalState}configure(e,t=!1,r=!0){if(r){this.internalConfig=t?e:Object.assign(this.internalConfig,e);for(const e of Object.keys(this.internalConfig)){const t=this.internalConfig[e];void 0!==t&&(this[e]=t)}}else for(const t of Object.keys(e))if(void 0!==this.internalConfig[t]){const r=e[t];this.internalConfig[t]=r,this[t]=r}}notify(){this.disabled||this.internalListeners.forEach((e=>{e(this.internalState)}))}subscribe(e){this.internalListeners.push(e)}unsubscribe(e){const t=this.internalListeners.findIndex((t=>e===t));return t>-1&&this.internalListeners.splice(t,1),t>-1}update(e,t=!1){this.internalState=t?Object.assign({},e):Object.assign({},this.internalState,e),this.notify()}},n=i;r.BaseControllerV1=i,r.BaseControllerV1_default=n}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@metamask/base-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/node_modules/@metamask/base-controller/dist/chunk-NINOM2XQ.js"}],[1939,{"./chunk-Z4BLTVTB.js":1940},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i,n,s,a,o,l,c,u,d,h,m=e("./chunk-Z4BLTVTB.js");i=new WeakMap,n=new WeakMap,s=new WeakMap,a=new WeakMap,o=new WeakSet,l=function(e){const t=m.__privateGet.call(void 0,this,a);return m.__privateMethod.call(void 0,this,d,h).call(this,e)||null!==t&&t.includes(e)},c=new WeakSet,u=function(e){const t=m.__privateGet.call(void 0,this,s);return m.__privateMethod.call(void 0,this,d,h).call(this,e)||null!==t&&t.includes(e)},d=new WeakSet,h=function(e){return e.startsWith(`${m.__privateGet.call(void 0,this,n)}:`)},r.RestrictedControllerMessenger=class{constructor({controllerMessenger:e,name:t,allowedActions:r,allowedEvents:l}){m.__privateAdd.call(void 0,this,o),m.__privateAdd.call(void 0,this,c),m.__privateAdd.call(void 0,this,d),m.__privateAdd.call(void 0,this,i,void 0),m.__privateAdd.call(void 0,this,n,void 0),m.__privateAdd.call(void 0,this,s,void 0),m.__privateAdd.call(void 0,this,a,void 0),m.__privateSet.call(void 0,this,i,e),m.__privateSet.call(void 0,this,n,t),m.__privateSet.call(void 0,this,s,r),m.__privateSet.call(void 0,this,a,l)}registerActionHandler(e,t){if(!m.__privateMethod.call(void 0,this,d,h).call(this,e))throw new Error(`Only allowed registering action handlers prefixed by '${m.__privateGet.call(void 0,this,n)}:'`);m.__privateGet.call(void 0,this,i).registerActionHandler(e,t)}unregisterActionHandler(e){if(!m.__privateMethod.call(void 0,this,d,h).call(this,e))throw new Error(`Only allowed unregistering action handlers prefixed by '${m.__privateGet.call(void 0,this,n)}:'`);m.__privateGet.call(void 0,this,i).unregisterActionHandler(e)}call(e,...t){if(!m.__privateMethod.call(void 0,this,c,u).call(this,e))throw new Error(`Action missing from allow list: ${e}`);return m.__privateGet.call(void 0,this,i).call(e,...t)}registerInitialEventPayload({eventType:e,getPayload:t}){if(!m.__privateMethod.call(void 0,this,d,h).call(this,e))throw new Error(`Only allowed publishing events prefixed by '${m.__privateGet.call(void 0,this,n)}:'`);m.__privateGet.call(void 0,this,i).registerInitialEventPayload({eventType:e,getPayload:t})}publish(e,...t){if(!m.__privateMethod.call(void 0,this,d,h).call(this,e))throw new Error(`Only allowed publishing events prefixed by '${m.__privateGet.call(void 0,this,n)}:'`);m.__privateGet.call(void 0,this,i).publish(e,...t)}subscribe(e,t,r){if(!m.__privateMethod.call(void 0,this,o,l).call(this,e))throw new Error(`Event missing from allow list: ${e}`);return r?m.__privateGet.call(void 0,this,i).subscribe(e,t,r):m.__privateGet.call(void 0,this,i).subscribe(e,t)}unsubscribe(e,t){if(!m.__privateMethod.call(void 0,this,o,l).call(this,e))throw new Error(`Event missing from allow list: ${e}`);m.__privateGet.call(void 0,this,i).unsubscribe(e,t)}clearEventSubscriptions(e){if(!m.__privateMethod.call(void 0,this,d,h).call(this,e))throw new Error(`Only allowed clearing events prefixed by '${m.__privateGet.call(void 0,this,n)}:'`);m.__privateGet.call(void 0,this,i).clearEventSubscriptions(e)}}}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@metamask/base-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/node_modules/@metamask/base-controller/dist/chunk-UJFCPTF3.js"}],[194,{"../../../shared/constants/network":4507,"bignumber.js":2933,lodash:3836},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i,n=e("lodash"),s=(i=e("bignumber.js"))&&i.__esModule?i:{default:i},a=e("../../../shared/constants/network");const o=e=>new s.default(e||"0x0",16).gt(0),l=["0x3","0x2a","0x4"],c={"0x3":{rpcUrl:(0,a.getRpcUrl)({network:"ropsten"}),nickname:"Ropsten",ticker:"RopstenETH"},"0x2a":{rpcUrl:(0,a.getRpcUrl)({network:"kovan"}),nickname:"Kovan",ticker:"KovanETH"},"0x4":{rpcUrl:(0,a.getRpcUrl)({network:"rinkeby"}),nickname:"Rinkeby",ticker:"RinkebyETH"}};r.default={version:74,async migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=74;const r=function(e){var t,r;const i=(null==e?void 0:e.PreferencesController)||{},s=i.preferences||{},a=(null==e?void 0:e.NetworkController)||{},u=(null==a?void 0:a.provider)||{},d=l.filter((e=>e===(null==u?void 0:u.chainId)));if(!s.showTestNetworks&&0===d.length)return e;const h=(null==e||null===(t=e.TransactionController)||void 0===t?void 0:t.transactions)||{},m=(null===(r=e.CachedBalancesController)||void 0===r?void 0:r.cachedBalances)||{},p=Object.values(h).filter((({chainId:e})=>l.includes(e))).map((({chainId:e})=>e)),f=l.filter((e=>Object.values(m[e]||{}).some(o))),v=(0,n.uniq)([...f,...p,...d]),g=i.frequentRpcListDetail??[];v.forEach((e=>{g.find((t=>t.chainId===e))||g.unshift({rpcUrl:c[e].rpcUrl,chainId:e,ticker:c[e].ticker,nickname:c[e].nickname,rpcPrefs:{}})})),g.length&&(i.frequentRpcListDetail=g);if(d.length){const e=d[0];a.provider={...a.provider,type:"rpc",rpcUrl:c[e].rpcUrl,chainId:e,nickname:c[e].nickname,ticker:c[e].ticker}}return{...e,PreferencesController:{...i},NetworkController:{...a}}}(t.data);return t.data=r,t}}}}},{package:"$root$",file:"app/scripts/migrations/074.js"}],[1940,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i=(e,t,r)=>{if(!t.has(e))throw TypeError("Cannot "+r)};r.__privateGet=(e,t,r)=>(i(e,t,"read from private field"),r?r.call(e):t.get(e)),r.__privateAdd=(e,t,r)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,r)},r.__privateSet=(e,t,r,n)=>(i(e,t,"write to private field"),n?n.call(e,r):t.set(e,r),r),r.__privateMethod=(e,t,r)=>(i(e,t,"access private method"),r)}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@metamask/base-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/node_modules/@metamask/base-controller/dist/chunk-Z4BLTVTB.js"}],[1941,{"./chunk-Z4BLTVTB.js":1940,immer:3640},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i,n=e("./chunk-Z4BLTVTB.js"),s=e("immer");s.enablePatches.call(void 0);function a(e,t,r){return Object.keys(e).reduce(((i,n)=>{try{const s=t[n];if(!s)throw new Error(`No metadata found for '${String(n)}'`);const a=s[r],o=e[n];return"function"==typeof a?i[n]=a(o):a&&(i[n]=o),i}catch(e){return setTimeout((()=>{throw e})),i}}),{})}i=new WeakMap,r.BaseController=class{constructor({messenger:e,metadata:t,name:r,state:a}){n.__privateAdd.call(void 0,this,i,void 0),this.messagingSystem=e,this.name=r,n.__privateSet.call(void 0,this,i,s.freeze.call(void 0,a,!0)),this.metadata=t,this.messagingSystem.registerActionHandler(`${r}:getState`,(()=>this.state)),this.messagingSystem.registerInitialEventPayload({eventType:`${r}:stateChange`,getPayload:()=>[this.state,[]]})}get state(){return n.__privateGet.call(void 0,this,i)}set state(e){throw new Error("Controller state cannot be directly mutated; use 'update' method instead.")}update(e){const[t,r,a]=s.produceWithPatches.call(void 0,n.__privateGet.call(void 0,this,i),e);return n.__privateSet.call(void 0,this,i,t),this.messagingSystem.publish(`${this.name}:stateChange`,t,r),{nextState:t,patches:r,inversePatches:a}}applyPatches(e){const t=s.applyPatches.call(void 0,n.__privateGet.call(void 0,this,i),e);n.__privateSet.call(void 0,this,i,t),this.messagingSystem.publish(`${this.name}:stateChange`,t,e)}destroy(){this.messagingSystem.clearEventSubscriptions(`${this.name}:stateChange`)}},r.getAnonymizedState=function(e,t){return a(e,t,"anonymous")},r.getPersistentState=function(e,t){return a(e,t,"persist")}}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@metamask/base-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/node_modules/@metamask/base-controller/dist/chunk-ZNOPSWMU.js"}],[1942,{"./chunk-G42723LG.js":1937,"./chunk-NINOM2XQ.js":1938,"./chunk-UJFCPTF3.js":1939,"./chunk-Z4BLTVTB.js":1940,"./chunk-ZNOPSWMU.js":1941},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i=e("./chunk-NINOM2XQ.js"),n=e("./chunk-ZNOPSWMU.js"),s=e("./chunk-G42723LG.js"),a=e("./chunk-UJFCPTF3.js");e("./chunk-Z4BLTVTB.js"),r.BaseController=n.BaseController,r.BaseControllerV1=i.BaseControllerV1,r.ControllerMessenger=s.ControllerMessenger,r.RestrictedControllerMessenger=a.RestrictedControllerMessenger,r.getAnonymizedState=n.getAnonymizedState,r.getPersistentState=n.getPersistentState}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@metamask/base-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/node_modules/@metamask/base-controller/dist/index.js"}],[1943,{"./chunk-RKVNLW2C.js":1947,"@ethereumjs/util":1929,"@metamask/ethjs-unit":1381,"@metamask/utils":2300,"bn.js":2980,buffer:3028,"eth-ens-namehash":3225,"fast-deep-equal":3356},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t){(function(){function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var n=e("./chunk-RKVNLW2C.js"),s=e("@ethereumjs/util"),a=e("@metamask/ethjs-unit"),o=e("@metamask/utils"),l=i(e("bn.js")),c=i(e("eth-ens-namehash")),u=i(e("fast-deep-equal")),d=new Error("timeout"),h=["__proto__","constructor","prototype"];function m(e){return e?new(0,l.default)(o.remove0x.call(void 0,e),16):new(0,l.default)(0)}async function p(e,t){const r=await fetch(e,t);if(!r.ok)throw new Error(`Fetch failed with status '${r.status}' for request '${String(e)}'`);return r}async function f(e,t){const r=await p(e,t);return await r.json()}r.PROTOTYPE_POLLUTION_BLOCKLIST=h,r.isSafeDynamicKey=function(e){return"string"==typeof e&&!h.some((t=>e===t))},r.isSafeChainId=function(e){if(!o.isHexString.call(void 0,e))return!1;const t=Number.parseInt(e,o.isStrictHexString.call(void 0,e)?16:10);return Number.isSafeInteger(t)&&t>0&&t<=n.MAX_SAFE_CHAIN_ID},r.BNToHex=function(e){return o.add0x.call(void 0,e.toString(16))},r.fractionBN=function(e,t,r){const i=new(0,l.default)(t),n=new(0,l.default)(r);return e.mul(i).div(n)},r.gweiDecToWEIBN=function(e){if(Number.isNaN(e))return new(0,l.default)(0);const t=e.toString().split("."),r=t[0]||"0";let i=t[1]||"";if(!i)return a.toWei.call(void 0,r,"gwei");if(i.length<=9)return a.toWei.call(void 0,`${r}.${i}`,"gwei");const n=i.slice(9)[0];i=i.slice(0,9);let s=a.toWei.call(void 0,`${r}.${i}`,"gwei");return Number(n)>=5&&(s=s.add(new(0,l.default)(1))),s},r.weiHexToGweiDec=function(e){const t=new(0,l.default)(o.remove0x.call(void 0,e),16);return a.fromWei.call(void 0,t,"gwei")},r.getBuyURL=function(e="1",t,r=5){switch(e){case"1":return`https://buy.coinbase.com/?code=9ec56d01-7e81-5017-930c-513daa27bb6a&amount=${r}&address=${t}&crypto_currency=ETH`;case"5":return"https://goerli-faucet.slock.it/";case"11155111":return"https://sepoliafaucet.net/";default:return}},r.hexToBN=m,r.hexToText=function(e){try{const r=o.remove0x.call(void 0,e);return t.from(r,"hex").toString("utf8")}catch(t){return e}},r.fromHex=function(e){return l.default.isBN(e)?e:new(0,l.default)(m(e).toString(10))},r.toHex=function(e){return"string"==typeof e&&o.isStrictHexString.call(void 0,e)?e:`0x${l.default.isBN(e)?e.toString(16):new(0,l.default)(e.toString(),10).toString(16)}`},r.safelyExecute=async function(e,t=!1){try{return await e()}catch(e){return void(t&&console.error(e))}},r.safelyExecuteWithTimeout=async function(e,t=!1,r=500){try{return await Promise.race([e(),new Promise(((e,t)=>setTimeout((()=>{t(d)}),r)))])}catch(e){return void(t&&console.error(e))}},r.toChecksumHexAddress=function(e){if("string"!=typeof e)return e;const t=o.add0x.call(void 0,e);return o.isHexString.call(void 0,t)?s.toChecksumAddress.call(void 0,t):t},r.isValidHexAddress=function(e,{allowNonPrefixed:t=!0}={}){const r=t?o.add0x.call(void 0,e):e;return!!o.isStrictHexString.call(void 0,r)&&s.isValidAddress.call(void 0,r)},r.isSmartContractCode=function(e){return!!e&&("0x"!==e&&"0x0"!==e)},r.successfulFetch=p,r.handleFetch=f,r.fetchWithErrorHandling=async function({url:e,options:t,timeout:r,errorCodesToCatch:i}){let n;try{n=r?Promise.race([await f(e,t),new Promise(((e,t)=>setTimeout((()=>{t(d)}),r)))]):await f(e,t)}catch(e){!function(e,t=[]){if(!e)return;if(!(e instanceof Error))throw e;if(!t.some((t=>e.message.includes(`Fetch failed with status '${t}'`)))&&!e.message.includes("Failed to fetch")&&e!==d)throw e;console.error(e)}(e,i)}return n},r.timeoutFetch=async function(e,t,r=500){return Promise.race([p(e,t),new Promise(((e,t)=>setTimeout((()=>{t(d)}),r)))])},r.normalizeEnsName=function(e){if("."===e)return e;if(e&&"string"==typeof e)try{const t=c.default.normalize(e.trim());if(t.match(/^(([\w\d-]+)\.)*[\w\d-]{7,}\.(eth|test)$/u))return t}catch(e){}return null},r.query=function(e,t,r=[]){return new Promise(((i,n)=>{const s=(e,t)=>{e?n(e):i(t)};t in e&&"function"==typeof e[t]?e[t](...r,s):e.sendAsync({method:t,params:r},s)}))},r.convertHexToDecimal=(e="0x0")=>o.isStrictHexString.call(void 0,e)?parseInt(e,16):Number(e)?Number(e):0,r.isPlainObject=function(e){return Boolean(e)&&"object"==typeof e&&!Array.isArray(e)},r.isNonEmptyArray=function(e){return Array.isArray(e)&&e.length>0},r.isValidJson=function(e){try{return u.default.call(void 0,e,JSON.parse(JSON.stringify(e)))}catch(e){return!1}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@metamask/controller-utils",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/node_modules/@metamask/controller-utils/dist/chunk-7C4YHS6A.js"}],[1944,{"@metamask/utils":2300},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i=e("@metamask/utils"),n=i.createProjectLogger.call(void 0,"controller-utils");r.createModuleLogger=i.createModuleLogger,r.projectLogger=n}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@metamask/controller-utils",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/node_modules/@metamask/controller-utils/dist/chunk-DBJSLKNR.js"}],[1945,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i={mainnet:"mainnet",goerli:"goerli",sepolia:"sepolia","linea-goerli":"linea-goerli","linea-sepolia":"linea-sepolia","linea-mainnet":"linea-mainnet"},n={...i,rpc:"rpc"};var s=(e=>(e.Mainnet="mainnet",e.Goerli="goerli",e.Sepolia="sepolia",e.LineaGoerli="linea-goerli",e.LineaSepolia="linea-sepolia",e.LineaMainnet="linea-mainnet",e.Aurora="aurora",e))(s||{}),a={mainnet:"0x1",goerli:"0x5",sepolia:"0xaa36a7",aurora:"0x4e454152","linea-goerli":"0xe704","linea-sepolia":"0xe705","linea-mainnet":"0xe708"},o=(e=>(e.mainnet="ETH",e.goerli="GoerliETH",e.sepolia="SepoliaETH",e["linea-goerli"]="LineaETH",e["linea-sepolia"]="LineaETH",e["linea-mainnet"]="ETH",e.rpc="",e))(o||{});r.InfuraNetworkType=i,r.NetworkType=n,r.isNetworkType=function(e){return Object.values(n).includes(e)},r.isInfuraNetworkType=function(e){return Object.keys(i).includes(e)},r.BuiltInNetworkName=s,r.ChainId=a,r.NetworksTicker=o}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@metamask/controller-utils",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/node_modules/@metamask/controller-utils/dist/chunk-LGGBBU6G.js"}],[1946,{"./chunk-DBJSLKNR.js":1944,"@metamask/utils":2300,"@spruceid/siwe-parser":2526,buffer:3028},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0});var i=e("./chunk-DBJSLKNR.js"),n=e("@metamask/utils"),s=e("@spruceid/siwe-parser"),a=i.createModuleLogger.call(void 0,i.projectLogger,"detect-siwe");function o(e){try{const i="string"!=typeof(r=e)?r:n.remove0x.call(void 0,r),s=t.from(i,"hex");return 32===s.length?e:s.toString("utf8")}catch(t){return a(t),e}var r}var l={"http:":"80","https:":"443"},c=(e,t)=>e.match(/^[^/:]*:\/\//u)?new URL(e):new URL(`${t}//${e}`);r.parseDomainParts=c,r.isValidSIWEOrigin=e=>{try{const{origin:t,siwe:r}=e;if(!t||!r?.parsedMessage?.domain)return!1;const i=new URL(t),n=c(r.parsedMessage.domain,i.protocol);return 0===n.hostname.localeCompare(i.hostname,void 0,{sensitivity:"accent"})&&(""!==n.port&&n.port!==i.port?""===i.port&&n.port===l[i.protocol]:""===n.username||n.username===i.username)}catch(e){return a(e),!1}},r.detectSIWE=e=>{try{const{data:t}=e,r=o(t);return{isSIWEMessage:!0,parsedMessage:new(0,s.ParsedMessage)(r)}}catch(e){return{isSIWEMessage:!1,parsedMessage:null}}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@metamask/controller-utils",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/node_modules/@metamask/controller-utils/dist/chunk-M6G3ISXG.js"}],[1947,{"./chunk-LGGBBU6G.js":1945},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i=e("./chunk-LGGBBU6G.js"),n={[i.NetworkType.goerli]:{chainId:i.ChainId.goerli,ticker:"GoerliETH",rpcPrefs:{blockExplorerUrl:`https://${i.NetworkType.goerli}.etherscan.io`}},[i.NetworkType.sepolia]:{chainId:i.ChainId.sepolia,ticker:"SepoliaETH",rpcPrefs:{blockExplorerUrl:`https://${i.NetworkType.sepolia}.etherscan.io`}},[i.NetworkType.mainnet]:{chainId:i.ChainId.mainnet,ticker:"ETH",rpcPrefs:{blockExplorerUrl:"https://etherscan.io"}},[i.NetworkType["linea-goerli"]]:{chainId:i.ChainId["linea-goerli"],ticker:"LineaETH",rpcPrefs:{blockExplorerUrl:"https://goerli.lineascan.build"}},[i.NetworkType["linea-sepolia"]]:{chainId:i.ChainId["linea-sepolia"],ticker:"LineaETH",rpcPrefs:{blockExplorerUrl:"https://sepolia.lineascan.build"}},[i.NetworkType["linea-mainnet"]]:{chainId:i.ChainId["linea-mainnet"],ticker:"ETH",rpcPrefs:{blockExplorerUrl:"https://lineascan.build"}},[i.NetworkType.rpc]:{chainId:void 0,blockExplorerUrl:void 0,ticker:void 0,rpcPrefs:void 0}},s=(e=>(e.AddEthereumChain="wallet_addEthereumChain",e.ConnectAccounts="connect_accounts",e.EthDecrypt="eth_decrypt",e.EthGetEncryptionPublicKey="eth_getEncryptionPublicKey",e.EthSignTypedData="eth_signTypedData",e.PersonalSign="personal_sign",e.ResultError="result_error",e.ResultSuccess="result_success",e.SnapDialogAlert="snap_dialog:alert",e.SnapDialogConfirmation="snap_dialog:confirmation",e.SnapDialogPrompt="snap_dialog:prompt",e.SwitchEthereumChain="wallet_switchEthereumChain",e.Transaction="transaction",e.Unlock="unlock",e.WalletConnect="wallet_connect",e.WalletRequestPermissions="wallet_requestPermissions",e.WatchAsset="wallet_watchAsset",e))(s||{}),a={[i.ChainId.goerli]:"goerli",[i.ChainId.sepolia]:"sepolia",[i.ChainId.mainnet]:"mainnet",[i.ChainId["linea-goerli"]]:"linea-goerli",[i.ChainId["linea-sepolia"]]:"linea-sepolia",[i.ChainId["linea-mainnet"]]:"linea-mainnet",[i.ChainId.aurora]:"aurora"};r.RPC="rpc",r.FALL_BACK_VS_CURRENCY="ETH",r.IPFS_DEFAULT_GATEWAY_URL="https://cloudflare-ipfs.com/ipfs/",r.GANACHE_CHAIN_ID="0x539",r.MAX_SAFE_CHAIN_ID=0xfffffffffffec,r.ERC721="ERC721",r.ERC1155="ERC1155",r.ERC20="ERC20",r.ERC721_INTERFACE_ID="0x80ac58cd",r.ERC721_METADATA_INTERFACE_ID="0x5b5e139f",r.ERC721_ENUMERABLE_INTERFACE_ID="0x780e9d63",r.ERC1155_INTERFACE_ID="0xd9b67a26",r.ERC1155_METADATA_URI_INTERFACE_ID="0x0e89341c",r.ERC1155_TOKEN_RECEIVER_INTERFACE_ID="0x4e2312e0",r.GWEI="gwei",r.ASSET_TYPES={NATIVE:"NATIVE",TOKEN:"TOKEN",NFT:"NFT",UNKNOWN:"UNKNOWN"},r.TESTNET_TICKER_SYMBOLS={GOERLI:"GoerliETH",SEPOLIA:"SepoliaETH",LINEA_GOERLI:"LineaETH",LINEA_SEPOLIA:"LineaETH"},r.BUILT_IN_NETWORKS=n,r.OPENSEA_PROXY_URL="https://proxy.api.cx.metamask.io/opensea/v1/api/v2",r.NFT_API_BASE_URL="https://nft.api.cx.metamask.io",r.NFT_API_VERSION="1",r.NFT_API_TIMEOUT=15e3,r.ORIGIN_METAMASK="metamask",r.ApprovalType=s,r.CHAIN_ID_TO_ETHERS_NETWORK_NAME_MAP=a}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@metamask/controller-utils",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/node_modules/@metamask/controller-utils/dist/chunk-RKVNLW2C.js"}],[1948,{"./chunk-7C4YHS6A.js":1943,"./chunk-DBJSLKNR.js":1944,"./chunk-LGGBBU6G.js":1945,"./chunk-M6G3ISXG.js":1946,"./chunk-RKVNLW2C.js":1947},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i=e("./chunk-M6G3ISXG.js");e("./chunk-DBJSLKNR.js");var n=e("./chunk-7C4YHS6A.js"),s=e("./chunk-RKVNLW2C.js"),a=e("./chunk-LGGBBU6G.js");r.ASSET_TYPES=s.ASSET_TYPES,r.ApprovalType=s.ApprovalType,r.BNToHex=n.BNToHex,r.BUILT_IN_NETWORKS=s.BUILT_IN_NETWORKS,r.BuiltInNetworkName=a.BuiltInNetworkName,r.CHAIN_ID_TO_ETHERS_NETWORK_NAME_MAP=s.CHAIN_ID_TO_ETHERS_NETWORK_NAME_MAP,r.ChainId=a.ChainId,r.ERC1155=s.ERC1155,r.ERC1155_INTERFACE_ID=s.ERC1155_INTERFACE_ID,r.ERC1155_METADATA_URI_INTERFACE_ID=s.ERC1155_METADATA_URI_INTERFACE_ID,r.ERC1155_TOKEN_RECEIVER_INTERFACE_ID=s.ERC1155_TOKEN_RECEIVER_INTERFACE_ID,r.ERC20=s.ERC20,r.ERC721=s.ERC721,r.ERC721_ENUMERABLE_INTERFACE_ID=s.ERC721_ENUMERABLE_INTERFACE_ID,r.ERC721_INTERFACE_ID=s.ERC721_INTERFACE_ID,r.ERC721_METADATA_INTERFACE_ID=s.ERC721_METADATA_INTERFACE_ID,r.FALL_BACK_VS_CURRENCY=s.FALL_BACK_VS_CURRENCY,r.GANACHE_CHAIN_ID=s.GANACHE_CHAIN_ID,r.GWEI=s.GWEI,r.IPFS_DEFAULT_GATEWAY_URL=s.IPFS_DEFAULT_GATEWAY_URL,r.InfuraNetworkType=a.InfuraNetworkType,r.MAX_SAFE_CHAIN_ID=s.MAX_SAFE_CHAIN_ID,r.NFT_API_BASE_URL=s.NFT_API_BASE_URL,r.NFT_API_TIMEOUT=s.NFT_API_TIMEOUT,r.NFT_API_VERSION=s.NFT_API_VERSION,r.NetworkType=a.NetworkType,r.NetworksTicker=a.NetworksTicker,r.OPENSEA_PROXY_URL=s.OPENSEA_PROXY_URL,r.ORIGIN_METAMASK=s.ORIGIN_METAMASK,r.RPC=s.RPC,r.TESTNET_TICKER_SYMBOLS=s.TESTNET_TICKER_SYMBOLS,r.convertHexToDecimal=n.convertHexToDecimal,r.detectSIWE=i.detectSIWE,r.fetchWithErrorHandling=n.fetchWithErrorHandling,r.fractionBN=n.fractionBN,r.fromHex=n.fromHex,r.getBuyURL=n.getBuyURL,r.gweiDecToWEIBN=n.gweiDecToWEIBN,r.handleFetch=n.handleFetch,r.hexToBN=n.hexToBN,r.hexToText=n.hexToText,r.isInfuraNetworkType=a.isInfuraNetworkType,r.isNetworkType=a.isNetworkType,r.isNonEmptyArray=n.isNonEmptyArray,r.isPlainObject=n.isPlainObject,r.isSafeChainId=n.isSafeChainId,r.isSafeDynamicKey=n.isSafeDynamicKey,r.isSmartContractCode=n.isSmartContractCode,r.isValidHexAddress=n.isValidHexAddress,r.isValidJson=n.isValidJson,r.isValidSIWEOrigin=i.isValidSIWEOrigin,r.normalizeEnsName=n.normalizeEnsName,r.parseDomainParts=i.parseDomainParts,r.query=n.query,r.safelyExecute=n.safelyExecute,r.safelyExecuteWithTimeout=n.safelyExecuteWithTimeout,r.successfulFetch=n.successfulFetch,r.timeoutFetch=n.timeoutFetch,r.toChecksumHexAddress=n.toChecksumHexAddress,r.toHex=n.toHex,r.weiHexToGweiDec=n.weiHexToGweiDec}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>@metamask/controller-utils",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/transaction-controller/node_modules/@metamask/controller-utils/dist/index.js"}],[1949,{"./Semaphore":1950,tslib:4378},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i=e("tslib"),n=e("./Semaphore"),s=function(){function e(e){this._semaphore=new n.default(1,e)}return e.prototype.acquire=function(){return i.__awaiter(this,arguments,void 0,(function(e){var t;return void 0===e&&(e=0),i.__generator(this,(function(r){switch(r.label){case 0:return[4,this._semaphore.acquire(1,e)];case 1:return t=r.sent(),[2,t[1]]}}))}))},e.prototype.runExclusive=function(e,t){return void 0===t&&(t=0),this._semaphore.runExclusive((function(){return e()}),1,t)},e.prototype.isLocked=function(){return this._semaphore.isLocked()},e.prototype.waitForUnlock=function(e){return void 0===e&&(e=0),this._semaphore.waitForUnlock(1,e)},e.prototype.release=function(){this._semaphore.isLocked()&&this._semaphore.release()},e.prototype.cancel=function(){return this._semaphore.cancel()},e}();r.default=s}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>async-mutex",file:"node_modules/@metamask/smart-transactions-controller/node_modules/async-mutex/lib/Mutex.js"}],[195,{lodash:3836},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=e("lodash");r.default={version:75,async migrate(e){const t=(0,i.cloneDeep)(e);t.meta.version=75;const r=function(e){return delete e.ThreeBoxController,e}(t.data);return t.data=r,t}}}}},{package:"$root$",file:"app/scripts/migrations/075.js"}],[1950,{"./errors":1951,tslib:4378},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i=e("tslib"),n=e("./errors"),s=function(){function e(e,t){void 0===t&&(t=n.E_CANCELED),this._value=e,this._cancelError=t,this._queue=[],this._weightedWaiters=[]}return e.prototype.acquire=function(e,t){var r=this;if(void 0===e&&(e=1),void 0===t&&(t=0),e<=0)throw new Error("invalid weight ".concat(e,": must be positive"));return new Promise((function(i,n){var s={resolve:i,reject:n,weight:e,priority:t},o=a(r._queue,(function(e){return t<=e.priority}));-1===o&&e<=r._value?r._dispatchItem(s):r._queue.splice(o+1,0,s)}))},e.prototype.runExclusive=function(e){return i.__awaiter(this,arguments,void 0,(function(e,t,r){var n,s,a;return void 0===t&&(t=1),void 0===r&&(r=0),i.__generator(this,(function(i){switch(i.label){case 0:return[4,this.acquire(t,r)];case 1:n=i.sent(),s=n[0],a=n[1],i.label=2;case 2:return i.trys.push([2,,4,5]),[4,e(s)];case 3:return[2,i.sent()];case 4:return a(),[7];case 5:return[2]}}))}))},e.prototype.waitForUnlock=function(e,t){var r=this;if(void 0===e&&(e=1),void 0===t&&(t=0),e<=0)throw new Error("invalid weight ".concat(e,": must be positive"));return this._couldLockImmediately(e,t)?Promise.resolve():new Promise((function(i){var n,s,o;r._weightedWaiters[e-1]||(r._weightedWaiters[e-1]=[]),n=r._weightedWaiters[e-1],s={resolve:i,priority:t},o=a(n,(function(e){return s.priority<=e.priority})),n.splice(o+1,0,s)}))},e.prototype.isLocked=function(){return this._value<=0},e.prototype.getValue=function(){return this._value},e.prototype.setValue=function(e){this._value=e,this._dispatchQueue()},e.prototype.release=function(e){if(void 0===e&&(e=1),e<=0)throw new Error("invalid weight ".concat(e,": must be positive"));this._value+=e,this._dispatchQueue()},e.prototype.cancel=function(){var e=this;this._queue.forEach((function(t){return t.reject(e._cancelError)})),this._queue=[]},e.prototype._dispatchQueue=function(){for(this._drainUnlockWaiters();this._queue.length>0&&this._queue[0].weight<=this._value;)this._dispatchItem(this._queue.shift()),this._drainUnlockWaiters()},e.prototype._dispatchItem=function(e){var t=this._value;this._value-=e.weight,e.resolve([t,this._newReleaser(e.weight)])},e.prototype._newReleaser=function(e){var t=this,r=!1;return function(){r||(r=!0,t.release(e))}},e.prototype._drainUnlockWaiters=function(){if(0===this._queue.length)for(var e=this._value;e>0;e--){(r=this._weightedWaiters[e-1])&&(r.forEach((function(e){return e.resolve()})),this._weightedWaiters[e-1]=[])}else{var t=this._queue[0].priority;for(e=this._value;e>0;e--){var r;if(r=this._weightedWaiters[e-1]){var i=r.findIndex((function(e){return e.priority<=t}));(-1===i?r:r.splice(0,i)).forEach((function(e){return e.resolve()}))}}}},e.prototype._couldLockImmediately=function(e,t){return(0===this._queue.length||this._queue[0].priority<t)&&e<=this._value},e}();function a(e,t){for(var r=e.length-1;r>=0;r--)if(t(e[r]))return r;return-1}r.default=s}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>async-mutex",file:"node_modules/@metamask/smart-transactions-controller/node_modules/async-mutex/lib/Semaphore.js"}],[1951,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.E_CANCELED=r.E_ALREADY_LOCKED=r.E_TIMEOUT=void 0,r.E_TIMEOUT=new Error("timeout while waiting for mutex to become available"),r.E_ALREADY_LOCKED=new Error("mutex already locked"),r.E_CANCELED=new Error("request for lock canceled")}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>async-mutex",file:"node_modules/@metamask/smart-transactions-controller/node_modules/async-mutex/lib/errors.js"}],[1952,{"./Mutex":1949,"./Semaphore":1950,"./errors":1951,"./tryAcquire":1953,"./withTimeout":1954,tslib:4378},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.tryAcquire=r.withTimeout=r.Semaphore=r.Mutex=void 0;var i=e("tslib"),n=e("./Mutex");Object.defineProperty(r,"Mutex",{enumerable:!0,get:function(){return n.default}});var s=e("./Semaphore");Object.defineProperty(r,"Semaphore",{enumerable:!0,get:function(){return s.default}});var a=e("./withTimeout");Object.defineProperty(r,"withTimeout",{enumerable:!0,get:function(){return a.withTimeout}});var o=e("./tryAcquire");Object.defineProperty(r,"tryAcquire",{enumerable:!0,get:function(){return o.tryAcquire}}),i.__exportStar(e("./errors"),r)}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>async-mutex",file:"node_modules/@metamask/smart-transactions-controller/node_modules/async-mutex/lib/index.js"}],[1953,{"./errors":1951,"./withTimeout":1954},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.tryAcquire=void 0;var i=e("./errors"),n=e("./withTimeout");r.tryAcquire=function(e,t){return void 0===t&&(t=i.E_ALREADY_LOCKED),(0,n.withTimeout)(e,0,t)}}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>async-mutex",file:"node_modules/@metamask/smart-transactions-controller/node_modules/async-mutex/lib/tryAcquire.js"}],[1954,{"./errors":1951,tslib:4378},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.withTimeout=void 0;var i=e("tslib"),n=e("./errors");function s(e){return e.getValue!==undefined}r.withTimeout=function(e,t,r){var a=this;return void 0===r&&(r=n.E_TIMEOUT),{acquire:function(n,o){var l;if(s(e)?l=n:(l=undefined,o=n),l!==undefined&&l<=0)throw new Error("invalid weight ".concat(l,": must be positive"));return new Promise((function(n,c){return i.__awaiter(a,void 0,void 0,(function(){var a,u,d,h;return i.__generator(this,(function(i){switch(i.label){case 0:a=!1,u=setTimeout((function(){a=!0,c(r)}),t),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,s(e)?e.acquire(l,o):e.acquire(o)];case 2:return d=i.sent(),a?(Array.isArray(d)?d[1]:d)():(clearTimeout(u),n(d)),[3,4];case 3:return h=i.sent(),a||(clearTimeout(u),c(h)),[3,4];case 4:return[2]}}))}))}))},runExclusive:function(e,t,r){return i.__awaiter(this,void 0,void 0,(function(){var n,s;return i.__generator(this,(function(i){switch(i.label){case 0:n=function(){return undefined},i.label=1;case 1:return i.trys.push([1,,7,8]),[4,this.acquire(t,r)];case 2:return s=i.sent(),Array.isArray(s)?(n=s[1],[4,e(s[0])]):[3,4];case 3:return[2,i.sent()];case 4:return n=s,[4,e()];case 5:return[2,i.sent()];case 6:return[3,8];case 7:return n(),[7];case 8:return[2]}}))}))},release:function(t){e.release(t)},cancel:function(){return e.cancel()},waitForUnlock:function(i,n){var a;if(s(e)?a=i:(a=undefined,n=i),a!==undefined&&a<=0)throw new Error("invalid weight ".concat(a,": must be positive"));return new Promise((function(i,o){var l=setTimeout((function(){return o(r)}),t);(s(e)?e.waitForUnlock(a,n):e.waitForUnlock(n)).then((function(){clearTimeout(l),i()}))}))},isLocked:function(){return e.isLocked()},getValue:function(){return e.getValue()},setValue:function(t){return e.setValue(t)}}}}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>async-mutex",file:"node_modules/@metamask/smart-transactions-controller/node_modules/async-mutex/lib/withTimeout.js"}],[1955,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){!function(e){var r,i=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,n=Math.ceil,s=Math.floor,a="[BigNumber Error] ",o=a+"Number primitive has more than 15 significant digits: ",l=1e14,c=14,u=9007199254740991,d=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],h=1e7,m=1e9;function p(e){var t=0|e;return e>0||e===t?t:t-1}function f(e){for(var t,r,i=1,n=e.length,s=e[0]+"";i<n;){for(t=e[i++]+"",r=c-t.length;r--;t="0"+t);s+=t}for(n=s.length;48===s.charCodeAt(--n););return s.slice(0,n+1||1)}function v(e,t){var r,i,n=e.c,s=t.c,a=e.s,o=t.s,l=e.e,c=t.e;if(!a||!o)return null;if(r=n&&!n[0],i=s&&!s[0],r||i)return r?i?0:-o:a;if(a!=o)return a;if(r=a<0,i=l==c,!n||!s)return i?0:!n^r?1:-1;if(!i)return l>c^r?1:-1;for(o=(l=n.length)<(c=s.length)?l:c,a=0;a<o;a++)if(n[a]!=s[a])return n[a]>s[a]^r?1:-1;return l==c?0:l>c^r?1:-1}function g(e,t,r,i){if(e<t||e>r||e!==s(e))throw Error(a+(i||"Argument")+("number"==typeof e?e<t||e>r?" out of range: ":" not an integer: ":" not a primitive number: ")+String(e))}function _(e){var t=e.c.length-1;return p(e.e/c)==t&&e.c[t]%2!=0}function k(e,t){return(e.length>1?e.charAt(0)+"."+e.slice(1):e)+(t<0?"e":"e+")+t}function y(e,t,r){var i,n;if(t<0){for(n=r+".";++t;n+=r);e=n+e}else if(++t>(i=e.length)){for(n=r,t-=i;--t;n+=r);e+=n}else t<i&&(e=e.slice(0,t)+"."+e.slice(t));return e}r=function e(t){var r,w,T,b,E,S,P,A,C,I,j=$.prototype={constructor:$,toString:null,valueOf:null},x=new $(1),M=20,N=4,O=-7,R=21,B=-1e7,L=1e7,G=!1,F=1,D=0,H={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},U="0123456789abcdefghijklmnopqrstuvwxyz",W=!0;function $(e,t){var r,n,a,l,d,h,m,p,f=this;if(!(f instanceof $))return new $(e,t);if(null==t){if(e&&!0===e._isBigNumber)return f.s=e.s,void(!e.c||e.e>L?f.c=f.e=null:e.e<B?f.c=[f.e=0]:(f.e=e.e,f.c=e.c.slice()));if((h="number"==typeof e)&&0*e==0){if(f.s=1/e<0?(e=-e,-1):1,e===~~e){for(l=0,d=e;d>=10;d/=10,l++);return void(l>L?f.c=f.e=null:(f.e=l,f.c=[e]))}p=String(e)}else{if(!i.test(p=String(e)))return T(f,p,h);f.s=45==p.charCodeAt(0)?(p=p.slice(1),-1):1}(l=p.indexOf("."))>-1&&(p=p.replace(".","")),(d=p.search(/e/i))>0?(l<0&&(l=d),l+=+p.slice(d+1),p=p.substring(0,d)):l<0&&(l=p.length)}else{if(g(t,2,U.length,"Base"),10==t&&W)return Y(f=new $(e),M+f.e+1,N);if(p=String(e),h="number"==typeof e){if(0*e!=0)return T(f,p,h,t);if(f.s=1/e<0?(p=p.slice(1),-1):1,$.DEBUG&&p.replace(/^0\.0*|\./,"").length>15)throw Error(o+e)}else f.s=45===p.charCodeAt(0)?(p=p.slice(1),-1):1;for(r=U.slice(0,t),l=d=0,m=p.length;d<m;d++)if(r.indexOf(n=p.charAt(d))<0){if("."==n){if(d>l){l=m;continue}}else if(!a&&(p==p.toUpperCase()&&(p=p.toLowerCase())||p==p.toLowerCase()&&(p=p.toUpperCase()))){a=!0,d=-1,l=0;continue}return T(f,String(e),h,t)}h=!1,(l=(p=w(p,t,10,f.s)).indexOf("."))>-1?p=p.replace(".",""):l=p.length}for(d=0;48===p.charCodeAt(d);d++);for(m=p.length;48===p.charCodeAt(--m););if(p=p.slice(d,++m)){if(m-=d,h&&$.DEBUG&&m>15&&(e>u||e!==s(e)))throw Error(o+f.s*e);if((l=l-d-1)>L)f.c=f.e=null;else if(l<B)f.c=[f.e=0];else{if(f.e=l,f.c=[],d=(l+1)%c,l<0&&(d+=c),d<m){for(d&&f.c.push(+p.slice(0,d)),m-=c;d<m;)f.c.push(+p.slice(d,d+=c));d=c-(p=p.slice(d)).length}else d-=m;for(;d--;p+="0");f.c.push(+p)}}else f.c=[f.e=0]}function K(e,t,r,i){var n,s,a,o,l;if(null==r?r=N:g(r,0,8),!e.c)return e.toString();if(n=e.c[0],a=e.e,null==t)l=f(e.c),l=1==i||2==i&&(a<=O||a>=R)?k(l,a):y(l,a,"0");else if(s=(e=Y(new $(e),t,r)).e,o=(l=f(e.c)).length,1==i||2==i&&(t<=s||s<=O)){for(;o<t;l+="0",o++);l=k(l,s)}else if(t-=a,l=y(l,s,"0"),s+1>o){if(--t>0)for(l+=".";t--;l+="0");}else if((t+=s-o)>0)for(s+1==o&&(l+=".");t--;l+="0");return e.s<0&&n?"-"+l:l}function V(e,t){for(var r,i,n=1,s=new $(e[0]);n<e.length;n++)(!(i=new $(e[n])).s||(r=v(s,i))===t||0===r&&s.s===t)&&(s=i);return s}function q(e,t,r){for(var i=1,n=t.length;!t[--n];t.pop());for(n=t[0];n>=10;n/=10,i++);return(r=i+r*c-1)>L?e.c=e.e=null:r<B?e.c=[e.e=0]:(e.e=r,e.c=t),e}function Y(e,t,r,i){var a,o,u,h,m,p,f,v=e.c,g=d;if(v){e:{for(a=1,h=v[0];h>=10;h/=10,a++);if((o=t-a)<0)o+=c,u=t,m=v[p=0],f=s(m/g[a-u-1]%10);else if((p=n((o+1)/c))>=v.length){if(!i)break e;for(;v.length<=p;v.push(0));m=f=0,a=1,u=(o%=c)-c+1}else{for(m=h=v[p],a=1;h>=10;h/=10,a++);f=(u=(o%=c)-c+a)<0?0:s(m/g[a-u-1]%10)}if(i=i||t<0||null!=v[p+1]||(u<0?m:m%g[a-u-1]),i=r<4?(f||i)&&(0==r||r==(e.s<0?3:2)):f>5||5==f&&(4==r||i||6==r&&(o>0?u>0?m/g[a-u]:0:v[p-1])%10&1||r==(e.s<0?8:7)),t<1||!v[0])return v.length=0,i?(t-=e.e+1,v[0]=g[(c-t%c)%c],e.e=-t||0):v[0]=e.e=0,e;if(0==o?(v.length=p,h=1,p--):(v.length=p+1,h=g[c-o],v[p]=u>0?s(m/g[a-u]%g[u])*h:0),i)for(;;){if(0==p){for(o=1,u=v[0];u>=10;u/=10,o++);for(u=v[0]+=h,h=1;u>=10;u/=10,h++);o!=h&&(e.e++,v[0]==l&&(v[0]=1));break}if(v[p]+=h,v[p]!=l)break;v[p--]=0,h=1}for(o=v.length;0===v[--o];v.pop());}e.e>L?e.c=e.e=null:e.e<B&&(e.c=[e.e=0])}return e}function X(e){var t,r=e.e;return null===r?e.toString():(t=f(e.c),t=r<=O||r>=R?k(t,r):y(t,r,"0"),e.s<0?"-"+t:t)}return $.clone=e,$.ROUND_UP=0,$.ROUND_DOWN=1,$.ROUND_CEIL=2,$.ROUND_FLOOR=3,$.ROUND_HALF_UP=4,$.ROUND_HALF_DOWN=5,$.ROUND_HALF_EVEN=6,$.ROUND_HALF_CEIL=7,$.ROUND_HALF_FLOOR=8,$.EUCLID=9,$.config=$.set=function(e){var t,r;if(null!=e){if("object"!=typeof e)throw Error(a+"Object expected: "+e);if(e.hasOwnProperty(t="DECIMAL_PLACES")&&(g(r=e[t],0,m,t),M=r),e.hasOwnProperty(t="ROUNDING_MODE")&&(g(r=e[t],0,8,t),N=r),e.hasOwnProperty(t="EXPONENTIAL_AT")&&((r=e[t])&&r.pop?(g(r[0],-m,0,t),g(r[1],0,m,t),O=r[0],R=r[1]):(g(r,-m,m,t),O=-(R=r<0?-r:r))),e.hasOwnProperty(t="RANGE"))if((r=e[t])&&r.pop)g(r[0],-m,-1,t),g(r[1],1,m,t),B=r[0],L=r[1];else{if(g(r,-m,m,t),!r)throw Error(a+t+" cannot be zero: "+r);B=-(L=r<0?-r:r)}if(e.hasOwnProperty(t="CRYPTO")){if((r=e[t])!==!!r)throw Error(a+t+" not true or false: "+r);if(r){if("undefined"==typeof crypto||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw G=!r,Error(a+"crypto unavailable");G=r}else G=r}if(e.hasOwnProperty(t="MODULO_MODE")&&(g(r=e[t],0,9,t),F=r),e.hasOwnProperty(t="POW_PRECISION")&&(g(r=e[t],0,m,t),D=r),e.hasOwnProperty(t="FORMAT")){if("object"!=typeof(r=e[t]))throw Error(a+t+" not an object: "+r);H=r}if(e.hasOwnProperty(t="ALPHABET")){if("string"!=typeof(r=e[t])||/^.?$|[+\-.\s]|(.).*\1/.test(r))throw Error(a+t+" invalid: "+r);W="0123456789"==r.slice(0,10),U=r}}return{DECIMAL_PLACES:M,ROUNDING_MODE:N,EXPONENTIAL_AT:[O,R],RANGE:[B,L],CRYPTO:G,MODULO_MODE:F,POW_PRECISION:D,FORMAT:H,ALPHABET:U}},$.isBigNumber=function(e){if(!e||!0!==e._isBigNumber)return!1;if(!$.DEBUG)return!0;var t,r,i=e.c,n=e.e,o=e.s;e:if("[object Array]"=={}.toString.call(i)){if((1===o||-1===o)&&n>=-m&&n<=m&&n===s(n)){if(0===i[0]){if(0===n&&1===i.length)return!0;break e}if((t=(n+1)%c)<1&&(t+=c),String(i[0]).length==t){for(t=0;t<i.length;t++)if((r=i[t])<0||r>=l||r!==s(r))break e;if(0!==r)return!0}}}else if(null===i&&null===n&&(null===o||1===o||-1===o))return!0;throw Error(a+"Invalid BigNumber: "+e)},$.maximum=$.max=function(){return V(arguments,-1)},$.minimum=$.min=function(){return V(arguments,1)},$.random=(b=9007199254740992,E=Math.random()*b&2097151?function(){return s(Math.random()*b)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(e){var t,r,i,o,l,u=0,h=[],p=new $(x);if(null==e?e=M:g(e,0,m),o=n(e/c),G)if(crypto.getRandomValues){for(t=crypto.getRandomValues(new Uint32Array(o*=2));u<o;)(l=131072*t[u]+(t[u+1]>>>11))>=9e15?(r=crypto.getRandomValues(new Uint32Array(2)),t[u]=r[0],t[u+1]=r[1]):(h.push(l%1e14),u+=2);u=o/2}else{if(!crypto.randomBytes)throw G=!1,Error(a+"crypto unavailable");for(t=crypto.randomBytes(o*=7);u<o;)(l=281474976710656*(31&t[u])+1099511627776*t[u+1]+4294967296*t[u+2]+16777216*t[u+3]+(t[u+4]<<16)+(t[u+5]<<8)+t[u+6])>=9e15?crypto.randomBytes(7).copy(t,u):(h.push(l%1e14),u+=7);u=o/7}if(!G)for(;u<o;)(l=E())<9e15&&(h[u++]=l%1e14);for(o=h[--u],e%=c,o&&e&&(l=d[c-e],h[u]=s(o/l)*l);0===h[u];h.pop(),u--);if(u<0)h=[i=0];else{for(i=-1;0===h[0];h.splice(0,1),i-=c);for(u=1,l=h[0];l>=10;l/=10,u++);u<c&&(i-=c-u)}return p.e=i,p.c=h,p}),$.sum=function(){for(var e=1,t=arguments,r=new $(t[0]);e<t.length;)r=r.plus(t[e++]);return r},w=function(){var e="0123456789";function t(e,t,r,i){for(var n,s,a=[0],o=0,l=e.length;o<l;){for(s=a.length;s--;a[s]*=t);for(a[0]+=i.indexOf(e.charAt(o++)),n=0;n<a.length;n++)a[n]>r-1&&(null==a[n+1]&&(a[n+1]=0),a[n+1]+=a[n]/r|0,a[n]%=r)}return a.reverse()}return function(i,n,s,a,o){var l,c,u,d,h,m,p,v,g=i.indexOf("."),_=M,k=N;for(g>=0&&(d=D,D=0,i=i.replace(".",""),m=(v=new $(n)).pow(i.length-g),D=d,v.c=t(y(f(m.c),m.e,"0"),10,s,e),v.e=v.c.length),u=d=(p=t(i,n,s,o?(l=U,e):(l=e,U))).length;0==p[--d];p.pop());if(!p[0])return l.charAt(0);if(g<0?--u:(m.c=p,m.e=u,m.s=a,p=(m=r(m,v,_,k,s)).c,h=m.r,u=m.e),g=p[c=u+_+1],d=s/2,h=h||c<0||null!=p[c+1],h=k<4?(null!=g||h)&&(0==k||k==(m.s<0?3:2)):g>d||g==d&&(4==k||h||6==k&&1&p[c-1]||k==(m.s<0?8:7)),c<1||!p[0])i=h?y(l.charAt(1),-_,l.charAt(0)):l.charAt(0);else{if(p.length=c,h)for(--s;++p[--c]>s;)p[c]=0,c||(++u,p=[1].concat(p));for(d=p.length;!p[--d];);for(g=0,i="";g<=d;i+=l.charAt(p[g++]));i=y(i,u,l.charAt(0))}return i}}(),r=function(){function e(e,t,r){var i,n,s,a,o=0,l=e.length,c=t%h,u=t/h|0;for(e=e.slice();l--;)o=((n=c*(s=e[l]%h)+(i=u*s+(a=e[l]/h|0)*c)%h*h+o)/r|0)+(i/h|0)+u*a,e[l]=n%r;return o&&(e=[o].concat(e)),e}function t(e,t,r,i){var n,s;if(r!=i)s=r>i?1:-1;else for(n=s=0;n<r;n++)if(e[n]!=t[n]){s=e[n]>t[n]?1:-1;break}return s}function r(e,t,r,i){for(var n=0;r--;)e[r]-=n,n=e[r]<t[r]?1:0,e[r]=n*i+e[r]-t[r];for(;!e[0]&&e.length>1;e.splice(0,1));}return function(i,n,a,o,u){var d,h,m,f,v,g,_,k,y,w,T,b,E,S,P,A,C,I=i.s==n.s?1:-1,j=i.c,x=n.c;if(!(j&&j[0]&&x&&x[0]))return new $(i.s&&n.s&&(j?!x||j[0]!=x[0]:x)?j&&0==j[0]||!x?0*I:I/0:NaN);for(y=(k=new $(I)).c=[],I=a+(h=i.e-n.e)+1,u||(u=l,h=p(i.e/c)-p(n.e/c),I=I/c|0),m=0;x[m]==(j[m]||0);m++);if(x[m]>(j[m]||0)&&h--,I<0)y.push(1),f=!0;else{for(S=j.length,A=x.length,m=0,I+=2,(v=s(u/(x[0]+1)))>1&&(x=e(x,v,u),j=e(j,v,u),A=x.length,S=j.length),E=A,T=(w=j.slice(0,A)).length;T<A;w[T++]=0);C=x.slice(),C=[0].concat(C),P=x[0],x[1]>=u/2&&P++;do{if(v=0,(d=t(x,w,A,T))<0){if(b=w[0],A!=T&&(b=b*u+(w[1]||0)),(v=s(b/P))>1)for(v>=u&&(v=u-1),_=(g=e(x,v,u)).length,T=w.length;1==t(g,w,_,T);)v--,r(g,A<_?C:x,_,u),_=g.length,d=1;else 0==v&&(d=v=1),_=(g=x.slice()).length;if(_<T&&(g=[0].concat(g)),r(w,g,T,u),T=w.length,-1==d)for(;t(x,w,A,T)<1;)v++,r(w,A<T?C:x,T,u),T=w.length}else 0===d&&(v++,w=[0]);y[m++]=v,w[0]?w[T++]=j[E]||0:(w=[j[E]],T=1)}while((E++<S||null!=w[0])&&I--);f=null!=w[0],y[0]||y.splice(0,1)}if(u==l){for(m=1,I=y[0];I>=10;I/=10,m++);Y(k,a+(k.e=m+h*c-1)+1,o,f)}else k.e=h,k.r=+f;return k}}(),S=/^(-?)0([xbo])(?=\w[\w.]*$)/i,P=/^([^.]+)\.$/,A=/^\.([^.]+)$/,C=/^-?(Infinity|NaN)$/,I=/^\s*\+(?=[\w.])|^\s+|\s+$/g,T=function(e,t,r,i){var n,s=r?t:t.replace(I,"");if(C.test(s))e.s=isNaN(s)?null:s<0?-1:1;else{if(!r&&(s=s.replace(S,(function(e,t,r){return n="x"==(r=r.toLowerCase())?16:"b"==r?2:8,i&&i!=n?e:t})),i&&(n=i,s=s.replace(P,"$1").replace(A,"0.$1")),t!=s))return new $(s,n);if($.DEBUG)throw Error(a+"Not a"+(i?" base "+i:"")+" number: "+t);e.s=null}e.c=e.e=null},j.absoluteValue=j.abs=function(){var e=new $(this);return e.s<0&&(e.s=1),e},j.comparedTo=function(e,t){return v(this,new $(e,t))},j.decimalPlaces=j.dp=function(e,t){var r,i,n,s=this;if(null!=e)return g(e,0,m),null==t?t=N:g(t,0,8),Y(new $(s),e+s.e+1,t);if(!(r=s.c))return null;if(i=((n=r.length-1)-p(this.e/c))*c,n=r[n])for(;n%10==0;n/=10,i--);return i<0&&(i=0),i},j.dividedBy=j.div=function(e,t){return r(this,new $(e,t),M,N)},j.dividedToIntegerBy=j.idiv=function(e,t){return r(this,new $(e,t),0,1)},j.exponentiatedBy=j.pow=function(e,t){var r,i,o,l,u,d,h,m,p=this;if((e=new $(e)).c&&!e.isInteger())throw Error(a+"Exponent not an integer: "+X(e));if(null!=t&&(t=new $(t)),u=e.e>14,!p.c||!p.c[0]||1==p.c[0]&&!p.e&&1==p.c.length||!e.c||!e.c[0])return m=new $(Math.pow(+X(p),u?e.s*(2-_(e)):+X(e))),t?m.mod(t):m;if(d=e.s<0,t){if(t.c?!t.c[0]:!t.s)return new $(NaN);(i=!d&&p.isInteger()&&t.isInteger())&&(p=p.mod(t))}else{if(e.e>9&&(p.e>0||p.e<-1||(0==p.e?p.c[0]>1||u&&p.c[1]>=24e7:p.c[0]<8e13||u&&p.c[0]<=9999975e7)))return l=p.s<0&&_(e)?-0:0,p.e>-1&&(l=1/l),new $(d?1/l:l);D&&(l=n(D/c+2))}for(u?(r=new $(.5),d&&(e.s=1),h=_(e)):h=(o=Math.abs(+X(e)))%2,m=new $(x);;){if(h){if(!(m=m.times(p)).c)break;l?m.c.length>l&&(m.c.length=l):i&&(m=m.mod(t))}if(o){if(0===(o=s(o/2)))break;h=o%2}else if(Y(e=e.times(r),e.e+1,1),e.e>14)h=_(e);else{if(0===(o=+X(e)))break;h=o%2}p=p.times(p),l?p.c&&p.c.length>l&&(p.c.length=l):i&&(p=p.mod(t))}return i?m:(d&&(m=x.div(m)),t?m.mod(t):l?Y(m,D,N,undefined):m)},j.integerValue=function(e){var t=new $(this);return null==e?e=N:g(e,0,8),Y(t,t.e+1,e)},j.isEqualTo=j.eq=function(e,t){return 0===v(this,new $(e,t))},j.isFinite=function(){return!!this.c},j.isGreaterThan=j.gt=function(e,t){return v(this,new $(e,t))>0},j.isGreaterThanOrEqualTo=j.gte=function(e,t){return 1===(t=v(this,new $(e,t)))||0===t},j.isInteger=function(){return!!this.c&&p(this.e/c)>this.c.length-2},j.isLessThan=j.lt=function(e,t){return v(this,new $(e,t))<0},j.isLessThanOrEqualTo=j.lte=function(e,t){return-1===(t=v(this,new $(e,t)))||0===t},j.isNaN=function(){return!this.s},j.isNegative=function(){return this.s<0},j.isPositive=function(){return this.s>0},j.isZero=function(){return!!this.c&&0==this.c[0]},j.minus=function(e,t){var r,i,n,s,a=this,o=a.s;if(t=(e=new $(e,t)).s,!o||!t)return new $(NaN);if(o!=t)return e.s=-t,a.plus(e);var u=a.e/c,d=e.e/c,h=a.c,m=e.c;if(!u||!d){if(!h||!m)return h?(e.s=-t,e):new $(m?a:NaN);if(!h[0]||!m[0])return m[0]?(e.s=-t,e):new $(h[0]?a:3==N?-0:0)}if(u=p(u),d=p(d),h=h.slice(),o=u-d){for((s=o<0)?(o=-o,n=h):(d=u,n=m),n.reverse(),t=o;t--;n.push(0));n.reverse()}else for(i=(s=(o=h.length)<(t=m.length))?o:t,o=t=0;t<i;t++)if(h[t]!=m[t]){s=h[t]<m[t];break}if(s&&(n=h,h=m,m=n,e.s=-e.s),(t=(i=m.length)-(r=h.length))>0)for(;t--;h[r++]=0);for(t=l-1;i>o;){if(h[--i]<m[i]){for(r=i;r&&!h[--r];h[r]=t);--h[r],h[i]+=l}h[i]-=m[i]}for(;0==h[0];h.splice(0,1),--d);return h[0]?q(e,h,d):(e.s=3==N?-1:1,e.c=[e.e=0],e)},j.modulo=j.mod=function(e,t){var i,n,s=this;return e=new $(e,t),!s.c||!e.s||e.c&&!e.c[0]?new $(NaN):!e.c||s.c&&!s.c[0]?new $(s):(9==F?(n=e.s,e.s=1,i=r(s,e,0,3),e.s=n,i.s*=n):i=r(s,e,0,F),(e=s.minus(i.times(e))).c[0]||1!=F||(e.s=s.s),e)},j.multipliedBy=j.times=function(e,t){var r,i,n,s,a,o,u,d,m,f,v,g,_,k,y,w=this,T=w.c,b=(e=new $(e,t)).c;if(!(T&&b&&T[0]&&b[0]))return!w.s||!e.s||T&&!T[0]&&!b||b&&!b[0]&&!T?e.c=e.e=e.s=null:(e.s*=w.s,T&&b?(e.c=[0],e.e=0):e.c=e.e=null),e;for(i=p(w.e/c)+p(e.e/c),e.s*=w.s,(u=T.length)<(f=b.length)&&(_=T,T=b,b=_,n=u,u=f,f=n),n=u+f,_=[];n--;_.push(0));for(k=l,y=h,n=f;--n>=0;){for(r=0,v=b[n]%y,g=b[n]/y|0,s=n+(a=u);s>n;)r=((d=v*(d=T[--a]%y)+(o=g*d+(m=T[a]/y|0)*v)%y*y+_[s]+r)/k|0)+(o/y|0)+g*m,_[s--]=d%k;_[s]=r}return r?++i:_.splice(0,1),q(e,_,i)},j.negated=function(){var e=new $(this);return e.s=-e.s||null,e},j.plus=function(e,t){var r,i=this,n=i.s;if(t=(e=new $(e,t)).s,!n||!t)return new $(NaN);if(n!=t)return e.s=-t,i.minus(e);var s=i.e/c,a=e.e/c,o=i.c,u=e.c;if(!s||!a){if(!o||!u)return new $(n/0);if(!o[0]||!u[0])return u[0]?e:new $(o[0]?i:0*n)}if(s=p(s),a=p(a),o=o.slice(),n=s-a){for(n>0?(a=s,r=u):(n=-n,r=o),r.reverse();n--;r.push(0));r.reverse()}for((n=o.length)-(t=u.length)<0&&(r=u,u=o,o=r,t=n),n=0;t;)n=(o[--t]=o[t]+u[t]+n)/l|0,o[t]=l===o[t]?0:o[t]%l;return n&&(o=[n].concat(o),++a),q(e,o,a)},j.precision=j.sd=function(e,t){var r,i,n,s=this;if(null!=e&&e!==!!e)return g(e,1,m),null==t?t=N:g(t,0,8),Y(new $(s),e,t);if(!(r=s.c))return null;if(i=(n=r.length-1)*c+1,n=r[n]){for(;n%10==0;n/=10,i--);for(n=r[0];n>=10;n/=10,i++);}return e&&s.e+1>i&&(i=s.e+1),i},j.shiftedBy=function(e){return g(e,-9007199254740991,u),this.times("1e"+e)},j.squareRoot=j.sqrt=function(){var e,t,i,n,s,a=this,o=a.c,l=a.s,c=a.e,u=M+4,d=new $("0.5");if(1!==l||!o||!o[0])return new $(!l||l<0&&(!o||o[0])?NaN:o?a:1/0);if(0==(l=Math.sqrt(+X(a)))||l==1/0?(((t=f(o)).length+c)%2==0&&(t+="0"),l=Math.sqrt(+t),c=p((c+1)/2)-(c<0||c%2),i=new $(t=l==1/0?"5e"+c:(t=l.toExponential()).slice(0,t.indexOf("e")+1)+c)):i=new $(l+""),i.c[0])for((l=(c=i.e)+u)<3&&(l=0);;)if(s=i,i=d.times(s.plus(r(a,s,u,1))),f(s.c).slice(0,l)===(t=f(i.c)).slice(0,l)){if(i.e<c&&--l,"9999"!=(t=t.slice(l-3,l+1))&&(n||"4999"!=t)){+t&&(+t.slice(1)||"5"!=t.charAt(0))||(Y(i,i.e+M+2,1),e=!i.times(i).eq(a));break}if(!n&&(Y(s,s.e+M+2,0),s.times(s).eq(a))){i=s;break}u+=4,l+=4,n=1}return Y(i,i.e+M+1,N,e)},j.toExponential=function(e,t){return null!=e&&(g(e,0,m),e++),K(this,e,t,1)},j.toFixed=function(e,t){return null!=e&&(g(e,0,m),e=e+this.e+1),K(this,e,t)},j.toFormat=function(e,t,r){var i,n=this;if(null==r)null!=e&&t&&"object"==typeof t?(r=t,t=null):e&&"object"==typeof e?(r=e,e=t=null):r=H;else if("object"!=typeof r)throw Error(a+"Argument not an object: "+r);if(i=n.toFixed(e,t),n.c){var s,o=i.split("."),l=+r.groupSize,c=+r.secondaryGroupSize,u=r.groupSeparator||"",d=o[0],h=o[1],m=n.s<0,p=m?d.slice(1):d,f=p.length;if(c&&(s=l,l=c,c=s,f-=s),l>0&&f>0){for(s=f%l||l,d=p.substr(0,s);s<f;s+=l)d+=u+p.substr(s,l);c>0&&(d+=u+p.slice(s)),m&&(d="-"+d)}i=h?d+(r.decimalSeparator||"")+((c=+r.fractionGroupSize)?h.replace(new RegExp("\\d{"+c+"}\\B","g"),"$&"+(r.fractionGroupSeparator||"")):h):d}return(r.prefix||"")+i+(r.suffix||"")},j.toFraction=function(e){var t,i,n,s,o,l,u,h,m,p,v,g,_=this,k=_.c;if(null!=e&&(!(u=new $(e)).isInteger()&&(u.c||1!==u.s)||u.lt(x)))throw Error(a+"Argument "+(u.isInteger()?"out of range: ":"not an integer: ")+X(u));if(!k)return new $(_);for(t=new $(x),m=i=new $(x),n=h=new $(x),g=f(k),o=t.e=g.length-_.e-1,t.c[0]=d[(l=o%c)<0?c+l:l],e=!e||u.comparedTo(t)>0?o>0?t:m:u,l=L,L=1/0,u=new $(g),h.c[0]=0;p=r(u,t,0,1),1!=(s=i.plus(p.times(n))).comparedTo(e);)i=n,n=s,m=h.plus(p.times(s=m)),h=s,t=u.minus(p.times(s=t)),u=s;return s=r(e.minus(i),n,0,1),h=h.plus(s.times(m)),i=i.plus(s.times(n)),h.s=m.s=_.s,v=r(m,n,o*=2,N).minus(_).abs().comparedTo(r(h,i,o,N).minus(_).abs())<1?[m,n]:[h,i],L=l,v},j.toNumber=function(){return+X(this)},j.toPrecision=function(e,t){return null!=e&&g(e,1,m),K(this,e,t,2)},j.toString=function(e){var t,r=this,i=r.s,n=r.e;return null===n?i?(t="Infinity",i<0&&(t="-"+t)):t="NaN":(null==e?t=n<=O||n>=R?k(f(r.c),n):y(f(r.c),n,"0"):10===e&&W?t=y(f((r=Y(new $(r),M+n+1,N)).c),r.e,"0"):(g(e,2,U.length,"Base"),t=w(y(f(r.c),n,"0"),10,e,i,!0)),i<0&&r.c[0]&&(t="-"+t)),t},j.valueOf=j.toJSON=function(){return X(this)},j._isBigNumber=!0,null!=t&&$.set(t),$}(),r.default=r.BigNumber=r,"function"==typeof define&&define.amd?define((function(){return r})):void 0!==t&&t.exports?t.exports=r:(e||(e="undefined"!=typeof self&&self?self:window),e.BigNumber=r)}(this)}}},{package:"@metamask/smart-transactions-controller>bignumber.js",file:"node_modules/@metamask/smart-transactions-controller/node_modules/bignumber.js/bignumber.js"}],[1956,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){t.exports=[{constant:!1,inputs:[{name:"_new",type:"address"}],name:"setOwner",outputs:[],payable:!1,type:"function"},{constant:!0,inputs:[],name:"totalSignatures",outputs:[{name:"",type:"uint256"}],payable:!1,type:"function"},{constant:!0,inputs:[],name:"owner",outputs:[{name:"",type:"address"}],payable:!1,type:"function"},{constant:!1,inputs:[],name:"drain",outputs:[],payable:!1,type:"function"},{constant:!0,inputs:[{name:"",type:"bytes4"}],name:"entries",outputs:[{name:"",type:"string"}],payable:!1,type:"function"},{constant:!1,inputs:[{name:"_method",type:"string"}],name:"register",outputs:[{name:"",type:"bool"}],payable:!1,type:"function"},{inputs:[],type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,name:"creator",type:"address"},{indexed:!0,name:"signature",type:"bytes4"},{indexed:!1,name:"method",type:"string"}],name:"Registered",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"old",type:"address"},{indexed:!0,name:"current",type:"address"}],name:"NewOwner",type:"event"}]}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>eth-method-registry",file:"node_modules/@metamask/smart-transactions-controller/node_modules/eth-method-registry/dist/abi.json"}],[1957,{"./abi.json":1956,"./registry-map.json":1958,"@metamask/ethjs-contract":1841,"@metamask/ethjs-query":1844},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.MethodRegistry=void 0;const n=i(e("@metamask/ethjs-query")),s=i(e("@metamask/ethjs-contract")),a=i(e("./registry-map.json")),o=i(e("./abi.json"));r.MethodRegistry=class{constructor(e){if(!e.provider)throw new Error("Missing required 'provider' option");const t=a.default[e.network||"1"];if(!t)throw new Error("No method registry found on the requested network.");const r=new n.default(e.provider),i=(0,s.default)(r);this.registry=i(o.default).at(t)}async lookup(e){const t=await this.registry.entries(e);return t?t[0]:undefined}parse(e){const t=e.match(/^([^)(]*)\((.*)\)([^)(]*)$/u);let r;if(r=t?t[1].charAt(0).toUpperCase()+t[1].slice(1).split(/(?=[A-Z])/u).join(" "):"",t){const i=e.match(new RegExp(`${t[1]}\\(+([a-z1-9,()\\[\\]]+)\\)`,"u"));let n,s=[];return i&&(n=i[1].match(/[A-z1-9]+/gu),n&&(s=n.map((e=>({type:e}))))),{name:r,args:s}}return{}}}}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>eth-method-registry",file:"node_modules/@metamask/smart-transactions-controller/node_modules/eth-method-registry/dist/index.js"}],[1958,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){t.exports={1:"0x44691B39d1a75dC4E0A0346CBB15E310e6ED1E86"}}}},{package:"@metamask/smart-transactions-controller>@metamask/transaction-controller>eth-method-registry",file:"node_modules/@metamask/smart-transactions-controller/node_modules/eth-method-registry/dist/registry-map.json"}],[1959,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){t.exports={name:"@metamask/smart-transactions-controller",version:"10.1.2",description:"Improves success rates for swaps by trialing transactions privately and finding minimum fees",repository:{type:"git",url:"https://github.com/MetaMask/smart-transactions-controller.git"},license:"SEE LICENSE IN LICENSE",main:"dist/index.js",types:"dist/index.d.ts",files:["dist/"],scripts:{build:"tsc --project .","build:clean":"rm -rf dist && yarn build","build:link":"yarn build && cd dist && yarn link && rm -rf node_modules && cd ..",lint:"yarn lint:eslint && yarn lint:misc --check","lint:eslint":"eslint . --cache --ext js,ts","lint:fix":"yarn lint:eslint --fix && yarn lint:misc --write","lint:misc":"prettier '**/*.json' '**/*.md' '!CHANGELOG.md' '**/*.yml' '!.yarnrc.yml' --ignore-path .gitignore",prepack:"./scripts/prepack.sh",test:"jest","test:watch":"jest --watchAll"},dependencies:{"@babel/runtime":"^7.24.1","@ethereumjs/tx":"^5.2.1","@ethereumjs/util":"^9.0.2","@ethersproject/bytes":"^5.7.0","@metamask/base-controller":"^5.0.1","@metamask/controller-utils":"^9.1.0","@metamask/eth-query":"^4.0.0","@metamask/network-controller":"^18.1.2","@metamask/polling-controller":"^6.0.1","@metamask/transaction-controller":"^30.0.0","bignumber.js":"^9.0.1",events:"^3.3.0","fast-json-patch":"^3.1.0",lodash:"^4.17.21"},devDependencies:{"@lavamoat/allow-scripts":"^2.3.1","@metamask/auto-changelog":"^3.1.0","@metamask/eslint-config":"^12.2.0","@metamask/eslint-config-jest":"^12.1.0","@metamask/eslint-config-nodejs":"^12.1.0","@metamask/eslint-config-typescript":"^12.1.0","@types/jest":"^26.0.24","@types/lodash":"^4.14.194","@types/node":"^18.19.17","@types/sinon":"^9.0.10","@typescript-eslint/eslint-plugin":"^5.33.0","@typescript-eslint/parser":"^5.33.0",eslint:"^8.48.0","eslint-config-prettier":"^8.8.0","eslint-plugin-import":"^2.27.5","eslint-plugin-jest":"^27.1.5","eslint-plugin-jsdoc":"^39.2.9","eslint-plugin-n":"^15.7.0","eslint-plugin-prettier":"^4.2.1","eslint-plugin-promise":"^6.1.1","isomorphic-fetch":"^3.0.0",jest:"^26.4.2",nock:"^13.3.1",prettier:"^2.8.8","prettier-plugin-packagejson":"^2.4.3",sinon:"^9.2.4","ts-jest":"^26.5.6",typescript:"~4.8.4"},packageManager:"yarn@3.2.1",engines:{node:"^18.18 || >=20"},publishConfig:{access:"public",registry:"https://registry.npmjs.org/"},lavamoat:{allowScripts:{"@lavamoat/preinstall-always-fail":!1,"@metamask/controller-utils>ethereumjs-util>ethereum-cryptography>keccak":!1,"@metamask/controller-utils>ethereumjs-util>ethereum-cryptography>secp256k1":!1,"@metamask/controller-utils>babel-runtime>core-js":!1}}}}}},{package:"@metamask/smart-transactions-controller",file:"node_modules/@metamask/smart-transactions-controller/package.json"}],[196,{lodash:3836},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=e("lodash");r.default={version:76,async migrate(e){const t=(0,i.cloneDeep)(e);t.meta.version=76;const r=function(e){var t;if(e.CollectiblesController){const{allCollectibleContracts:t,allCollectibles:r,ignoredCollectibles:i,...n}=e.CollectiblesController;e.NftController={...t?{allNftContracts:t}:{},...r?{allNfts:r}:{},...i?{ignoredNfts:i}:{},...n},delete e.CollectiblesController}null!==(t=e.PreferencesController)&&void 0!==t&&t.useCollectibleDetection&&(e.PreferencesController.useNftDetection=e.PreferencesController.useCollectibleDetection,delete e.PreferencesController.useCollectibleDetection);return e}(t.data);return t.data=r,t}}}}},{package:"$root$",file:"app/scripts/migrations/076.js"}],[1960,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i=(e=>(e[e.Unverified=0]="Unverified",e[e.Blocked=1]="Blocked",e[e.Verified=2]="Verified",e[e.Unavailable=3]="Unavailable",e))(i||{});r.SnapsRegistryStatus=i}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-4CA3O64H.js"}],[1961,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-4URGXJP7.js"}],[1962,{"./chunk-EXN2TFDJ.js":1971,"./chunk-KH72WRHR.js":1978,"@metamask/post-message-stream":1669},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i,n=e("./chunk-KH72WRHR.js"),s=e("./chunk-EXN2TFDJ.js"),a=e("@metamask/post-message-stream"),o=class extends n.ProxyExecutionService{constructor({messenger:e,setupSnapProvider:t,offscreenPromise:r}){super({messenger:e,setupSnapProvider:t,stream:new(0,a.BrowserRuntimePostMessageStream)({name:"parent",target:"child"})}),s.__privateAdd.call(void 0,this,i,void 0),s.__privateSet.call(void 0,this,i,r)}async initEnvStream(e){return await s.__privateGet.call(void 0,this,i),await super.initEnvStream(e)}};i=new WeakMap,r.OffscreenExecutionService=o}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-6ERB63FH.js"}],[1963,{"./chunk-EXN2TFDJ.js":1971,"./chunk-WCDDYBFW.js":1987,"@metamask/base-controller":1999,"@metamask/snaps-utils":2163,"@metamask/utils":2300,nanoid:2031},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i,n,s,a,o,l,c,u,d,h,m=e("./chunk-WCDDYBFW.js"),p=e("./chunk-EXN2TFDJ.js"),f=e("@metamask/base-controller"),v=e("@metamask/snaps-utils"),g=e("@metamask/utils"),_=e("nanoid"),k=1e7,y="SnapInterfaceController",w=class extends f.BaseController{constructor({messenger:e,state:t}){super({messenger:e,metadata:{interfaces:{persist:!1,anonymous:!1}},name:y,state:{interfaces:{},...t}}),p.__privateAdd.call(void 0,this,i),p.__privateAdd.call(void 0,this,s),p.__privateAdd.call(void 0,this,o),p.__privateAdd.call(void 0,this,c),p.__privateAdd.call(void 0,this,d),p.__privateMethod.call(void 0,this,i,n).call(this)}async createInterface(e,t,r){const i=m.getJsxInterface.call(void 0,t);await p.__privateMethod.call(void 0,this,d,h).call(this,i),m.validateInterfaceContext.call(void 0,r);const n=_.nanoid.call(void 0),s=m.constructState.call(void 0,{},i);return this.update((t=>{t.interfaces[n]={snapId:e,content:i,state:s,context:r??null}})),n}getInterface(e,t){return p.__privateMethod.call(void 0,this,s,a).call(this,e,t),this.state.interfaces[t]}async updateInterface(e,t,r){p.__privateMethod.call(void 0,this,s,a).call(this,e,t);const i=m.getJsxInterface.call(void 0,r);await p.__privateMethod.call(void 0,this,d,h).call(this,i);const n=this.state.interfaces[t].state,o=m.constructState.call(void 0,n,i);this.update((e=>{e.interfaces[t].state=o,e.interfaces[t].content=i}))}deleteInterface(e){this.update((t=>{delete t.interfaces[e]}))}updateInterfaceState(e,t){this.update((r=>{r.interfaces[e].state=t}))}};i=new WeakSet,n=function(){this.messagingSystem.registerActionHandler(`${y}:createInterface`,this.createInterface.bind(this)),this.messagingSystem.registerActionHandler(`${y}:getInterface`,this.getInterface.bind(this)),this.messagingSystem.registerActionHandler(`${y}:updateInterface`,this.updateInterface.bind(this)),this.messagingSystem.registerActionHandler(`${y}:deleteInterface`,this.deleteInterface.bind(this)),this.messagingSystem.registerActionHandler(`${y}:updateInterfaceState`,this.updateInterfaceState.bind(this))},s=new WeakSet,a=function(e,t){const r=this.state.interfaces[t];g.assert.call(void 0,void 0!==r,`Interface with id '${t}' not found.`),g.assert.call(void 0,r.snapId===e,`Interface not created by ${e}.`)},o=new WeakSet,l=async function(){await this.messagingSystem.call("PhishingController:maybeUpdateState")},c=new WeakSet,u=function(e){return this.messagingSystem.call("PhishingController:testOrigin",e).result},d=new WeakSet,h=async function(e){const t=v.getJsonSizeUnsafe.call(void 0,e);g.assert.call(void 0,t<=k,"A Snap UI may not be larger than 10 MB."),await p.__privateMethod.call(void 0,this,o,l).call(this),v.validateJsxLinks.call(void 0,e,p.__privateMethod.call(void 0,this,c,u).bind(this))},r.SnapInterfaceController=w}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-6VGMRXGY.js"}],[1964,{"./chunk-EXN2TFDJ.js":1971,"@metamask/post-message-stream":1669},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i,n,s,a,o=e("./chunk-EXN2TFDJ.js"),l=e("@metamask/post-message-stream"),c=class extends l.BasePostMessageStream{constructor({stream:e,jobId:t}){super(),o.__privateAdd.call(void 0,this,s),o.__privateAdd.call(void 0,this,i,void 0),o.__privateAdd.call(void 0,this,n,void 0),o.__privateSet.call(void 0,this,i,e),o.__privateSet.call(void 0,this,n,t),o.__privateGet.call(void 0,this,i).on("data",o.__privateMethod.call(void 0,this,s,a).bind(this))}_postMessage(e){o.__privateGet.call(void 0,this,i).write({jobId:o.__privateGet.call(void 0,this,n),data:e})}};i=new WeakMap,n=new WeakMap,s=new WeakSet,a=function(e){e.jobId===o.__privateGet.call(void 0,this,n)&&this.push(e.data)},r.ProxyPostMessageStream=c}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-7Y6P5FRN.js"}],[1965,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});r.RequestQueue=class{constructor(e){this.maxQueueSize=e,this.queueSizes=new Map}increment(e){const t=this.queueSizes.get(e)??0;if(t>=this.maxQueueSize)throw new Error("Maximum number of requests reached. Try again later.");this.queueSizes.set(e,t+1)}decrement(e){const t=this.queueSizes.get(e)??0;if(0===t)throw new Error(`Cannot decrement, ${e} does not have any outstanding requests.`);this.queueSizes.set(e,t-1)}get(e){return this.queueSizes.get(e)??0}}}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-AP7CJ6DA.js"}],[1966,{"@metamask/utils":2300,"@xstate/fsm":2645},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i=e("@metamask/utils"),n=e("@xstate/fsm");r.validateMachine=function(e){i.assert.call(void 0,"_options"in e,"The machine is not an @xstate/fsm machine");const t=e,r=new Set,n=e=>{return(t=e,Array.isArray(t)?t:null==t?[]:[t]).flatMap((e=>"string"==typeof e?[e]:(i.assert.call(void 0,"function"==typeof e),[]))).forEach(r.add.bind(r));var t};for(const e of Object.values(t.config.states)){n(e.entry),n(e.exit);for(const t of Object.values(e.on??{}))n(t.actions)}r.forEach((e=>i.assert.call(void 0,void 0!==t._options.actions&&e in t._options.actions,`Action "${e}" doesn't have an implementation`)))},r.forceStrict=function(e){let t=!1;e.subscribe((e=>{i.assert.call(void 0,!t||e.changed,"Invalid state transition"),t=!0}));const r=e.send.bind(e);e.send=(...t)=>(i.assert.call(void 0,e.status===n.InterpreterStatus.Running,"Interpreter is stopped"),r(...t))}}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-BO2ZDPWV.js"}],[1967,{"@metamask/utils":2300},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i=e("@metamask/utils");r.Timer=class{constructor(e){i.assert.call(void 0,!Number.isNaN(e),new TypeError("Can't start a timer with NaN time")),i.assert.call(void 0,e>=0,new TypeError("Can't start a timer with negative time")),this.state={value:"stopped",remaining:e}}get status(){return this.state.value}get remaining(){return this.state.remaining}cancel(){i.assert.call(void 0,"paused"===this.status||"running"===this.status,new Error("Tried to cancel a not running Timer")),this.onFinish(!1)}finish(){i.assert.call(void 0,"finished"!==this.status,new Error("Tried to finish a finished Timer.")),this.onFinish(!0)}pause(){i.assert.call(void 0,"running"===this.state.value,new Error("Tried to pause a not running Timer"));const{callback:e,start:t,timeout:r,remaining:n}=this.state;void 0!==r&&clearTimeout(r),this.state={value:"paused",callback:e,remaining:n-(Date.now()-t)}}start(e){i.assert.call(void 0,"stopped"===this.state.value,new Error("Tried to start an already running Timer"));const{remaining:t}=this.state;this.state={value:"paused",remaining:t,callback:e},this.resume()}resume(){i.assert.call(void 0,"paused"===this.state.value,new Error("Tried to resume not paused Timer"));const{remaining:e,callback:t}=this.state,r=Date.now();let n;e!==Number.POSITIVE_INFINITY&&(n=setTimeout((()=>this.onFinish(!0)),e)),this.state={value:"running",callback:t,remaining:e,start:r,timeout:n}}onFinish(e){i.assert.call(void 0,"running"===this.state.value||"paused"===this.state.value),"running"===this.state.value&&void 0!==this.state.timeout&&clearTimeout(this.state.timeout);const{callback:t,remaining:r}=this.state;this.state={value:"finished",remaining:"running"===this.state.value?r-(Date.now()-this.state.start):r},e&&t()}}}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-BOFPNIRX.js"}],[1968,{"./chunk-BOFPNIRX.js":1967,"@metamask/snaps-sdk":2122,"@metamask/snaps-utils":2163,"fast-deep-equal":3356},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i,n=e("./chunk-BOFPNIRX.js"),s=e("@metamask/snaps-sdk"),a=e("@metamask/snaps-utils"),o=e("fast-deep-equal"),l=(i=o)&&i.__esModule?i:{default:i};function c(e,t){return Object.entries(e).reduce(((e,[r,i])=>(r in t||(e[r]=i),e)),{})}function u(e,t){let r;const i=new Promise(((i,n)=>{e.start((()=>{void 0===t?i():i(t)})),r=n}));return i.cancel=()=>{"finished"!==e.status&&(e.cancel(),r(new Error("The delay has been canceled.")))},i}var d=Symbol("Used to check if the requested promise has timeout (see withTimeout)");async function h(e,t){return t&&0!==t.length?await Promise.all(t.map((async t=>e.fetch(t)))):[]}r.setDiff=c,r.permissionsDiff=function(e,t){return Object.entries(e).reduce(((e,[r,i])=>{const n=r in t;return(!n||n&&!l.default.call(void 0,i.caveats??[],t[r].caveats??[]))&&(e[r]=i),e}),{})},r.delay=function(e,t){return u(new(0,n.Timer)(e),t)},r.delayWithTimer=u,r.hasTimedOut=d,r.withTimeout=async function(e,t){const r=u("number"==typeof t?new(0,n.Timer)(t):t,d);try{return await Promise.race([e,r])}finally{r.cancel()}},r.getSnapFiles=h,r.fetchSnap=async function(e,t){try{const e=await t.manifest(),r=await t.fetch(e.result.source.location.npm.filePath),{iconPath:i}=e.result.source.location.npm,n=i?await t.fetch(i):void 0,s=await h(t,e.result.source.files);await Promise.all(s.map((async e=>{e.data.base64=await a.encodeBase64.call(void 0,e)})));const o=await h(t,e.result.source.locales),l={manifest:e,sourceCode:r,svgIcon:n,auxiliaryFiles:s,localizationFiles:a.getValidatedLocalizationFiles.call(void 0,o)};return await a.validateFetchedSnap.call(void 0,l),l}catch(t){throw new Error(`Failed to fetch snap "${e}": ${s.getErrorMessage.call(void 0,t)}.`)}},r.calculateConnectionsChange=function(e,t){const r=c(t,e),i=c(e,t);return{newConnections:r,unusedConnections:i,approvedConnections:c(e,i)}}}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-CDTGUNSA.js"}],[1969,{"./chunk-EXN2TFDJ.js":1971,"@metamask/base-controller":1999,"@metamask/snaps-registry":2038,"@metamask/snaps-utils":2163,"@metamask/utils":2300},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i,n,s,a,o,l,c,u,d,h,m,p,f,v,g,_,k,y,w,T,b,E,S,P,A,C,I=e("./chunk-EXN2TFDJ.js"),j=e("@metamask/base-controller"),x=e("@metamask/snaps-registry"),M=e("@metamask/snaps-utils"),N=e("@metamask/utils"),O={database:null,lastUpdated:null,databaseUnavailable:!1},R=class extends j.BaseController{constructor({messenger:e,state:t,url:r={registry:"https://acl.execution.metamask.io/latest/registry.json",signature:"https://acl.execution.metamask.io/latest/signature.json"},publicKey:u="0x025b65308f0f0fb8bc7f7ff87bfc296e0330eee5d3c1d1ee4a048b2fd6a86fa0a6",fetchFunction:p=globalThis.fetch.bind(globalThis),recentFetchThreshold:v=N.inMilliseconds.call(void 0,5,N.Duration.Minute),refetchOnAllowlistMiss:_=!0}){super({messenger:e,metadata:{database:{persist:!0,anonymous:!1},lastUpdated:{persist:!0,anonymous:!1},databaseUnavailable:{persist:!0,anonymous:!1}},name:"SnapsRegistry",state:{...O,...t}}),I.__privateAdd.call(void 0,this,c),I.__privateAdd.call(void 0,this,d),I.__privateAdd.call(void 0,this,m),I.__privateAdd.call(void 0,this,f),I.__privateAdd.call(void 0,this,g),I.__privateAdd.call(void 0,this,k),I.__privateAdd.call(void 0,this,w),I.__privateAdd.call(void 0,this,b),I.__privateAdd.call(void 0,this,S),I.__privateAdd.call(void 0,this,A),I.__privateAdd.call(void 0,this,i,void 0),I.__privateAdd.call(void 0,this,n,void 0),I.__privateAdd.call(void 0,this,s,void 0),I.__privateAdd.call(void 0,this,a,void 0),I.__privateAdd.call(void 0,this,o,void 0),I.__privateAdd.call(void 0,this,l,void 0),I.__privateSet.call(void 0,this,i,r),I.__privateSet.call(void 0,this,n,u),I.__privateSet.call(void 0,this,s,p),I.__privateSet.call(void 0,this,a,v),I.__privateSet.call(void 0,this,o,_),I.__privateSet.call(void 0,this,l,null),this.messagingSystem.registerActionHandler("SnapsRegistry:get",(async(...e)=>I.__privateMethod.call(void 0,this,k,y).call(this,...e))),this.messagingSystem.registerActionHandler("SnapsRegistry:getMetadata",(async(...e)=>I.__privateMethod.call(void 0,this,b,E).call(this,...e))),this.messagingSystem.registerActionHandler("SnapsRegistry:resolveVersion",(async(...e)=>I.__privateMethod.call(void 0,this,w,T).call(this,...e))),this.messagingSystem.registerActionHandler("SnapsRegistry:update",(async()=>I.__privateMethod.call(void 0,this,d,h).call(this)))}};i=new WeakMap,n=new WeakMap,s=new WeakMap,a=new WeakMap,o=new WeakMap,l=new WeakMap,c=new WeakSet,u=function(){return this.state.lastUpdated&&Date.now()-this.state.lastUpdated<I.__privateGet.call(void 0,this,a)},d=new WeakSet,h=async function(){I.__privateGet.call(void 0,this,l)?await I.__privateGet.call(void 0,this,l):(null===I.__privateGet.call(void 0,this,l)&&I.__privateSet.call(void 0,this,l,I.__privateMethod.call(void 0,this,m,p).call(this)),await I.__privateGet.call(void 0,this,l),I.__privateSet.call(void 0,this,l,null))},m=new WeakSet,p=async function(){if(!I.__privateMethod.call(void 0,this,c,u).call(this))try{const e=await I.__privateMethod.call(void 0,this,A,C).call(this,I.__privateGet.call(void 0,this,i).registry),t=await I.__privateMethod.call(void 0,this,A,C).call(this,I.__privateGet.call(void 0,this,i).signature);I.__privateMethod.call(void 0,this,S,P).call(this,e,t),this.update((t=>{t.database=JSON.parse(e),t.lastUpdated=Date.now(),t.databaseUnavailable=!1}))}catch{this.update((e=>{e.databaseUnavailable=!0}))}},f=new WeakSet,v=async function(){return null===this.state.database&&await I.__privateMethod.call(void 0,this,d,h).call(this),this.state.database},g=new WeakSet,_=async function(e,t,r=!1){const i=await I.__privateMethod.call(void 0,this,f,v).call(this),n=i?.blockedSnaps.find((r=>"id"in r?r.id===e&&N.satisfiesVersionRange.call(void 0,t.version,r.versionRange):r.checksum===t.checksum));if(n)return{status:1,reason:n.reason};const s=i?.verifiedSnaps[e],a=s?.versions?.[t.version];return a&&a.checksum===t.checksum?{status:2}:I.__privateGet.call(void 0,this,o)&&!r?(await I.__privateMethod.call(void 0,this,d,h).call(this),I.__privateMethod.call(void 0,this,g,_).call(this,e,t,!0)):{status:this.state.databaseUnavailable?3:0}},k=new WeakSet,y=async function(e){return Object.entries(e).reduce((async(e,[t,r])=>{const i=await I.__privateMethod.call(void 0,this,g,_).call(this,t,r),n=await e;return n[t]=i,n}),Promise.resolve({}))},w=new WeakSet,T=async function(e,t,r=!1){const i=await I.__privateMethod.call(void 0,this,f,v).call(this),n=i?.verifiedSnaps[e]?.versions??null;if(!n&&I.__privateGet.call(void 0,this,o)&&!r)return await I.__privateMethod.call(void 0,this,d,h).call(this),I.__privateMethod.call(void 0,this,w,T).call(this,e,t,!0);if(!n)return t;const s=M.getTargetVersion.call(void 0,Object.keys(n),t);return s||!I.__privateGet.call(void 0,this,o)||r?s?(N.assertIsSemVerRange.call(void 0,s),s):t:(await I.__privateMethod.call(void 0,this,d,h).call(this),I.__privateMethod.call(void 0,this,w,T).call(this,e,t,!0))},b=new WeakSet,E=async function(e){const t=await I.__privateMethod.call(void 0,this,f,v).call(this);return t?.verifiedSnaps[e]?.metadata??null},S=new WeakSet,P=function(e,t){N.assert.call(void 0,I.__privateGet.call(void 0,this,n),"No public key provided.");const r=x.verify.call(void 0,{registry:e,signature:JSON.parse(t),publicKey:I.__privateGet.call(void 0,this,n)});N.assert.call(void 0,r,"Invalid registry signature.")},A=new WeakSet,C=async function(e){const t=await I.__privateGet.call(void 0,this,s).call(this,e);if(!t.ok)throw new Error(`Failed to fetch ${e}.`);return await t.text()},r.JsonSnapsRegistry=R}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-CPUUURMT.js"}],[197,{"@metamask/utils":2300},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e){(0,i.hasProperty)(e,"PreferencesController")&&(0,i.isObject)(e.PreferencesController)&&(0,i.hasProperty)(e.PreferencesController,"frequentRpcListDetail")&&(0,i.isObject)(e.NetworkController)&&(0,i.hasProperty)(e.NetworkController,"networkConfigurations")&&delete e.PreferencesController.frequentRpcListDetail;return{...e}};var i=e("@metamask/utils")}}},{package:"$root$",file:"app/scripts/migrations/077-supplements/077-supplement-for-082.ts"}],[1970,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-D74XJG2L.js"}],[1971,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i=(t=>void 0!==e?e:"undefined"!=typeof Proxy?new Proxy(t,{get:(t,r)=>(void 0!==e?e:t)[r]}):t)((function(t){if(void 0!==e)return e.apply(this,arguments);throw Error('Dynamic require of "'+t+'" is not supported')})),n=(e,t,r)=>{if(!t.has(e))throw TypeError("Cannot "+r)};r.__require=i,r.__privateGet=(e,t,r)=>(n(e,t,"read from private field"),r?r.call(e):t.get(e)),r.__privateAdd=(e,t,r)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,r)},r.__privateSet=(e,t,r,i)=>(n(e,t,"write to private field"),i?i.call(e,r):t.set(e,r),r),r.__privateMethod=(e,t,r)=>(n(e,t,"access private method"),r)}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-EXN2TFDJ.js"}],[1972,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-G66GQJS6.js"}],[1973,{"./chunk-BOFPNIRX.js":1967,"./chunk-EXN2TFDJ.js":1971,"./chunk-YYPUPKQY.js":1990,"@metamask/base-controller":1999,"@metamask/snaps-rpc-methods":2086,"@metamask/snaps-utils":2163,"@metamask/utils":2300},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i,n,s,a,o=e("./chunk-YYPUPKQY.js"),l=e("./chunk-BOFPNIRX.js"),c=e("./chunk-EXN2TFDJ.js"),u=e("@metamask/base-controller"),d=e("@metamask/snaps-rpc-methods"),h=e("@metamask/snaps-utils"),m=e("@metamask/utils"),p=m.inMilliseconds.call(void 0,24,m.Duration.Hour),f=class extends u.BaseController{constructor({messenger:e,state:t}){super({messenger:e,metadata:{jobs:{persist:!0,anonymous:!1}},name:"CronjobController",state:{jobs:{},...t}}),c.__privateAdd.call(void 0,this,i,void 0),c.__privateAdd.call(void 0,this,n,void 0),c.__privateAdd.call(void 0,this,s,void 0),c.__privateAdd.call(void 0,this,a,void 0),c.__privateSet.call(void 0,this,s,new Map),c.__privateSet.call(void 0,this,a,new Map),c.__privateSet.call(void 0,this,i,e),this._handleSnapRegisterEvent=this._handleSnapRegisterEvent.bind(this),this._handleSnapUnregisterEvent=this._handleSnapUnregisterEvent.bind(this),this._handleEventSnapUpdated=this._handleEventSnapUpdated.bind(this),this.messagingSystem.subscribe("SnapController:snapInstalled",this._handleSnapRegisterEvent),this.messagingSystem.subscribe("SnapController:snapUninstalled",this._handleSnapUnregisterEvent),this.messagingSystem.subscribe("SnapController:snapEnabled",this._handleSnapRegisterEvent),this.messagingSystem.subscribe("SnapController:snapDisabled",this._handleSnapUnregisterEvent),this.messagingSystem.subscribe("SnapController:snapUpdated",this._handleEventSnapUpdated),this.dailyCheckIn().catch((e=>{h.logError.call(void 0,e)}))}getAllJobs(){const e=this.messagingSystem.call("SnapController:getAll");return o.getRunnableSnaps.call(void 0,e).map((e=>this.getSnapJobs(e.id))).flat().filter((e=>void 0!==e))}getSnapJobs(e){const t=c.__privateGet.call(void 0,this,i).call("PermissionController:getPermissions",e),r=t?.[d.SnapEndowments.Cronjob],n=d.getCronjobCaveatJobs.call(void 0,r);return n?.map(((t,r)=>({...t,id:`${e}-${r}`,snapId:e})))}register(e){const t=this.getSnapJobs(e);t?.forEach((e=>this.schedule(e)))}schedule(e){if(c.__privateGet.call(void 0,this,s).has(e.id))return;const t=h.parseCronExpression.call(void 0,e.expression).next(),r=new Date,i=t.getTime()-r.getTime();if(i>p)return;const n=new(0,l.Timer)(i);n.start((()=>{this.executeCronjob(e).catch((e=>{h.logError.call(void 0,e)})),c.__privateGet.call(void 0,this,s).delete(e.id),this.schedule(e)})),this.state.jobs[e.id]?.lastRun||this.updateJobLastRunState(e.id,0),c.__privateGet.call(void 0,this,s).set(e.id,n),c.__privateGet.call(void 0,this,a).set(e.id,e.snapId)}async executeCronjob(e){this.updateJobLastRunState(e.id,Date.now()),await c.__privateGet.call(void 0,this,i).call("SnapController:handleRequest",{snapId:e.snapId,origin:"",handler:h.HandlerType.OnCronjob,request:e.request})}unregister(e){const t=[...c.__privateGet.call(void 0,this,a).entries()].filter((([t,r])=>r===e));t.length&&t.forEach((([e])=>{const t=c.__privateGet.call(void 0,this,s).get(e);t&&(t.cancel(),c.__privateGet.call(void 0,this,s).delete(e),c.__privateGet.call(void 0,this,a).delete(e))}))}updateJobLastRunState(e,t){this.update((r=>{r.jobs[e]={lastRun:t}}))}async dailyCheckIn(){const e=this.getAllJobs();for(const t of e){const e=h.parseCronExpression.call(void 0,t.expression),r=this.state.jobs[t.id]?.lastRun;void 0!==r&&e.hasPrev()&&e.prev().getTime()>r&&await this.executeCronjob(t),this.schedule(t)}c.__privateSet.call(void 0,this,n,new(0,l.Timer)(p)),c.__privateGet.call(void 0,this,n).start((()=>{this.dailyCheckIn().catch((e=>{h.logError.call(void 0,e)}))}))}destroy(){super.destroy(),this.messagingSystem.unsubscribe("SnapController:snapInstalled",this._handleSnapRegisterEvent),this.messagingSystem.unsubscribe("SnapController:snapUninstalled",this._handleSnapUnregisterEvent),this.messagingSystem.unsubscribe("SnapController:snapEnabled",this._handleSnapRegisterEvent),this.messagingSystem.unsubscribe("SnapController:snapDisabled",this._handleSnapUnregisterEvent),this.messagingSystem.unsubscribe("SnapController:snapUpdated",this._handleEventSnapUpdated),c.__privateGet.call(void 0,this,a).forEach((e=>{this.unregister(e)}))}_handleSnapRegisterEvent(e){this.register(e.id)}_handleSnapUnregisterEvent(e){this.unregister(e.id)}_handleEventSnapUpdated(e){this.unregister(e.id),this.register(e.id)}};i=new WeakMap,n=new WeakMap,s=new WeakMap,a=new WeakMap,r.DAILY_TIMEOUT=p,r.CronjobController=f}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-GRBWVPLF.js"}],[1974,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-HOY6NKQR.js"}],[1975,{"./chunk-7Y6P5FRN.js":1964,"./chunk-EXN2TFDJ.js":1971,"./chunk-S775IABY.js":1985,"@metamask/post-message-stream":1669,"@metamask/snaps-utils":2163,"@metamask/utils":2300,nanoid:2031},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i,n,s=e("./chunk-S775IABY.js"),a=e("./chunk-7Y6P5FRN.js"),o=e("./chunk-EXN2TFDJ.js"),l=e("@metamask/post-message-stream"),c=e("@metamask/snaps-utils"),u=e("@metamask/utils"),d=e("nanoid"),h="snaps-worker-pool",m=class extends s.AbstractExecutionService{constructor({documentUrl:e,messenger:t,setupSnapProvider:r}){super({messenger:t,setupSnapProvider:r}),o.__privateAdd.call(void 0,this,i,void 0),o.__privateAdd.call(void 0,this,n,void 0),o.__privateSet.call(void 0,this,i,e)}async terminateJob(e){u.assert.call(void 0,o.__privateGet.call(void 0,this,n),"Runtime stream not initialized."),o.__privateGet.call(void 0,this,n).write({jobId:e.id,data:{jsonrpc:"2.0",method:"terminateJob",id:d.nanoid.call(void 0)}})}async initEnvStream(e){await this.createDocument(),u.assert.call(void 0,o.__privateGet.call(void 0,this,n),"Runtime stream not initialized.");return{worker:e,stream:new(0,a.ProxyPostMessageStream)({stream:o.__privateGet.call(void 0,this,n),jobId:e})}}async createDocument(){if(document.getElementById(h))return;const e=await c.createWindow.call(void 0,o.__privateGet.call(void 0,this,i).href,h,!1);o.__privateSet.call(void 0,this,n,new(0,l.WindowPostMessageStream)({name:"parent",target:"child",targetWindow:e,targetOrigin:"*"}))}};i=new WeakMap,n=new WeakMap,r.WORKER_POOL_ID=h,r.WebWorkerExecutionService=m}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-HQ6HMINL.js"}],[1976,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-JAUAKTUL.js"}],[1977,{"@metamask/snaps-rpc-methods":2086},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i=e("@metamask/snaps-rpc-methods"),n=Object.freeze(["snap_dialog","snap_manageState","snap_notify","snap_getLocale",i.SnapEndowments.Cronjob,i.SnapEndowments.HomePage,i.SnapEndowments.LifecycleHooks,i.SnapEndowments.EthereumProvider,i.SnapEndowments.TransactionInsight,i.SnapEndowments.SignatureInsight]);r.ALLOWED_PERMISSIONS=n,r.LEGACY_ENCRYPTION_KEY_DERIVATION_OPTIONS={algorithm:"PBKDF2",params:{iterations:1e4}}}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-JQ54YYLU.js"}],[1978,{"./chunk-7Y6P5FRN.js":1964,"./chunk-EXN2TFDJ.js":1971,"./chunk-S775IABY.js":1985,nanoid:2031},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i,n=e("./chunk-S775IABY.js"),s=e("./chunk-7Y6P5FRN.js"),a=e("./chunk-EXN2TFDJ.js"),o=e("nanoid"),l=class extends n.AbstractExecutionService{constructor({stream:e,messenger:t,setupSnapProvider:r}){super({messenger:t,setupSnapProvider:r,usePing:!1}),a.__privateAdd.call(void 0,this,i,void 0),a.__privateSet.call(void 0,this,i,e)}async terminateJob(e){a.__privateGet.call(void 0,this,i).write({jobId:e.id,data:{jsonrpc:"2.0",method:"terminateJob",id:o.nanoid.call(void 0)}})}async initEnvStream(e){const t=new(0,s.ProxyPostMessageStream)({stream:a.__privateGet.call(void 0,this,i),jobId:e});return await new Promise((e=>{t.once("data",e),t.write({name:"command",data:{jsonrpc:"2.0",method:"ping",id:o.nanoid.call(void 0)}})})),{worker:e,stream:t}}};i=new WeakMap,r.ProxyExecutionService=l}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-KH72WRHR.js"}],[1979,{"./chunk-EXN2TFDJ.js":1971,"./chunk-RDBT3ZJQ.js":1984,"@metamask/snaps-utils":2163,"@metamask/utils":2300},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i,n=e("./chunk-RDBT3ZJQ.js"),s=e("./chunk-EXN2TFDJ.js"),a=e("@metamask/snaps-utils"),o=e("@metamask/utils");function l(e){return o.assert.call(void 0,void 0!==e.data.canonicalPath),e.data.canonicalPath=`local:${e.data.canonicalPath}`,e}i=new WeakMap,r.LocalLocation=class{constructor(e,t={}){s.__privateAdd.call(void 0,this,i,void 0),o.assertStruct.call(void 0,e.toString(),a.LocalSnapIdStruct,"Invalid Snap Id"),o.assert.call(void 0,void 0===t.fetchOptions,"Currently adding fetch options to local: is unsupported."),s.__privateSet.call(void 0,this,i,new(0,n.HttpLocation)(new URL(e.toString().slice(a.SnapIdPrefixes.local.length)),{...t,fetchOptions:{cache:"no-cache"}}))}async manifest(){return l(await s.__privateGet.call(void 0,this,i).manifest())}async fetch(e){return l(await s.__privateGet.call(void 0,this,i).fetch(e))}get shouldAlwaysReload(){return!0}}}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-LWBPKSU2.js"}],[198,{"@metamask/utils":2300},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e){(0,i.hasProperty)(e,"NetworkController")&&(0,i.isObject)(e.NetworkController)&&(0,i.hasProperty)(e.NetworkController,"network")&&(0,i.hasProperty)(e.NetworkController,"networkId")&&delete e.NetworkController.network;return{...e}};var i=e("@metamask/utils")}}},{package:"$root$",file:"app/scripts/migrations/077-supplements/077-supplement-for-084.ts"}],[1980,{"@metamask/snaps-utils":2163,"@metamask/utils":2300},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i=e("@metamask/snaps-utils"),n=e("@metamask/utils").createModuleLogger.call(void 0,i.snapsLogger,"snaps-controllers");r.log=n}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-NXZVKBSV.js"}],[1981,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-OHMCPTOI.js"}],[1982,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-OIEUL55W.js"}],[1983,{"./chunk-LWBPKSU2.js":1979,"./chunk-RDBT3ZJQ.js":1984,"./chunk-XWDEGRM5.js":1989,"@metamask/utils":2300},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i=e("./chunk-LWBPKSU2.js"),n=e("./chunk-XWDEGRM5.js"),s=e("./chunk-RDBT3ZJQ.js"),a=e("@metamask/utils");r.detectSnapLocation=function(e,t){const r=t?.allowHttp??!1,o=t?.allowLocal??!1,l=new URL(e);switch(l.protocol){case"npm:":return new(0,n.NpmLocation)(l,t);case"local:":return a.assert.call(void 0,o,new TypeError("Fetching local snaps is disabled.")),new(0,i.LocalLocation)(l,t);case"http:":case"https:":return a.assert.call(void 0,r,new TypeError("Fetching snaps through http/https is disabled.")),new(0,s.HttpLocation)(l,t);default:throw new TypeError(`Unrecognized "${l.protocol}" snap location protocol.`)}}}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-PT22IXNS.js"}],[1984,{"@metamask/snaps-utils":2163,"@metamask/utils":2300},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i=e("@metamask/snaps-utils"),n=e("@metamask/utils");r.HttpLocation=class{constructor(e,t={}){this.cache=new Map,n.assertStruct.call(void 0,e.toString(),i.HttpSnapIdStruct,"Invalid Snap Id: "),this.fetchFn=t.fetch??globalThis.fetch.bind(globalThis),this.fetchOptions=t.fetchOptions,this.url=e}async manifest(){if(this.validatedManifest)return this.validatedManifest.clone();const e=new URL(i.NpmSnapFileNames.Manifest,this.url).toString(),t=await this.fetchFn(e,this.fetchOptions);if(!t.ok)throw new Error(`Failed to fetch "${e}". Status code: ${t.status}.`);const r=await t.text(),n=i.parseJson.call(void 0,r),s=new(0,i.VirtualFile)({value:r,result:i.createSnapManifest.call(void 0,n),path:i.NpmSnapFileNames.Manifest,data:{canonicalPath:e}});return this.validatedManifest=s,this.manifest()}async fetch(e){const t=i.normalizeRelative.call(void 0,e),r=this.cache.get(t);if(void 0!==r){const{file:e,contents:t}=r,i=new Uint8Array(await t.arrayBuffer()),n=e.clone();return n.value=i,n}const s=this.toCanonical(t).toString(),a=await this.fetchFn(s,this.fetchOptions);if(!a.ok)throw new Error(`Failed to fetch "${s}". Status code: ${a.status}.`);const o=new(0,i.VirtualFile)({value:"",path:t,data:{canonicalPath:s}}),l=await a.blob();return n.assert.call(void 0,!this.cache.has(t),"Corrupted cache, multiple files with same path."),this.cache.set(t,{file:o,contents:l}),this.fetch(t)}get root(){return new URL(this.url)}toCanonical(e){return n.assert.call(void 0,!e.startsWith("/"),"Tried to parse absolute path."),new URL(e,this.url)}}}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-RDBT3ZJQ.js"}],[1985,{"./chunk-BOFPNIRX.js":1967,"./chunk-CDTGUNSA.js":1968,"./chunk-EXN2TFDJ.js":1971,"./chunk-NXZVKBSV.js":1980,"@metamask/json-rpc-engine":2013,"@metamask/json-rpc-middleware-stream":2016,"@metamask/object-multiplex":1605,"@metamask/rpc-errors":1717,"@metamask/snaps-utils":2163,"@metamask/utils":2300,nanoid:2031,"readable-stream":4258},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i,n,s,a,o,l,c,u,d,h,m,p,f,v,g,_,k,y=e("./chunk-NXZVKBSV.js"),w=e("./chunk-CDTGUNSA.js"),T=e("./chunk-BOFPNIRX.js"),b=e("./chunk-EXN2TFDJ.js"),E=e("@metamask/json-rpc-engine"),S=e("@metamask/json-rpc-middleware-stream"),P=e("@metamask/object-multiplex"),A=(i=P)&&i.__esModule?i:{default:i},C=e("@metamask/rpc-errors"),I=e("@metamask/snaps-utils"),j=e("@metamask/utils"),x=e("nanoid"),M=e("readable-stream"),N="ExecutionService";function O(e,t){const r=new(0,A.default);return M.pipeline.call(void 0,e,r,e,(e=>{e&&(t?I.logError.call(void 0,`"${t}" stream failure.`,e):I.logError.call(void 0,e))})),r}n=new WeakMap,s=new WeakMap,a=new WeakMap,o=new WeakMap,l=new WeakMap,c=new WeakMap,u=new WeakMap,d=new WeakMap,h=new WeakSet,m=function(e){b.__privateGet.call(void 0,this,n).delete(e)},p=new WeakSet,f=function(e,t){b.__privateGet.call(void 0,this,n).set(e,(async({origin:r,handler:i,request:n})=>await this.command(t,{id:x.nanoid.call(void 0),jsonrpc:"2.0",method:"snapRpc",params:{origin:r,handler:i,request:n,target:e}})))},v=new WeakSet,g=function(e,t){b.__privateGet.call(void 0,this,s).set(e,t),b.__privateGet.call(void 0,this,a).set(t,e)},_=new WeakSet,k=function(e){const t=b.__privateGet.call(void 0,this,a).get(e);if(!t)throw new Error(`job: "${e}" has no mapped snap.`);b.__privateGet.call(void 0,this,a).delete(e),b.__privateGet.call(void 0,this,s).delete(t),b.__privateMethod.call(void 0,this,h,m).call(this,t)},r.AbstractExecutionService=class{constructor({setupSnapProvider:e,messenger:t,initTimeout:r=j.inMilliseconds.call(void 0,60,j.Duration.Second),pingTimeout:i=j.inMilliseconds.call(void 0,2,j.Duration.Second),terminationTimeout:m=j.inMilliseconds.call(void 0,1,j.Duration.Second),usePing:f=!0}){b.__privateAdd.call(void 0,this,h),b.__privateAdd.call(void 0,this,p),b.__privateAdd.call(void 0,this,v),b.__privateAdd.call(void 0,this,_),b.__privateAdd.call(void 0,this,n,void 0),b.__privateAdd.call(void 0,this,s,void 0),b.__privateAdd.call(void 0,this,a,void 0),b.__privateAdd.call(void 0,this,o,void 0),b.__privateAdd.call(void 0,this,l,void 0),b.__privateAdd.call(void 0,this,c,void 0),b.__privateAdd.call(void 0,this,u,void 0),b.__privateAdd.call(void 0,this,d,void 0),b.__privateSet.call(void 0,this,n,new Map),this.jobs=new Map,this.setupSnapProvider=e,b.__privateSet.call(void 0,this,s,new Map),b.__privateSet.call(void 0,this,a,new Map),b.__privateSet.call(void 0,this,o,t),b.__privateSet.call(void 0,this,l,r),b.__privateSet.call(void 0,this,c,i),b.__privateSet.call(void 0,this,u,m),b.__privateSet.call(void 0,this,d,f),this.registerMessageHandlers()}registerMessageHandlers(){b.__privateGet.call(void 0,this,o).registerActionHandler(`${N}:handleRpcRequest`,(async(e,t)=>this.handleRpcRequest(e,t))),b.__privateGet.call(void 0,this,o).registerActionHandler(`${N}:executeSnap`,(async e=>this.executeSnap(e))),b.__privateGet.call(void 0,this,o).registerActionHandler(`${N}:terminateSnap`,(async e=>this.terminateSnap(e))),b.__privateGet.call(void 0,this,o).registerActionHandler(`${N}:terminateAllSnaps`,(async()=>this.terminateAllSnaps()))}async terminate(e){const t=this.jobs.get(e);if(!t)throw new Error(`Job with id "${e}" not found.`);try{const t=await w.withTimeout.call(void 0,this.command(e,{jsonrpc:"2.0",method:"terminate",params:[],id:x.nanoid.call(void 0)}),b.__privateGet.call(void 0,this,u));t!==w.hasTimedOut&&"OK"===t||I.logError.call(void 0,`Job "${e}" failed to terminate gracefully.`,t)}catch{}Object.values(t.streams).forEach((e=>{try{!e.destroyed&&e.destroy(),e.removeAllListeners()}catch(e){I.logError.call(void 0,"Error while destroying stream",e)}})),this.terminateJob(t),this.jobs.delete(e),b.__privateMethod.call(void 0,this,_,k).call(this,e),y.log.call(void 0,`Job "${e}" terminated.`)}async initJob(e,t){const{streams:r,worker:i}=await this.initStreams(e,t),n=new(0,E.JsonRpcEngine),s=S.createStreamMiddleware.call(void 0);M.pipeline.call(void 0,s.stream,r.command,s.stream,(e=>{e&&I.logError.call(void 0,"Command stream failure.",e)})),n.push(s.middleware);const a={id:e,streams:r,rpcEngine:n,worker:i};return this.jobs.set(e,a),a}async initStreams(e,t){const r=await w.withTimeout.call(void 0,this.initEnvStream(e),t);if(r===w.hasTimedOut)throw this.terminateJob({id:e}),new Error("The Snaps execution environment failed to start.");const{worker:i,stream:n}=r,s=O(n,`Job: "${e}"`),l=s.createStream(I.SNAP_STREAM_NAMES.COMMAND),c=t=>{if(!j.isJsonRpcNotification.call(void 0,t))return;const r=b.__privateGet.call(void 0,this,a).get(e);"OutboundRequest"===t.method?b.__privateGet.call(void 0,this,o).publish("ExecutionService:outboundRequest",r):"OutboundResponse"===t.method?b.__privateGet.call(void 0,this,o).publish("ExecutionService:outboundResponse",r):"UnhandledError"===t.method?j.isObject.call(void 0,t.params)&&t.params.error?(b.__privateGet.call(void 0,this,o).publish("ExecutionService:unhandledError",r,t.params.error),l.removeListener("data",c)):I.logError.call(void 0,new Error(`Received malformed "${t.method}" command stream notification.`)):I.logError.call(void 0,new Error(`Received unexpected command stream notification "${t.method}".`))};l.on("data",c);const u=s.createStream(I.SNAP_STREAM_NAMES.JSON_RPC);return{streams:{command:l,rpc:u,_connection:n},worker:i}}async terminateSnap(e){const t=b.__privateGet.call(void 0,this,s).get(e);t&&await this.terminate(t)}async terminateAllSnaps(){await Promise.all([...this.jobs.keys()].map((async e=>this.terminate(e)))),b.__privateGet.call(void 0,this,n).clear()}getRpcRequestHandler(e){return b.__privateGet.call(void 0,this,n).get(e)}async executeSnap({snapId:e,sourceCode:t,endowments:r}){if(b.__privateGet.call(void 0,this,s).has(e))throw new Error(`Snap "${e}" is already being executed.`);const i=x.nanoid.call(void 0),n=new(0,T.Timer)(b.__privateGet.call(void 0,this,l)),a=await this.initJob(i,n);if(b.__privateMethod.call(void 0,this,v,g).call(this,e,a.id),b.__privateGet.call(void 0,this,d)){if(await w.withTimeout.call(void 0,this.command(a.id,{jsonrpc:"2.0",method:"ping",id:x.nanoid.call(void 0)}),b.__privateGet.call(void 0,this,c))===w.hasTimedOut)throw new Error("The Snaps execution environment failed to start.")}const o=a.streams.rpc;this.setupSnapProvider(e,o);const u=n.remaining,h=await w.withTimeout.call(void 0,this.command(a.id,{jsonrpc:"2.0",method:"executeSnap",params:{snapId:e,sourceCode:t,endowments:r},id:x.nanoid.call(void 0)}),u);if(h===w.hasTimedOut)throw new Error(`${e} failed to start.`);return b.__privateMethod.call(void 0,this,p,f).call(this,e,a.id),h}async command(e,t){j.assertIsJsonRpcRequest.call(void 0,t);const r=this.jobs.get(e);if(!r)throw new Error(`Job with id "${e}" not found.`);y.log.call(void 0,"Parent: Sending Command",t);const i=await r.rpcEngine.handle(t);if(i.error)throw new(0,C.JsonRpcError)(i.error.code,i.error.message,i.error.data);return i.result}async handleRpcRequest(e,t){const r=this.getRpcRequestHandler(e);if(!r)throw new Error(`Snap execution service returned no RPC handler for running snap "${e}".`);return r(t)}},r.setupMultiplex=O}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-S775IABY.js"}],[1986,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-VNOCJWOK.js"}],[1987,{"@metamask/snaps-sdk":2122,"@metamask/snaps-sdk/jsx":2126,"@metamask/snaps-utils":2163},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i=e("@metamask/snaps-sdk"),n=e("@metamask/snaps-sdk/jsx"),s=e("@metamask/snaps-utils");function a(e,t){i.assert.call(void 0,void 0===e[t],`Duplicate component names are not allowed, found multiple instances of: "${t}".`)}function o(e){if("Dropdown"===e.type){const t=s.getJsxChildren.call(void 0,e);return t[0]?.props.value}return null}function l(e,t,r,i){if("Button"===t.type)return i;const n=(s=t,Array.isArray(s.props.children)?s.props.children[0]:s.props.children);var s;return a(i,n.props.name),i[n.props.name]=function(e,t,r){const i=e[r],n=i?.[t.props.name];return t.props.value??n??o(t)??null}(e,n,r),i}var c=1e6;r.getJsxInterface=function(e){return n.isJSXElementUnsafe.call(void 0,e)?e:s.getJsxElementFromComponent.call(void 0,e)},r.assertNameIsUnique=a,r.constructState=function e(t,r,i={}){if("Box"===r.type){return s.getJsxChildren.call(void 0,r).reduce(((r,i)=>e(t,i,r)),i)}if("Form"===r.type){a(i,r.props.name);const e=s.getJsxChildren.call(void 0,r);return i[r.props.name]=e.reduce(((e,i)=>l(t,i,r.props.name,e)),{}),i}return"Input"!==r.type&&"Dropdown"!==r.type||(a(i,r.props.name),i[r.props.name]=function(e,t){return t.props.value??e[t.props.name]??o(t)??null}(t,r)),i},r.validateInterfaceContext=function(e){if(!e)return;const t=s.getJsonSizeUnsafe.call(void 0,e);i.assert.call(void 0,t<=c,"A Snap interface context may not be larger than 1 MB.")}}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-WCDDYBFW.js"}],[1988,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-WEY7ICES.js"}],[1989,{"./chunk-EXN2TFDJ.js":1971,"@metamask/snaps-utils":2163,"@metamask/utils":2300,"browserify-zlib":3022,"concat-stream":2030,"get-npm-tarball-url":3410,"readable-stream":4258,"readable-web-to-node-stream":4259,"tar-stream":4362},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var n,s,a,o,l=e("./chunk-EXN2TFDJ.js"),c=e("@metamask/snaps-utils"),u=e("@metamask/utils"),d=e("browserify-zlib"),h=i(e("concat-stream")),m=i(e("get-npm-tarball-url")),p=e("readable-stream"),f=e("readable-web-to-node-stream"),v=e("tar-stream"),g=new URL("https://registry.npmjs.org"),_=class{constructor(e,t={}){l.__privateAdd.call(void 0,this,a),l.__privateAdd.call(void 0,this,n,void 0),l.__privateAdd.call(void 0,this,s,void 0);const r=t.allowCustomRegistries??!1,i=t.fetch??globalThis.fetch.bind(globalThis),o=t.versionRange??c.DEFAULT_REQUESTED_SNAP_VERSION,d=t.resolveVersion??(async e=>e);let h;u.assertStruct.call(void 0,e.toString(),c.NpmSnapIdStruct,"Invalid Snap Id: "),""===e.host&&""===e.port&&""===e.username&&""===e.password?h=g:(h="https://",e.username&&(h+=e.username,e.password&&(h+=`:${e.password}`),h+="@"),h+=e.host,h=new URL(h),u.assert.call(void 0,r,new TypeError(`Custom NPM registries are disabled, tried to use "${h.toString()}".`))),u.assert.call(void 0,"/"===h.pathname&&""===h.search&&""===h.hash),u.assert.call(void 0,""!==e.pathname&&"/"!==e.pathname,new TypeError("The package name in NPM location is empty."));let m=e.pathname;m.startsWith("/")&&(m=m.slice(1)),this.meta={requestedRange:o,registry:h,packageName:m,fetch:i,resolveVersion:d}}async manifest(){if(l.__privateGet.call(void 0,this,n))return l.__privateGet.call(void 0,this,n).clone();const e=await this.fetch("snap.manifest.json"),t=c.parseJson.call(void 0,e.toString());return e.result=c.createSnapManifest.call(void 0,t),l.__privateSet.call(void 0,this,n,e),this.manifest()}async fetch(e){const t=c.normalizeRelative.call(void 0,e);l.__privateGet.call(void 0,this,s)||(await l.__privateMethod.call(void 0,this,a,o).call(this),u.assert.call(void 0,void 0!==l.__privateGet.call(void 0,this,s)));const r=l.__privateGet.call(void 0,this,s).get(t);return u.assert.call(void 0,void 0!==r,new TypeError(`File "${e}" not found in package.`)),r.clone()}get packageName(){return this.meta.packageName}get version(){return u.assert.call(void 0,void 0!==this.meta.version,"Tried to access version without first fetching NPM package."),this.meta.version}get registry(){return this.meta.registry}get versionRange(){return this.meta.requestedRange}};n=new WeakMap,s=new WeakMap,a=new WeakSet,o=async function(){u.assert.call(void 0,void 0===l.__privateGet.call(void 0,this,s));const e=await this.meta.resolveVersion(this.meta.requestedRange),{tarballURL:t,targetVersion:r}=await async function(e,t,r,i){if(T(r)&&u.isValidSemVerVersion.call(void 0,t))return{tarballURL:m.default.call(void 0,e,t),targetVersion:t};const n=await y(e,r,i),s=Object.keys(n?.versions??{}).map((e=>(u.assertIsSemVerVersion.call(void 0,e),e))),a=c.getTargetVersion.call(void 0,s,t);if(null===a)throw new Error(`Failed to find a matching version in npm metadata for package "${e}" and requested semver range "${t}".`);const o=n?.versions?.[a]?.dist?.tarball;return{tarballURL:o,targetVersion:a}}(this.meta.packageName,e,this.meta.registry,this.meta.fetch);if(!c.isValidUrl.call(void 0,t)||!t.toString().endsWith(".tgz"))throw new Error(`Failed to find valid tarball URL in NPM metadata for package "${this.meta.packageName}".`);const i=new URL(t);i.hostname=this.meta.registry.hostname,i.protocol=this.meta.registry.protocol;const n=await this.fetchNpmTarball(i);l.__privateSet.call(void 0,this,s,n),this.meta.version=r};var k=262144e3;async function y(e,t,r){const i=await r(new URL(e,t).toString(),{headers:{accept:T(t)?"application/vnd.npm.install-v1+json; q=1.0, application/json; q=0.8, */*":"application/json"}});if(!i.ok)throw new Error(`Failed to fetch NPM registry entry. Status code: ${i.status}.`);const n=await i.json();if(!u.isObject.call(void 0,n))throw new Error(`Failed to fetch package "${e}" metadata from npm.`);return n}function w(e,t){let r="npm://";return""!==e.username&&(r+=e.username,""!==e.password&&(r+=`:${e.password}`),r+="@"),`${r}${e.host}/${t}/`}function T(e){return e.toString()===g.toString()}var b=/^package\//u;function E(e){return"function"!=typeof e.getReader?e:new(0,f.ReadableWebToNodeStream)(e)}r.DEFAULT_NPM_REGISTRY=g,r.BaseNpmLocation=_,r.TARBALL_SIZE_SAFETY_LIMIT=k,r.NpmLocation=class extends _{async fetchNpmTarball(e){const t=await this.meta.fetch(e.toString());if(!t.ok||!t.body)throw new Error(`Failed to fetch tarball for package "${this.meta.packageName}".`);const r=t.headers.get("content-length");u.assert.call(void 0,r,"Snap tarball has invalid content-length");const i=parseInt(r,10);return u.assert.call(void 0,i<=k,"Snap tarball exceeds size limit"),new Promise(((e,r)=>{const i=new Map,n=function(e,t){u.assert.call(void 0,e.endsWith("/"),"Base needs to end with '/' for relative paths to be added as children instead of siblings."),u.assert.call(void 0,e.startsWith("npm:"),'Protocol mismatch, expected "npm:".');const r=v.extract.call(void 0);let i=0;return r.on("entry",((n,s,a)=>{const{name:o,type:l}=n;if("file"===l){const n=o.replace(b,"");return s.pipe(h.default.call(void 0,{encoding:"uint8array"},(s=>{try{i+=s.byteLength,u.assert.call(void 0,i<k,"Snap tarball exceeds limit of 262144000 bytes.");const r=new(0,c.VirtualFile)({value:s,path:n,data:{canonicalPath:new URL(n,e).toString()}});return u.assert.call(void 0,!t.has(n),"Malformed tarball, multiple files with the same path."),t.set(n,r),a()}catch(e){return r.destroy(e)}})))}return s.on("end",(()=>a())),s.resume()})),r}(w(this.meta.registry,this.meta.packageName),i),s=t.body;if("pipeThrough"in s&&"DecompressionStream"in globalThis){const t=new DecompressionStream("gzip"),a=s.pipeThrough(t);p.pipeline.call(void 0,E(a),n,(t=>{t?r(t):e(i)}))}else p.pipeline.call(void 0,E(s),d.createGunzip.call(void 0),n,(t=>{t?r(t):e(i)}))}))}},r.fetchNpmMetadata=y,r.getNpmCanonicalBasePath=w}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-XWDEGRM5.js"}],[199,{"@metamask/utils":2300},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e){(0,i.hasProperty)(e,"NetworkController")&&(0,i.isObject)(e.NetworkController)&&(0,i.hasProperty)(e.NetworkController,"provider")&&(0,i.hasProperty)(e.NetworkController,"providerConfig")&&delete e.NetworkController.provider;return{...e}};var i=e("@metamask/utils")}}},{package:"$root$",file:"app/scripts/migrations/077-supplements/077-supplement-for-086.ts"}],[1990,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});r.getRunnableSnaps=e=>e.filter((e=>e.enabled&&!e.blocked))}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-YYPUPKQY.js"}],[1991,{"./chunk-AP7CJ6DA.js":1965,"./chunk-BO2ZDPWV.js":1966,"./chunk-BOFPNIRX.js":1967,"./chunk-CDTGUNSA.js":1968,"./chunk-EXN2TFDJ.js":1971,"./chunk-JQ54YYLU.js":1977,"./chunk-NXZVKBSV.js":1980,"./chunk-PT22IXNS.js":1983,"@metamask/base-controller":1999,"@metamask/permission-controller":2029,"@metamask/rpc-errors":1717,"@metamask/snaps-rpc-methods":2086,"@metamask/snaps-sdk":2122,"@metamask/snaps-utils":2163,"@metamask/utils":2300,"@xstate/fsm":2645,nanoid:2031},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i=e("./chunk-PT22IXNS.js"),n=e("./chunk-AP7CJ6DA.js"),s=e("./chunk-JQ54YYLU.js"),a=e("./chunk-BO2ZDPWV.js"),o=e("./chunk-NXZVKBSV.js"),l=e("./chunk-CDTGUNSA.js"),c=e("./chunk-BOFPNIRX.js"),u=e("./chunk-EXN2TFDJ.js"),d=e("@metamask/base-controller"),h=e("@metamask/permission-controller"),m=e("@metamask/rpc-errors"),p=e("@metamask/snaps-rpc-methods"),f=e("@metamask/snaps-sdk"),v=e("@metamask/snaps-utils"),g=e("@metamask/utils"),_=e("@xstate/fsm"),k=e("nanoid"),y="SnapController",w="wallet_installSnap",T="wallet_updateSnap",b="wallet_installSnapResult",E=new Set(["initialPermissions","id","version","enabled","blocked"]),S={snaps:{},snapStates:{},unencryptedSnapStates:{}};function P(e){return Object.keys(e).reduce(((t,r)=>(E.has(r)&&(t[r]=e[r]),t)),{})}var A,C,I,j,x,M,N,O,R,B,L,G,F,D,H,U,W,$,K,V,q,Y,X,J,z,Q,Z,ee,te,re,ie,ne,se,ae,oe,le,ce,ue,de,he,me,pe,fe,ve,ge,_e,ke,ye,we,Te,be,Ee,Se,Pe,Ae,Ce,Ie,je,xe,Me,Ne,Oe,Re,Be,Le,Ge,Fe,De,He,Ue,We,$e,Ke,Ve,qe,Ye,Xe,Je,ze,Qe,Ze,et,tt,rt,it,nt,st,at,ot,lt,ct,ut,dt,ht,mt,pt,ft,vt,gt,_t,kt,yt,wt,Tt,bt,Et,St,Pt=class extends d.BaseController{constructor({closeAllConnections:e,messenger:t,state:r,dynamicPermissions:n=["eth_accounts"],environmentEndowmentPermissions:s=[],excludedPermissions:a={},idleTimeCheckInterval:o=g.inMilliseconds.call(void 0,5,g.Duration.Second),maxIdleTime:l=g.inMilliseconds.call(void 0,30,g.Duration.Second),maxRequestTime:c=g.inMilliseconds.call(void 0,60,g.Duration.Second),fetchFunction:d=globalThis.fetch.bind(globalThis),featureFlags:h={},detectSnapLocation:m=i.detectSnapLocation,preinstalledSnaps:p=null,encryptor:_,getMnemonic:k,getFeatureFlags:y=(()=>({}))}){super({messenger:t,metadata:{snapStates:{persist:!0,anonymous:!1},unencryptedSnapStates:{persist:!0,anonymous:!1},snaps:{persist:e=>Object.values(e).filter((e=>e.status!==v.SnapStatus.Installing)).map((e=>({...e,status:v.SnapStatus.Stopped}))).reduce(((e,t)=>(e[t.id]=t,e)),{}),anonymous:!1}},name:"SnapController",state:{...S,...r}}),u.__privateAdd.call(void 0,this,$),u.__privateAdd.call(void 0,this,V),u.__privateAdd.call(void 0,this,Y),u.__privateAdd.call(void 0,this,J),u.__privateAdd.call(void 0,this,Q),u.__privateAdd.call(void 0,this,ee),u.__privateAdd.call(void 0,this,re),u.__privateAdd.call(void 0,this,ne),u.__privateAdd.call(void 0,this,ae),u.__privateAdd.call(void 0,this,le),u.__privateAdd.call(void 0,this,ue),u.__privateAdd.call(void 0,this,he),u.__privateAdd.call(void 0,this,pe),u.__privateAdd.call(void 0,this,ve),u.__privateAdd.call(void 0,this,_e),u.__privateAdd.call(void 0,this,ye),u.__privateAdd.call(void 0,this,Te),u.__privateAdd.call(void 0,this,Ee),u.__privateAdd.call(void 0,this,Pe),u.__privateAdd.call(void 0,this,Ce),u.__privateAdd.call(void 0,this,je),u.__privateAdd.call(void 0,this,Me),u.__privateAdd.call(void 0,this,Oe),u.__privateAdd.call(void 0,this,Be),u.__privateAdd.call(void 0,this,Ge),u.__privateAdd.call(void 0,this,De),u.__privateAdd.call(void 0,this,Ue),u.__privateAdd.call(void 0,this,$e),u.__privateAdd.call(void 0,this,Ve),u.__privateAdd.call(void 0,this,Ye),u.__privateAdd.call(void 0,this,Je),u.__privateAdd.call(void 0,this,Qe),u.__privateAdd.call(void 0,this,et),u.__privateAdd.call(void 0,this,rt),u.__privateAdd.call(void 0,this,nt),u.__privateAdd.call(void 0,this,at),u.__privateAdd.call(void 0,this,lt),u.__privateAdd.call(void 0,this,ut),u.__privateAdd.call(void 0,this,ht),u.__privateAdd.call(void 0,this,pt),u.__privateAdd.call(void 0,this,vt),u.__privateAdd.call(void 0,this,_t),u.__privateAdd.call(void 0,this,yt),u.__privateAdd.call(void 0,this,Tt),u.__privateAdd.call(void 0,this,Et),u.__privateAdd.call(void 0,this,A,void 0),u.__privateAdd.call(void 0,this,C,void 0),u.__privateAdd.call(void 0,this,I,void 0),u.__privateAdd.call(void 0,this,j,void 0),u.__privateAdd.call(void 0,this,x,void 0),u.__privateAdd.call(void 0,this,M,void 0),u.__privateAdd.call(void 0,this,N,void 0),u.__privateAdd.call(void 0,this,O,void 0),u.__privateAdd.call(void 0,this,R,void 0),u.__privateAdd.call(void 0,this,B,void 0),u.__privateAdd.call(void 0,this,L,void 0),u.__privateAdd.call(void 0,this,G,void 0),u.__privateAdd.call(void 0,this,F,void 0),u.__privateAdd.call(void 0,this,D,void 0),u.__privateAdd.call(void 0,this,H,void 0),u.__privateAdd.call(void 0,this,U,void 0),u.__privateAdd.call(void 0,this,W,void 0),u.__privateSet.call(void 0,this,A,e),u.__privateSet.call(void 0,this,C,n),u.__privateSet.call(void 0,this,I,s),u.__privateSet.call(void 0,this,j,a),u.__privateSet.call(void 0,this,x,h),u.__privateSet.call(void 0,this,M,d),u.__privateSet.call(void 0,this,N,o),u.__privateSet.call(void 0,this,O,l),this.maxRequestTime=c,u.__privateSet.call(void 0,this,G,m),u.__privateSet.call(void 0,this,R,_),u.__privateSet.call(void 0,this,B,k),u.__privateSet.call(void 0,this,L,y),u.__privateSet.call(void 0,this,W,p),this._onUnhandledSnapError=this._onUnhandledSnapError.bind(this),this._onOutboundRequest=this._onOutboundRequest.bind(this),this._onOutboundResponse=this._onOutboundResponse.bind(this),u.__privateSet.call(void 0,this,D,new Map),u.__privateSet.call(void 0,this,F,new Map),u.__privateMethod.call(void 0,this,J,z).call(this),this.messagingSystem.subscribe("ExecutionService:unhandledError",this._onUnhandledSnapError),this.messagingSystem.subscribe("ExecutionService:outboundRequest",this._onOutboundRequest),this.messagingSystem.subscribe("ExecutionService:outboundResponse",this._onOutboundResponse),this.messagingSystem.subscribe("SnapController:snapInstalled",(({id:e},t)=>{u.__privateMethod.call(void 0,this,Et,St).call(this,t,e,v.HandlerType.OnInstall).catch((t=>{v.logError.call(void 0,`Error when calling \`onInstall\` lifecycle hook for snap "${e}": ${f.getErrorMessage.call(void 0,t)}`)}))})),this.messagingSystem.subscribe("SnapController:snapUpdated",(({id:e},t,r)=>{u.__privateMethod.call(void 0,this,Et,St).call(this,r,e,v.HandlerType.OnUpdate).catch((t=>{v.logError.call(void 0,`Error when calling \`onUpdate\` lifecycle hook for snap "${e}": ${f.getErrorMessage.call(void 0,t)}`)}))})),u.__privateMethod.call(void 0,this,$,K).call(this),u.__privateMethod.call(void 0,this,V,q).call(this),u.__privateGet.call(void 0,this,W)&&u.__privateMethod.call(void 0,this,Y,X).call(this,u.__privateGet.call(void 0,this,W)),Object.values(this.state?.snaps??{}).forEach((e=>u.__privateMethod.call(void 0,this,vt,gt).call(this,e.id)))}async updateBlockedSnaps(){u.__privateMethod.call(void 0,this,ne,se).call(this),await this.messagingSystem.call("SnapsRegistry:update");const e=await this.messagingSystem.call("SnapsRegistry:get",Object.values(this.state.snaps).reduce(((e,t)=>(e[t.id]={version:t.version,checksum:t.manifest.source.shasum},e)),{}));await Promise.all(Object.entries(e).map((async([e,{status:t,reason:r}])=>1===t?u.__privateMethod.call(void 0,this,Q,Z).call(this,e,r):u.__privateMethod.call(void 0,this,ee,te).call(this,e))))}_onUnhandledSnapError(e,t){this.stopSnap(e,v.SnapStatusEvents.Crash).catch((e=>{v.logError.call(void 0,e)}))}_onOutboundRequest(e){const t=u.__privateMethod.call(void 0,this,pt,ft).call(this,e);t.pendingInboundRequests.filter((e=>"running"===e.timer.status)).forEach((e=>e.timer.pause())),t.pendingOutboundRequests+=1}_onOutboundResponse(e){const t=u.__privateMethod.call(void 0,this,pt,ft).call(this,e);t.pendingOutboundRequests-=1,0===t.pendingOutboundRequests&&t.pendingInboundRequests.filter((e=>"paused"===e.timer.status)).forEach((e=>e.timer.resume()))}async startSnap(e){u.__privateMethod.call(void 0,this,ne,se).call(this);const t=this.state.snaps[e];if(!1===t.enabled)throw new Error(`Snap "${e}" is disabled.`);await u.__privateMethod.call(void 0,this,Oe,Re).call(this,{snapId:e,sourceCode:t.sourceCode})}enableSnap(e){if(this.getExpect(e),this.state.snaps[e].blocked)throw new Error(`Snap "${e}" is blocked and cannot be enabled.`);this.update((t=>{t.snaps[e].enabled=!0})),this.messagingSystem.publish("SnapController:snapEnabled",this.getTruncatedExpect(e))}async disableSnap(e){if(!this.has(e))throw new Error(`Snap "${e}" not found.`);this.update((t=>{t.snaps[e].enabled=!1})),this.isRunning(e)&&await this.stopSnap(e,v.SnapStatusEvents.Stop),this.messagingSystem.publish("SnapController:snapDisabled",this.getTruncatedExpect(e))}async stopSnap(e,t=v.SnapStatusEvents.Stop){var r;const i=u.__privateMethod.call(void 0,this,ht,mt).call(this,e);if(!i)throw new Error(`The snap "${e}" is not running.`);if(!i.stopping){i.stopping=!0;try{this.isRunning(e)&&(null==(r=u.__privateGet.call(void 0,this,A))||r.call(this,e),await u.__privateMethod.call(void 0,this,ue,de).call(this,e))}finally{i.lastRequest=null,i.pendingInboundRequests=[],i.pendingOutboundRequests=0,i.stopping=!1,this.isRunning(e)&&u.__privateMethod.call(void 0,this,le,ce).call(this,e,t)}}}isRunning(e){return"running"===this.getExpect(e).status}has(e){return Boolean(this.get(e))}get(e){return this.state.snaps[e]}getExpect(e){const t=this.get(e);return g.assert.call(void 0,void 0!==t,new Error(`Snap "${e}" not found.`)),t}getTruncated(e){const t=this.get(e);return t?P(t):null}getTruncatedExpect(e){return P(this.getExpect(e))}async updateSnapState(e,t,r){if(r){const r=await u.__privateMethod.call(void 0,this,ve,ge).call(this,e,t);this.update((t=>{t.snapStates[e]=r}))}else this.update((r=>{r.unencryptedSnapStates[e]=JSON.stringify(t)}))}clearSnapState(e,t){this.update((r=>{t?r.snapStates[e]=null:r.unencryptedSnapStates[e]=null}))}async getSnapState(e,t){const r=t?this.state.snapStates[e]:this.state.unencryptedSnapStates[e];if(null==r)return null;if(!t)return v.parseJson.call(void 0,r);return await u.__privateMethod.call(void 0,this,pe,fe).call(this,e,r)}async getSnapFile(e,t,r=f.AuxiliaryFileEncoding.Base64){const i=this.getExpect(e),n=v.normalizeRelative.call(void 0,t),s=i.auxiliaryFiles?.find((e=>e.path===n))?.value;return s?v.encodeAuxiliaryFile.call(void 0,s,r):null}async clearState(){const e=Object.keys(this.state.snaps);u.__privateGet.call(void 0,this,A)&&e.forEach((e=>{var t;null==(t=u.__privateGet.call(void 0,this,A))||t.call(this,e)})),await this.messagingSystem.call("ExecutionService:terminateAllSnaps"),e.forEach((e=>u.__privateMethod.call(void 0,this,Ee,Se).call(this,e))),this.update((e=>{e.snaps={},e.snapStates={}})),u.__privateGet.call(void 0,this,F).clear(),u.__privateGet.call(void 0,this,W)&&(u.__privateMethod.call(void 0,this,Y,X).call(this,u.__privateGet.call(void 0,this,W)),Object.values(this.state?.snaps).forEach((e=>u.__privateMethod.call(void 0,this,vt,gt).call(this,e.id))))}async removeSnap(e){return this.removeSnaps([e])}async removeSnaps(e){if(!Array.isArray(e))throw new Error("Expected array of snap ids.");e.forEach((e=>{const t=this.getExpect(e);g.assert.call(void 0,!1!==t.removable,`${e} is not removable.`)})),await Promise.all(e.map((async e=>{const t=this.getExpect(e),r=this.getTruncatedExpect(e);await this.disableSnap(e),u.__privateMethod.call(void 0,this,Ee,Se).call(this,e),u.__privateMethod.call(void 0,this,Te,be).call(this,e),u.__privateGet.call(void 0,this,F).delete(e),this.update((t=>{delete t.snaps[e],delete t.snapStates[e],delete t.unencryptedSnapStates[e]})),t.status!==v.SnapStatus.Installing&&this.messagingSystem.publish("SnapController:snapUninstalled",r)})))}removeSnapFromSubject(e,t){const r=this.messagingSystem.call("PermissionController:getPermissions",e),i=r?.[p.WALLET_SNAP_PERMISSION_KEY]?.caveats?.find((e=>e.type===v.SnapCaveatType.SnapIds));if(!i)return;if(Boolean(i.value?.[t])){const r={...i.value};delete r[t],Object.keys(r).length>0?this.messagingSystem.call("PermissionController:updateCaveat",e,p.WALLET_SNAP_PERMISSION_KEY,v.SnapCaveatType.SnapIds,r):this.messagingSystem.call("PermissionController:revokePermissions",{[e]:[p.WALLET_SNAP_PERMISSION_KEY]})}}revokeDynamicSnapPermissions(e,t){g.assert.call(void 0,t.every((e=>u.__privateGet.call(void 0,this,C).includes(e))),"Non-dynamic permissions cannot be revoked"),this.messagingSystem.call("PermissionController:revokePermissions",{[e]:t})}incrementActiveReferences(e){u.__privateMethod.call(void 0,this,pt,ft).call(this,e).activeReferences+=1}decrementActiveReferences(e){const t=u.__privateMethod.call(void 0,this,pt,ft).call(this,e);g.assert.call(void 0,t.activeReferences>0,"SnapController reference management is in an invalid state."),t.activeReferences-=1}getAllSnaps(){return Object.values(this.state.snaps).map(P)}getPermittedSnaps(e){const t=this.messagingSystem.call("PermissionController:getPermissions",e)??{},r=t[p.WALLET_SNAP_PERMISSION_KEY]?.caveats?.find((e=>e.type===v.SnapCaveatType.SnapIds))?.value??{};return Object.keys(r).reduce(((e,t)=>{const r=this.get(t),i=this.getTruncated(t);return i&&r?.status!==v.SnapStatus.Installing&&(e[t]=i),e}),{})}async installSnaps(e,t){u.__privateMethod.call(void 0,this,ne,se).call(this);const r={},i=Object.keys(t),n=[],s=[];try{for(const[i,{version:a}]of Object.entries(t)){v.assertIsValidSnapId.call(void 0,i);const[t,o]=v.resolveVersionRange.call(void 0,a);if(t)throw m.rpcErrors.invalidParams(`The "version" field must be a valid SemVer version range if specified. Received: "${a}".`);const l=u.__privateGet.call(void 0,this,G).call(this,i,{versionRange:o,fetch:u.__privateGet.call(void 0,this,M),allowLocal:u.__privateGet.call(void 0,this,x).allowLocalSnaps,resolveVersion:async e=>u.__privateGet.call(void 0,this,x).requireAllowlist?await u.__privateMethod.call(void 0,this,je,xe).call(this,i,e):e}),c=this.has(i)&&!l.shouldAlwaysReload;if(c&&u.__privateMethod.call(void 0,this,Tt,bt).call(this,i,o)){const e=this.getExpect(i);n.push({snapId:i,oldVersion:e.version});let t=u.__privateMethod.call(void 0,this,nt,st).call(this,i);if(void 0!==t)throw new Error("This snap is already being updated.");t=u.__privateMethod.call(void 0,this,at,ot).call(this,i),t.newVersion=o}else c||s.push(i);r[i]=await this.processRequestedSnap(e,i,l,o)}s.forEach((t=>this.messagingSystem.publish("SnapController:snapInstalled",this.getTruncatedExpect(t),e))),n.forEach((({snapId:t,oldVersion:r})=>this.messagingSystem.publish("SnapController:snapUpdated",this.getTruncatedExpect(t),r,e))),i.forEach((e=>u.__privateGet.call(void 0,this,D).delete(e)))}catch(e){const t=s.filter((e=>this.has(e)));await this.removeSnaps(t);const r=[...u.__privateGet.call(void 0,this,D).keys()],i=n.map((({snapId:e})=>e)).filter((e=>r.includes(e)));throw await u.__privateMethod.call(void 0,this,ut,dt).call(this,i),e}return r}async processRequestedSnap(e,t,r,i){const n=this.getTruncated(t);if(n&&!r.shouldAlwaysReload)return g.satisfiesVersionRange.call(void 0,n.version,i)?n:await this.updateSnap(e,t,r,i,!1);let s=u.__privateMethod.call(void 0,this,Pe,Ae).call(this,{origin:e,snapId:t,type:w});this.messagingSystem.publish("SnapController:snapInstallStarted",t,e,!1),n&&this.isRunning(t)&&await this.stopSnap(t,v.SnapStatusEvents.Stop),n&&r.shouldAlwaysReload&&u.__privateMethod.call(void 0,this,Ee,Se).call(this,t);try{const{sourceCode:n}=await u.__privateMethod.call(void 0,this,Me,Ne).call(this,{origin:e,id:t,location:r,versionRange:i});await this.authorize(t,s),s=u.__privateMethod.call(void 0,this,Pe,Ae).call(this,{origin:e,snapId:t,type:b}),await u.__privateMethod.call(void 0,this,Oe,Re).call(this,{snapId:t,sourceCode:n});const a=this.getTruncatedExpect(t);return u.__privateMethod.call(void 0,this,Ce,Ie).call(this,s.id,{loading:!1,type:w}),a}catch(r){v.logError.call(void 0,`Error when adding ${t}.`,r);const i=r instanceof Error?r.message:r.toString();throw u.__privateMethod.call(void 0,this,Ce,Ie).call(this,s.id,{loading:!1,type:w,error:i}),this.messagingSystem.publish("SnapController:snapInstallFailed",t,e,!1,i),r}}async updateSnap(e,t,r,i=v.DEFAULT_REQUESTED_SNAP_VERSION,n=!0){if(u.__privateMethod.call(void 0,this,ne,se).call(this),!g.isValidSemVerRange.call(void 0,i))throw new Error(`Received invalid snap version range: "${i}".`);let s=u.__privateMethod.call(void 0,this,Pe,Ae).call(this,{origin:e,snapId:t,type:T});try{this.messagingSystem.publish("SnapController:snapInstallStarted",t,e,!0);const a=this.getExpect(t),o=a.manifest,c=await l.fetchSnap.call(void 0,t,r),{sourceCode:d,manifest:h}=c,f=h.result,_=f.version;if(!g.gtVersion.call(void 0,_,a.version))throw m.rpcErrors.invalidParams(`Snap "${t}@${a.version}" is already installed. Couldn't update to a version inside requested "${i}" range.`);if(!g.satisfiesVersionRange.call(void 0,_,i))throw new Error(`Version mismatch. Manifest for "${t}" specifies version "${_}" which doesn't satisfy requested version range "${i}".`);await u.__privateMethod.call(void 0,this,re,ie).call(this,t,{version:_,checksum:f.source.shasum,permissions:f.initialPermissions});const k=p.processSnapPermissions.call(void 0,f.initialPermissions);u.__privateMethod.call(void 0,this,De,He).call(this,k);const{newPermissions:y,unusedPermissions:w,approvedPermissions:E}=u.__privateMethod.call(void 0,this,_t,kt).call(this,t,k),{newConnections:S,unusedConnections:P,approvedConnections:A}=l.calculateConnectionsChange.call(void 0,o.initialConnections??{},f.initialConnections??{});u.__privateMethod.call(void 0,this,Ce,Ie).call(this,s.id,{permissions:y,newVersion:f.version,newPermissions:y,approvedPermissions:E,unusedPermissions:w,newConnections:S,unusedConnections:P,approvedConnections:A,loading:!1});const{permissions:C,...I}=await s.promise;s=u.__privateMethod.call(void 0,this,Pe,Ae).call(this,{origin:e,snapId:t,type:b}),this.isRunning(t)&&await this.stopSnap(t,v.SnapStatusEvents.Stop),u.__privateMethod.call(void 0,this,le,ce).call(this,t,v.SnapStatusEvents.Update),u.__privateMethod.call(void 0,this,Ge,Fe).call(this,{origin:e,id:t,files:c,isUpdate:!0}),u.__privateMethod.call(void 0,this,yt,wt).call(this,{snapId:t,unusedPermissions:w,newPermissions:C,requestData:I}),f.initialConnections&&u.__privateMethod.call(void 0,this,_e,ke).call(this,t,o.initialConnections??null,f.initialConnections);const j=u.__privateMethod.call(void 0,this,nt,st).call(this,t);void 0!==j&&(j.permissions.revoked=w,j.permissions.granted=C,j.permissions.requestData=I);const x=d.toString();g.assert.call(void 0,"string"==typeof x&&x.length>0,`Invalid source code for snap "${t}".`);try{await u.__privateMethod.call(void 0,this,Oe,Re).call(this,{snapId:t,sourceCode:x})}catch{throw new Error(`Snap ${t} crashed with updated source code.`)}const M=this.getTruncatedExpect(t);return n&&this.messagingSystem.publish("SnapController:snapUpdated",M,a.version,e),u.__privateMethod.call(void 0,this,Ce,Ie).call(this,s.id,{loading:!1,type:T}),M}catch(r){v.logError.call(void 0,`Error when updating ${t},`,r);const i=r instanceof Error?r.message:r.toString();throw u.__privateMethod.call(void 0,this,Ce,Ie).call(this,s.id,{loading:!1,error:i,type:T}),this.messagingSystem.publish("SnapController:snapInstallFailed",t,e,!0,i),r}}async getRegistryMetadata(e){return u.__privateMethod.call(void 0,this,ne,se).call(this),await this.messagingSystem.call("SnapsRegistry:getMetadata",e)}async authorize(e,t){o.log.call(void 0,`Authorizing snap: ${e}`);const r=this.state.snaps[e],{initialPermissions:i,initialConnections:n}=r;try{const s=p.processSnapPermissions.call(void 0,i);u.__privateMethod.call(void 0,this,De,He).call(this,s),u.__privateMethod.call(void 0,this,Ce,Ie).call(this,t.id,{loading:!1,connections:n??{},permissions:s});const{permissions:a,...o}=await t.promise;u.__privateMethod.call(void 0,this,yt,wt).call(this,{snapId:e,newPermissions:a,requestData:o}),r.manifest.initialConnections&&u.__privateMethod.call(void 0,this,_e,ke).call(this,e,null,r.manifest.initialConnections)}finally{u.__privateMethod.call(void 0,this,pt,ft).call(this,e).installPromise=null}}destroy(){super.destroy(),u.__privateGet.call(void 0,this,H)&&clearTimeout(u.__privateGet.call(void 0,this,H)),this.messagingSystem.unsubscribe("ExecutionService:unhandledError",this._onUnhandledSnapError),this.messagingSystem.unsubscribe("ExecutionService:outboundRequest",this._onOutboundRequest),this.messagingSystem.unsubscribe("ExecutionService:outboundResponse",this._onOutboundResponse),this.messagingSystem.clearEventSubscriptions("SnapController:snapInstalled"),this.messagingSystem.clearEventSubscriptions("SnapController:snapUpdated")}async handleRequest({snapId:e,origin:t,handler:r,request:i}){u.__privateMethod.call(void 0,this,ne,se).call(this);const n={jsonrpc:"2.0",id:k.nanoid.call(void 0),...i};g.assertIsJsonRpcRequest.call(void 0,n);const s=p.handlerEndowments[r];g.assert.call(void 0,"string"==typeof s||null===s,"'permissionName' must be either a string or null.");const a=this.messagingSystem.call("PermissionController:getPermissions",e);if(!(null===s||a&&g.hasProperty.call(void 0,a,s)))throw new Error(`Snap "${e}" is not permitted to use "${s}".`);const o=s?a[s]:void 0;if(s===p.SnapEndowments.Rpc||s===p.SnapEndowments.Keyring){g.assert.call(void 0,o);const r=this.messagingSystem.call("SubjectMetadataController:getSubjectMetadata",t),i=s===p.SnapEndowments.Rpc?p.getRpcCaveatOrigins.call(void 0,o):p.getKeyringCaveatOrigins.call(void 0,o);if(g.assert.call(void 0,i),!v.isOriginAllowed.call(void 0,i,r?.subjectType??h.SubjectType.Website,t))throw new Error(`Snap "${e}" is not permitted to handle requests from "${t}".`)}const l=u.__privateMethod.call(void 0,this,$e,Ke).call(this,e);if(!l)throw new Error(`Snap RPC message handler not found for snap "${e}".`);return l({origin:t,handler:r,request:n,timeout:u.__privateMethod.call(void 0,this,Ue,We).call(this,o)})}};A=new WeakMap,C=new WeakMap,I=new WeakMap,j=new WeakMap,x=new WeakMap,M=new WeakMap,N=new WeakMap,O=new WeakMap,R=new WeakMap,B=new WeakMap,L=new WeakMap,G=new WeakMap,F=new WeakMap,D=new WeakMap,H=new WeakMap,U=new WeakMap,W=new WeakMap,$=new WeakSet,K=function(){const e=({snapId:e})=>this.getExpect(e).enabled,t={initial:v.SnapStatus.Installing,states:{[v.SnapStatus.Installing]:{on:{[v.SnapStatusEvents.Start]:{target:v.SnapStatus.Running,cond:e}}},[v.SnapStatus.Updating]:{on:{[v.SnapStatusEvents.Start]:{target:v.SnapStatus.Running,cond:e},[v.SnapStatusEvents.Stop]:v.SnapStatus.Stopped}},[v.SnapStatus.Running]:{on:{[v.SnapStatusEvents.Stop]:v.SnapStatus.Stopped,[v.SnapStatusEvents.Crash]:v.SnapStatus.Crashed}},[v.SnapStatus.Stopped]:{on:{[v.SnapStatusEvents.Start]:{target:v.SnapStatus.Running,cond:e},[v.SnapStatusEvents.Update]:v.SnapStatus.Updating}},[v.SnapStatus.Crashed]:{on:{[v.SnapStatusEvents.Start]:{target:v.SnapStatus.Running,cond:e},[v.SnapStatusEvents.Update]:v.SnapStatus.Updating}}}};u.__privateSet.call(void 0,this,U,_.createMachine.call(void 0,t)),a.validateMachine.call(void 0,u.__privateGet.call(void 0,this,U))},V=new WeakSet,q=function(){this.messagingSystem.registerActionHandler(`${y}:clearSnapState`,((...e)=>this.clearSnapState(...e))),this.messagingSystem.registerActionHandler(`${y}:get`,((...e)=>this.get(...e))),this.messagingSystem.registerActionHandler(`${y}:getSnapState`,(async(...e)=>this.getSnapState(...e))),this.messagingSystem.registerActionHandler(`${y}:handleRequest`,(async(...e)=>this.handleRequest(...e))),this.messagingSystem.registerActionHandler(`${y}:has`,((...e)=>this.has(...e))),this.messagingSystem.registerActionHandler(`${y}:updateBlockedSnaps`,(async()=>this.updateBlockedSnaps())),this.messagingSystem.registerActionHandler(`${y}:updateSnapState`,(async(...e)=>this.updateSnapState(...e))),this.messagingSystem.registerActionHandler(`${y}:enable`,((...e)=>this.enableSnap(...e))),this.messagingSystem.registerActionHandler(`${y}:disable`,(async(...e)=>this.disableSnap(...e))),this.messagingSystem.registerActionHandler(`${y}:remove`,(async(...e)=>this.removeSnap(...e))),this.messagingSystem.registerActionHandler(`${y}:getPermitted`,((...e)=>this.getPermittedSnaps(...e))),this.messagingSystem.registerActionHandler(`${y}:install`,(async(...e)=>this.installSnaps(...e))),this.messagingSystem.registerActionHandler(`${y}:getAll`,((...e)=>this.getAllSnaps(...e))),this.messagingSystem.registerActionHandler(`${y}:incrementActiveReferences`,((...e)=>this.incrementActiveReferences(...e))),this.messagingSystem.registerActionHandler(`${y}:decrementActiveReferences`,((...e)=>this.decrementActiveReferences(...e))),this.messagingSystem.registerActionHandler(`${y}:getRegistryMetadata`,(async(...e)=>this.getRegistryMetadata(...e))),this.messagingSystem.registerActionHandler(`${y}:disconnectOrigin`,((...e)=>this.removeSnapFromSubject(...e))),this.messagingSystem.registerActionHandler(`${y}:revokeDynamicPermissions`,((...e)=>this.revokeDynamicSnapPermissions(...e))),this.messagingSystem.registerActionHandler(`${y}:getFile`,(async(...e)=>this.getSnapFile(...e)))},Y=new WeakSet,X=function(e){for(const{snapId:t,manifest:r,files:i,removable:n,hidden:s}of e){const e=this.get(t),a=void 0!==e,o=a&&g.gtVersion.call(void 0,r.version,e.version);if(a&&(!o||!0!==e.preinstalled))continue;const l=new(0,v.VirtualFile)({path:v.NpmSnapFileNames.Manifest,value:JSON.stringify(r),result:r}),c=i.map((({path:e,value:t})=>new(0,v.VirtualFile)({value:t,path:e}))),{filePath:d,iconPath:h}=r.source.location.npm,m=c.find((e=>e.path===d)),f=h?c.find((e=>e.path===h)):void 0;g.assert.call(void 0,m,"Source code not provided for preinstalled snap."),g.assert.call(void 0,!h||h&&f,"Icon not provided for preinstalled snap."),g.assert.call(void 0,void 0===r.source.files,"Auxiliary files are not currently supported for preinstalled snaps.");const _=r.source.locales?.map((e=>c.find((t=>t.path===e))))??[],k=v.getValidatedLocalizationFiles.call(void 0,_.filter(Boolean));g.assert.call(void 0,_.length===k.length,"Missing localization files for preinstalled snap.");const y={manifest:l,sourceCode:m,svgIcon:f,auxiliaryFiles:[],localizationFiles:k};u.__privateMethod.call(void 0,this,Ge,Fe).call(this,{id:t,origin:"metamask",files:y,removable:n,hidden:s,preinstalled:!0});const w=p.processSnapPermissions.call(void 0,r.initialPermissions);u.__privateMethod.call(void 0,this,De,He).call(this,w);const{newPermissions:T,unusedPermissions:b}=u.__privateMethod.call(void 0,this,_t,kt).call(this,t,w);u.__privateMethod.call(void 0,this,yt,wt).call(this,{snapId:t,newPermissions:T,unusedPermissions:b}),this.update((e=>{e.snaps[t].status=v.SnapStatus.Stopped}))}},J=new WeakSet,z=function(){u.__privateSet.call(void 0,this,H,setTimeout((()=>{u.__privateMethod.call(void 0,this,ae,oe).call(this).catch((e=>{v.logError.call(void 0,e)})),u.__privateMethod.call(void 0,this,J,z).call(this)}),u.__privateGet.call(void 0,this,N)))},Q=new WeakSet,Z=async function(e,t){if(this.has(e)){try{this.update((r=>{r.snaps[e].blocked=!0,r.snaps[e].blockInformation=t})),await this.disableSnap(e)}catch(t){v.logError.call(void 0,`Encountered error when stopping blocked snap "${e}".`,t)}this.messagingSystem.publish(`${y}:snapBlocked`,e,t)}},ee=new WeakSet,te=function(e){this.has(e)&&this.state.snaps[e].blocked&&(this.update((t=>{t.snaps[e].blocked=!1,delete t.snaps[e].blockInformation})),this.messagingSystem.publish(`${y}:snapUnblocked`,e))},re=new WeakSet,ie=async function(e,t){const r=(await this.messagingSystem.call("SnapsRegistry:get",{[e]:t}))[e];if(1===r.status)throw new Error(`Cannot install version "${t.version}" of snap "${e}": The version is blocked. ${r.reason?.explanation??""}`);const i=Object.keys(t.permissions).some((e=>!s.ALLOWED_PERMISSIONS.includes(e)));if(u.__privateGet.call(void 0,this,x).requireAllowlist&&i&&2!==r.status)throw new Error(`Cannot install version "${t.version}" of snap "${e}": ${3===r.status?"The registry is temporarily unavailable.":"The snap is not on the allowlist."}`)},ne=new WeakSet,se=function(){const e=u.__privateGet.call(void 0,this,L).call(this);g.assert.call(void 0,!0!==e.disableSnaps,"The Snaps platform requires basic functionality to be used. Enable basic functionality in the settings to use the Snaps platform.")},ae=new WeakSet,oe=async function(){const e=[...u.__privateGet.call(void 0,this,F).entries()];return Promise.all(e.filter((([e,t])=>0===t.activeReferences&&0===t.pendingInboundRequests.length&&t.lastRequest&&u.__privateGet.call(void 0,this,O)&&g.timeSince.call(void 0,t.lastRequest)>u.__privateGet.call(void 0,this,O))).map((async([e])=>this.stopSnap(e,v.SnapStatusEvents.Stop))))},le=new WeakSet,ce=function(e,t){const{interpreter:r}=u.__privateMethod.call(void 0,this,pt,ft).call(this,e);r.send(t),this.update((t=>{t.snaps[e].status=r.state.value}))},ue=new WeakSet,de=async function(e){await this.messagingSystem.call("ExecutionService:terminateSnap",e),await new Promise((e=>setTimeout(e,1)));u.__privateMethod.call(void 0,this,pt,ft).call(this,e).pendingInboundRequests.filter((e=>"finished"!==e.timer.status)).forEach((e=>e.timer.finish())),await new Promise((e=>setTimeout(e,1))),this.messagingSystem.publish("SnapController:snapTerminated",this.getTruncatedExpect(e))},he=new WeakSet,me=async function({snapId:e,salt:t,useCache:r,keyMetadata:i}){const n=u.__privateMethod.call(void 0,this,pt,ft).call(this,e);if(n.encryptionKey&&n.encryptionSalt&&r)return{key:await u.__privateGet.call(void 0,this,R).importKey(n.encryptionKey),salt:n.encryptionSalt};const s=t??u.__privateGet.call(void 0,this,R).generateSalt(),a=await u.__privateGet.call(void 0,this,B).call(this),o=await p.getEncryptionEntropy.call(void 0,{snapId:e,mnemonicPhrase:a}),l=await u.__privateGet.call(void 0,this,R).keyFromPassword(o,s,!0,i),c=await u.__privateGet.call(void 0,this,R).exportKey(l);return r&&(n.encryptionKey=c,n.encryptionSalt=s),{key:l,salt:s}},pe=new WeakSet,fe=async function(e,t){try{const r=v.parseJson.call(void 0,t),{salt:i,keyMetadata:n}=r,a=u.__privateGet.call(void 0,this,R).isVaultUpdated(t),{key:o}=await u.__privateMethod.call(void 0,this,he,me).call(this,{snapId:e,salt:i,useCache:a,keyMetadata:n??s.LEGACY_ENCRYPTION_KEY_DERIVATION_OPTIONS}),l=await u.__privateGet.call(void 0,this,R).decryptWithKey(o,r);return g.assert.call(void 0,g.isValidJson.call(void 0,l)),l}catch{throw m.rpcErrors.internal({message:"Failed to decrypt snap state, the state must be corrupted."})}},ve=new WeakSet,ge=async function(e,t){const{key:r,salt:i}=await u.__privateMethod.call(void 0,this,he,me).call(this,{snapId:e,useCache:!0}),n=await u.__privateGet.call(void 0,this,R).encryptWithKey(r,t);return n.salt=i,JSON.stringify(n)},_e=new WeakSet,ke=function(e,t,r){if(t){const i=l.setDiff.call(void 0,t,r);for(const t of Object.keys(i))this.removeSnapFromSubject(t,e)}for(const t of Object.keys(r))u.__privateMethod.call(void 0,this,ye,we).call(this,t,e)},ye=new WeakSet,we=function(e,t){const r=this.messagingSystem.call("PermissionController:getPermissions",e),i=r?.[p.WALLET_SNAP_PERMISSION_KEY]?.caveats?.find((e=>e.type===v.SnapCaveatType.SnapIds));if(Boolean(i?.value?.[t]))return;if(i)return void this.messagingSystem.call("PermissionController:updateCaveat",e,p.WALLET_SNAP_PERMISSION_KEY,v.SnapCaveatType.SnapIds,{...i.value,[t]:{}});const n={[p.WALLET_SNAP_PERMISSION_KEY]:{caveats:[{type:v.SnapCaveatType.SnapIds,value:{[t]:{}}}]}};this.messagingSystem.call("PermissionController:grantPermissions",{approvedPermissions:n,subject:{origin:e}})},Te=new WeakSet,be=function(e){const t=this.messagingSystem.call("PermissionController:getSubjectNames");for(const r of t)this.removeSnapFromSubject(r,e)},Ee=new WeakSet,Se=function(e){this.messagingSystem.call("PermissionController:hasPermissions",e)&&this.messagingSystem.call("PermissionController:revokeAllPermissions",e)},Pe=new WeakSet,Ae=function({origin:e,snapId:t,type:r}){const i=k.nanoid.call(void 0);return{id:i,promise:this.messagingSystem.call("ApprovalController:addRequest",{origin:e,id:i,type:r,requestData:{metadata:{id:i,origin:t,dappOrigin:e},snapId:t},requestState:{loading:!0}},!0)}},Ce=new WeakSet,Ie=function(e,t){try{this.messagingSystem.call("ApprovalController:updateRequestState",{id:e,requestState:t})}catch{}},je=new WeakSet,xe=async function(e,t){return await this.messagingSystem.call("SnapsRegistry:resolveVersion",e,t)},Me=new WeakSet,Ne=async function(e){const{id:t,location:r,versionRange:i}=e;u.__privateMethod.call(void 0,this,vt,gt).call(this,t);const n=u.__privateMethod.call(void 0,this,pt,ft).call(this,t);n.installPromise||(o.log.call(void 0,`Adding snap: ${t}`),n.installPromise=(async()=>{const n=await l.fetchSnap.call(void 0,t,r),s=n.manifest.result;if(!g.satisfiesVersionRange.call(void 0,s.version,i))throw new Error(`Version mismatch. Manifest for "${t}" specifies version "${s.version}" which doesn't satisfy requested version range "${i}".`);return await u.__privateMethod.call(void 0,this,re,ie).call(this,t,{version:s.version,checksum:s.source.shasum,permissions:s.initialPermissions}),u.__privateMethod.call(void 0,this,Ge,Fe).call(this,{...e,files:n,id:t})})());try{return await n.installPromise}catch(e){throw n.installPromise=null,e}},Oe=new WeakSet,Re=async function(e){const{snapId:t}=e;if(this.isRunning(t))throw new Error(`Snap "${t}" is already started.`);try{const r=u.__privateMethod.call(void 0,this,pt,ft).call(this,t),i=await this.messagingSystem.call("ExecutionService:executeSnap",{...e,endowments:await u.__privateMethod.call(void 0,this,Be,Le).call(this,t)});return u.__privateMethod.call(void 0,this,le,ce).call(this,t,v.SnapStatusEvents.Start),r.lastRequest=Date.now(),i}catch(e){throw await u.__privateMethod.call(void 0,this,ue,de).call(this,t),e}},Be=new WeakSet,Le=async function(e){let t=[];for(const r of u.__privateGet.call(void 0,this,I))if(this.messagingSystem.call("PermissionController:hasPermission",e,r)){const i=await this.messagingSystem.call("PermissionController:getEndowments",e,r);if(i){if(!Array.isArray(i)||i.some((e=>"string"!=typeof e)))throw new Error("Expected an array of string endowment names.");t=t.concat(i)}}const r=[...new Set([...v.DEFAULT_ENDOWMENTS,...t])];return r.length<v.DEFAULT_ENDOWMENTS.length+t.length&&v.logError.call(void 0,`Duplicate endowments found for ${e}. Default endowments should not be requested.`,t),r},Ge=new WeakSet,Fe=function(e){const{id:t,origin:r,files:i,isUpdate:n=!1,removable:s,preinstalled:a,hidden:o}=e,{manifest:l,sourceCode:c,svgIcon:d,auxiliaryFiles:m,localizationFiles:p}=i;v.assertIsSnapManifest.call(void 0,l.result);const{version:f}=l.result,_=c.toString();g.assert.call(void 0,"string"==typeof _&&_.length>0,`Invalid source code for snap "${t}".`);const k=m.map((e=>(g.assert.call(void 0,"string"==typeof e.data.base64),{path:e.path,value:e.data.base64}))),y=this.state.snaps[t],w=[...y?.versionHistory??[],{version:f,date:Date.now(),origin:r}],T=p.map((e=>e.result)),b={...y,blocked:!1,enabled:!0,removable:s,preinstalled:a,hidden:o,id:t,initialConnections:l.result.initialConnections,initialPermissions:l.result.initialPermissions,manifest:l.result,status:u.__privateGet.call(void 0,this,U).config.initial,sourceCode:_,version:f,versionHistory:w,auxiliaryFiles:k,localizationFiles:T};delete b.blockInformation;const{inversePatches:E}=this.update((e=>{e.snaps[t]=b}));if(n){const e=u.__privateMethod.call(void 0,this,nt,st).call(this,t);void 0!==e&&(e.statePatches=E)}const{proposedName:S}=v.getLocalizedSnapManifest.call(void 0,l.result,"en",T);return this.messagingSystem.call("SubjectMetadataController:addSubjectMetadata",{subjectType:h.SubjectType.Snap,name:S,origin:b.id,version:f,svgIcon:d?.toString()??null}),{...b,sourceCode:_}},De=new WeakSet,He=function(e){const t=Object.keys(e),r=Array.from(new Set(Object.values(p.handlerEndowments)));g.assert.call(void 0,t.some((e=>r.includes(e))),`A snap must request at least one of the following permissions: ${r.filter((e=>null!==e)).join(", ")}.`);const i=t.reduce(((e,t)=>(g.hasProperty.call(void 0,u.__privateGet.call(void 0,this,j),t)&&e.push(u.__privateGet.call(void 0,this,j)[t]),e)),[]);g.assert.call(void 0,0===i.length,`One or more permissions are not allowed:\n${i.join("\n")}`)},Ue=new WeakSet,We=function(e){return p.getMaxRequestTimeCaveat.call(void 0,e)??this.maxRequestTime},$e=new WeakSet,Ke=function(e){const t=u.__privateMethod.call(void 0,this,pt,ft).call(this,e),r=t.rpcHandler;if(r)return r;const i=new(0,n.RequestQueue)(5),s=new Map,a=async({origin:t,handler:r,request:n,timeout:a})=>{if(!1===this.state.snaps[e].enabled)throw new Error(`Snap "${e}" is disabled.`);if(this.state.snaps[e].status===v.SnapStatus.Installing)throw new Error(`Snap "${e}" is currently being installed. Please try again later.`);if(!this.isRunning(e)){let r=s.get(e);if(r){if(i.get(t)>=i.maxQueueSize)throw new Error("Exceeds maximum number of requests waiting to be resolved, please try again.")}else r=this.startSnap(e),s.set(e,r);i.increment(t);try{await r}finally{i.decrement(t),s.get(e)===r&&s.delete(e)}}const o=new(0,c.Timer)(a);u.__privateMethod.call(void 0,this,et,tt).call(this,e,n.id,o);const d=this.messagingSystem.call("ExecutionService:handleRpcRequest",e,{origin:t,handler:r,request:n});try{const t=await l.withTimeout.call(void 0,d,o);if(t===l.hasTimedOut)throw new Error(`${e} failed to respond to the request in time.`);await u.__privateMethod.call(void 0,this,Qe,Ze).call(this,e,r,t);const i=await u.__privateMethod.call(void 0,this,Je,ze).call(this,e,r,t);return u.__privateMethod.call(void 0,this,rt,it).call(this,e,n.id),i}catch(t){u.__privateMethod.call(void 0,this,rt,it).call(this,e,n.id);const[r,i]=v.unwrapError.call(void 0,t);throw i||await this.stopSnap(e,v.SnapStatusEvents.Crash),r}};return t.rpcHandler=a,a},Ve=new WeakSet,qe=async function(e,t){return this.messagingSystem.call("SnapInterfaceController:createInterface",e,t)},Ye=new WeakSet,Xe=function(e,t){g.assert.call(void 0,this.messagingSystem.call("SnapInterfaceController:getInterface",e,t))},Je=new WeakSet,ze=async function(e,t,r){switch(t){case v.HandlerType.OnTransaction:case v.HandlerType.OnSignature:case v.HandlerType.OnHomePage:{const t=r;if(t&&g.hasProperty.call(void 0,t,"content")){const{content:r,...i}=t;return{...i,id:await u.__privateMethod.call(void 0,this,Ve,qe).call(this,e,r)}}return r}default:return r}},Qe=new WeakSet,Ze=async function(e,t,r){switch(t){case v.HandlerType.OnTransaction:g.assertStruct.call(void 0,r,v.OnTransactionResponseStruct),r&&g.hasProperty.call(void 0,r,"id")&&u.__privateMethod.call(void 0,this,Ye,Xe).call(this,e,r.id);break;case v.HandlerType.OnSignature:g.assertStruct.call(void 0,r,v.OnSignatureResponseStruct),r&&g.hasProperty.call(void 0,r,"id")&&u.__privateMethod.call(void 0,this,Ye,Xe).call(this,e,r.id);break;case v.HandlerType.OnHomePage:g.assertStruct.call(void 0,r,v.OnHomePageResponseStruct),r&&g.hasProperty.call(void 0,r,"id")&&u.__privateMethod.call(void 0,this,Ye,Xe).call(this,e,r.id);break;case v.HandlerType.OnNameLookup:g.assertStruct.call(void 0,r,v.OnNameLookupResponseStruct)}},et=new WeakSet,tt=function(e,t,r){const i=u.__privateMethod.call(void 0,this,pt,ft).call(this,e);i.pendingInboundRequests.push({requestId:t,timer:r}),i.lastRequest=null},rt=new WeakSet,it=function(e,t){const r=u.__privateMethod.call(void 0,this,pt,ft).call(this,e);r.pendingInboundRequests=r.pendingInboundRequests.filter((e=>e.requestId!==t)),0===r.pendingInboundRequests.length&&(r.lastRequest=Date.now())},nt=new WeakSet,st=function(e){return u.__privateGet.call(void 0,this,D).get(e)},at=new WeakSet,ot=function(e){g.assert.call(void 0,void 0===u.__privateGet.call(void 0,this,D).get(e),new Error(`Snap "${e}" rollback snapshot already exists.`)),u.__privateGet.call(void 0,this,D).set(e,{statePatches:[],permissions:{},newVersion:""});const t=u.__privateGet.call(void 0,this,D).get(e);return g.assert.call(void 0,void 0!==t,new Error(`Snapshot creation failed for ${e}.`)),t},lt=new WeakSet,ct=async function(e){const t=u.__privateMethod.call(void 0,this,nt,st).call(this,e);if(!t)throw new Error("A snapshot does not exist for this snap.");await this.stopSnap(e,v.SnapStatusEvents.Stop),this.get(e)?.status!==v.SnapStatus.Stopped&&u.__privateMethod.call(void 0,this,le,ce).call(this,e,v.SnapStatusEvents.Stop);const{statePatches:r,permissions:i}=t;r?.length&&this.applyPatches(r),this.get(e)?.status!==v.SnapStatus.Stopped&&this.update((t=>{t.snaps[e].status=v.SnapStatus.Stopped})),u.__privateMethod.call(void 0,this,yt,wt).call(this,{snapId:e,unusedPermissions:i.granted,newPermissions:i.revoked,requestData:i.requestData});const n=this.getTruncatedExpect(e);this.messagingSystem.publish("SnapController:snapRolledback",n,t.newVersion),u.__privateGet.call(void 0,this,D).delete(e)},ut=new WeakSet,dt=async function(e){for(const t of e)await u.__privateMethod.call(void 0,this,lt,ct).call(this,t)},ht=new WeakSet,mt=function(e){return u.__privateGet.call(void 0,this,F).get(e)},pt=new WeakSet,ft=function(e){const t=u.__privateMethod.call(void 0,this,ht,mt).call(this,e);return g.assert.call(void 0,void 0!==t,new Error(`Snap "${e}" runtime data not found`)),t},vt=new WeakSet,gt=function(e){if(u.__privateGet.call(void 0,this,F).has(e))return;const t=this.get(e),r=_.interpret.call(void 0,u.__privateGet.call(void 0,this,U));r.start({context:{snapId:e},value:t?.status??u.__privateGet.call(void 0,this,U).config.initial}),a.forceStrict.call(void 0,r),u.__privateGet.call(void 0,this,F).set(e,{lastRequest:null,rpcHandler:null,installPromise:null,encryptionKey:null,encryptionSalt:null,activeReferences:0,pendingInboundRequests:[],pendingOutboundRequests:0,interpreter:r,stopping:!1})},_t=new WeakSet,kt=function(e,t){const r=this.messagingSystem.call("PermissionController:getPermissions",e)??{},i=l.permissionsDiff.call(void 0,t,r),n=l.permissionsDiff.call(void 0,r,t);return{newPermissions:i,unusedPermissions:n,approvedPermissions:l.permissionsDiff.call(void 0,r,n)}},yt=new WeakSet,wt=function({snapId:e,unusedPermissions:t={},newPermissions:r={},requestData:i}){const n=Object.keys(t);g.isNonEmptyArray.call(void 0,n)&&this.messagingSystem.call("PermissionController:revokePermissions",{[e]:n}),g.isNonEmptyArray.call(void 0,Object.keys(r))&&this.messagingSystem.call("PermissionController:grantPermissions",{approvedPermissions:r,subject:{origin:e},requestData:i})},Tt=new WeakSet,bt=function(e,t){const r=this.getExpect(e);return!g.satisfiesVersionRange.call(void 0,r.version,t)&&!g.gtRange.call(void 0,r.version,t)},Et=new WeakSet,St=async function(e,t,r){const i=p.handlerEndowments[r];g.assert.call(void 0,i,"Lifecycle hook must have an endowment.");this.messagingSystem.call("PermissionController:hasPermission",t,i)&&await this.handleRequest({snapId:t,handler:r,origin:e,request:{jsonrpc:"2.0",method:r}})},r.controllerName=y,r.SNAP_APPROVAL_INSTALL=w,r.SNAP_APPROVAL_UPDATE=T,r.SNAP_APPROVAL_RESULT=b,r.SnapController=Pt}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-ZBSBCWWM.js"}],[1992,{"./chunk-S775IABY.js":1985,"@metamask/post-message-stream":1669,"@metamask/snaps-utils":2163},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i=e("./chunk-S775IABY.js"),n=e("@metamask/post-message-stream"),s=e("@metamask/snaps-utils"),a=class extends i.AbstractExecutionService{constructor({iframeUrl:e,messenger:t,setupSnapProvider:r}){super({messenger:t,setupSnapProvider:r}),this.iframeUrl=e}terminateJob(e){document.getElementById(e.id)?.remove()}async initEnvStream(e){const t=await s.createWindow.call(void 0,this.iframeUrl.toString(),e);return{worker:t,stream:new(0,n.WindowPostMessageStream)({name:"parent",target:"child",targetWindow:t,targetOrigin:"*"})}}};r.IframeExecutionService=a}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-ZRC46TUF.js"}],[1993,{"./chunk-4CA3O64H.js":1960,"./chunk-4URGXJP7.js":1961,"./chunk-6ERB63FH.js":1962,"./chunk-6VGMRXGY.js":1963,"./chunk-7Y6P5FRN.js":1964,"./chunk-AP7CJ6DA.js":1965,"./chunk-BO2ZDPWV.js":1966,"./chunk-BOFPNIRX.js":1967,"./chunk-CDTGUNSA.js":1968,"./chunk-CPUUURMT.js":1969,"./chunk-D74XJG2L.js":1970,"./chunk-EXN2TFDJ.js":1971,"./chunk-G66GQJS6.js":1972,"./chunk-GRBWVPLF.js":1973,"./chunk-HOY6NKQR.js":1974,"./chunk-HQ6HMINL.js":1975,"./chunk-JAUAKTUL.js":1976,"./chunk-JQ54YYLU.js":1977,"./chunk-KH72WRHR.js":1978,"./chunk-LWBPKSU2.js":1979,"./chunk-NXZVKBSV.js":1980,"./chunk-OHMCPTOI.js":1981,"./chunk-OIEUL55W.js":1982,"./chunk-PT22IXNS.js":1983,"./chunk-RDBT3ZJQ.js":1984,"./chunk-S775IABY.js":1985,"./chunk-VNOCJWOK.js":1986,"./chunk-WCDDYBFW.js":1987,"./chunk-WEY7ICES.js":1988,"./chunk-XWDEGRM5.js":1989,"./chunk-YYPUPKQY.js":1990,"./chunk-ZBSBCWWM.js":1991,"./chunk-ZRC46TUF.js":1992},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i=e("./chunk-GRBWVPLF.js");e("./chunk-JAUAKTUL.js");var n=e("./chunk-ZBSBCWWM.js");e("./chunk-WEY7ICES.js");var s=e("./chunk-PT22IXNS.js"),a=e("./chunk-LWBPKSU2.js"),o=e("./chunk-XWDEGRM5.js");e("./chunk-G66GQJS6.js");var l=e("./chunk-CPUUURMT.js"),c=e("./chunk-4CA3O64H.js"),u=e("./chunk-RDBT3ZJQ.js");e("./chunk-AP7CJ6DA.js"),e("./chunk-JQ54YYLU.js");var d=e("./chunk-YYPUPKQY.js");e("./chunk-VNOCJWOK.js");var h=e("./chunk-6VGMRXGY.js");e("./chunk-WCDDYBFW.js"),e("./chunk-4URGXJP7.js"),e("./chunk-OHMCPTOI.js"),e("./chunk-D74XJG2L.js");var m=e("./chunk-HQ6HMINL.js");e("./chunk-HOY6NKQR.js");var p=e("./chunk-ZRC46TUF.js"),f=e("./chunk-6ERB63FH.js");e("./chunk-KH72WRHR.js");var v=e("./chunk-S775IABY.js");e("./chunk-OIEUL55W.js");var g=e("./chunk-7Y6P5FRN.js");e("./chunk-BO2ZDPWV.js"),e("./chunk-NXZVKBSV.js");var _=e("./chunk-CDTGUNSA.js");e("./chunk-BOFPNIRX.js"),e("./chunk-EXN2TFDJ.js"),r.AbstractExecutionService=v.AbstractExecutionService,r.BaseNpmLocation=o.BaseNpmLocation,r.CronjobController=i.CronjobController,r.DAILY_TIMEOUT=i.DAILY_TIMEOUT,r.DEFAULT_NPM_REGISTRY=o.DEFAULT_NPM_REGISTRY,r.HttpLocation=u.HttpLocation,r.IframeExecutionService=p.IframeExecutionService,r.JsonSnapsRegistry=l.JsonSnapsRegistry,r.LocalLocation=a.LocalLocation,r.NpmLocation=o.NpmLocation,r.OffscreenExecutionService=f.OffscreenExecutionService,r.ProxyPostMessageStream=g.ProxyPostMessageStream,r.SNAP_APPROVAL_INSTALL=n.SNAP_APPROVAL_INSTALL,r.SNAP_APPROVAL_RESULT=n.SNAP_APPROVAL_RESULT,r.SNAP_APPROVAL_UPDATE=n.SNAP_APPROVAL_UPDATE,r.SnapController=n.SnapController,r.SnapInterfaceController=h.SnapInterfaceController,r.SnapsRegistryStatus=c.SnapsRegistryStatus,r.TARBALL_SIZE_SAFETY_LIMIT=o.TARBALL_SIZE_SAFETY_LIMIT,r.WebWorkerExecutionService=m.WebWorkerExecutionService,r.calculateConnectionsChange=_.calculateConnectionsChange,r.controllerName=n.controllerName,r.delay=_.delay,r.delayWithTimer=_.delayWithTimer,r.detectSnapLocation=s.detectSnapLocation,r.fetchNpmMetadata=o.fetchNpmMetadata,r.fetchSnap=_.fetchSnap,r.getNpmCanonicalBasePath=o.getNpmCanonicalBasePath,r.getRunnableSnaps=d.getRunnableSnaps,r.getSnapFiles=_.getSnapFiles,r.hasTimedOut=_.hasTimedOut,r.permissionsDiff=_.permissionsDiff,r.setDiff=_.setDiff,r.setupMultiplex=v.setupMultiplex,r.withTimeout=_.withTimeout}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/index.js"}],[1994,{"./chunk-UJFCPTF3.js":1996,"./chunk-Z4BLTVTB.js":1997},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i,n,s,a,o=e("./chunk-UJFCPTF3.js"),l=e("./chunk-Z4BLTVTB.js");i=new WeakMap,n=new WeakMap,s=new WeakMap,a=new WeakMap,r.ControllerMessenger=class{constructor(){l.__privateAdd.call(void 0,this,i,new Map),l.__privateAdd.call(void 0,this,n,new Map),l.__privateAdd.call(void 0,this,s,new Map),l.__privateAdd.call(void 0,this,a,new Map)}registerActionHandler(e,t){if(l.__privateGet.call(void 0,this,i).has(e))throw new Error(`A handler for ${e} has already been registered`);l.__privateGet.call(void 0,this,i).set(e,t)}unregisterActionHandler(e){l.__privateGet.call(void 0,this,i).delete(e)}clearActions(){l.__privateGet.call(void 0,this,i).clear()}call(e,...t){const r=l.__privateGet.call(void 0,this,i).get(e);if(!r)throw new Error(`A handler for ${e} has not been registered`);return r(...t)}registerInitialEventPayload({eventType:e,getPayload:t}){l.__privateGet.call(void 0,this,s).set(e,t)}publish(e,...t){const r=l.__privateGet.call(void 0,this,n).get(e);if(r)for(const[e,i]of r.entries())try{if(i){const r=l.__privateGet.call(void 0,this,a).get(e),n=i(...t);n!==r&&(l.__privateGet.call(void 0,this,a).set(e,n),e(n,r))}else e(...t)}catch(e){setTimeout((()=>{throw e}))}}subscribe(e,t,r){let i=l.__privateGet.call(void 0,this,n).get(e);if(i||(i=new Map,l.__privateGet.call(void 0,this,n).set(e,i)),i.set(t,r),r){const i=l.__privateGet.call(void 0,this,s).get(e);if(i){const e=r(...i());l.__privateGet.call(void 0,this,a).set(t,e)}}}unsubscribe(e,t){const r=l.__privateGet.call(void 0,this,n).get(e);if(!r||!r.has(t))throw new Error(`Subscription not found for event: ${e}`);r.get(t)&&l.__privateGet.call(void 0,this,a).delete(t),r.delete(t)}clearEventSubscriptions(e){l.__privateGet.call(void 0,this,n).delete(e)}clearSubscriptions(){l.__privateGet.call(void 0,this,n).clear()}getRestricted({name:e,allowedActions:t,allowedEvents:r}){return new(0,o.RestrictedControllerMessenger)({controllerMessenger:this,name:e,allowedActions:t,allowedEvents:r})}}}}},{package:"@metamask/snaps-controllers>@metamask/base-controller",file:"node_modules/@metamask/snaps-controllers/node_modules/@metamask/base-controller/dist/chunk-G42723LG.js"}],[1995,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i=class{constructor(e={},t={}){this.defaultConfig={},this.defaultState={},this.disabled=!1,this.name="BaseController",this.internalConfig=this.defaultConfig,this.internalState=this.defaultState,this.internalListeners=[],this.initialState=t,this.initialConfig=e}initialize(){return this.internalState=this.defaultState,this.internalConfig=this.defaultConfig,this.configure(this.initialConfig),this.update(this.initialState),this}get config(){return this.internalConfig}get state(){return this.internalState}configure(e,t=!1,r=!0){if(r){this.internalConfig=t?e:Object.assign(this.internalConfig,e);for(const e of Object.keys(this.internalConfig)){const t=this.internalConfig[e];void 0!==t&&(this[e]=t)}}else for(const t of Object.keys(e))if(void 0!==this.internalConfig[t]){const r=e[t];this.internalConfig[t]=r,this[t]=r}}notify(){this.disabled||this.internalListeners.forEach((e=>{e(this.internalState)}))}subscribe(e){this.internalListeners.push(e)}unsubscribe(e){const t=this.internalListeners.findIndex((t=>e===t));return t>-1&&this.internalListeners.splice(t,1),t>-1}update(e,t=!1){this.internalState=t?Object.assign({},e):Object.assign({},this.internalState,e),this.notify()}},n=i;r.BaseControllerV1=i,r.BaseControllerV1_default=n}}},{package:"@metamask/snaps-controllers>@metamask/base-controller",file:"node_modules/@metamask/snaps-controllers/node_modules/@metamask/base-controller/dist/chunk-NINOM2XQ.js"}],[1996,{"./chunk-Z4BLTVTB.js":1997},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i,n,s,a,o,l,c,u,d,h,m=e("./chunk-Z4BLTVTB.js");i=new WeakMap,n=new WeakMap,s=new WeakMap,a=new WeakMap,o=new WeakSet,l=function(e){const t=m.__privateGet.call(void 0,this,a);return m.__privateMethod.call(void 0,this,d,h).call(this,e)||null!==t&&t.includes(e)},c=new WeakSet,u=function(e){const t=m.__privateGet.call(void 0,this,s);return m.__privateMethod.call(void 0,this,d,h).call(this,e)||null!==t&&t.includes(e)},d=new WeakSet,h=function(e){return e.startsWith(`${m.__privateGet.call(void 0,this,n)}:`)},r.RestrictedControllerMessenger=class{constructor({controllerMessenger:e,name:t,allowedActions:r,allowedEvents:l}){m.__privateAdd.call(void 0,this,o),m.__privateAdd.call(void 0,this,c),m.__privateAdd.call(void 0,this,d),m.__privateAdd.call(void 0,this,i,void 0),m.__privateAdd.call(void 0,this,n,void 0),m.__privateAdd.call(void 0,this,s,void 0),m.__privateAdd.call(void 0,this,a,void 0),m.__privateSet.call(void 0,this,i,e),m.__privateSet.call(void 0,this,n,t),m.__privateSet.call(void 0,this,s,r),m.__privateSet.call(void 0,this,a,l)}registerActionHandler(e,t){if(!m.__privateMethod.call(void 0,this,d,h).call(this,e))throw new Error(`Only allowed registering action handlers prefixed by '${m.__privateGet.call(void 0,this,n)}:'`);m.__privateGet.call(void 0,this,i).registerActionHandler(e,t)}unregisterActionHandler(e){if(!m.__privateMethod.call(void 0,this,d,h).call(this,e))throw new Error(`Only allowed unregistering action handlers prefixed by '${m.__privateGet.call(void 0,this,n)}:'`);m.__privateGet.call(void 0,this,i).unregisterActionHandler(e)}call(e,...t){if(!m.__privateMethod.call(void 0,this,c,u).call(this,e))throw new Error(`Action missing from allow list: ${e}`);return m.__privateGet.call(void 0,this,i).call(e,...t)}registerInitialEventPayload({eventType:e,getPayload:t}){if(!m.__privateMethod.call(void 0,this,d,h).call(this,e))throw new Error(`Only allowed publishing events prefixed by '${m.__privateGet.call(void 0,this,n)}:'`);m.__privateGet.call(void 0,this,i).registerInitialEventPayload({eventType:e,getPayload:t})}publish(e,...t){if(!m.__privateMethod.call(void 0,this,d,h).call(this,e))throw new Error(`Only allowed publishing events prefixed by '${m.__privateGet.call(void 0,this,n)}:'`);m.__privateGet.call(void 0,this,i).publish(e,...t)}subscribe(e,t,r){if(!m.__privateMethod.call(void 0,this,o,l).call(this,e))throw new Error(`Event missing from allow list: ${e}`);return r?m.__privateGet.call(void 0,this,i).subscribe(e,t,r):m.__privateGet.call(void 0,this,i).subscribe(e,t)}unsubscribe(e,t){if(!m.__privateMethod.call(void 0,this,o,l).call(this,e))throw new Error(`Event missing from allow list: ${e}`);m.__privateGet.call(void 0,this,i).unsubscribe(e,t)}clearEventSubscriptions(e){if(!m.__privateMethod.call(void 0,this,d,h).call(this,e))throw new Error(`Only allowed clearing events prefixed by '${m.__privateGet.call(void 0,this,n)}:'`);m.__privateGet.call(void 0,this,i).clearEventSubscriptions(e)}}}}},{package:"@metamask/snaps-controllers>@metamask/base-controller",file:"node_modules/@metamask/snaps-controllers/node_modules/@metamask/base-controller/dist/chunk-UJFCPTF3.js"}],[1997,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i=(e,t,r)=>{if(!t.has(e))throw TypeError("Cannot "+r)};r.__privateGet=(e,t,r)=>(i(e,t,"read from private field"),r?r.call(e):t.get(e)),r.__privateAdd=(e,t,r)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,r)},r.__privateSet=(e,t,r,n)=>(i(e,t,"write to private field"),n?n.call(e,r):t.set(e,r),r),r.__privateMethod=(e,t,r)=>(i(e,t,"access private method"),r)}}},{package:"@metamask/snaps-controllers>@metamask/base-controller",file:"node_modules/@metamask/snaps-controllers/node_modules/@metamask/base-controller/dist/chunk-Z4BLTVTB.js"}],[1998,{"./chunk-Z4BLTVTB.js":1997,immer:3640},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i,n=e("./chunk-Z4BLTVTB.js"),s=e("immer");s.enablePatches.call(void 0);function a(e,t,r){return Object.keys(e).reduce(((i,n)=>{try{const s=t[n];if(!s)throw new Error(`No metadata found for '${String(n)}'`);const a=s[r],o=e[n];return"function"==typeof a?i[n]=a(o):a&&(i[n]=o),i}catch(e){return setTimeout((()=>{throw e})),i}}),{})}i=new WeakMap,r.BaseController=class{constructor({messenger:e,metadata:t,name:r,state:a}){n.__privateAdd.call(void 0,this,i,void 0),this.messagingSystem=e,this.name=r,n.__privateSet.call(void 0,this,i,s.freeze.call(void 0,a,!0)),this.metadata=t,this.messagingSystem.registerActionHandler(`${r}:getState`,(()=>this.state)),this.messagingSystem.registerInitialEventPayload({eventType:`${r}:stateChange`,getPayload:()=>[this.state,[]]})}get state(){return n.__privateGet.call(void 0,this,i)}set state(e){throw new Error("Controller state cannot be directly mutated; use 'update' method instead.")}update(e){const[t,r,a]=s.produceWithPatches.call(void 0,n.__privateGet.call(void 0,this,i),e);return n.__privateSet.call(void 0,this,i,t),this.messagingSystem.publish(`${this.name}:stateChange`,t,r),{nextState:t,patches:r,inversePatches:a}}applyPatches(e){const t=s.applyPatches.call(void 0,n.__privateGet.call(void 0,this,i),e);n.__privateSet.call(void 0,this,i,t),this.messagingSystem.publish(`${this.name}:stateChange`,t,e)}destroy(){this.messagingSystem.clearEventSubscriptions(`${this.name}:stateChange`)}},r.getAnonymizedState=function(e,t){return a(e,t,"anonymous")},r.getPersistentState=function(e,t){return a(e,t,"persist")}}}},{package:"@metamask/snaps-controllers>@metamask/base-controller",file:"node_modules/@metamask/snaps-controllers/node_modules/@metamask/base-controller/dist/chunk-ZNOPSWMU.js"}],[1999,{"./chunk-G42723LG.js":1994,"./chunk-NINOM2XQ.js":1995,"./chunk-UJFCPTF3.js":1996,"./chunk-Z4BLTVTB.js":1997,"./chunk-ZNOPSWMU.js":1998},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i=e("./chunk-NINOM2XQ.js"),n=e("./chunk-ZNOPSWMU.js"),s=e("./chunk-G42723LG.js"),a=e("./chunk-UJFCPTF3.js");e("./chunk-Z4BLTVTB.js"),r.BaseController=n.BaseController,r.BaseControllerV1=i.BaseControllerV1,r.ControllerMessenger=s.ControllerMessenger,r.RestrictedControllerMessenger=a.RestrictedControllerMessenger,r.getAnonymizedState=n.getAnonymizedState,r.getPersistentState=n.getPersistentState}}},{package:"@metamask/snaps-controllers>@metamask/base-controller",file:"node_modules/@metamask/snaps-controllers/node_modules/@metamask/base-controller/dist/index.js"}],[20,{"../constants/notification-schema":17,"./process-feature-announcement":19,"./process-onchain-notifications":21},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.processNotification=function(e,t=[]){if(o(e)){const r=(0,s.processFeatureAnnouncement)(e);return r.isRead=(0,s.isFeatureAnnouncementRead)(r,t),r}if(a(e))return(0,n.processOnChainNotification)(e);return(t=>{throw new Error(`No processor found for notification kind ${e.type}`)})()};var i=e("../constants/notification-schema"),n=e("./process-onchain-notifications"),s=e("./process-feature-announcement");const a=e=>Object.values(i.TRIGGER_TYPES).includes(e.type),o=e=>e.type===i.TRIGGER_TYPES.FEATURES_ANNOUNCEMENT}}},{package:"$root$",file:"app/scripts/controllers/metamask-notifications/processors/process-notifications.ts"}],[200,{"@metamask/utils":2300},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e){if((0,i.hasProperty)(e,"NftController")&&(0,i.isObject)(e.NftController)){const t=e.NftController;if((0,i.hasProperty)(t,"allNftContracts")&&(0,i.isObject)(t.allNftContracts)){const{allNftContracts:e}=t;Object.keys(e).every((t=>(0,i.isObject)(e[t])))&&Object.keys(e).forEach((t=>{const r=e[t];if((0,i.isObject)(r)&&n(r))for(const e of Object.keys(r))(0,i.isStrictHexString)(e)||delete r[e]}))}if((0,i.hasProperty)(t,"allNfts")&&(0,i.isObject)(t.allNfts)){const{allNfts:e}=t;Object.keys(e).every((t=>(0,i.isObject)(e[t])))&&Object.keys(e).forEach((t=>{const r=e[t];if((0,i.isObject)(r)&&n(r))for(const e of Object.keys(r))(0,i.isStrictHexString)(e)||delete r[e]}))}e.NftController=t}if((0,i.hasProperty)(e,"TokenListController")&&(0,i.isObject)(e.TokenListController)){const t=e.TokenListController;if((0,i.hasProperty)(t,"tokensChainsCache")&&(0,i.isObject)(t.tokensChainsCache)&&n(t.tokensChainsCache))for(const e of Object.keys(t.tokensChainsCache))(0,i.isStrictHexString)(e)||delete t.tokensChainsCache[e]}if((0,i.hasProperty)(e,"TokensController")&&(0,i.isObject)(e.TokensController)){const t=e.TokensController;if((0,i.hasProperty)(t,"allTokens")&&(0,i.isObject)(t.allTokens)&&n(t.allTokens)){const{allTokens:e}=t;for(const r of Object.keys(e))(0,i.isStrictHexString)(r)||delete t.allTokens[r]}if((0,i.hasProperty)(t,"allIgnoredTokens")&&(0,i.isObject)(t.allIgnoredTokens)&&n(t.allIgnoredTokens)){const{allIgnoredTokens:e}=t;for(const r of Object.keys(e))(0,i.isStrictHexString)(r)||delete t.allIgnoredTokens[r]}if((0,i.hasProperty)(t,"allDetectedTokens")&&(0,i.isObject)(t.allDetectedTokens)&&n(t.allDetectedTokens)){const{allDetectedTokens:e}=t;for(const r of Object.keys(e))(0,i.isStrictHexString)(r)||delete t.allDetectedTokens[r]}e.TokensController=t}return e};var i=e("@metamask/utils");function n(e){return Object.keys(e).some((e=>(0,i.isStrictHexString)(e)))}}}},{package:"$root$",file:"app/scripts/migrations/077-supplements/077-supplement-for-088.ts"}],[2e3,{"./chunk-RKVNLW2C.js":2004,"@ethereumjs/util":438,"@metamask/ethjs-unit":1381,"@metamask/utils":2300,"bn.js":2980,buffer:3028,"eth-ens-namehash":3225,"fast-deep-equal":3356},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t){(function(){function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var n=e("./chunk-RKVNLW2C.js"),s=e("@ethereumjs/util"),a=e("@metamask/ethjs-unit"),o=e("@metamask/utils"),l=i(e("bn.js")),c=i(e("eth-ens-namehash")),u=i(e("fast-deep-equal")),d=new Error("timeout"),h=["__proto__","constructor","prototype"];function m(e){return e?new(0,l.default)(o.remove0x.call(void 0,e),16):new(0,l.default)(0)}async function p(e,t){const r=await fetch(e,t);if(!r.ok)throw new Error(`Fetch failed with status '${r.status}' for request '${String(e)}'`);return r}async function f(e,t){const r=await p(e,t);return await r.json()}r.PROTOTYPE_POLLUTION_BLOCKLIST=h,r.isSafeDynamicKey=function(e){return"string"==typeof e&&!h.some((t=>e===t))},r.isSafeChainId=function(e){if(!o.isHexString.call(void 0,e))return!1;const t=Number.parseInt(e,o.isStrictHexString.call(void 0,e)?16:10);return Number.isSafeInteger(t)&&t>0&&t<=n.MAX_SAFE_CHAIN_ID},r.BNToHex=function(e){return o.add0x.call(void 0,e.toString(16))},r.fractionBN=function(e,t,r){const i=new(0,l.default)(t),n=new(0,l.default)(r);return e.mul(i).div(n)},r.gweiDecToWEIBN=function(e){if(Number.isNaN(e))return new(0,l.default)(0);const t=e.toString().split("."),r=t[0]||"0";let i=t[1]||"";if(!i)return a.toWei.call(void 0,r,"gwei");if(i.length<=9)return a.toWei.call(void 0,`${r}.${i}`,"gwei");const n=i.slice(9)[0];i=i.slice(0,9);let s=a.toWei.call(void 0,`${r}.${i}`,"gwei");return Number(n)>=5&&(s=s.add(new(0,l.default)(1))),s},r.weiHexToGweiDec=function(e){const t=new(0,l.default)(o.remove0x.call(void 0,e),16);return a.fromWei.call(void 0,t,"gwei")},r.getBuyURL=function(e="1",t,r=5){switch(e){case"1":return`https://buy.coinbase.com/?code=9ec56d01-7e81-5017-930c-513daa27bb6a&amount=${r}&address=${t}&crypto_currency=ETH`;case"5":return"https://goerli-faucet.slock.it/";case"11155111":return"https://sepoliafaucet.net/";default:return}},r.hexToBN=m,r.hexToText=function(e){try{const r=o.remove0x.call(void 0,e);return t.from(r,"hex").toString("utf8")}catch(t){return e}},r.fromHex=function(e){return l.default.isBN(e)?e:new(0,l.default)(m(e).toString(10))},r.toHex=function(e){return"string"==typeof e&&o.isStrictHexString.call(void 0,e)?e:`0x${l.default.isBN(e)?e.toString(16):new(0,l.default)(e.toString(),10).toString(16)}`},r.safelyExecute=async function(e,t=!1){try{return await e()}catch(e){return void(t&&console.error(e))}},r.safelyExecuteWithTimeout=async function(e,t=!1,r=500){try{return await Promise.race([e(),new Promise(((e,t)=>setTimeout((()=>{t(d)}),r)))])}catch(e){return void(t&&console.error(e))}},r.toChecksumHexAddress=function(e){if("string"!=typeof e)return e;const t=o.add0x.call(void 0,e);return o.isHexString.call(void 0,t)?s.toChecksumAddress.call(void 0,t):t},r.isValidHexAddress=function(e,{allowNonPrefixed:t=!0}={}){const r=t?o.add0x.call(void 0,e):e;return!!o.isStrictHexString.call(void 0,r)&&s.isValidAddress.call(void 0,r)},r.isSmartContractCode=function(e){return!!e&&("0x"!==e&&"0x0"!==e)},r.successfulFetch=p,r.handleFetch=f,r.fetchWithErrorHandling=async function({url:e,options:t,timeout:r,errorCodesToCatch:i}){let n;try{n=r?Promise.race([await f(e,t),new Promise(((e,t)=>setTimeout((()=>{t(d)}),r)))]):await f(e,t)}catch(e){!function(e,t=[]){if(!e)return;if(!(e instanceof Error))throw e;if(!t.some((t=>e.message.includes(`Fetch failed with status '${t}'`)))&&!e.message.includes("Failed to fetch")&&e!==d)throw e;console.error(e)}(e,i)}return n},r.timeoutFetch=async function(e,t,r=500){return Promise.race([p(e,t),new Promise(((e,t)=>setTimeout((()=>{t(d)}),r)))])},r.normalizeEnsName=function(e){if("."===e)return e;if(e&&"string"==typeof e)try{const t=c.default.normalize(e.trim());if(t.match(/^(([\w\d-]+)\.)*[\w\d-]{7,}\.(eth|test)$/u))return t}catch(e){}return null},r.query=function(e,t,r=[]){return new Promise(((i,n)=>{const s=(e,t)=>{e?n(e):i(t)};t in e&&"function"==typeof e[t]?e[t](...r,s):e.sendAsync({method:t,params:r},s)}))},r.convertHexToDecimal=(e="0x0")=>o.isStrictHexString.call(void 0,e)?parseInt(e,16):Number(e)?Number(e):0,r.isPlainObject=function(e){return Boolean(e)&&"object"==typeof e&&!Array.isArray(e)},r.isNonEmptyArray=function(e){return Array.isArray(e)&&e.length>0},r.isValidJson=function(e){try{return u.default.call(void 0,e,JSON.parse(JSON.stringify(e)))}catch(e){return!1}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/snaps-controllers>@metamask/phishing-controller>@metamask/controller-utils",file:"node_modules/@metamask/snaps-controllers/node_modules/@metamask/controller-utils/dist/chunk-7C4YHS6A.js"}],[2001,{"@metamask/utils":2300},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i=e("@metamask/utils"),n=i.createProjectLogger.call(void 0,"controller-utils");r.createModuleLogger=i.createModuleLogger,r.projectLogger=n}}},{package:"@metamask/snaps-controllers>@metamask/phishing-controller>@metamask/controller-utils",file:"node_modules/@metamask/snaps-controllers/node_modules/@metamask/controller-utils/dist/chunk-DBJSLKNR.js"}],[2002,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i={mainnet:"mainnet",goerli:"goerli",sepolia:"sepolia","linea-goerli":"linea-goerli","linea-sepolia":"linea-sepolia","linea-mainnet":"linea-mainnet"},n={...i,rpc:"rpc"};var s=(e=>(e.Mainnet="mainnet",e.Goerli="goerli",e.Sepolia="sepolia",e.LineaGoerli="linea-goerli",e.LineaSepolia="linea-sepolia",e.LineaMainnet="linea-mainnet",e.Aurora="aurora",e))(s||{}),a={mainnet:"0x1",goerli:"0x5",sepolia:"0xaa36a7",aurora:"0x4e454152","linea-goerli":"0xe704","linea-sepolia":"0xe705","linea-mainnet":"0xe708"},o=(e=>(e.mainnet="ETH",e.goerli="GoerliETH",e.sepolia="SepoliaETH",e["linea-goerli"]="LineaETH",e["linea-sepolia"]="LineaETH",e["linea-mainnet"]="ETH",e.rpc="",e))(o||{});r.InfuraNetworkType=i,r.NetworkType=n,r.isNetworkType=function(e){return Object.values(n).includes(e)},r.isInfuraNetworkType=function(e){return Object.keys(i).includes(e)},r.BuiltInNetworkName=s,r.ChainId=a,r.NetworksTicker=o}}},{package:"@metamask/snaps-controllers>@metamask/phishing-controller>@metamask/controller-utils",file:"node_modules/@metamask/snaps-controllers/node_modules/@metamask/controller-utils/dist/chunk-LGGBBU6G.js"}],[2003,{"./chunk-DBJSLKNR.js":2001,"@metamask/utils":2300,"@spruceid/siwe-parser":2526,buffer:3028},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0});var i=e("./chunk-DBJSLKNR.js"),n=e("@metamask/utils"),s=e("@spruceid/siwe-parser"),a=i.createModuleLogger.call(void 0,i.projectLogger,"detect-siwe");function o(e){try{const i="string"!=typeof(r=e)?r:n.remove0x.call(void 0,r),s=t.from(i,"hex");return 32===s.length?e:s.toString("utf8")}catch(t){return a(t),e}var r}var l={"http:":"80","https:":"443"},c=(e,t)=>e.match(/^[^/:]*:\/\//u)?new URL(e):new URL(`${t}//${e}`);r.parseDomainParts=c,r.isValidSIWEOrigin=e=>{try{const{origin:t,siwe:r}=e;if(!t||!r?.parsedMessage?.domain)return!1;const i=new URL(t),n=c(r.parsedMessage.domain,i.protocol);return 0===n.hostname.localeCompare(i.hostname,void 0,{sensitivity:"accent"})&&(""!==n.port&&n.port!==i.port?""===i.port&&n.port===l[i.protocol]:""===n.username||n.username===i.username)}catch(e){return a(e),!1}},r.detectSIWE=e=>{try{const{data:t}=e,r=o(t);return{isSIWEMessage:!0,parsedMessage:new(0,s.ParsedMessage)(r)}}catch(e){return{isSIWEMessage:!1,parsedMessage:null}}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/snaps-controllers>@metamask/phishing-controller>@metamask/controller-utils",file:"node_modules/@metamask/snaps-controllers/node_modules/@metamask/controller-utils/dist/chunk-M6G3ISXG.js"}],[2004,{"./chunk-LGGBBU6G.js":2002},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i=e("./chunk-LGGBBU6G.js"),n={[i.NetworkType.goerli]:{chainId:i.ChainId.goerli,ticker:"GoerliETH",rpcPrefs:{blockExplorerUrl:`https://${i.NetworkType.goerli}.etherscan.io`}},[i.NetworkType.sepolia]:{chainId:i.ChainId.sepolia,ticker:"SepoliaETH",rpcPrefs:{blockExplorerUrl:`https://${i.NetworkType.sepolia}.etherscan.io`}},[i.NetworkType.mainnet]:{chainId:i.ChainId.mainnet,ticker:"ETH",rpcPrefs:{blockExplorerUrl:"https://etherscan.io"}},[i.NetworkType["linea-goerli"]]:{chainId:i.ChainId["linea-goerli"],ticker:"LineaETH",rpcPrefs:{blockExplorerUrl:"https://goerli.lineascan.build"}},[i.NetworkType["linea-sepolia"]]:{chainId:i.ChainId["linea-sepolia"],ticker:"LineaETH",rpcPrefs:{blockExplorerUrl:"https://sepolia.lineascan.build"}},[i.NetworkType["linea-mainnet"]]:{chainId:i.ChainId["linea-mainnet"],ticker:"ETH",rpcPrefs:{blockExplorerUrl:"https://lineascan.build"}},[i.NetworkType.rpc]:{chainId:void 0,blockExplorerUrl:void 0,ticker:void 0,rpcPrefs:void 0}},s=(e=>(e.AddEthereumChain="wallet_addEthereumChain",e.ConnectAccounts="connect_accounts",e.EthDecrypt="eth_decrypt",e.EthGetEncryptionPublicKey="eth_getEncryptionPublicKey",e.EthSignTypedData="eth_signTypedData",e.PersonalSign="personal_sign",e.ResultError="result_error",e.ResultSuccess="result_success",e.SnapDialogAlert="snap_dialog:alert",e.SnapDialogConfirmation="snap_dialog:confirmation",e.SnapDialogPrompt="snap_dialog:prompt",e.SwitchEthereumChain="wallet_switchEthereumChain",e.Transaction="transaction",e.Unlock="unlock",e.WalletConnect="wallet_connect",e.WalletRequestPermissions="wallet_requestPermissions",e.WatchAsset="wallet_watchAsset",e))(s||{}),a={[i.ChainId.goerli]:"goerli",[i.ChainId.sepolia]:"sepolia",[i.ChainId.mainnet]:"mainnet",[i.ChainId["linea-goerli"]]:"linea-goerli",[i.ChainId["linea-sepolia"]]:"linea-sepolia",[i.ChainId["linea-mainnet"]]:"linea-mainnet",[i.ChainId.aurora]:"aurora"};r.RPC="rpc",r.FALL_BACK_VS_CURRENCY="ETH",r.IPFS_DEFAULT_GATEWAY_URL="https://cloudflare-ipfs.com/ipfs/",r.GANACHE_CHAIN_ID="0x539",r.MAX_SAFE_CHAIN_ID=0xfffffffffffec,r.ERC721="ERC721",r.ERC1155="ERC1155",r.ERC20="ERC20",r.ERC721_INTERFACE_ID="0x80ac58cd",r.ERC721_METADATA_INTERFACE_ID="0x5b5e139f",r.ERC721_ENUMERABLE_INTERFACE_ID="0x780e9d63",r.ERC1155_INTERFACE_ID="0xd9b67a26",r.ERC1155_METADATA_URI_INTERFACE_ID="0x0e89341c",r.ERC1155_TOKEN_RECEIVER_INTERFACE_ID="0x4e2312e0",r.GWEI="gwei",r.ASSET_TYPES={NATIVE:"NATIVE",TOKEN:"TOKEN",NFT:"NFT",UNKNOWN:"UNKNOWN"},r.TESTNET_TICKER_SYMBOLS={GOERLI:"GoerliETH",SEPOLIA:"SepoliaETH",LINEA_GOERLI:"LineaETH",LINEA_SEPOLIA:"LineaETH"},r.BUILT_IN_NETWORKS=n,r.OPENSEA_PROXY_URL="https://proxy.api.cx.metamask.io/opensea/v1/api/v2",r.NFT_API_BASE_URL="https://nft.api.cx.metamask.io",r.NFT_API_VERSION="1",r.NFT_API_TIMEOUT=15e3,r.ORIGIN_METAMASK="metamask",r.ApprovalType=s,r.CHAIN_ID_TO_ETHERS_NETWORK_NAME_MAP=a}}},{package:"@metamask/snaps-controllers>@metamask/phishing-controller>@metamask/controller-utils",file:"node_modules/@metamask/snaps-controllers/node_modules/@metamask/controller-utils/dist/chunk-RKVNLW2C.js"}],[2005,{"./chunk-7C4YHS6A.js":2e3,"./chunk-DBJSLKNR.js":2001,"./chunk-LGGBBU6G.js":2002,"./chunk-M6G3ISXG.js":2003,"./chunk-RKVNLW2C.js":2004},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i=e("./chunk-M6G3ISXG.js");e("./chunk-DBJSLKNR.js");var n=e("./chunk-7C4YHS6A.js"),s=e("./chunk-RKVNLW2C.js"),a=e("./chunk-LGGBBU6G.js");r.ASSET_TYPES=s.ASSET_TYPES,r.ApprovalType=s.ApprovalType,r.BNToHex=n.BNToHex,r.BUILT_IN_NETWORKS=s.BUILT_IN_NETWORKS,r.BuiltInNetworkName=a.BuiltInNetworkName,r.CHAIN_ID_TO_ETHERS_NETWORK_NAME_MAP=s.CHAIN_ID_TO_ETHERS_NETWORK_NAME_MAP,r.ChainId=a.ChainId,r.ERC1155=s.ERC1155,r.ERC1155_INTERFACE_ID=s.ERC1155_INTERFACE_ID,r.ERC1155_METADATA_URI_INTERFACE_ID=s.ERC1155_METADATA_URI_INTERFACE_ID,r.ERC1155_TOKEN_RECEIVER_INTERFACE_ID=s.ERC1155_TOKEN_RECEIVER_INTERFACE_ID,r.ERC20=s.ERC20,r.ERC721=s.ERC721,r.ERC721_ENUMERABLE_INTERFACE_ID=s.ERC721_ENUMERABLE_INTERFACE_ID,r.ERC721_INTERFACE_ID=s.ERC721_INTERFACE_ID,r.ERC721_METADATA_INTERFACE_ID=s.ERC721_METADATA_INTERFACE_ID,r.FALL_BACK_VS_CURRENCY=s.FALL_BACK_VS_CURRENCY,r.GANACHE_CHAIN_ID=s.GANACHE_CHAIN_ID,r.GWEI=s.GWEI,r.IPFS_DEFAULT_GATEWAY_URL=s.IPFS_DEFAULT_GATEWAY_URL,r.InfuraNetworkType=a.InfuraNetworkType,r.MAX_SAFE_CHAIN_ID=s.MAX_SAFE_CHAIN_ID,r.NFT_API_BASE_URL=s.NFT_API_BASE_URL,r.NFT_API_TIMEOUT=s.NFT_API_TIMEOUT,r.NFT_API_VERSION=s.NFT_API_VERSION,r.NetworkType=a.NetworkType,r.NetworksTicker=a.NetworksTicker,r.OPENSEA_PROXY_URL=s.OPENSEA_PROXY_URL,r.ORIGIN_METAMASK=s.ORIGIN_METAMASK,r.RPC=s.RPC,r.TESTNET_TICKER_SYMBOLS=s.TESTNET_TICKER_SYMBOLS,r.convertHexToDecimal=n.convertHexToDecimal,r.detectSIWE=i.detectSIWE,r.fetchWithErrorHandling=n.fetchWithErrorHandling,r.fractionBN=n.fractionBN,r.fromHex=n.fromHex,r.getBuyURL=n.getBuyURL,r.gweiDecToWEIBN=n.gweiDecToWEIBN,r.handleFetch=n.handleFetch,r.hexToBN=n.hexToBN,r.hexToText=n.hexToText,r.isInfuraNetworkType=a.isInfuraNetworkType,r.isNetworkType=a.isNetworkType,r.isNonEmptyArray=n.isNonEmptyArray,r.isPlainObject=n.isPlainObject,r.isSafeChainId=n.isSafeChainId,r.isSafeDynamicKey=n.isSafeDynamicKey,r.isSmartContractCode=n.isSmartContractCode,r.isValidHexAddress=n.isValidHexAddress,r.isValidJson=n.isValidJson,r.isValidSIWEOrigin=i.isValidSIWEOrigin,r.normalizeEnsName=n.normalizeEnsName,r.parseDomainParts=i.parseDomainParts,r.query=n.query,r.safelyExecute=n.safelyExecute,r.safelyExecuteWithTimeout=n.safelyExecuteWithTimeout,r.successfulFetch=n.successfulFetch,r.timeoutFetch=n.timeoutFetch,r.toChecksumHexAddress=n.toChecksumHexAddress,r.toHex=n.toHex,r.weiHexToGweiDec=n.weiHexToGweiDec}}},{package:"@metamask/snaps-controllers>@metamask/phishing-controller>@metamask/controller-utils",file:"node_modules/@metamask/snaps-controllers/node_modules/@metamask/controller-utils/dist/index.js"}],[2006,{"./chunk-Z4BLTVTB.js":2011,"@metamask/rpc-errors":1717,"@metamask/safe-event-emitter":1718,"@metamask/utils":2300},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i,n,s,a,o,l,c,u,d,h,m,p,f,v,g,_,k,y,w,T,b=e("./chunk-Z4BLTVTB.js"),E=e("@metamask/rpc-errors"),S=e("@metamask/safe-event-emitter"),P=(i=S)&&i.__esModule?i:{default:i},A=e("@metamask/utils"),C=class e extends P.default{constructor({notificationHandler:e}={}){super(),b.__privateAdd.call(void 0,this,o),b.__privateAdd.call(void 0,this,c),b.__privateAdd.call(void 0,this,d),b.__privateAdd.call(void 0,this,n,!1),b.__privateAdd.call(void 0,this,s,void 0),b.__privateAdd.call(void 0,this,a,void 0),b.__privateSet.call(void 0,this,s,[]),b.__privateSet.call(void 0,this,a,e)}destroy(){b.__privateGet.call(void 0,this,s).forEach((e=>{"destroy"in e&&"function"==typeof e.destroy&&e.destroy()})),b.__privateSet.call(void 0,this,s,[]),b.__privateSet.call(void 0,this,n,!0)}push(e){b.__privateMethod.call(void 0,this,o,l).call(this),b.__privateGet.call(void 0,this,s).push(e)}handle(e,t){if(b.__privateMethod.call(void 0,this,o,l).call(this),t&&"function"!=typeof t)throw new Error('"callback" must be a function if provided.');return Array.isArray(e)?t?b.__privateMethod.call(void 0,this,c,u).call(this,e,t):b.__privateMethod.call(void 0,this,c,u).call(this,e):t?b.__privateMethod.call(void 0,this,d,h).call(this,e,t):this._promiseHandle(e)}asMiddleware(){return b.__privateMethod.call(void 0,this,o,l).call(this),async(t,r,i,n)=>{var a,o;try{const[l,c,u]=await b.__privateMethod.call(void 0,a=e,f,v).call(a,t,r,b.__privateGet.call(void 0,this,s));return c?(await b.__privateMethod.call(void 0,o=e,k,y).call(o,u),n(l)):i((async t=>{var r;try{await b.__privateMethod.call(void 0,r=e,k,y).call(r,u)}catch(e){return t(e)}return t()}))}catch(e){return n(e)}}}async _promiseHandle(e){return new Promise(((t,r)=>{b.__privateMethod.call(void 0,this,d,h).call(this,e,((e,i)=>{e&&void 0===i?r(e):t(i)})).catch(r)}))}};n=new WeakMap,s=new WeakMap,a=new WeakMap,o=new WeakSet,l=function(){if(b.__privateGet.call(void 0,this,n))throw new Error("This engine is destroyed and can no longer be used.")},c=new WeakSet,u=async function(e,t){try{if(0===e.length){const e=[{id:null,jsonrpc:"2.0",error:new(0,E.JsonRpcError)(E.errorCodes.rpc.invalidRequest,"Request batch must contain plain objects. Received an empty array")}];return t?t(null,e):e}const r=(await Promise.all(e.map(this._promiseHandle.bind(this)))).filter((e=>void 0!==e));return t?t(null,r):r}catch(e){if(t)return t(e);throw e}},d=new WeakSet,h=async function(e,t){var r;if(!e||Array.isArray(e)||"object"!=typeof e){const r=new(0,E.JsonRpcError)(E.errorCodes.rpc.invalidRequest,"Requests must be plain objects. Received: "+typeof e,{request:e});return t(r,{id:null,jsonrpc:"2.0",error:r})}if("string"!=typeof e.method){const r=new(0,E.JsonRpcError)(E.errorCodes.rpc.invalidRequest,"Must specify a string method. Received: "+typeof e.method,{request:e});return b.__privateGet.call(void 0,this,a)&&!A.isJsonRpcRequest.call(void 0,e)?t(null):t(r,{id:e.id??null,jsonrpc:"2.0",error:r})}if(b.__privateGet.call(void 0,this,a)&&A.isJsonRpcNotification.call(void 0,e)&&!A.isJsonRpcRequest.call(void 0,e)){try{await b.__privateGet.call(void 0,this,a).call(this,e)}catch(e){return t(e)}return t(null)}let i=null;const n={...e},o={id:n.id,jsonrpc:n.jsonrpc};try{await b.__privateMethod.call(void 0,r=C,m,p).call(r,n,o,b.__privateGet.call(void 0,this,s))}catch(e){i=e}return i&&(delete o.result,o.error||(o.error=E.serializeError.call(void 0,i))),t(i,o)},m=new WeakSet,p=async function(e,t,r){var i,n,s;const[a,o,l]=await b.__privateMethod.call(void 0,i=C,f,v).call(i,e,t,r);if(b.__privateMethod.call(void 0,n=C,w,T).call(n,e,t,o),await b.__privateMethod.call(void 0,s=C,k,y).call(s,l),a)throw a},f=new WeakSet,v=async function(e,t,r){var i;const n=[];let s=null,a=!1;for(const o of r)if([s,a]=await b.__privateMethod.call(void 0,i=C,g,_).call(i,e,t,o,n),a)break;return[s,a,n.reverse()]},g=new WeakSet,_=async function(e,t,r,i){return new Promise((n=>{const s=e=>{const r=e||t.error;r&&(t.error=E.serializeError.call(void 0,r)),n([r,!0])},a=r=>{t.error?s(t.error):(r&&("function"!=typeof r&&s(new(0,E.JsonRpcError)(E.errorCodes.rpc.internal,`JsonRpcEngine: "next" return handlers must be functions. Received "${typeof r}" for request:\n${j(e)}`,{request:e})),i.push(r)),n([null,!1]))};try{r(e,t,a,s)}catch(e){s(e)}}))},k=new WeakSet,y=async function(e){for(const t of e)await new Promise(((e,r)=>{t((t=>t?r(t):e()))}))},w=new WeakSet,T=function(e,t,r){if(!A.hasProperty.call(void 0,t,"result")&&!A.hasProperty.call(void 0,t,"error"))throw new(0,E.JsonRpcError)(E.errorCodes.rpc.internal,`JsonRpcEngine: Response has no error or result for request:\n${j(e)}`,{request:e});if(!r)throw new(0,E.JsonRpcError)(E.errorCodes.rpc.internal,`JsonRpcEngine: Nothing ended request:\n${j(e)}`,{request:e})},b.__privateAdd.call(void 0,C,m),b.__privateAdd.call(void 0,C,f),b.__privateAdd.call(void 0,C,g),b.__privateAdd.call(void 0,C,k),b.__privateAdd.call(void 0,C,w);var I=C;function j(e){return JSON.stringify(e,null,2)}r.JsonRpcEngine=I}}},{package:"@metamask/snaps-controllers>@metamask/json-rpc-engine",file:"node_modules/@metamask/snaps-controllers/node_modules/@metamask/json-rpc-engine/dist/chunk-2LXAFMJD.js"}],[2007,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.createScaffoldMiddleware=function(e){return(t,r,i,n)=>{const s=e[t.method];return void 0===s?i():"function"==typeof s?s(t,r,i,n):(r.result=s,n())}}}}},{package:"@metamask/snaps-controllers>@metamask/json-rpc-engine",file:"node_modules/@metamask/snaps-controllers/node_modules/@metamask/json-rpc-engine/dist/chunk-3AC2MIND.js"}],[2008,{"./chunk-XDGWQHNY.js":2010},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i=e("./chunk-XDGWQHNY.js");r.createIdRemapMiddleware=function(){return(e,t,r,n)=>{const s=e.id,a=i.getUniqueId.call(void 0);e.id=a,t.id=a,r((r=>{e.id=s,t.id=s,r()}))}}}}},{package:"@metamask/snaps-controllers>@metamask/json-rpc-engine",file:"node_modules/@metamask/snaps-controllers/node_modules/@metamask/json-rpc-engine/dist/chunk-PBQXMZM5.js"}],[2009,{"./chunk-2LXAFMJD.js":2006},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i=e("./chunk-2LXAFMJD.js");r.mergeMiddleware=function(e){const t=new(0,i.JsonRpcEngine);return e.forEach((e=>t.push(e))),t.asMiddleware()}}}},{package:"@metamask/snaps-controllers>@metamask/json-rpc-engine",file:"node_modules/@metamask/snaps-controllers/node_modules/@metamask/json-rpc-engine/dist/chunk-VK4MHWJV.js"}],[201,{"./077-supplements/077-supplement-for-082":197,"./077-supplements/077-supplement-for-084":198,"./077-supplements/077-supplement-for-086":199,"./077-supplements/077-supplement-for-088":200,"@metamask/utils":2300,lodash:3836,loglevel:3842},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=e("lodash"),n=u(e("loglevel")),s=e("@metamask/utils"),a=u(e("./077-supplements/077-supplement-for-082")),o=u(e("./077-supplements/077-supplement-for-084")),l=u(e("./077-supplements/077-supplement-for-086")),c=u(e("./077-supplements/077-supplement-for-088"));function u(e){return e&&e.__esModule?e:{default:e}}r.default={version:77,async migrate(e){const t=(0,i.cloneDeep)(e);t.meta.version=77;let r=function(e){if(!(0,s.hasProperty)(e,"TokenListController"))return n.default.warn("Skipping migration, TokenListController state is missing"),e;var t,r;if(!(0,s.isObject)(e.TokenListController))return null===(t=global.sentry)||void 0===t||null===(r=t.captureException)||void 0===r||r.call(t,new Error("typeof state.TokenListController is "+typeof e.TokenListController)),e;if(!(0,s.hasProperty)(e.TokenListController,"tokensChainsCache"))return n.default.warn("Skipping migration, TokenListController.tokensChainsCache state is missing"),e;const{TokenListController:i}=e,{tokensChainsCache:a}=i;let o,l;for(const e in a){var c,u;if(o=a[e].data||{},l={},Array.isArray(o))for(const e of o)l[e.address]=e;else if((null===(c=Object.keys(o)[0])||void 0===c?void 0:c.toLowerCase())!==(null===(u=o[Object.keys(o)[0]])||void 0===u||null===(u=u.address)||void 0===u?void 0:u.toLowerCase()))for(const e in o)l[o[e].address]=o[e];a[e].data=Object.keys(l).length>0?l:o}return i.tokensChainsCache=a,{...e,TokenListController:{...i}}}(t.data);return r=(0,a.default)(r),r=(0,o.default)(r),r=(0,l.default)(r),r=(0,c.default)(r),t.data=r,t}}}}},{package:"$root$",file:"app/scripts/migrations/077.js"}],[2010,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i=4294967295,n=Math.floor(Math.random()*i);r.getUniqueId=function(){return n=(n+1)%i}}}},{package:"@metamask/snaps-controllers>@metamask/json-rpc-engine",file:"node_modules/@metamask/snaps-controllers/node_modules/@metamask/json-rpc-engine/dist/chunk-XDGWQHNY.js"}],[2011,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i=(e,t,r)=>{if(!t.has(e))throw TypeError("Cannot "+r)};r.__privateGet=(e,t,r)=>(i(e,t,"read from private field"),r?r.call(e):t.get(e)),r.__privateAdd=(e,t,r)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,r)},r.__privateSet=(e,t,r,n)=>(i(e,t,"write to private field"),n?n.call(e,r):t.set(e,r),r),r.__privateMethod=(e,t,r)=>(i(e,t,"access private method"),r)}}},{package:"@metamask/snaps-controllers>@metamask/json-rpc-engine",file:"node_modules/@metamask/snaps-controllers/node_modules/@metamask/json-rpc-engine/dist/chunk-Z4BLTVTB.js"}],[2012,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.createAsyncMiddleware=function(e){return async(t,r,i,n)=>{let s;const a=new Promise((e=>{s=e}));let o=null,l=!1;const c=async()=>(l=!0,i((e=>{o=e,s()})),a);try{await e(t,r,c),l?(await a,o(null)):n(null)}catch(e){o?o(e):n(e)}}}}}},{package:"@metamask/snaps-controllers>@metamask/json-rpc-engine",file:"node_modules/@metamask/snaps-controllers/node_modules/@metamask/json-rpc-engine/dist/chunk-ZYXL5TCS.js"}],[2013,{"./chunk-2LXAFMJD.js":2006,"./chunk-3AC2MIND.js":2007,"./chunk-PBQXMZM5.js":2008,"./chunk-VK4MHWJV.js":2009,"./chunk-XDGWQHNY.js":2010,"./chunk-Z4BLTVTB.js":2011,"./chunk-ZYXL5TCS.js":2012},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i=e("./chunk-ZYXL5TCS.js"),n=e("./chunk-3AC2MIND.js"),s=e("./chunk-PBQXMZM5.js"),a=e("./chunk-XDGWQHNY.js"),o=e("./chunk-VK4MHWJV.js"),l=e("./chunk-2LXAFMJD.js");e("./chunk-Z4BLTVTB.js"),r.JsonRpcEngine=l.JsonRpcEngine,r.createAsyncMiddleware=i.createAsyncMiddleware,r.createIdRemapMiddleware=s.createIdRemapMiddleware,r.createScaffoldMiddleware=n.createScaffoldMiddleware,r.getUniqueId=a.getUniqueId,r.mergeMiddleware=o.mergeMiddleware}}},{package:"@metamask/snaps-controllers>@metamask/json-rpc-engine",file:"node_modules/@metamask/snaps-controllers/node_modules/@metamask/json-rpc-engine/dist/index.js"}],[2014,{"@metamask/safe-event-emitter":1718,"readable-stream":4258},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i,n=e("@metamask/safe-event-emitter"),s=(i=n)&&i.__esModule?i:{default:i},a=e("readable-stream");r.createStreamMiddleware=function(e={}){const t={},r=new(0,a.Duplex)({objectMode:!0,read:()=>{},write:function(r,s,a){let o=null;try{!r.id?function(r){e?.retryOnMessage&&r.method===e.retryOnMessage&&Object.values(t).forEach((({req:e,retryCount:r=0})=>{if(!e.id)return;if(r>=3)throw new Error(`StreamMiddleware - Retry limit exceeded for request id "${e.id}"`);const i=t[e.id];i&&(i.retryCount=r+1),n(e)}));i.emit("notification",r)}(r):function(e){const{id:r}=e;if(null===r)return;const i=t[r];if(!i)return void console.warn(`StreamMiddleware - Unknown response id "${r}"`);delete t[r],Object.assign(i.res,e),setTimeout(i.end)}(r)}catch(e){o=e}a(o)}}),i=new(0,s.default);return{events:i,middleware:(e,r,i,s)=>{t[e.id]={req:e,res:r,next:i,end:s},n(e)},stream:r};function n(e){r.push(e)}}}}},{package:"@metamask/snaps-controllers>@metamask/json-rpc-middleware-stream",file:"node_modules/@metamask/snaps-controllers/node_modules/@metamask/json-rpc-middleware-stream/dist/chunk-3SFZPJR3.js"}],[2015,{"readable-stream":4258},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i=e("readable-stream");r.createEngineStream=function(e){if(!e?.engine)throw new Error("Missing engine parameter!");const{engine:t}=e,r=new(0,i.Duplex)({objectMode:!0,read:()=>{},write:function(e,i,n){t.handle(e,((e,t)=>{r.push(t)})),n()}});return t.on&&t.on("notification",(e=>{r.push(e)})),r}}}},{package:"@metamask/snaps-controllers>@metamask/json-rpc-middleware-stream",file:"node_modules/@metamask/snaps-controllers/node_modules/@metamask/json-rpc-middleware-stream/dist/chunk-IDTAZSDC.js"}],[2016,{"./chunk-3SFZPJR3.js":2014,"./chunk-IDTAZSDC.js":2015},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i=e("./chunk-IDTAZSDC.js"),n=e("./chunk-3SFZPJR3.js");r.createEngineStream=i.createEngineStream,r.createStreamMiddleware=n.createStreamMiddleware}}},{package:"@metamask/snaps-controllers>@metamask/json-rpc-middleware-stream",file:"node_modules/@metamask/snaps-controllers/node_modules/@metamask/json-rpc-middleware-stream/dist/index.js"}],[2017,{"@metamask/rpc-errors":1717},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i=e("@metamask/rpc-errors");var n=class extends Error{constructor(e){super(`Invalid subject identifier: "${"string"==typeof e?e:typeof e}"`)}},s=class extends Error{constructor(e){super(`Unrecognized subject: "${e}" has no permissions.`)}},a=class extends Error{constructor(e){super(`Caveat value merger does not exist for type: "${e}"`)}},o=class extends Error{constructor(e,t,r){super(`Invalid merged permissions for subject "${e}":\n${t.message}`),this.cause=t,this.data={diff:r}}},l=class extends Error{constructor(e,t,r){super(`Invalid approved permission for origin "${e}" and target "${t}".`),this.data={origin:e,target:t,approvedPermission:r}}},c=class extends Error{constructor(e,t){super(`Subject "${e}" has no permission for "${t}".`)}},u=class extends Error{constructor(e,t){super(`Subject "${t}" has no permission for "${e}".`),t&&(this.data={origin:t})}},d=class extends Error{constructor(e,t,r){super(`Unrecognized caveat type: "${e}"`),this.data={caveatType:e},void 0!==t&&(this.data.origin=t),void 0!==r&&(this.data.target=r)}},h=class extends Error{constructor(e,t,r){super(`The "caveats" property of permission for "${t}" of subject "${e}" is invalid. It must be a non-empty array if specified.`),this.data={origin:e,target:t,caveatsProperty:r}}},m=class extends Error{constructor(e,t,r){super(`Permission for "${t}" of subject "${e}" has no caveat of type "${r}".`)}},p=class extends Error{constructor(e,t,r){super(`Permission for "${t}" of subject "${e}" already has a caveat of type "${r}".`)}},f=class extends i.JsonRpcError{constructor(e,t,r){super(i.errorCodes.rpc.invalidParams,"Invalid caveat. Caveats must be plain objects.",{receivedCaveat:e}),this.data={origin:t,target:r}}},v=class extends Error{constructor(e,t,r){super(`Caveat types must be strings. Received: "${typeof e.type}"`),this.data={caveat:e,origin:t,target:r}}},g=class extends Error{constructor(e,t,r){super('Caveat is missing "value" field.'),this.data={caveat:e,origin:t,target:r}}},_=class extends Error{constructor(e,t,r){super('Caveat "value" is invalid JSON.'),this.data={caveat:e,origin:t,target:r}}},k=class extends Error{constructor(e,t,r){super(`Caveat has unexpected number of fields: "${Object.keys(e).length}"`),this.data={caveat:e,origin:t,target:r}}},y=class extends Error{constructor(e,t,r){super(`Permissions for target "${r}" may not have caveats of type "${e}".`),this.data={caveatType:e,origin:t,target:r}}},w=class extends Error{constructor(e,t,r){super(`Permissions for target "${r}" contains multiple caveats of type "${e}".`),this.data={caveatType:e,origin:t,target:r}}},T=class extends Error{constructor(e,t){super(`Cannot merge caveats of different types: "${e}" and "${t}".`),this.data={leftCaveatType:e,rightCaveatType:t}}},b=class extends Error{constructor(e,t){super(`Caveat specification uses a mismatched type. Expected caveats for ${t}`),this.data={caveatSpec:e,permissionType:t}}},E=class extends Error{constructor(e){super(`Permissions request with id "${e}" not found.`)}};r.unauthorized=function(e){return i.providerErrors.unauthorized({message:"Unauthorized to perform action. Try requesting the required permission(s) first. For more information, see: https://docs.metamask.io/guide/rpc-api.html#permissions",data:e.data})},r.methodNotFound=function(e,t){const r={message:`The method "${e}" does not exist / is not available.`};return void 0!==t&&(r.data=t),i.rpcErrors.methodNotFound(r)},r.invalidParams=function(e){return i.rpcErrors.invalidParams({data:e.data,message:e.message})},r.userRejectedRequest=function(e){return i.providerErrors.userRejectedRequest({data:e})},r.internalError=function(e,t){return i.rpcErrors.internal({message:e,data:t})},r.InvalidSubjectIdentifierError=n,r.UnrecognizedSubjectError=s,r.CaveatMergerDoesNotExistError=a,r.InvalidMergedPermissionsError=o,r.InvalidApprovedPermissionError=l,r.PermissionDoesNotExistError=c,r.EndowmentPermissionDoesNotExistError=u,r.UnrecognizedCaveatTypeError=d,r.InvalidCaveatsPropertyError=h,r.CaveatDoesNotExistError=m,r.CaveatAlreadyExistsError=p,r.InvalidCaveatError=f,r.InvalidCaveatTypeError=v,r.CaveatMissingValueError=g,r.CaveatInvalidJsonError=_,r.InvalidCaveatFieldsError=k,r.ForbiddenCaveatError=y,r.DuplicateCaveatError=w,r.CaveatMergeTypeMismatchError=T,r.CaveatSpecificationMismatchError=b,r.PermissionsRequestNotFoundError=E}}},{package:"@metamask/snaps-controllers>@metamask/permission-controller",file:"node_modules/@metamask/snaps-controllers/node_modules/@metamask/permission-controller/dist/chunk-3X6WO7UG.js"}],[2018,{"@metamask/base-controller":1999},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i=e("@metamask/base-controller"),n=(e=>(e.Extension="extension",e.Internal="internal",e.Unknown="unknown",e.Website="website",e.Snap="snap",e))(n||{}),s={subjectMetadata:{persist:!0,anonymous:!1}},a={subjectMetadata:{}},o=class e extends i.BaseController{constructor({messenger:t,subjectCacheLimit:r,state:i={}}){if(!Number.isInteger(r)||r<1)throw new Error(`subjectCacheLimit must be a positive integer. Received: "${r}"`);const n=e=>t.call("PermissionController:hasPermissions",e);super({name:"SubjectMetadataController",metadata:s,messenger:t,state:{...e.getTrimmedState(i,n)}}),this.subjectHasPermissions=n,this.subjectCacheLimit=r,this.subjectsWithoutPermissionsEncounteredSinceStartup=new Set,this.messagingSystem.registerActionHandler(`${this.name}:getSubjectMetadata`,this.getSubjectMetadata.bind(this)),this.messagingSystem.registerActionHandler(`${this.name}:addSubjectMetadata`,this.addSubjectMetadata.bind(this))}clearState(){this.subjectsWithoutPermissionsEncounteredSinceStartup.clear(),this.update((e=>({...a})))}addSubjectMetadata(e){const{origin:t}=e,r={...e,extensionId:e.extensionId||null,iconUrl:e.iconUrl||null,name:e.name||null,subjectType:e.subjectType||null};let i=null;if(this.subjectsWithoutPermissionsEncounteredSinceStartup.size>=this.subjectCacheLimit){const e=this.subjectsWithoutPermissionsEncounteredSinceStartup.values().next().value;this.subjectsWithoutPermissionsEncounteredSinceStartup.delete(e),this.subjectHasPermissions(e)||(i=e)}this.subjectsWithoutPermissionsEncounteredSinceStartup.add(t),this.update((e=>{e.subjectMetadata[t]=r,"string"==typeof i&&delete e.subjectMetadata[i]}))}getSubjectMetadata(e){return this.state.subjectMetadata[e]}trimMetadataState(){this.update((t=>e.getTrimmedState(t,this.subjectHasPermissions)))}static getTrimmedState(e,t){const{subjectMetadata:r={}}=e;return{subjectMetadata:Object.keys(r).reduce(((e,i)=>(t(i)&&(e[i]=r[i]),e)),{})}}};r.SubjectType=n,r.SubjectMetadataController=o}}},{package:"@metamask/snaps-controllers>@metamask/permission-controller",file:"node_modules/@metamask/snaps-controllers/node_modules/@metamask/permission-controller/dist/chunk-C73QV75D.js"}],[2019,{"./chunk-GHOOCGN3.js":2020,"./chunk-HRDKMOYS.js":2021,"./chunk-XM622CMP.js":2026,"./chunk-Z2XKIXLS.js":2027},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i=e("./chunk-HRDKMOYS.js"),n=e("./chunk-XM622CMP.js"),s=e("./chunk-GHOOCGN3.js"),a={};e("./chunk-Z2XKIXLS.js").__export.call(void 0,a,{handlers:()=>o});var o=[n.requestPermissionsHandler,i.getPermissionsHandler,s.revokePermissionsHandler];r.handlers=o,r.rpc_methods_exports=a}}},{package:"@metamask/snaps-controllers>@metamask/permission-controller",file:"node_modules/@metamask/snaps-controllers/node_modules/@metamask/permission-controller/dist/chunk-DV74ZDGD.js"}],[202,{"@metamask/utils":2300,lodash:3836},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.migrate=async function(e){const t=(0,i.cloneDeep)(e);return t.meta.version=s,t.data=function(e){if(!(0,n.hasProperty)(e,"PhishingController")||!(0,n.isObject)(e.PhishingController))return e;const{PhishingController:t}=e;return delete t.phishing,delete t.lastFetched,e}(t.data),t},r.version=void 0;var i=e("lodash"),n=e("@metamask/utils");const s=r.version=78}}},{package:"$root$",file:"app/scripts/migrations/078.ts"}],[2020,{"./chunk-3X6WO7UG.js":2017,"@metamask/utils":2300},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i=e("./chunk-3X6WO7UG.js"),n=e("@metamask/utils"),s={methodNames:["wallet_revokePermissions"],implementation:async function(e,t,r,s,{revokePermissionsForOrigin:a}){const{params:o}=e,l=o?.[0];if(!l)return s(i.invalidParams.call(void 0,{data:{request:e}}));const c=Object.keys(l);if(!n.isNonEmptyArray.call(void 0,c))return s(i.invalidParams.call(void 0,{data:{request:e}}));return a(c),t.result=null,s()},hookNames:{revokePermissionsForOrigin:!0}};r.revokePermissionsHandler=s}}},{package:"@metamask/snaps-controllers>@metamask/permission-controller",file:"node_modules/@metamask/snaps-controllers/node_modules/@metamask/permission-controller/dist/chunk-GHOOCGN3.js"}],[2021,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i={methodNames:["wallet_getPermissions"],implementation:async function(e,t,r,i,{getPermissionsForOrigin:n}){return t.result=Object.values(n()||{}),i()},hookNames:{getPermissionsForOrigin:!0}};r.getPermissionsHandler=i}}},{package:"@metamask/snaps-controllers>@metamask/permission-controller",file:"node_modules/@metamask/snaps-controllers/node_modules/@metamask/permission-controller/dist/chunk-HRDKMOYS.js"}],[2022,{"./chunk-3X6WO7UG.js":2017,"./chunk-PTE4672I.js":2023,"./chunk-RKDXFKNN.js":2024,"./chunk-VM4LI55W.js":2025,"./chunk-Z2XKIXLS.js":2027,"./chunk-ZH4MLSXX.js":2028,"@metamask/base-controller":1999,"@metamask/controller-utils":2005,"@metamask/rpc-errors":1717,"@metamask/utils":2300,"deep-freeze-strict":3173,immer:3640,nanoid:2031},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i,n=e("./chunk-RKDXFKNN.js"),s=e("./chunk-ZH4MLSXX.js"),a=e("./chunk-VM4LI55W.js"),o=e("./chunk-3X6WO7UG.js"),l=e("./chunk-PTE4672I.js"),c=e("./chunk-Z2XKIXLS.js"),u=e("@metamask/base-controller"),d=e("@metamask/controller-utils"),h=e("@metamask/rpc-errors"),m=e("@metamask/utils"),p=e("deep-freeze-strict"),f=(i=p)&&i.__esModule?i:{default:i},v=e("immer"),g=e("nanoid"),_="PermissionController";var k,y,w,T,b,E,S,P,A,C,I,j,x=(e=>(e[e.noop=0]="noop",e[e.updateValue=1]="updateValue",e[e.deleteCaveat=2]="deleteCaveat",e[e.revokePermission=3]="revokePermission",e))(x||{}),M=class extends u.BaseController{constructor(e){const{caveatSpecifications:t,permissionSpecifications:r,unrestrictedMethods:i,messenger:n,state:s={}}=e;super({name:_,metadata:{subjects:{anonymous:!0,persist:!0}},messenger:n,state:{subjects:{},...s}}),c.__privateAdd.call(void 0,this,k),c.__privateAdd.call(void 0,this,w),c.__privateAdd.call(void 0,this,b),c.__privateAdd.call(void 0,this,S),c.__privateAdd.call(void 0,this,A),c.__privateAdd.call(void 0,this,I),this._unrestrictedMethods=new Set(i),this._caveatSpecifications=f.default.call(void 0,{...t}),this.validatePermissionSpecifications(r,this._caveatSpecifications),this._permissionSpecifications=f.default.call(void 0,{...r}),this.registerMessageHandlers(),this.createPermissionMiddleware=a.getPermissionMiddlewareFactory.call(void 0,{executeRestrictedMethod:this._executeRestrictedMethod.bind(this),getRestrictedMethod:this.getRestrictedMethod.bind(this),isUnrestrictedMethod:this.unrestrictedMethods.has.bind(this.unrestrictedMethods)})}get unrestrictedMethods(){return this._unrestrictedMethods}getPermissionSpecification(e){return this._permissionSpecifications[e]}getCaveatSpecification(e){return this._caveatSpecifications[e]}validatePermissionSpecifications(e,t){Object.entries(e).forEach((([e,{permissionType:r,targetName:i,allowedCaveats:a}])=>{if(!r||!m.hasProperty.call(void 0,s.PermissionType,r))throw new Error(`Invalid permission type: "${r}"`);if(!e)throw new Error(`Invalid permission target name: "${e}"`);if(e!==i)throw new Error(`Invalid permission specification: target name "${e}" must match specification.targetName value "${i}".`);a&&a.forEach((e=>{if(!m.hasProperty.call(void 0,t,e))throw new(0,o.UnrecognizedCaveatTypeError)(e);const i=t[e],s=n.isRestrictedMethodCaveatSpecification.call(void 0,i);if("RestrictedMethod"===r&&!s||"Endowment"===r&&s)throw new(0,o.CaveatSpecificationMismatchError)(i,r)}))}))}registerMessageHandlers(){this.messagingSystem.registerActionHandler(`${_}:clearPermissions`,(()=>this.clearState())),this.messagingSystem.registerActionHandler(`${_}:getEndowments`,((e,t,r)=>this.getEndowments(e,t,r))),this.messagingSystem.registerActionHandler(`${_}:getSubjectNames`,(()=>this.getSubjectNames())),this.messagingSystem.registerActionHandler(`${_}:getPermissions`,(e=>this.getPermissions(e))),this.messagingSystem.registerActionHandler(`${_}:hasPermission`,((e,t)=>this.hasPermission(e,t))),this.messagingSystem.registerActionHandler(`${_}:hasPermissions`,(e=>this.hasPermissions(e))),this.messagingSystem.registerActionHandler(`${_}:grantPermissions`,this.grantPermissions.bind(this)),this.messagingSystem.registerActionHandler(`${_}:grantPermissionsIncremental`,this.grantPermissionsIncremental.bind(this)),this.messagingSystem.registerActionHandler(`${_}:requestPermissions`,((e,t)=>this.requestPermissions(e,t))),this.messagingSystem.registerActionHandler(`${_}:requestPermissionsIncremental`,((e,t)=>this.requestPermissionsIncremental(e,t))),this.messagingSystem.registerActionHandler(`${_}:revokeAllPermissions`,(e=>this.revokeAllPermissions(e))),this.messagingSystem.registerActionHandler(`${_}:revokePermissionForAllSubjects`,(e=>this.revokePermissionForAllSubjects(e))),this.messagingSystem.registerActionHandler(`${_}:revokePermissions`,this.revokePermissions.bind(this)),this.messagingSystem.registerActionHandler(`${_}:updateCaveat`,((e,t,r,i)=>{this.updateCaveat(e,t,r,i)}))}clearState(){this.update((e=>({subjects:{}})))}getTypedPermissionSpecification(e,t,r){const i="RestrictedMethod"===e?o.methodNotFound.call(void 0,t,r?{origin:r}:void 0):new(0,o.EndowmentPermissionDoesNotExistError)(t,r);if(!this.targetExists(t))throw i;const n=this.getPermissionSpecification(t);if(!s.hasSpecificationType.call(void 0,n,e))throw i;return n}getRestrictedMethod(e,t){return this.getTypedPermissionSpecification("RestrictedMethod",e,t).methodImplementation}getSubjectNames(){return Object.keys(this.state.subjects)}getPermission(e,t){return this.state.subjects[e]?.permissions[t]}getPermissions(e){return this.state.subjects[e]?.permissions}hasPermission(e,t){return Boolean(this.getPermission(e,t))}hasPermissions(e){return Boolean(this.state.subjects[e])}revokeAllPermissions(e){this.update((t=>{if(!t.subjects[e])throw new(0,o.UnrecognizedSubjectError)(e);delete t.subjects[e]}))}revokePermission(e,t){this.revokePermissions({[e]:[t]})}revokePermissions(e){this.update((t=>{Object.keys(e).forEach((r=>{if(!m.hasProperty.call(void 0,t.subjects,r))throw new(0,o.UnrecognizedSubjectError)(r);e[r].forEach((e=>{const{permissions:i}=t.subjects[r];if(!m.hasProperty.call(void 0,i,e))throw new(0,o.PermissionDoesNotExistError)(r,e);this.deletePermission(t.subjects,r,e)}))}))}))}revokePermissionForAllSubjects(e){0!==this.getSubjectNames().length&&this.update((t=>{Object.entries(t.subjects).forEach((([r,i])=>{const{permissions:n}=i;m.hasProperty.call(void 0,n,e)&&this.deletePermission(t.subjects,r,e)}))}))}deletePermission(e,t,r){const{permissions:i}=e[t];Object.keys(i).length>1?delete i[r]:delete e[t]}hasCaveat(e,t,r){return Boolean(this.getCaveat(e,t,r))}getCaveat(e,t,r){const i=this.getPermission(e,t);if(!i)throw new(0,o.PermissionDoesNotExistError)(e,t);return s.findCaveat.call(void 0,i,r)}addCaveat(e,t,r,i){if(this.hasCaveat(e,t,r))throw new(0,o.CaveatAlreadyExistsError)(e,t,r);this.setCaveat(e,t,r,i)}updateCaveat(e,t,r,i){if(!this.hasCaveat(e,t,r))throw new(0,o.CaveatDoesNotExistError)(e,t,r);this.setCaveat(e,t,r,i)}setCaveat(e,t,r,i){this.update((n=>{const s=n.subjects[e];if(!s)throw new(0,o.UnrecognizedSubjectError)(e);const a=s.permissions[t];if(!a)throw new(0,o.PermissionDoesNotExistError)(e,t);const l={type:r,value:i};if(this.validateCaveat(l,e,t),a.caveats){const e=a.caveats.findIndex((e=>e.type===l.type));-1===e?a.caveats.push(l):a.caveats.splice(e,1,l)}else a.caveats=[l];this.validateModifiedPermission(a,e)}))}updatePermissionsByCaveat(e,t){0!==Object.keys(this.state.subjects).length&&this.update((r=>{Object.values(r.subjects).forEach((i=>{Object.values(i.permissions).forEach((n=>{const{caveats:s}=n,a=s?.find((({type:t})=>t===e));if(!a)return;const o=t(a.value),{operation:l}=o;switch(l){case 0:break;case 1:a.value=o.value,this.validateCaveat(a,i.origin,n.parentCapability);break;case 2:this.deleteCaveat(n,e,i.origin);break;case 3:this.deletePermission(r.subjects,i.origin,n.parentCapability);break;default:throw new Error(`Unrecognized mutation result: "${l}"`)}}))}))}))}removeCaveat(e,t,r){this.update((i=>{const n=i.subjects[e]?.permissions[t];if(!n)throw new(0,o.PermissionDoesNotExistError)(e,t);if(!n.caveats)throw new(0,o.CaveatDoesNotExistError)(e,t,r);this.deleteCaveat(n,r,e)}))}deleteCaveat(e,t,r){if(!e.caveats)throw new(0,o.CaveatDoesNotExistError)(r,e.parentCapability,t);const i=e.caveats.findIndex((e=>e.type===t));if(-1===i)throw new(0,o.CaveatDoesNotExistError)(r,e.parentCapability,t);1===e.caveats.length?e.caveats=null:e.caveats.splice(i,1),this.validateModifiedPermission(e,r)}validateModifiedPermission(e,t){if(!this.targetExists(e.parentCapability))throw new Error(`Fatal: Existing permission target "${e.parentCapability}" has no specification.`);this.validatePermission(this.getPermissionSpecification(e.parentCapability),e,t)}targetExists(e){return m.hasProperty.call(void 0,this._permissionSpecifications,e)}grantPermissions({approvedPermissions:e,requestData:t,preserveExistingPermissions:r=!0,subject:i}){return c.__privateMethod.call(void 0,this,w,T).call(this,{approvedPermissions:e,subject:i,mergePermissions:!1,preserveExistingPermissions:r,requestData:t})}grantPermissionsIncremental({approvedPermissions:e,requestData:t,subject:r}){return c.__privateMethod.call(void 0,this,w,T).call(this,{approvedPermissions:e,subject:r,mergePermissions:!0,preserveExistingPermissions:!0,requestData:t})}validatePermission(e,t,r,{invokePermissionValidator:i,performCaveatValidation:n}={invokePermissionValidator:!0,performCaveatValidation:!0}){const{allowedCaveats:s,validator:a,targetName:l}=e;if(e.subjectTypes?.length&&e.subjectTypes.length>0){const t=this.messagingSystem.call("SubjectMetadataController:getSubjectMetadata",r);if(!t||null===t.subjectType||!e.subjectTypes.includes(t.subjectType))throw"RestrictedMethod"===e.permissionType?o.methodNotFound.call(void 0,l,{origin:r}):new(0,o.EndowmentPermissionDoesNotExistError)(l,r)}if(m.hasProperty.call(void 0,t,"caveats")){const{caveats:e}=t;if(null!==e&&!(Array.isArray(e)&&e.length>0))throw new(0,o.InvalidCaveatsPropertyError)(r,l,e);const i=new Set;e?.forEach((e=>{if(n&&this.validateCaveat(e,r,l),!s?.includes(e.type))throw new(0,o.ForbiddenCaveatError)(e.type,r,l);if(i.has(e.type))throw new(0,o.DuplicateCaveatError)(e.type,r,l);i.add(e.type)}))}i&&a&&a(t,r,l)}setValidatedPermissions(e,t){this.update((r=>{r.subjects[e]||(r.subjects[e]={origin:e,permissions:{}}),r.subjects[e].permissions=v.castDraft.call(void 0,t)}))}constructCaveats(e,t,r){const i=r?.map((r=>{this.validateCaveat(r,e,t);const{type:i,value:n}=r;return{type:i,value:n}}));return i&&d.isNonEmptyArray.call(void 0,i)?i:void 0}validateCaveat(e,t,r){if(!d.isPlainObject.call(void 0,e))throw new(0,o.InvalidCaveatError)(e,t,r);if(2!==Object.keys(e).length)throw new(0,o.InvalidCaveatFieldsError)(e,t,r);if("string"!=typeof e.type)throw new(0,o.InvalidCaveatTypeError)(e,t,r);const i=this.getCaveatSpecification(e.type);if(!i)throw new(0,o.UnrecognizedCaveatTypeError)(e.type,t,r);if(!m.hasProperty.call(void 0,e,"value")||void 0===e.value)throw new(0,o.CaveatMissingValueError)(e,t,r);if(!d.isValidJson.call(void 0,e.value))throw new(0,o.CaveatInvalidJsonError)(e,t,r);i.validator?.(e,t,r)}async requestPermissions(e,t,r={}){const{origin:i}=e,{id:n=g.nanoid.call(void 0),preserveExistingPermissions:s=!0}=r;this.validateRequestedPermissions(i,t);const a={...r.metadata,id:n,origin:i},o={metadata:a,permissions:t},l=await this.requestUserApproval(o);return await c.__privateMethod.call(void 0,this,I,j).call(this,{subject:e,metadata:a,preserveExistingPermissions:s,approvedRequest:l})}async requestPermissionsIncremental(e,t,r={}){const{origin:i}=e,{id:n=g.nanoid.call(void 0)}=r;this.validateRequestedPermissions(i,t);const s=this.getPermissions(i)??{},[a,l]=c.__privateMethod.call(void 0,this,b,E).call(this,s,t);if(void 0===a||void 0===l)return[];try{this.validateRequestedPermissions(i,a)}catch(e){if(e instanceof Error)throw new(0,o.InvalidMergedPermissionsError)(i,e,l);throw o.internalError.call(void 0,"Unrecognized error type",{error:e})}const u={...r.metadata,id:n,origin:i},d={metadata:u,permissions:a,diff:{currentPermissions:s,permissionDiffMap:l}},h=await this.requestUserApproval(d);return await c.__privateMethod.call(void 0,this,I,j).call(this,{subject:e,metadata:u,preserveExistingPermissions:!1,approvedRequest:h})}validateRequestedPermissions(e,t){if(!d.isPlainObject.call(void 0,t))throw o.invalidParams.call(void 0,{message:`Requested permissions for origin "${e}" is not a plain object.`,data:{origin:e,requestedPermissions:t}});if(0===Object.keys(t).length)throw o.invalidParams.call(void 0,{message:`Permissions request for origin "${e}" contains no permissions.`,data:{requestedPermissions:t}});for(const r of Object.keys(t)){const i=t[r];if(!this.targetExists(r))throw o.methodNotFound.call(void 0,r,{origin:e,requestedPermissions:t});if(!d.isPlainObject.call(void 0,i)||void 0!==i.parentCapability&&r!==i.parentCapability)throw o.invalidParams.call(void 0,{message:`Permissions request for origin "${e}" contains invalid requested permission(s).`,data:{origin:e,requestedPermissions:t}});this.validatePermission(this.getPermissionSpecification(r),i,e,{invokePermissionValidator:!1,performCaveatValidation:!0})}}async requestUserApproval(e){const{origin:t,id:r}=e.metadata,i=await this.messagingSystem.call("ApprovalController:addRequest",{id:r,origin:t,requestData:e,type:"wallet_requestPermissions"},!0);return this.validateApprovedPermissions(i,{id:r,origin:t}),i}getSideEffects(e){return Object.keys(e).reduce(((e,t)=>{if(this.targetExists(t)){const r=this.getPermissionSpecification(t);r.sideEffect&&(e.permittedHandlers[t]=r.sideEffect.onPermitted,r.sideEffect.onFailure&&(e.failureHandlers[t]=r.sideEffect.onFailure))}return e}),{permittedHandlers:{},failureHandlers:{}})}async executeSideEffects(e,t){const{permittedHandlers:r,failureHandlers:i}=e,n={requestData:t,messagingSystem:this.messagingSystem},s=await Promise.allSettled(Object.values(r).map((e=>e(n)))),a=s.filter((e=>"rejected"===e.status));if(a.length>0){const e=Object.values(i);if(e.length>0)try{await Promise.all(e.map((e=>e(n))))}catch(e){throw o.internalError.call(void 0,"Unexpected error in side-effects",{error:e})}const t=a.map((e=>e.reason));throw t.forEach((e=>{console.error(e)})),t.length>1?o.internalError.call(void 0,"Multiple errors occurred during side-effects execution",{errors:t}):t[0]}return s.map((({value:e})=>e))}validateApprovedPermissions(e,t){const{id:r,origin:i}=t;if(!d.isPlainObject.call(void 0,e)||!d.isPlainObject.call(void 0,e.metadata))throw o.internalError.call(void 0,`Approved permissions request for subject "${i}" is invalid.`,{data:{approvedRequest:e}});const{metadata:{id:n,origin:s},permissions:a}=e;if(n!==r)throw o.internalError.call(void 0,`Approved permissions request for subject "${i}" mutated its id.`,{originalId:r,mutatedId:n});if(s!==i)throw o.internalError.call(void 0,`Approved permissions request for subject "${i}" mutated its origin.`,{originalOrigin:i,mutatedOrigin:s});try{this.validateRequestedPermissions(i,a)}catch(e){if(e instanceof Error)throw o.internalError.call(void 0,`Invalid approved permissions request: ${e.message}`,e instanceof h.JsonRpcError?e.data:void 0);throw o.internalError.call(void 0,"Unrecognized error type",{error:e})}}async acceptPermissionsRequest(e){const{id:t}=e.metadata;if(!this.hasApprovalRequest({id:t}))throw new(0,o.PermissionsRequestNotFoundError)(t);if(0!==Object.keys(e.permissions).length)try{this.messagingSystem.call("ApprovalController:acceptRequest",t,e)}catch(e){throw this._rejectPermissionsRequest(t,e),e}else this._rejectPermissionsRequest(t,o.invalidParams.call(void 0,{message:"Must request at least one permission."}))}async rejectPermissionsRequest(e){if(!this.hasApprovalRequest({id:e}))throw new(0,o.PermissionsRequestNotFoundError)(e);this._rejectPermissionsRequest(e,o.userRejectedRequest.call(void 0))}hasApprovalRequest(e){return this.messagingSystem.call("ApprovalController:hasRequest",e)}_rejectPermissionsRequest(e,t){return this.messagingSystem.call("ApprovalController:rejectRequest",e,t)}async getEndowments(e,t,r){if(!this.hasPermission(e,t))throw o.unauthorized.call(void 0,{data:{origin:e,targetName:t}});return this.getTypedPermissionSpecification("Endowment",t,e).endowmentGetter({origin:e,requestData:r})}async executeRestrictedMethod(e,t,r){const i=this.getRestrictedMethod(t,e),n=await this._executeRestrictedMethod(i,{origin:e},t,r);if(void 0===n)throw new Error(`Internal request for method "${t}" as origin "${e}" returned no result.`);return n}_executeRestrictedMethod(e,t,r,i=[]){const{origin:s}=t,a=this.getPermission(s,r);if(!a)throw o.unauthorized.call(void 0,{data:{origin:s,method:r}});return n.decorateWithCaveats.call(void 0,e,a,this._caveatSpecifications)({method:r,params:i,context:{origin:s}})}};k=new WeakSet,y=function(e){const{merger:t}=this.getCaveatSpecification(e);if(void 0===t)throw new(0,o.CaveatMergerDoesNotExistError)(e);return t},w=new WeakSet,T=function({approvedPermissions:e,subject:t,mergePermissions:r,preserveExistingPermissions:i,requestData:n}){const{origin:a}=t;if(!a||"string"!=typeof a)throw new(0,o.InvalidSubjectIdentifierError)(a);const l=i?{...this.getPermissions(a)}:{};for(const[t,i]of Object.entries(e)){if(!this.targetExists(t))throw o.methodNotFound.call(void 0,t);if(void 0!==i.parentCapability&&t!==i.parentCapability)throw new(0,o.InvalidApprovedPermissionError)(a,t,i);const e=t,u=this.getPermissionSpecification(e),d={caveats:this.constructCaveats(a,e,i.caveats),invoker:a,target:e};let h,m=!0;u.factory?h=u.factory(d,n):(h=s.constructPermission.call(void 0,d),m=!1),r&&(h=c.__privateMethod.call(void 0,this,S,P).call(this,l[e],h)[0]),this.validatePermission(u,h,a,{invokePermissionValidator:!0,performCaveatValidation:m}),l[e]=h}return this.setValidatedPermissions(a,l),l},b=new WeakSet,E=function(e,t){const r={},i=v.produce.call(void 0,e,(e=>{const i=e;Object.entries(t).forEach((([e,t])=>{const n=i[e],[s,a]=c.__privateMethod.call(void 0,this,S,P).call(this,n??{},t);(void 0===n||Object.keys(a).length>0)&&(i[e]=s,r[e]=a)}))}));return 0===Object.keys(r).length?[]:[i,r]},S=new WeakSet,P=function(e,t){const{caveatPairs:r,leftUniqueCaveats:i,rightUniqueCaveats:n}=l.collectUniqueAndPairedCaveats.call(void 0,e,t),[s,a]=r.reduce((([e,t],[r,i])=>{const[n,s]=c.__privateMethod.call(void 0,this,A,C).call(this,r,i);return void 0!==n&&void 0!==s?(e.push(n),t[n.type]=s):e.push(r),[e,t]}),[[],{}]),o=[...s,...i,...n.map((e=>{const[t,r]=c.__privateMethod.call(void 0,this,A,C).call(this,void 0,e);return a[t.type]=r,t}))];return[{...e,...t,...o.length>0?{caveats:o}:{}},a]},A=new WeakSet,C=function(e,t){if(void 0!==e&&e.type!==t.type)throw new(0,o.CaveatMergeTypeMismatchError)(e.type,t.type);const r=c.__privateMethod.call(void 0,this,k,y).call(this,t.type);if(void 0===e)return[{...t},t.value];const[i,n]=r(e.value,t.value);return void 0!==i&&void 0!==n?[{type:t.type,value:i},n]:[]},I=new WeakSet,j=async function({subject:e,metadata:t,preserveExistingPermissions:r,approvedRequest:i}){const{permissions:n,...s}=i,a={...t},o=this.getSideEffects(n);if(Object.values(o.permittedHandlers).length>0){const e=await this.executeSideEffects(o,i);a.data=Object.keys(o.permittedHandlers).reduce(((t,r,i)=>({[r]:e[i],...t})),{})}return[this.grantPermissions({subject:e,approvedPermissions:n,preserveExistingPermissions:r,requestData:s}),a]},r.CaveatMutatorOperation=x,r.PermissionController=M}}},{package:"@metamask/snaps-controllers>@metamask/permission-controller",file:"node_modules/@metamask/snaps-controllers/node_modules/@metamask/permission-controller/dist/chunk-I3DJ23QH.js"}],[2023,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i=(e=>(e.requestPermissions="wallet_requestPermissions",e.getPermissions="wallet_getPermissions",e.revokePermissions="wallet_revokePermissions",e))(i||{});r.MethodNames=i,r.collectUniqueAndPairedCaveats=function(e,t){const r=e?.caveats?.slice()??[],i=t.caveats?.slice()??[],n=[],s=[];return r.forEach((e=>{const t=i.findIndex((t=>t.type===e.type));-1===t?n.push(e):(s.push([e,i[t]]),i.splice(t,1))})),{caveatPairs:s,leftUniqueCaveats:n,rightUniqueCaveats:[...i]}}}}},{package:"@metamask/snaps-controllers>@metamask/permission-controller",file:"node_modules/@metamask/snaps-controllers/node_modules/@metamask/permission-controller/dist/chunk-PTE4672I.js"}],[2024,{"./chunk-3X6WO7UG.js":2017,"@metamask/utils":2300},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i=e("./chunk-3X6WO7UG.js"),n=e("@metamask/utils");function s(e){return n.hasProperty.call(void 0,e,"decorator")}r.isRestrictedMethodCaveatSpecification=s,r.decorateWithCaveats=function(e,t,r){const{caveats:n}=t;if(!n)return e;let a=async t=>e(t);for(const e of n){const t=r[e.type];if(!t)throw new(0,i.UnrecognizedCaveatTypeError)(e.type);if(!s(t))throw new(0,i.CaveatSpecificationMismatchError)(t,"RestrictedMethod");a=t.decorator(a,e)}return a}}}},{package:"@metamask/snaps-controllers>@metamask/permission-controller",file:"node_modules/@metamask/snaps-controllers/node_modules/@metamask/permission-controller/dist/chunk-RKDXFKNN.js"}],[2025,{"./chunk-3X6WO7UG.js":2017,"@metamask/json-rpc-engine":2013},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i=e("./chunk-3X6WO7UG.js"),n=e("@metamask/json-rpc-engine");r.getPermissionMiddlewareFactory=function({executeRestrictedMethod:e,getRestrictedMethod:t,isUnrestrictedMethod:r}){return function(s){const{origin:a}=s;if("string"!=typeof a||!a)throw new Error('The subject "origin" must be a non-empty string.');return n.createAsyncMiddleware.call(void 0,(async(n,o,l)=>{const{method:c,params:u}=n;if(r(c))return l();const d=t(c,a),h=await e(d,s,c,u);void 0!==h?o.result=h:o.error=i.internalError.call(void 0,`Request for method "${n.method}" returned undefined result.`,{request:n})}))}}}}},{package:"@metamask/snaps-controllers>@metamask/permission-controller",file:"node_modules/@metamask/snaps-controllers/node_modules/@metamask/permission-controller/dist/chunk-VM4LI55W.js"}],[2026,{"./chunk-3X6WO7UG.js":2017,"@metamask/controller-utils":2005},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i=e("./chunk-3X6WO7UG.js"),n=e("@metamask/controller-utils"),s={methodNames:["wallet_requestPermissions"],implementation:async function(e,t,r,s,{requestPermissionsForOrigin:a}){const{params:o}=e;if(!Array.isArray(o)||!n.isPlainObject.call(void 0,o[0]))return s(i.invalidParams.call(void 0,{data:{request:e}}));const[l]=o,[c]=await a(l);return t.result=Object.values(c),s()},hookNames:{requestPermissionsForOrigin:!0}};r.requestPermissionsHandler=s}}},{package:"@metamask/snaps-controllers>@metamask/permission-controller",file:"node_modules/@metamask/snaps-controllers/node_modules/@metamask/permission-controller/dist/chunk-XM622CMP.js"}],[2027,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i=Object.defineProperty;r.__export=(e,t)=>{for(var r in t)i(e,r,{get:t[r],enumerable:!0})},r.__privateAdd=(e,t,r)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,r)},r.__privateMethod=(e,t,r)=>(((e,t,r)=>{if(!t.has(e))throw TypeError("Cannot "+r)})(e,t,"access private method"),r)}}},{package:"@metamask/snaps-controllers>@metamask/permission-controller",file:"node_modules/@metamask/snaps-controllers/node_modules/@metamask/permission-controller/dist/chunk-Z2XKIXLS.js"}],[2028,{nanoid:2031},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i=e("nanoid");var n=(e=>(e.RestrictedMethod="RestrictedMethod",e.Endowment="Endowment",e))(n||{});r.constructPermission=function(e){const{caveats:t=null,invoker:r,target:n}=e;return{id:i.nanoid.call(void 0),parentCapability:n,invoker:r,caveats:t,date:(new Date).getTime()}},r.findCaveat=function(e,t){return e.caveats?.find((e=>e.type===t))},r.PermissionType=n,r.hasSpecificationType=function(e,t){return e.permissionType===t}}}},{package:"@metamask/snaps-controllers>@metamask/permission-controller",file:"node_modules/@metamask/snaps-controllers/node_modules/@metamask/permission-controller/dist/chunk-ZH4MLSXX.js"}],[2029,{"./chunk-3X6WO7UG.js":2017,"./chunk-C73QV75D.js":2018,"./chunk-DV74ZDGD.js":2019,"./chunk-GHOOCGN3.js":2020,"./chunk-HRDKMOYS.js":2021,"./chunk-I3DJ23QH.js":2022,"./chunk-PTE4672I.js":2023,"./chunk-RKDXFKNN.js":2024,"./chunk-VM4LI55W.js":2025,"./chunk-XM622CMP.js":2026,"./chunk-Z2XKIXLS.js":2027,"./chunk-ZH4MLSXX.js":2028},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i=e("./chunk-DV74ZDGD.js");e("./chunk-HRDKMOYS.js"),e("./chunk-XM622CMP.js"),e("./chunk-GHOOCGN3.js");var n=e("./chunk-I3DJ23QH.js"),s=e("./chunk-RKDXFKNN.js"),a=e("./chunk-ZH4MLSXX.js"),o=e("./chunk-C73QV75D.js");e("./chunk-VM4LI55W.js");var l=e("./chunk-3X6WO7UG.js"),c=e("./chunk-PTE4672I.js");e("./chunk-Z2XKIXLS.js"),r.CaveatAlreadyExistsError=l.CaveatAlreadyExistsError,r.CaveatDoesNotExistError=l.CaveatDoesNotExistError,r.CaveatInvalidJsonError=l.CaveatInvalidJsonError,r.CaveatMergeTypeMismatchError=l.CaveatMergeTypeMismatchError,r.CaveatMergerDoesNotExistError=l.CaveatMergerDoesNotExistError,r.CaveatMissingValueError=l.CaveatMissingValueError,r.CaveatMutatorOperation=n.CaveatMutatorOperation,r.CaveatSpecificationMismatchError=l.CaveatSpecificationMismatchError,r.DuplicateCaveatError=l.DuplicateCaveatError,r.EndowmentPermissionDoesNotExistError=l.EndowmentPermissionDoesNotExistError,r.ForbiddenCaveatError=l.ForbiddenCaveatError,r.InvalidApprovedPermissionError=l.InvalidApprovedPermissionError,r.InvalidCaveatError=l.InvalidCaveatError,r.InvalidCaveatFieldsError=l.InvalidCaveatFieldsError,r.InvalidCaveatTypeError=l.InvalidCaveatTypeError,r.InvalidCaveatsPropertyError=l.InvalidCaveatsPropertyError,r.InvalidMergedPermissionsError=l.InvalidMergedPermissionsError,r.InvalidSubjectIdentifierError=l.InvalidSubjectIdentifierError,r.MethodNames=c.MethodNames,r.PermissionController=n.PermissionController,r.PermissionDoesNotExistError=l.PermissionDoesNotExistError,r.PermissionType=a.PermissionType,r.PermissionsRequestNotFoundError=l.PermissionsRequestNotFoundError,r.SubjectMetadataController=o.SubjectMetadataController,r.SubjectType=o.SubjectType,r.UnrecognizedCaveatTypeError=l.UnrecognizedCaveatTypeError,r.UnrecognizedSubjectError=l.UnrecognizedSubjectError,r.constructPermission=a.constructPermission,r.decorateWithCaveats=s.decorateWithCaveats,r.findCaveat=a.findCaveat,r.hasSpecificationType=a.hasSpecificationType,r.internalError=l.internalError,r.invalidParams=l.invalidParams,r.isRestrictedMethodCaveatSpecification=s.isRestrictedMethodCaveatSpecification,r.methodNotFound=l.methodNotFound,r.permissionRpcMethods=i.rpc_methods_exports,r.unauthorized=l.unauthorized,r.userRejectedRequest=l.userRejectedRequest}}},{package:"@metamask/snaps-controllers>@metamask/permission-controller",file:"node_modules/@metamask/snaps-controllers/node_modules/@metamask/permission-controller/dist/index.js"}],[203,{lodash:3836},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=e("lodash");r.default={version:79,async migrate(e){const t=(0,i.cloneDeep)(e);t.meta.version=79;const r=function(e){var t,r;(null==e||null===(t=e.AppStateController)||void 0===t?void 0:t.collectiblesDetectionNoticeDismissed)!==undefined&&delete e.AppStateController.collectiblesDetectionNoticeDismissed;(null==e||null===(r=e.metamask)||void 0===r?void 0:r.collectiblesDropdownState)!==undefined&&delete e.metamask.collectiblesDropdownState;return e}(t.data);return t.data=r,t}}}}},{package:"$root$",file:"app/scripts/migrations/079.js"}],[2030,{buffer:3028,"buffer-from":3033,inherits:3641,"readable-stream":4258,typedarray:4381},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(r){(function(){var i=e("readable-stream").Writable,n=e("inherits"),s=e("buffer-from");if("undefined"==typeof Uint8Array)var a=e("typedarray").Uint8Array;else a=Uint8Array;function o(e,t){if(!(this instanceof o))return new o(e,t);"function"==typeof e&&(t=e,e={}),e||(e={});var r=e.encoding,n=!1;r?"u8"!==(r=String(r).toLowerCase())&&"uint8"!==r||(r="uint8array"):n=!0,i.call(this,{objectMode:!0}),this.encoding=r,this.shouldInferEncoding=n,t&&this.on("finish",(function(){t(this.getBody())})),this.body=[]}t.exports=o,n(o,i),o.prototype._write=function(e,t,r){this.body.push(e),r()},o.prototype.inferEncoding=function(e){var t=e===undefined?this.body[0]:e;return r.isBuffer(t)?"buffer":"undefined"!=typeof Uint8Array&&t instanceof Uint8Array?"uint8array":Array.isArray(t)?"array":"string"==typeof t?"string":"[object Object]"===Object.prototype.toString.call(t)?"object":"buffer"},o.prototype.getBody=function(){return this.encoding||0!==this.body.length?(this.shouldInferEncoding&&(this.encoding=this.inferEncoding()),"array"===this.encoding?function(e){for(var t=[],r=0;r<e.length;r++)t.push.apply(t,e[r]);return t}(this.body):"string"===this.encoding?function(e){for(var t=[],i=0;i<e.length;i++){var n=e[i];"string"==typeof n||r.isBuffer(n)?t.push(n):l(n)?t.push(s(n)):t.push(s(String(n)))}t=r.isBuffer(e[0])?(t=r.concat(t)).toString("utf8"):t.join("");return t}(this.body):"buffer"===this.encoding?function(e){for(var t=[],i=0;i<e.length;i++){var n=e[i];r.isBuffer(n)?t.push(n):l(n)?t.push(s(n)):t.push(s(String(n)))}return r.concat(t)}(this.body):"uint8array"===this.encoding?function(e){for(var t=0,r=0;r<e.length;r++)"string"==typeof e[r]&&(e[r]=s(e[r])),t+=e[r].length;for(var i=new a(t),n=(r=0,0);r<e.length;r++)for(var o=e[r],l=0;l<o.length;l++)i[n++]=o[l];return i}(this.body):this.body):[]};Array.isArray;function l(e){return"string"==typeof e||(t=e,/Array\]$/.test(Object.prototype.toString.call(t)))||e&&"function"==typeof e.subarray;var t}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/snaps-controllers>concat-stream",file:"node_modules/@metamask/snaps-controllers/node_modules/concat-stream/index.js"}],[2031,{"./url-alphabet/index.cjs":2032},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){let{urlAlphabet:i}=e("./url-alphabet/index.cjs"),n=e=>crypto.getRandomValues(new Uint8Array(e)),s=(e,t,r)=>{let i=(2<<Math.log(e.length-1)/Math.LN2)-1,n=-~(1.6*i*t/e.length);return(s=t)=>{let a="";for(;;){let t=r(n),o=n;for(;o--;)if(a+=e[t[o]&i]||"",a.length===s)return a}}};t.exports={nanoid:(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce(((e,t)=>e+=(t&=63)<36?t.toString(36):t<62?(t-26).toString(36).toUpperCase():t>62?"-":"_"),""),customAlphabet:(e,t=21)=>s(e,t,n),customRandom:s,urlAlphabet:i,random:n}}}},{package:"@metamask/snaps-controllers>nanoid",file:"node_modules/@metamask/snaps-controllers/node_modules/nanoid/index.browser.cjs"}],[2032,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){t.exports={urlAlphabet:"useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict"}}}},{package:"@metamask/snaps-controllers>nanoid",file:"node_modules/@metamask/snaps-controllers/node_modules/nanoid/url-alphabet/index.cjs"}],[2038,{"./verify":2039,"@metamask/utils":2300,superstruct:4358},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var i=this&&this.__createBinding||(Object.create?function(e,t,r,i){i===undefined&&(i=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,i,n)}:function(e,t,r,i){i===undefined&&(i=r),e[i]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||i(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),r.SnapsRegistryDatabaseStruct=r.BlockedSnapStruct=r.BlockReasonStruct=r.VerifiedSnapStruct=r.ImagePathStruct=r.AdditionalSourceCodeStruct=r.SupportStruct=r.AuditStruct=r.AuthorStruct=void 0;const s=e("@metamask/utils"),a=e("superstruct"),o=(0,a.refine)((0,a.string)(),"Npm ID",(e=>e.startsWith("npm:"))),l=(0,a.object)({checksum:s.ChecksumStruct});r.AuthorStruct=(0,a.object)({name:(0,a.string)(),website:(0,a.string)()}),r.AuditStruct=(0,a.object)({auditor:(0,a.string)(),report:(0,a.string)()}),r.SupportStruct=(0,a.object)({knowledgeBase:(0,a.optional)((0,a.string)()),faq:(0,a.optional)((0,a.string)()),contact:(0,a.optional)((0,a.string)()),keyRecovery:(0,a.optional)((0,a.string)())}),r.AdditionalSourceCodeStruct=(0,a.object)({name:(0,a.string)(),url:(0,a.string)()}),r.ImagePathStruct=(0,a.pattern)((0,a.string)(),/\.\/images\/.*\/\d+\.(?:png|jpe?g)$/u),r.VerifiedSnapStruct=(0,a.object)({id:o,metadata:(0,a.object)({name:(0,a.string)(),type:(0,a.optional)((0,a.enums)(["account"])),author:(0,a.optional)(r.AuthorStruct),website:(0,a.optional)((0,a.string)()),onboard:(0,a.optional)((0,a.boolean)()),summary:(0,a.optional)((0,a.string)()),description:(0,a.optional)((0,a.string)()),audits:(0,a.optional)((0,a.array)(r.AuditStruct)),category:(0,a.optional)((0,a.enums)(["interoperability","notifications","transaction insights","account management"])),tags:(0,a.optional)((0,a.array)((0,a.string)())),support:(0,a.optional)(r.SupportStruct),sourceCode:(0,a.optional)((0,a.string)()),hidden:(0,a.optional)((0,a.boolean)()),privateCode:(0,a.optional)((0,a.boolean)()),privacyPolicy:(0,a.optional)((0,a.string)()),termsOfUse:(0,a.optional)((0,a.string)()),additionalSourceCode:(0,a.optional)((0,a.array)(r.AdditionalSourceCodeStruct)),screenshots:(0,a.optional)((0,a.size)((0,a.array)(r.ImagePathStruct),3,3))}),versions:(0,a.record)(s.VersionStruct,l)}),r.BlockReasonStruct=(0,a.object)({explanation:(0,a.optional)((0,a.string)()),url:(0,a.optional)((0,a.string)())}),r.BlockedSnapStruct=(0,a.union)([(0,a.object)({id:o,versionRange:s.VersionRangeStruct,reason:(0,a.optional)(r.BlockReasonStruct)}),(0,a.object)({checksum:s.ChecksumStruct,reason:(0,a.optional)(r.BlockReasonStruct)})]),r.SnapsRegistryDatabaseStruct=(0,a.object)({verifiedSnaps:(0,a.record)(o,r.VerifiedSnapStruct),blockedSnaps:(0,a.array)(r.BlockedSnapStruct)}),n(e("./verify"),r)}}},{package:"@metamask/snaps-utils>@metamask/snaps-registry",file:"node_modules/@metamask/snaps-registry/dist/index.js"}],[2039,{"@metamask/utils":2300,"@noble/curves/secp256k1":2330,"@noble/hashes/sha256":2339,superstruct:4358},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.verify=r.SignatureStruct=void 0;const i=e("@metamask/utils"),n=e("@noble/curves/secp256k1"),s=e("@noble/hashes/sha256"),a=e("superstruct");r.SignatureStruct=(0,a.object)({signature:i.StrictHexStruct,curve:(0,a.literal)("secp256k1"),format:(0,a.literal)("DER")}),r.verify=function({registry:e,signature:t,publicKey:a}){(0,i.assertStruct)(t,r.SignatureStruct,"Invalid signature object");const o=(0,i.hexToBytes)(a);return n.secp256k1.verify((0,i.remove0x)(t.signature),(0,s.sha256)((0,i.stringToBytes)(e)),o)}}}},{package:"@metamask/snaps-utils>@metamask/snaps-registry",file:"node_modules/@metamask/snaps-registry/dist/verify.js"}],[204,{lodash:3836},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=e("lodash");r.default={version:80,async migrate(e){const t=(0,i.cloneDeep)(e);t.meta.version=80;const r=function(e){var t;(null==e||null===(t=e.metamask)||void 0===t?void 0:t.showPortfolioTooltip)!==undefined&&delete e.metamask.showPortfolioTooltip;return e}(t.data);return t.data=r,t}}}}},{package:"$root$",file:"app/scripts/migrations/080.js"}],[205,{"@metamask/utils":2300,lodash:3836},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.migrate=async function(e){const t=(0,i.cloneDeep)(e);t.meta.version=s;const r=function(e){if(!(0,n.hasProperty)(e,"SnapController")||!(0,n.hasProperty)(e,"PermissionController")||!(0,n.isObject)(e.PermissionController))return e;const{PermissionController:t}=e,{subjects:r}=t;if(!(0,n.isObject)(r))return e;const s="wallet_snap_";for(const[t,a]of Object.entries(r)){if(!(0,n.isObject)(a)||!(0,n.isObject)(a.permissions))return e;let r,o=1;const{permissions:l}=a,c={...l};for(const[a,u]of Object.entries(l))if(a.startsWith(s)){if(!(0,n.isObject)(u)||!(0,n.hasProperty)(u,"id")||!(0,n.hasProperty)(u,"date"))return e;if((0,n.hasProperty)(c,"wallet_snap")||(c.wallet_snap={caveats:[{type:"snapIds",value:{}}],invoker:t,parentCapability:"wallet_snap"}),!(0,n.isObject)(c.wallet_snap))return e;if(!(0,i.isArray)(c.wallet_snap.caveats))return e;const l=a.slice(s.length),d=c.wallet_snap.caveats[0];if(!(0,n.isObject)(d))return e;if(!(0,n.hasProperty)(d,"type")||"snapIds"!==d.type||!(0,n.hasProperty)(d,"value")||!(0,n.isObject)(d.value))return e;if(d.value[l]={},"number"!=typeof u.date||"string"!=typeof u.id)return e;u.date>o&&(o=u.date,r=u.id),delete c[a]}c.wallet_snap&&(c.wallet_snap.date=o,c.wallet_snap.id=r,a.permissions=c)}return e}(t.data);return t.data=r,t},r.version=void 0;var i=e("lodash"),n=e("@metamask/utils");const s=r.version=81}}},{package:"$root$",file:"app/scripts/migrations/081.ts"}],[206,{"@metamask/utils":2300,lodash:3836,loglevel:3842,uuid:4424},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.migrate=async function(e){const t=(0,n.cloneDeep)(e);return t.meta.version=l,t.data=function(e){if(!(0,s.hasProperty)(e,"PreferencesController"))return o.default.warn("state.PreferencesController is undefined"),e;if(!(0,s.isObject)(e.PreferencesController)){var t,r;return null===(t=global.sentry)||void 0===t||null===(r=t.captureException)||void 0===r||r.call(t,new Error("typeof state.PreferencesController is "+typeof e.PreferencesController)),e}if(!(0,s.hasProperty)(e,"NetworkController")||!(0,s.isObject)(e.NetworkController)){var i,n;return null===(i=global.sentry)||void 0===i||null===(n=i.captureException)||void 0===n||n.call(i,new Error("typeof state.NetworkController is "+typeof e.NetworkController)),e}if(!(0,s.hasProperty)(e.PreferencesController,"frequentRpcListDetail")||!Array.isArray(e.PreferencesController.frequentRpcListDetail)){var l,c;if(!(e.NetworkController.networkConfigurations&&e.PreferencesController.frequentRpcListDetail===undefined))null===(l=global.sentry)||void 0===l||null===(c=l.captureException)||void 0===c||c.call(l,new Error("typeof state.PreferencesController.frequentRpcListDetail is "+typeof e.PreferencesController.frequentRpcListDetail));return e}if(!e.PreferencesController.frequentRpcListDetail.every(s.isObject)){var u,d;const t=e.PreferencesController.frequentRpcListDetail.find((e=>!(0,s.isObject)(e)));return null===(u=global.sentry)||void 0===u||null===(d=u.captureException)||void 0===d||d.call(u,new Error("state.PreferencesController.frequentRpcListDetail contains an element of type "+typeof t)),e}const{PreferencesController:h,NetworkController:m}=e,{frequentRpcListDetail:p}=h;if(!Array.isArray(p))return e;const f=p.reduce(((e,{rpcUrl:t,chainId:r,ticker:i,nickname:n,rpcPrefs:s})=>({...e,[(0,a.v4)()]:{rpcUrl:t,chainId:r,ticker:i,rpcPrefs:s,nickname:n}})),{});return delete h.frequentRpcListDetail,{...e,NetworkController:{...m,networkConfigurations:f},PreferencesController:{...h}}}(t.data),t},r.version=void 0;var i,n=e("lodash"),s=e("@metamask/utils"),a=e("uuid"),o=(i=e("loglevel"))&&i.__esModule?i:{default:i};const l=r.version=82}}},{package:"$root$",file:"app/scripts/migrations/082.ts"}],[207,{"@metamask/utils":2300,lodash:3836},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.migrate=async function(e){const t=(0,i.cloneDeep)(e);return t.meta.version=s,t.data=function(e){if(!(0,n.isObject)(e.NetworkController)){var t,r;return null===(t=global.sentry)||void 0===t||null===(r=t.captureException)||void 0===r||r.call(t,new Error("typeof state.NetworkController is "+typeof e.NetworkController)),e}const{NetworkController:i}=e;if(!(0,n.isObject)(i.networkConfigurations)){var s,a;return null===(s=global.sentry)||void 0===s||null===(a=s.captureException)||void 0===a||a.call(s,new Error("typeof NetworkController.networkConfigurations is "+typeof i.networkConfigurations)),e}const{networkConfigurations:o}=i,l={};for(const t of Object.keys(o)){const r=o[t];if(!(0,n.isObject)(r))return e;l[t]={...r,id:t}}return{...e,NetworkController:{...i,networkConfigurations:l}}}(t.data),t},r.version=void 0;var i=e("lodash"),n=e("@metamask/utils");const s=r.version=83}}},{package:"$root$",file:"app/scripts/migrations/083.ts"}],[208,{"@metamask/utils":2300,lodash:3836},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.migrate=async function(e){const t=(0,i.cloneDeep)(e);return t.meta.version=s,t.data=function(e){if(!(0,n.hasProperty)(e,"NetworkController")||!(0,n.isObject)(e.NetworkController)){var t,r;return null===(t=global.sentry)||void 0===t||null===(r=t.captureException)||void 0===r||r.call(t,new Error("typeof state.NetworkController is "+typeof e.NetworkController)),e}if(!(0,n.hasProperty)(e.NetworkController,"network")){var i,s;if(e.NetworkController.networkId===undefined)null===(i=global.sentry)||void 0===i||null===(s=i.captureException)||void 0===s||s.call(i,new Error("typeof state.NetworkController.network is "+typeof e.NetworkController.network));return e}const a={...e.NetworkController};"loading"===a.network?(a.networkId=null,a.networkStatus="unknown"):(a.networkId=a.network,a.networkStatus="available");return delete a.network,{...e,NetworkController:a}}(t.data),t},r.version=void 0;var i=e("lodash"),n=e("@metamask/utils");const s=r.version=84}}},{package:"$root$",file:"app/scripts/migrations/084.ts"}],[209,{"@metamask/utils":2300,lodash:3836},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.migrate=async function(e){const t=(0,i.cloneDeep)(e);return t.meta.version=s,t.data=function(e){if(!(0,n.isObject)(e.NetworkController)){var t,r;return null===(t=global.sentry)||void 0===t||null===(r=t.captureException)||void 0===r||r.call(t,new Error("typeof state.NetworkController is "+typeof e.NetworkController)),e}return delete e.NetworkController.previousProviderStore,e}(t.data),t},r.version=void 0;var i=e("lodash"),n=e("@metamask/utils");const s=r.version=85}}},{package:"$root$",file:"app/scripts/migrations/085.ts"}],[21,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.processOnChainNotification=function(e){return{...e,id:e.id,createdAt:new Date(e.created_at).toISOString(),isRead:!e.unread}}}}},{package:"$root$",file:"app/scripts/controllers/metamask-notifications/processors/process-onchain-notifications.ts"}],[210,{"@metamask/utils":2300,lodash:3836},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.migrate=async function(e){const t=(0,n.cloneDeep)(e);return t.meta.version=s,t.data=function(e){if((0,i.hasProperty)(e,"NetworkController")&&(0,i.isObject)(e.NetworkController)&&(0,i.hasProperty)(e.NetworkController,"provider")){const t=e.NetworkController;return t.providerConfig=t.provider,delete t.provider,{...e,NetworkController:t}}var t,r;if((0,i.isObject)(e.NetworkController)){if(!(0,i.hasProperty)(e.NetworkController,"provider")){var n,s;if(e.NetworkController.providerConfig===undefined)null===(n=global.sentry)||void 0===n||null===(s=n.captureException)||void 0===s||s.call(n,new Error("typeof state.NetworkController.provider is "+typeof e.NetworkController.provider))}}else null===(t=global.sentry)||void 0===t||null===(r=t.captureException)||void 0===r||r.call(t,new Error("typeof state.NetworkController is "+typeof e.NetworkController));return e}(t.data),t},r.version=void 0;var i=e("@metamask/utils"),n=e("lodash");const s=r.version=86}}},{package:"$root$",file:"app/scripts/migrations/086.ts"}],[211,{"@metamask/utils":2300,lodash:3836},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.migrate=async function(e){const t=(0,n.cloneDeep)(e);return t.meta.version=s,t.data=function(e){if(!(0,i.isObject)(e.TokensController)){var t,r;return null===(t=global.sentry)||void 0===t||null===(r=t.captureException)||void 0===r||r.call(t,new Error("typeof state.TokensController is "+typeof e.TokensController)),e}return delete e.TokensController.suggestedAssets,e}(t.data),t},r.version=void 0;var i=e("@metamask/utils"),n=e("lodash");const s=r.version=87}}},{package:"$root$",file:"app/scripts/migrations/087.ts"}],[212,{"@metamask/utils":2300,"ethereumjs-util":3288,lodash:3836,loglevel:3842},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.migrate=async function(e){const t=(0,a.cloneDeep)(e);return t.meta.version=l,function(e){if((0,n.hasProperty)(e,"NftController")&&(0,n.isObject)(e.NftController)){const l=e.NftController;if((0,n.hasProperty)(l,"allNftContracts")&&(0,n.isObject)(l.allNftContracts)){const{allNftContracts:e}=l;Object.keys(e).every((t=>(0,n.isObject)(e[t])))&&Object.keys(e).forEach((t=>{const r=e[t];if((0,n.isObject)(r)){for(const e of Object.keys(r))"undefined"!==e&&e!==undefined||delete r[e];e[t]=(0,a.mapKeys)(r,((e,t)=>c(t)))}}))}else if((0,n.hasProperty)(l,"allNftContracts")){var t,r;null===(t=global.sentry)||void 0===t||null===(r=t.captureException)||void 0===r||r.call(t,new Error("typeof state.NftController.allNftContracts is "+typeof l.allNftContracts))}else o.default.warn("typeof state.NftController.allNftContracts is "+typeof l.allNftContracts);if((0,n.hasProperty)(l,"allNfts")&&(0,n.isObject)(l.allNfts)){const{allNfts:e}=l;Object.keys(e).every((t=>(0,n.isObject)(e[t])))&&Object.keys(e).forEach((t=>{const r=e[t];if((0,n.isObject)(r)){for(const e of Object.keys(r))"undefined"!==e&&e!==undefined||delete r[e];e[t]=(0,a.mapKeys)(r,((e,t)=>c(t)))}}))}else if((0,n.hasProperty)(l,"allNfts")){var i,s;null===(i=global.sentry)||void 0===i||null===(s=i.captureException)||void 0===s||s.call(i,new Error("typeof state.NftController.allNfts is "+typeof l.allNfts))}else o.default.warn("typeof state.NftController.allNfts is "+typeof l.allNfts);e.NftController=l}else if((0,n.hasProperty)(e,"NftController")){var l,u;null===(l=global.sentry)||void 0===l||null===(u=l.captureException)||void 0===u||u.call(l,new Error("typeof state.NftController is "+typeof e.NftController))}else o.default.warn("typeof state.NftController is undefined");if((0,n.hasProperty)(e,"TokenListController")&&(0,n.isObject)(e.TokenListController)){const t=e.TokenListController;if((0,n.hasProperty)(t,"tokensChainsCache")&&(0,n.isObject)(t.tokensChainsCache)){for(const e of Object.keys(t.tokensChainsCache))"undefined"!==e&&e!==undefined||delete t.tokensChainsCache[e];t.tokensChainsCache=(0,a.mapKeys)(t.tokensChainsCache,((e,t)=>c(t)))}else if((0,n.hasProperty)(t,"tokensChainsCache")){var d,h;null===(d=global.sentry)||void 0===d||null===(h=d.captureException)||void 0===h||h.call(d,new Error("typeof state.TokenListController.tokensChainsCache is "+typeof e.TokenListController.tokensChainsCache))}else o.default.warn("typeof state.TokenListController.tokensChainsCache is undefined")}else o.default.warn("typeof state.TokenListController is "+typeof e.TokenListController);if((0,n.hasProperty)(e,"TokensController")&&(0,n.isObject)(e.TokensController)){const t=e.TokensController;if((0,n.hasProperty)(t,"allTokens")&&(0,n.isObject)(t.allTokens)){const{allTokens:e}=t;for(const t of Object.keys(e))"undefined"!==t&&t!==undefined||delete e[t];t.allTokens=(0,a.mapKeys)(e,((e,t)=>c(t)))}else if((0,n.hasProperty)(t,"allTokens")){var m,p;null===(m=global.sentry)||void 0===m||null===(p=m.captureException)||void 0===p||p.call(m,new Error("typeof state.TokensController.allTokens is "+typeof t.allTokens))}else o.default.warn("typeof state.TokensController.allTokens is "+typeof t.allTokens);if((0,n.hasProperty)(t,"allIgnoredTokens")&&(0,n.isObject)(t.allIgnoredTokens)){const{allIgnoredTokens:e}=t;for(const t of Object.keys(e))"undefined"!==t&&t!==undefined||delete e[t];t.allIgnoredTokens=(0,a.mapKeys)(e,((e,t)=>c(t)))}else if((0,n.hasProperty)(t,"allIgnoredTokens")){var f,v;null===(f=global.sentry)||void 0===f||null===(v=f.captureException)||void 0===v||v.call(f,new Error("typeof state.TokensController.allIgnoredTokens is "+typeof t.allIgnoredTokens))}else o.default.warn("typeof state.TokensController.allIgnoredTokens is "+typeof t.allIgnoredTokens);if((0,n.hasProperty)(t,"allDetectedTokens")&&(0,n.isObject)(t.allDetectedTokens)){const{allDetectedTokens:e}=t;for(const t of Object.keys(e))"undefined"!==t&&t!==undefined||delete e[t];t.allDetectedTokens=(0,a.mapKeys)(e,((e,t)=>c(t)))}else if((0,n.hasProperty)(t,"allDetectedTokens")){var g,_;null===(g=global.sentry)||void 0===g||null===(_=g.captureException)||void 0===_||_.call(g,new Error("typeof state.TokensController.allDetectedTokens is "+typeof t.allDetectedTokens))}else o.default.warn("typeof state.TokensController.allDetectedTokens is "+typeof t.allDetectedTokens);e.TokensController=t}else{var k,y;null===(k=global.sentry)||void 0===k||null===(y=k.captureException)||void 0===y||y.call(k,new Error("typeof state.TokensController is "+typeof e.TokensController))}}(t.data),t},r.version=void 0;var i,n=e("@metamask/utils"),s=e("ethereumjs-util"),a=e("lodash"),o=(i=e("loglevel"))&&i.__esModule?i:{default:i};const l=r.version=88;function c(e){if("string"==typeof e&&(0,n.isStrictHexString)(e))return e;return`0x${s.BN.isBN(e)?e.toString(16):new s.BN(e.toString(),10).toString(16)}`}}}},{package:"$root$",file:"app/scripts/migrations/088.ts"}],[213,{"@metamask/utils":2300,lodash:3836},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.migrate=async function(e){const t=(0,n.cloneDeep)(e);return t.meta.version=s,t.data=function(e){if((0,i.hasProperty)(e,"NetworkController")&&(0,i.isObject)(e.NetworkController)&&(0,i.hasProperty)(e.NetworkController,"providerConfig")&&(0,i.isObject)(e.NetworkController.providerConfig)){const{networkConfigurations:t,providerConfig:r}=e.NetworkController;if(!(0,i.isObject)(t))return e;if(r.id)return e;let n;for(const s of Object.keys(t)){const a=t[s];if(!(0,i.isObject)(a))return e;if(a.rpcUrl===r.rpcUrl){n=a.id;break}}return n?(e.NetworkController.providerConfig={...r,id:n},{...e,NetworkController:e.NetworkController}):e}var t,r;if((0,i.isObject)(e.NetworkController)){if(!(0,i.isObject)(e.NetworkController.providerConfig)){var n,s;null===(n=global.sentry)||void 0===n||null===(s=n.captureException)||void 0===s||s.call(n,new Error("typeof state.NetworkController.providerConfig is "+typeof e.NetworkController.providerConfig))}}else null===(t=global.sentry)||void 0===t||null===(r=t.captureException)||void 0===r||r.call(t,new Error("typeof state.NetworkController is "+typeof e.NetworkController));return e}(t.data),t},r.version=void 0;var i=e("@metamask/utils"),n=e("lodash");const s=r.version=89}}},{package:"$root$",file:"app/scripts/migrations/089.ts"}],[214,{"@metamask/utils":2300,lodash:3836,loglevel:3842},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.migrate=async function(e){const t=(0,n.cloneDeep)(e);return t.meta.version=o,t.data=function(e){if(!(0,s.hasProperty)(e,"PhishingController"))return a.default.warn("typeof state.PhishingController is undefined"),e;if(!(0,s.isObject)(e.PhishingController)){var t,r;return null===(t=global.sentry)||void 0===t||null===(r=t.captureException)||void 0===r||r.call(t,new Error("typeof state.PhishingController is "+typeof e.PhishingController)),e}if(!(0,s.hasProperty)(e.PhishingController,"listState"))return a.default.warn("typeof state.PhishingController.listState is "+typeof e.PhishingController),e;return delete e.PhishingController.listState,e}(t.data),t},r.version=void 0;var i,n=e("lodash"),s=e("@metamask/utils"),a=(i=e("loglevel"))&&i.__esModule?i:{default:i};const o=r.version=90}}},{package:"$root$",file:"app/scripts/migrations/090.ts"}],[215,{"@metamask/utils":2300,lodash:3836},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.migrate=async function(e){const t=(0,n.cloneDeep)(e);return t.meta.version=s,t.data=function(e){if((0,i.hasProperty)(e,"NetworkController")&&(0,i.isObject)(e.NetworkController)&&(0,i.hasProperty)(e.NetworkController,"networkConfigurations")&&(0,i.isObject)(e.NetworkController.networkConfigurations)){const{networkConfigurations:t}=e.NetworkController;for(const[e,r]of Object.entries(t))(0,i.isObject)(r)&&(r.chainId||delete t[e]);return e.NetworkController={...e.NetworkController,networkConfigurations:t},{...e,NetworkController:e.NetworkController}}var t,r;if((0,i.isObject)(e.NetworkController)){if(!(0,i.isObject)(e.NetworkController.networkConfigurations)){var n,s;null===(n=global.sentry)||void 0===n||null===(s=n.captureException)||void 0===s||s.call(n,new Error("typeof state.NetworkController.networkConfigurations is "+typeof e.NetworkController.networkConfigurations))}}else null===(t=global.sentry)||void 0===t||null===(r=t.captureException)||void 0===r||r.call(t,new Error("typeof state.NetworkController is "+typeof e.NetworkController));return e}(t.data),t},r.version=void 0;var i=e("@metamask/utils"),n=e("lodash");const s=r.version=91}}},{package:"$root$",file:"app/scripts/migrations/091.ts"}],[216,{"@metamask/utils":2300,lodash:3836,loglevel:3842},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.migrate=async function(e){const t=(0,n.cloneDeep)(e);return t.meta.version=o,t.data=function(e){if(!(0,s.hasProperty)(e,"TokenListController"))return a.default.warn("Skipping migration, TokenListController state is missing"),e;var t,r;if(!(0,s.isObject)(e.TokenListController))return null===(t=global.sentry)||void 0===t||null===(r=t.captureException)||void 0===r||r.call(t,new Error("typeof state.TokenListController is "+typeof e.TokenListController)),e;if(!(0,s.hasProperty)(e.TokenListController,"tokensChainsCache"))return a.default.warn("Skipping migration, TokenListController.tokensChainsCache state is missing"),e;e.TokenListController.tokensChainsCache===undefined&&delete e.TokenListController.tokensChainsCache;return e}(t.data),t},r.version=void 0;var i,n=e("lodash"),s=e("@metamask/utils"),a=(i=e("loglevel"))&&i.__esModule?i:{default:i};const o=r.version=92.1}}},{package:"$root$",file:"app/scripts/migrations/092.1.ts"}],[217,{"@metamask/utils":2300,"@sentry/browser":2409,lodash:3836},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.migrate=async function(e){const t=(0,s.cloneDeep)(e);return t.meta.version=a,t.data=function(e){return function(e){const t=["networkId","networkStatus","providerConfig","networkDetails","networkConfigurations"];if(!(0,i.hasProperty)(e,"NetworkController")||!(0,s.isObject)(e.NetworkController))return(0,n.captureException)(`Migration ${a}: Invalid NetworkController state: ${typeof e.NetworkController}`),e;const r=e.NetworkController,o=(0,s.pick)(r,t);return{...e,NetworkController:o}}(e)}(t.data),t},r.version=void 0;var i=e("@metamask/utils"),n=e("@sentry/browser"),s=e("lodash");const a=r.version=92.2}}},{package:"$root$",file:"app/scripts/migrations/092.2.ts"}],[218,{"@metamask/utils":2300,lodash:3836,loglevel:3842},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.migrate=async function(e){const t=(0,s.cloneDeep)(e);return t.meta.version=o,function(e){!function(e){if((0,n.isNullOrUndefined)(e.PreferencesController))return void a.default.warn(`Migration #${o}: preferences controller null or undefined, skipping migration`);if((0,n.hasProperty)(e,"AppStateController")&&(0,n.isObject)(e.AppStateController)&&(0,n.hasProperty)(e,"PreferencesController")&&(0,n.isObject)(e.PreferencesController)){var t;const r=null===(t=e.PreferencesController)||void 0===t?void 0:t.advancedGasFee,i=(0,n.isObject)(r)&&l(r);e.AppStateController.hadAdvancedGasFeesSetPriorToMigration92_3=i,(null===e.PreferencesController.advancedGasFee||(0,n.isObject)(e.PreferencesController.advancedGasFee)&&l(e.PreferencesController.advancedGasFee))&&(e.PreferencesController.advancedGasFee={})}else if(!1===(0,n.isObject)(e.AppStateController)){var r,i;null===(r=global.sentry)||void 0===r||null===(i=r.captureException)||void 0===i||i.call(r,new Error("typeof state.AppStateController is "+typeof e.AppStateController))}else if(!1===(0,n.isObject)(e.PreferencesController)){var s,c;null===(s=global.sentry)||void 0===s||null===(c=s.captureException)||void 0===c||c.call(s,new Error("typeof state.PreferencesController is "+typeof e.PreferencesController))}}(e)}(t.data),t},r.version=void 0;var i,n=e("@metamask/utils"),s=e("lodash"),a=(i=e("loglevel"))&&i.__esModule?i:{default:i};const o=r.version=92.3;function l(e){const t=Object.keys(e);return!(!t.includes("maxBaseFee")&&!t.includes("priorityFee"))}}}},{package:"$root$",file:"app/scripts/migrations/092.3.ts"}],[219,{"@metamask/utils":2300,lodash:3836,loglevel:3842},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.migrate=async function(e){const t=(0,n.cloneDeep)(e);return t.meta.version=o,t.data=function(e){if((0,s.hasProperty)(e,"PhishingController")&&(0,s.isObject)(e.PhishingController))delete e.PhishingController.stalelistLastFetched,delete e.PhishingController.hotlistLastFetched;else if((0,s.hasProperty)(e,"PhishingController")){var t,r;null===(t=global.sentry)||void 0===t||null===(r=t.captureException)||void 0===r||r.call(t,new Error("typeof state.PhishingController is "+typeof e.PhishingController))}else a.default.warn("typeof state.PhishingController is undefined");return e}(t.data),t},r.version=void 0;var i,n=e("lodash"),s=e("@metamask/utils"),a=(i=e("loglevel"))&&i.__esModule?i:{default:i};const o=r.version=92}}},{package:"$root$",file:"app/scripts/migrations/092.ts"}],[22,{"../constants/notification-schema":17,"../processors/process-feature-announcement":19,"@contentful/rich-text-html-renderer":351,loglevel:3842},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.FEATURE_ANNOUNCEMENT_URL=r.FEATURE_ANNOUNCEMENT_API=void 0,r.getFeatureAnnouncementNotifications=async function(){return(await async function(){const e=await async function(e,t=1,r=1e3){let i=null;for(let n=0;n<t;n++)try{const t=await fetch(e);if(!t.ok)throw new Error(`Fetch failed with status: ${t.status}`);return await t.json()}catch(e){e instanceof Error&&(i=e),n<t-1&&await new Promise((e=>setTimeout(e,r)))}return s.default.error(`Error fetching from Contentful after ${t} retries: ${i}`),null}(c);if(!e)return[];const t=t=>{var r,i;const n=(null==e||null===(r=e.includes)||void 0===r||null===(r=r.Entry)||void 0===r?void 0:r.find((e=>{var r;return(null==e||null===(r=e.sys)||void 0===r?void 0:r.id)===t})))||(null==e||null===(i=e.includes)||void 0===i||null===(i=i.Asset)||void 0===i?void 0:i.find((e=>{var r;return(null==e||null===(r=e.sys)||void 0===r?void 0:r.id)===t})));return n?null==n?void 0:n.fields:null},r=((null==e?void 0:e.items)??[]).map((e=>{var r;const{fields:i}=e,s=i.image?t(i.image.sys.id):undefined,a=i.extensionLink?t(i.extensionLink.sys.id):undefined;return{type:o.TRIGGER_TYPES.FEATURES_ANNOUNCEMENT,createdAt:new Date(e.sys.createdAt).toString(),data:{id:i.id,category:i.category,title:i.title,longDescription:(0,n.documentToHtmlString)(i.longDescription),shortDescription:i.shortDescription,image:{title:null==s?void 0:s.title,description:null==s?void 0:s.description,url:(null==s||null===(r=s.file)||void 0===r?void 0:r.url)??""},extensionLink:a&&{extensionLinkText:null==a?void 0:a.extensionLinkText,extensionLinkRoute:null==a?void 0:a.extensionLinkRoute}}}}));return r}()).map((e=>(0,a.processFeatureAnnouncement)(e)));return[]};var i,n=e("@contentful/rich-text-html-renderer"),s=(i=e("loglevel"))&&i.__esModule?i:{default:i},a=e("../processors/process-feature-announcement"),o=e("../constants/notification-schema");const l=r.FEATURE_ANNOUNCEMENT_API="https://cdn.contentful.com/spaces/jdkgyfmyd9sw/environments/master/entries",c=r.FEATURE_ANNOUNCEMENT_URL=`${l}?access_token=mAYNB_k65snv4AXW4o8ksZN8BwWDQF9702HKV7yBDZI&content_type=productAnnouncement&include=10&fields.clients=extension`}}},{package:"$root$",file:"app/scripts/controllers/metamask-notifications/services/feature-announcements.ts"}],[220,{"@metamask/utils":2300,lodash:3836},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.migrate=async function(e){const t=(0,i.cloneDeep)(e);return t.meta.version=s,t.data=function(e){if((0,n.hasProperty)(e,"NetworkController")&&(0,n.isObject)(e.NetworkController)&&(0,n.hasProperty)(e.NetworkController,"providerConfig")&&(0,n.isObject)(e.NetworkController.providerConfig)){const{providerConfig:t}=e.NetworkController;return t.ticker?e:(e.NetworkController.providerConfig={ticker:"ETH",...t},{...e,NetworkController:e.NetworkController})}var t,r;if((0,n.isObject)(e.NetworkController)){if((0,n.isObject)(e.NetworkController)&&!(0,n.isObject)(e.NetworkController.providerConfig)){var i,s;null===(i=global.sentry)||void 0===i||null===(s=i.captureException)||void 0===s||s.call(i,new Error("typeof state.NetworkController.providerConfig is "+typeof e.NetworkController.providerConfig))}}else null===(t=global.sentry)||void 0===t||null===(r=t.captureException)||void 0===r||r.call(t,new Error("typeof state.NetworkController is "+typeof e.NetworkController));return e}(t.data),t},r.version=void 0;var i=e("lodash"),n=e("@metamask/utils");const s=r.version=93}}},{package:"$root$",file:"app/scripts/migrations/093.ts"}],[221,{"@metamask/controller-utils":1163,"@metamask/network-controller":1555,"@metamask/utils":2300,lodash:3836},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.migrate=async function(e){const t=(0,i.cloneDeep)(e);return t.meta.version=o,t.data=function(e){if((0,n.hasProperty)(e,"NetworkController")&&(0,n.isObject)(e.NetworkController)&&(0,n.hasProperty)(e.NetworkController,"providerConfig")&&(0,n.isObject)(e.NetworkController.providerConfig)&&((0,n.hasProperty)(e.NetworkController.providerConfig,"id")||(0,n.hasProperty)(e.NetworkController.providerConfig,"type")&&e.NetworkController.providerConfig.type!==a.NetworkType.rpc)){const t=e.NetworkController.providerConfig.id||e.NetworkController.providerConfig.type;if(!t||"string"!=typeof t)return e;const r={[t]:{EIPS:{},status:s.NetworkStatus.Unknown}};if((0,n.hasProperty)(e.NetworkController,"networkDetails")&&(0,n.isObject)(e.NetworkController.networkDetails)){const{networkDetails:i}=e.NetworkController;i.EIPS&&(0,n.isObject)(i.EIPS)&&(r[t].EIPS={...i.EIPS}),delete e.NetworkController.networkDetails}return(0,n.hasProperty)(e.NetworkController,"networkStatus")&&"string"==typeof e.NetworkController.networkStatus&&(r[t].status=e.NetworkController.networkStatus,delete e.NetworkController.networkStatus),{...e,NetworkController:{...e.NetworkController,networksMetadata:r,selectedNetworkClientId:t}}}var t,r;if((0,n.isObject)(e.NetworkController)){if((0,n.isObject)(e.NetworkController)&&!(0,n.isObject)(e.NetworkController.providerConfig)){var i,o;null===(i=global.sentry)||void 0===i||null===(o=i.captureException)||void 0===o||o.call(i,new Error("typeof state.NetworkController.providerConfig is "+typeof e.NetworkController.providerConfig))}else if((0,n.isObject)(e.NetworkController)&&(0,n.isObject)(e.NetworkController.providerConfig)){var l,c;null===(l=global.sentry)||void 0===l||null===(c=l.captureException)||void 0===c||c.call(l,new Error(`typeof state.NetworkController.providerConfig.id is ${typeof e.NetworkController.providerConfig.id} and state.NetworkController.providerConfig.type is ${e.NetworkController.providerConfig.type}`))}}else null===(t=global.sentry)||void 0===t||null===(r=t.captureException)||void 0===r||r.call(t,new Error("typeof state.NetworkController is "+typeof e.NetworkController));return e}(t.data),t},r.version=void 0;var i=e("lodash"),n=e("@metamask/utils"),s=e("@metamask/network-controller"),a=e("@metamask/controller-utils");const o=r.version=94}}},{package:"$root$",file:"app/scripts/migrations/094.ts"}],[222,{lodash:3836},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.migrate=async function(e){const t=(0,i.cloneDeep)(e);return t.meta.version=n,function(e){(function(e){var t,r;const i=(null===(t=e.IncomingTransactionsController)||void 0===t?void 0:t.incomingTransactions)||{};if(0===Object.keys(i).length)return;const n=(null===(r=e.TransactionController)||void 0===r?void 0:r.transactions)||{},s=Object.values(i).reduce(((e,t)=>(e[t.id]=t,e)),n);e.TransactionController={...e.TransactionController||{},transactions:s}})(e),function(e){var t;const r=(null===(t=e.IncomingTransactionsController)||void 0===t?void 0:t.incomingTransactions)||{};if(0===Object.keys(r).length)return;const i={};for(const e of Object.values(r)){if(!e.blockNumber||!e.chainId||!e.txParams.to)continue;const t=parseInt(e.blockNumber,10),r=`${e.chainId}#${e.txParams.to.toLowerCase()}`,n=i[r]||-1;i[r]=Math.max(n,t)}e.TransactionController={...e.TransactionController,lastFetchedBlockNumbers:i}}(e),function(e){delete e.IncomingTransactionsController}(e)}(t.data),t},r.version=void 0;var i=e("lodash");const n=r.version=95}}},{package:"$root$",file:"app/scripts/migrations/095.ts"}],[223,{"../../../shared/constants/network":4507,"@metamask/utils":2300,lodash:3836},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.migrate=async function(e){const t=(0,i.cloneDeep)(e);return t.meta.version=a,function(e){if(!((0,n.hasProperty)(e,"PreferencesController")&&(0,n.isObject)(e.PreferencesController)&&(0,n.isObject)(e.NetworkController)&&(0,n.hasProperty)(e.PreferencesController,"featureFlags")&&(0,n.hasProperty)(e.NetworkController,"networkConfigurations")))return e;const{PreferencesController:t,NetworkController:r}=e,{featureFlags:a}=t,{showIncomingTransactions:o}=a,{networkConfigurations:l}=r,c=Object.values(l).map((e=>e.chainId)),u=[s.CHAIN_IDS.MAINNET,s.CHAIN_IDS.LINEA_MAINNET],d=[s.CHAIN_IDS.GOERLI,s.CHAIN_IDS.SEPOLIA,s.CHAIN_IDS.LINEA_GOERLI],h=[...u,...c,...d],m=(0,i.fromPairs)((0,i.map)(h,(e=>[e,o])));(null==a?void 0:a.showIncomingTransactions)!==undefined&&delete a.showIncomingTransactions;e.PreferencesController.incomingTransactionsPreferences=m}(t.data),t},r.version=void 0;var i=e("lodash"),n=e("@metamask/utils"),s=e("../../../shared/constants/network");const a=r.version=96}}},{package:"$root$",file:"app/scripts/migrations/096.ts"}],[224,{lodash:3836},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.migrate=async function(e){const t=(0,i.cloneDeep)(e);return t.meta.version=n,function(e){const t=(null==e?void 0:e.TransactionController)||{},r=(null==t?void 0:t.transactions)||{};if((0,i.isEmpty)(r))return;const n=Object.keys(r).reduce(((e,t)=>{const i=r[t];return null!=i&&i.nonceDetails&&delete i.nonceDetails,{...e,[t]:i}}),{});e.TransactionController={...t,transactions:n}}(t.data),t},r.version=void 0;var i=e("lodash");const n=r.version=97}}},{package:"$root$",file:"app/scripts/migrations/097.ts"}],[225,{lodash:3836},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.migrate=async function(e){const t=(0,i.cloneDeep)(e);return t.meta.version=n,function(e){const t=(null==e?void 0:e.TransactionController)||{},r=(null==t?void 0:t.transactions)||{};if((0,i.isEmpty)(r))return;const n=Object.keys(r).reduce(((e,t)=>{const i=r[t];return i.verifiedOnBlockchain=Boolean(i.txReceipt),{...e,[t]:i}}),{});e.TransactionController={...t,transactions:n}}(t.data),t},r.version=void 0;var i=e("lodash");const n=r.version=98}}},{package:"$root$",file:"app/scripts/migrations/098.ts"}],[2253,{"./chunk-BTR56Y3F.js":2254,"./chunk-K6XMMCKJ.js":2257,"./chunk-KQMYR73X.js":2259,"@metamask/controller-utils":2278,"@metamask/utils":2300,"bn.js":2980},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i,n=e("./chunk-K6XMMCKJ.js"),s=e("./chunk-KQMYR73X.js"),a=e("./chunk-BTR56Y3F.js"),o=e("@metamask/controller-utils"),l=e("@metamask/utils"),c=e("bn.js"),u=(i=c)&&i.__esModule?i:{default:i},d=s.createModuleLogger.call(void 0,s.projectLogger,"gas"),h=1.5;function m(e){const t=("string"==typeof e?o.hexToBN.call(void 0,e):new(0,u.default)(e)).muln(h);return l.add0x.call(void 0,t.toString(16))}r.updateGas=async function(e,t,r){const{userOperation:i}=e;if(t.gas)return i.callGasLimit=t.gas.callGasLimit,i.preVerificationGas=t.gas.preVerificationGas,i.verificationGasLimit=t.gas.verificationGasLimit,void d("Using gas values from smart contract account",{callGasLimit:i.callGasLimit,preVerificationGas:i.preVerificationGas,verificationGasLimit:i.verificationGasLimit});const s={...i,maxFeePerGas:a.VALUE_ZERO,maxPriorityFeePerGas:a.VALUE_ZERO,callGasLimit:a.VALUE_ZERO,preVerificationGas:a.VALUE_ZERO,verificationGasLimit:"0xF4240"},o=new(0,n.Bundler)(e.bundlerUrl),l=await o.estimateUserOperationGas(s,r);i.callGasLimit=m(l.callGasLimit),i.preVerificationGas=m(l.preVerificationGas),i.verificationGasLimit=m(l.verificationGasLimit??l.verificationGas),d("Using buffered gas values from bundler estimate",{callGasLimit:i.callGasLimit,preVerificationGas:i.preVerificationGas,verificationGasLimit:i.verificationGasLimit,multiplier:h,estimate:l})}}}},{package:"@metamask/user-operation-controller",file:"node_modules/@metamask/user-operation-controller/dist/chunk-7JPKNM2X.js"}],[2254,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});r.EMPTY_BYTES="0x",r.ADDRESS_ZERO="0x0000000000000000000000000000000000000000",r.VALUE_ZERO="0x0"}}},{package:"@metamask/user-operation-controller",file:"node_modules/@metamask/user-operation-controller/dist/chunk-BTR56Y3F.js"}],[2255,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var i=(e=>(e.Unapproved="unapproved",e.Approved="approved",e.Signed="signed",e.Submitted="submitted",e.Failed="failed",e.Confirmed="confirmed",e))(i||{});r.UserOperationStatus=i}}},{package:"@metamask/user-operation-controller",file:"node_modules/@metamask/user-operation-controller/dist/chunk-EKSYIL4U.js"}]],[],{});